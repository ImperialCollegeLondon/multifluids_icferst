<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE testproblem SYSTEM "regressiontest.dtd">
<testproblem>
  <name>p1p1-cg LES convergence test</name>
  <owner userid="jbull"/>
  <tags>flml</tags>
  <problem_definition length="special" nprocs="4">
    <command_line>mpiexec ../../bin/fluidity -l -v2 taylor-green-vortex-3d-48.flml</command_line>
  </problem_definition>
  <variables>
    <variable name="tke_dissipation_rate" language="python">
from fluidity_tools import stat_parser as stat
from math import log, pi
from vortex_tools import plot_dissipation as vplot
import numpy

vort_12 = stat("taylor-green-vortex-3d-12.stat")["Fluid"]["Vorticity%magnitude"]["l2norm"]
time_12 = stat("taylor-green-vortex-3d-12.stat")["ElapsedTime"]["value"]
vort_24 = stat("taylor-green-vortex-3d.stat")["Fluid"]["Vorticity%magnitude"]["l2norm"]
time_24 = stat("taylor-green-vortex-3d.stat")["ElapsedTime"]["value"]
vort_48 = stat("taylor-green-vortex-3d-48.stat")["Fluid"]["Vorticity%magnitude"]["l2norm"]
time_48 = stat("taylor-green-vortex-3d-48.stat")["ElapsedTime"]["value"]
vort_les12 = stat("taylor-green-vortex-3d-les-12.stat")["Fluid"]["Vorticity%magnitude"]["l2norm"]
time_les12 = stat("taylor-green-vortex-3d-les-12.stat")["ElapsedTime"]["value"]

vplot(vort_12,time_12,vort_24,time_24,vort_48,time_48,vort_les12,time_les12)

tke_dissipation_rate = 1.0
    </variable>
  </variables>
  <pass_tests>
    <test name="test" language="python">
assert(tke_dissipation_rate==1.0)
    </test>
  </pass_tests>
  <warn_tests>
  </warn_tests>
</testproblem>

