<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE testproblem SYSTEM "regressiontest.dtd">
<testproblem>
  <name>p2p1-cg inverse Helmholtz filter convergence test</name>
  <owner userid="jbull"/>
  <tags>flml</tags>
  <problem_definition length="short" nprocs="1">
    <command_line>fluidity -v2 -l MMS_A_unstructured.flml &amp;&amp; fluidity MMS_B_unstructured.flml &amp;&amp; fluidity MMS_C_unstructured.flml &amp;&amp; fluidity MMS_D_unstructured.flml  &amp;&amp; fluidity MMS_E_unstructured.flml</command_line>
  </problem_definition>
  <variables>
    <variable name="ab_convergence_f" language="python">
#
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','w')

a_error = stat("MMS_A_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_B_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_A_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_B_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('ab_convergence_f '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

ab_convergence_f = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="ab_convergence_if" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_A_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_B_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_A_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_B_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('ab_convergence_if '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

ab_convergence_if = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="ab_convergence_mlf" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_A_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_B_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_A_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_B_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('ab_convergence_mlf '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

ab_convergence_mlf = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="bc_convergence_f" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_B_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_C_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_B_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_C_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('bc_convergence_f '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

bc_convergence_f = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="bc_convergence_if" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_B_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_C_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_B_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_C_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('bc_convergence_if '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

bc_convergence_if = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="bc_convergence_mlf" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_B_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_C_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_B_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_C_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('bc_convergence_mlf '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

bc_convergence_mlf = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="cd_convergence_f" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_C_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_D_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_C_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_D_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('cd_convergence_f '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

cd_convergence_f = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="cd_convergence_if" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_C_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_D_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_C_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_D_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('cd_convergence_if '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

cd_convergence_if = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="cd_convergence_mlf" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_C_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_D_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_C_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_D_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('cd_convergence_mlf '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

cd_convergence_mlf = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="de_convergence_f" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_D_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_E_unstructured.stat")["NS"]["AnisoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_D_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_E_unstructured.stat")["NS"]["AnisoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('de_convergence_f '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

de_convergence_f = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="de_convergence_if" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_D_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_E_unstructured.stat")["NS"]["IsoFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_D_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_E_unstructured.stat")["NS"]["IsoFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('de_convergence_if '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

de_convergence_if = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="de_convergence_mlf" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output=open('output_unstructured.log','a')

a_error = stat("MMS_D_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]
b_error = stat("MMS_E_unstructured.stat")["NS"]["MLFilterDifference"]["l2norm"][-1]

a_error_inf = stat("MMS_D_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]
b_error_inf = stat("MMS_E_unstructured.stat")["NS"]["MLFilterDifference"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output.write('de_convergence_mlf '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output.close()

de_convergence_mlf = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="ab_convergence_comm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','w')
output2=open('commerror_unstructured.log','w')

a_error = stat("MMS_A_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_B_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_A_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_B_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('AB_convergence_comm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('A_commerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

ab_convergence_comm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="ab_convergence_icomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_A_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_B_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_A_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_B_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('AB_convergence_icomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('A_icommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

ab_convergence_icomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="ab_convergence_mlcomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_A_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_B_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_A_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_B_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('AB_convergence_mlcomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('A_mlcommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

ab_convergence_mlcomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="bc_convergence_comm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_B_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_C_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_B_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_C_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('BC_convergence_comm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('B_commerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

bc_convergence_comm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="bc_convergence_icomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_B_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_C_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_B_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_C_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('BC_convergence_icomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('B_icommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

bc_convergence_icomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="bc_convergence_mlcomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_B_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_C_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_B_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_C_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('BC_convergence_mlcomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('B_mlcommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

bc_convergence_mlcomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="cd_convergence_comm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_C_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_D_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_C_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_D_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('CD_convergence_comm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('C_commerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

cd_convergence_comm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="cd_convergence_icomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_C_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_D_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_C_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_D_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('CD_convergence_icomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('C_icommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

cd_convergence_icomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="cd_convergence_mlcomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_C_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_D_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_C_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_D_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('CD_convergence_mlcomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('C_mlcommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

cd_convergence_mlcomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="de_convergence_comm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_D_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_E_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_D_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_E_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('DE_convergence_comm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('D_commerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

de_convergence_comm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="de_convergence_icomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_D_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_E_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_D_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_E_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('DE_convergence_icomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('D_icommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output1.close()
output2.close()

de_convergence_icomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
    <variable name="de_convergence_mlcomm" language="python">
from fluidity_tools import stat_parser as stat
from math import log
output1=open('commconv_unstructured.log','a')
output2=open('commerror_unstructured.log','a')

a_error = stat("MMS_D_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]
b_error = stat("MMS_E_unstructured.stat")["NS"]["MLCommError%magnitude"]["l2norm"][-1]
b2_error = stat("MMS_E_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["l2norm"][-1]
b3_error = stat("MMS_E_unstructured.stat")["NS"]["IsoCommError%magnitude"]["l2norm"][-1]

a_error_inf = stat("MMS_D_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]
b_error_inf = stat("MMS_E_unstructured.stat")["NS"]["MLCommError%magnitude"]["max"][-1]
b2_error_inf = stat("MMS_E_unstructured.stat")["NS"]["AnisoCommError%magnitude"]["max"][-1]
b3_error_inf = stat("MMS_E_unstructured.stat")["NS"]["IsoCommError%magnitude"]["max"][-1]

ab_ratio = a_error / b_error
ab_ratio_inf = a_error_inf / b_error_inf

output1.write('DE_convergence_mlcomm '+str(log(ab_ratio, 2))+' '+str(log(ab_ratio_inf, 2))+'\n')
output2.write('D_mlcommerror '+str(a_error)+' '+str(a_error_inf)+'\n')
output2.write('E_commerror '+str(b2_error)+' '+str(b2_error_inf)+'\n')
output2.write('E_icommerror '+str(b3_error)+' '+str(b3_error_inf)+'\n')
output2.write('E_mlcommerror '+str(b_error)+' '+str(b_error_inf)+'\n')
output1.close()
output2.close()

de_convergence_mlcomm = [log(ab_ratio, 2), log(ab_ratio_inf, 2)]
    </variable>
  </variables>
  <pass_tests>
    <test name="ab_convergence_f: L2 order > 1.7" language="python">
assert(ab_convergence_f[0] &gt; 1.7)
    </test>
    <test name="bc_convergence_f: L2 order > 1.7" language="python">
assert(bc_convergence_f[0] &gt; 1.7)
    </test>
    <test name="cd_convergence_f: L2 order > 1.7" language="python">
assert(cd_convergence_f[0] &gt; 1.7)
    </test>
    <test name="de_convergence_f: L2 order > 1.7" language="python">
assert(de_convergence_f[0] &gt; 1.7)
    </test>
    <test name="ab_convergence_if: L2 order > 1.7" language="python">
assert(ab_convergence_if[0] &gt; 1.7)
    </test>
    <test name="bc_convergence_if: L2 order > 1.7" language="python">
assert(bc_convergence_if[0] &gt; 1.7)
    </test>
    <test name="cd_convergence_if: L2 order > 1.7" language="python">
assert(cd_convergence_if[0] &gt; 1.7)
    </test>
    <test name="de_convergence_if: L2 order > 1.7" language="python">
assert(de_convergence_if[0] &gt; 1.7)
    </test>
    <test name="ab_convergence_mlf: L2 order > 1.7" language="python">
assert(ab_convergence_mlf[0] &gt; 1.7)
    </test>
    <test name="bc_convergence_mlf: L2 order > 1.7" language="python">
assert(bc_convergence_mlf[0] &gt; 1.7)
    </test>
    <test name="cd_convergence_mlf: L2 order > 1.7" language="python">
assert(cd_convergence_mlf[0] &gt; 1.7)
    </test>
    <test name="de_convergence_mlf: L2 order > 1.7" language="python">
assert(de_convergence_mlf[0] &gt; 1.7)
    </test>
    <test name="ab_convergence_comm: L2 order > 1.5" language="python">
assert(ab_convergence_comm[0] &gt; 1.5)
    </test>
    <test name="bc_convergence_comm: L2 order > 1.5" language="python">
assert(bc_convergence_comm[0] &gt; 1.5)
    </test>
    <test name="cd_convergence_comm: L2 order > 1.5" language="python">
assert(cd_convergence_comm[0] &gt; 1.5)
    </test>
    <test name="de_convergence_comm: L2 order > 1.5" language="python">
assert(de_convergence_comm[0] &gt; 1.5)
    </test>
    <test name="ab_convergence_icomm: L2 order > 1.5" language="python">
assert(ab_convergence_icomm[0] &gt; 1.5)
    </test>
    <test name="bc_convergence_icomm: L2 order > 1.5" language="python">
assert(bc_convergence_icomm[0] &gt; 1.5)
    </test>
    <test name="cd_convergence_icomm: L2 order > 1.5" language="python">
assert(cd_convergence_icomm[0] &gt; 1.5)
    </test>
    <test name="de_convergence_icomm: L2 order > 1.5" language="python">
assert(de_convergence_icomm[0] &gt; 1.5)
    </test>
    <test name="ab_convergence_mlcomm: L2 order > 1.5" language="python">
assert(ab_convergence_mlcomm[0] &gt; 1.5)
    </test>
    <test name="bc_convergence_mlcomm: L2 order > 1.5" language="python">
assert(bc_convergence_mlcomm[0] &gt; 1.5)
    </test>
    <test name="cd_convergence_mlcomm: L2 order > 1.5" language="python">
assert(cd_convergence_mlcomm[0] &gt; 1.5)
    </test>
    <test name="de_convergence_mlcomm: L2 order > 1.5" language="python">
assert(de_convergence_mlcomm[0] &gt; 1.5)
    </test>
  </pass_tests>
  <warn_tests>
  </warn_tests>
</testproblem>

