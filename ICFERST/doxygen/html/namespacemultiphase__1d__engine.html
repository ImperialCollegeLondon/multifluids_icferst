<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: multiphase_1d_engine Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICFERST
   &#160;<span id="projectnumber">22_06</span>
   </div>
   <div id="projectbrief">Reservoir simulator</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">multiphase_1d_engine Module Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a98e757b51a04b55df8d38e36470e0b96"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96">intenerge_assem_solve</a> (state, packed_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, tracer, velocity, density, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, VOLFRA_PORE, IGOT_T2, igot_theta_flux, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, option_path, mass_ele_transp, thermal, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, icomp, saturation, Permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:a98e757b51a04b55df8d38e36470e0b96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the transport of energy/temperature and to solve the transport of components.  <a href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96">More...</a><br /></td></tr>
<tr class="separator:a98e757b51a04b55df8d38e36470e0b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af9aedf8b67f5b7198eb4b67601a7fab0"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#af9aedf8b67f5b7198eb4b67601a7fab0">enthalpy_assem_solve</a> (state, packed_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, tracer, velocity, density, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, VOLFRA_PORE, IGOT_T2, igot_theta_flux, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, option_path, mass_ele_transp, thermal, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, icomp, saturation, Permeability_tensor_field, nonlinear_iteration, magma_phase_coefficients)</td></tr>
<tr class="memdesc:af9aedf8b67f5b7198eb4b67601a7fab0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the enthalpy equation. This is efectively the temperature equation but making the enthalpy implicit by substituting the temperature by its linear relationship with enthalpy: H = rho Cp Temp + rho Lf phi; Where Lf is the latent heat and phi is the amount of liquid fluid phase.  <a href="namespacemultiphase__1d__engine.html#af9aedf8b67f5b7198eb4b67601a7fab0">More...</a><br /></td></tr>
<tr class="separator:af9aedf8b67f5b7198eb4b67601a7fab0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c48c7bcc5921e6764217e562a7b5d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6">force_min_max_principle</a> (Mdims, entrance, tracer, nonlinear_iteration, totally_min_max)</td></tr>
<tr class="memdesc:a86c48c7bcc5921e6764217e562a7b5d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">: To help the stability of the system,if there are no sources/sinks it is known that the temperature must fulfill the min max principle, therefore here values outside this rank are capped.  <a href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6">More...</a><br /></td></tr>
<tr class="separator:a86c48c7bcc5921e6764217e562a7b5d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5819c18b57b8144faa1885776a2cc8b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b">tracer_assemble_solve</a> (Tracer_name, state, packed_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, tracer, velocity, density, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, VOLFRA_PORE, IGOT_T2, igot_theta_flux, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, mass_ele_transp, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, icomp, saturation, Permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:aa5819c18b57b8144faa1885776a2cc8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passive_Tracer_N Where N is an integer which is continuous starting from 1 A boussinesq approximation is enforced on these tracers as the are totally INERT CURRENTLY NO DIFFUSION.  <a href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b">More...</a><br /></td></tr>
<tr class="separator:aa5819c18b57b8144faa1885776a2cc8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29606c63b241238edd97827aa4564d7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7">volumefraction_assemble_solve</a> (state, packed_state, multicomponent_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, DT, SUF_SIG_DIAGTEN_BC, V_SOURCE, VOLFRA_PORE, igot_theta_flux, mass_ele_transp, nonlinear_iteration, time_step, SFPI_taken, SFPI_its, Courant_number, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J)</td></tr>
<tr class="memdesc:ad29606c63b241238edd97827aa4564d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded.  <a href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7">More...</a><br /></td></tr>
<tr class="separator:ad29606c63b241238edd97827aa4564d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871f4ede396b430a5194023196511192"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192">compositional_assemble_solve</a> (state, packed_state, multicomponent_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, mass_ele, sum_theta_flux, sum_one_m_theta_flux, sum_theta_flux_j, sum_one_m_theta_flux_j)</td></tr>
<tr class="memdesc:a871f4ede396b430a5194023196511192"><td class="mdescLeft">&#160;</td><td class="mdescRight">:In this subroutine the components are solved for all the phases. Systems for each component are assembled and solved by calling INTENERGE_ASSEM_SOLVE  <a href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192">More...</a><br /></td></tr>
<tr class="separator:a871f4ede396b430a5194023196511192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5be4b78c1796fac4008d398a7cdd0aa"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa">force_bal_cty_assem_solve</a> (state, packed_state, Mdims, CV_GIdims, FE_GIdims, CV_funs, FE_funs, Mspars, ndgln, Mdisopt, Mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, velocity, pressure, DT, SUF_SIG_DIAGTEN_BC, V_SOURCE, VOLFRA_PORE, IGOT_THETA_FLUX, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, calculate_mass_delta, outfluxes, pres_its_taken, nonlinear_its, Courant_number)</td></tr>
<tr class="memdesc:ae5be4b78c1796fac4008d398a7cdd0aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix Once these matrices (and corresponding RHSs) are generated the system of equations is solved.  <a href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa">More...</a><br /></td></tr>
<tr class="separator:ae5be4b78c1796fac4008d398a7cdd0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5917482b2dae4c57c6e06a839682e42"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#af5917482b2dae4c57c6e06a839682e42">dg_visc_lin</a> (S_INV_NNX_MAT12, NNX_MAT, NNX_MAT2, NN_MAT, NN_MAT2, U_SNLOC, U_NLOC, SBUFEN_REVERSED, SDETWE, SBCVNGI, SNORMXN_ALL, NDIM, U_SLOC2LOC, U_OTHER_LOC, U_NLOC_EXT, ON_BOUNDARY)</td></tr>
<tr class="memdesc:af5917482b2dae4c57c6e06a839682e42"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter element coupling for the viscocity discretization. NNX_MAT, NNX_MAT2 contain matricies of first derivative times basis function for current element and neightbouring element. Similarly NN_MAT, NN_MAT2, contain the element-wise mass matrices. Only call this sub if element not next to the boundary...  <a href="namespacemultiphase__1d__engine.html#af5917482b2dae4c57c6e06a839682e42">More...</a><br /></td></tr>
<tr class="separator:af5917482b2dae4c57c6e06a839682e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcedae35a0a37c9b033248d85bb9ad86"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86">viscocity_tensor_les_calc</a> (LES_UDIFFUSION, LES_UDIFFUSION_VOL, DUX_ELE_ALL, NDIM, NPHASE, U_NLOC, X_NLOC, TOTELE, X_NONODS, X_ALL, X_NDGLN, MAT_NONODS, MAT_NLOC, MAT_NDGLN, LES_DISOPT, LES_CS, UDEN, CV_NONODS, CV_NDGLN, U_NDGLN, U_NONODS, U_ALL, DERIV)</td></tr>
<tr class="memdesc:afcedae35a0a37c9b033248d85bb9ad86"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL  <a href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86">More...</a><br /></td></tr>
<tr class="separator:afcedae35a0a37c9b033248d85bb9ad86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d78676878788b54916f9a7e0bc894a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a92d78676878788b54916f9a7e0bc894a">comb_vel_matrix_diag_dist</a> (DIAG_BIGM_CON, BIGM_CON, DGM_PETSC, FINELE, COLELE, NDIM, NPHASE, U_NLOC, TOTELE, velocity, pressure, Mmat)</td></tr>
<tr class="memdesc:a92d78676878788b54916f9a7e0bc894a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. For stokes also the diagonal of the matrix is introduced in the mass matrix  <a href="namespacemultiphase__1d__engine.html#a92d78676878788b54916f9a7e0bc894a">More...</a><br /></td></tr>
<tr class="separator:a92d78676878788b54916f9a7e0bc894a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e1dabacd438da77f8e97f5234e6e3e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#af8e1dabacd438da77f8e97f5234e6e3e">comb_vel_matrix_diag_dist_lump</a> (DIAG_BIGM_CON, BIGM_CON, DGM_PETSC, FINELE, COLELE, NDIM, NPHASE, U_NLOC, TOTELE, velocity, pressure)</td></tr>
<tr class="memdesc:af8e1dabacd438da77f8e97f5234e6e3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA.  <a href="namespacemultiphase__1d__engine.html#af8e1dabacd438da77f8e97f5234e6e3e">More...</a><br /></td></tr>
<tr class="separator:af8e1dabacd438da77f8e97f5234e6e3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e2d722ec8283f1e4d87f7b6d7e427a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8e2d722ec8283f1e4d87f7b6d7e427a5">use_posinmat_c_store</a> (COUNT, U_INOD, P_JNOD, U_NONODS, FINDC, COLC, NCOLC, IDO_STORE_AC_SPAR_PT, STORED_AC_SPAR_PT, POSINMAT_C_STORE, ELE, U_ILOC, P_JLOC, TOTELE, U_NLOC, P_NLOC)</td></tr>
<tr class="separator:a8e2d722ec8283f1e4d87f7b6d7e427a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25c88bda5ea4082016d39781e111d445"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a25c88bda5ea4082016d39781e111d445">use_posinmat_c_store_suf_dg</a> (COUNT, U_INOD, P_JNOD, U_NONODS, FINDC, COLC, NCOLC, IDO_STORE_AC_SPAR_PT, STORED_AC_SPAR_PT, POSINMAT_C_STORE_SUF_DG, ELE, IFACE, U_SILOC, P_SJLOC, TOTELE, NFACE, U_SNLOC, P_SNLOC)</td></tr>
<tr class="separator:a25c88bda5ea4082016d39781e111d445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8917356adde1eb2aedccd0320529a6c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5">linearise_field</a> (field_in, field_out)</td></tr>
<tr class="memdesc:a8917356adde1eb2aedccd0320529a6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This sub will linearise a p2 field  <a href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5">More...</a><br /></td></tr>
<tr class="separator:a8917356adde1eb2aedccd0320529a6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c49a0f1a67a464bbb77115775ae4d1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1">introduce_grad_rhs_field_term</a> (packed_state, Mdims, Mmat, RHS_field, FE_funs, Devfuns, X_ALL, LOC_U_RHS, ele, cv_ndgln, x_ndgln, ele2, iface, sdetwe, SNORMXN_ALL, U_SLOC2LOC, CV_SLOC2LOC, MAT_OTHER_LOC)</td></tr>
<tr class="memdesc:a03c49a0f1a67a464bbb77115775ae4d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example) for the momentum equation. The inout field is RHS_field For capillary pressure: The capillary pressure is a term introduced as a RHS which affects the effective velocity  <a href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1">More...</a><br /></td></tr>
<tr class="separator:a03c49a0f1a67a464bbb77115775ae4d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad594ff5e1d219a2e1c7e5fe2a51605"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605">getoverrelaxation_parameter</a> (state, packed_state, Mdims, ndgln, Overrelaxation, Phase_with_Pc, totally_min_max, for_transport)</td></tr>
<tr class="memdesc:acad594ff5e1d219a2e1c7e5fe2a51605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more information read: doi.org/10.1016/j.cma.2019.07.004.  <a href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605">More...</a><br /></td></tr>
<tr class="separator:acad594ff5e1d219a2e1c7e5fe2a51605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a01c78d922871a74af7e6e4a3228868"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a7a01c78d922871a74af7e6e4a3228868">high_order_pressure_solve</a> (Mdims, ndgln, u_rhs, state, packed_state, nphase, u_absorbin)</td></tr>
<tr class="memdesc:a7a01c78d922871a74af7e6e4a3228868"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created and solved that accounts for the gravity effect in the system. Next, this is introduced as a RHS in the momemtum equation This allows for higher precision for the gravity effect.  <a href="namespacemultiphase__1d__engine.html#a7a01c78d922871a74af7e6e4a3228868">More...</a><br /></td></tr>
<tr class="separator:a7a01c78d922871a74af7e6e4a3228868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a4fb88f761b81639c9b81628eddc95"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a75a4fb88f761b81639c9b81628eddc95">dg_oscilat_detect</a> (SNDOTQ_KEEP, SNDOTQ2_KEEP, N_DOT_DU, N_DOT_DU2, SINCOME, MASS_ELE, MASS_ELE2)</td></tr>
<tr class="memdesc:a75a4fb88f761b81639c9b81628eddc95"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <a href="namespacemultiphase__1d__engine.html#a75a4fb88f761b81639c9b81628eddc95">More...</a><br /></td></tr>
<tr class="separator:a75a4fb88f761b81639c9b81628eddc95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34cd5ba5d5dfec039fa896b5fdc14e9f"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a34cd5ba5d5dfec039fa896b5fdc14e9f">p0_dg_oscilat_detect</a> (SNDOTQ_KEEP, SNDOTQ2_KEEP, N_DOT_DU, N_DOT_DU2, SINCOME, MASS_ELE, MASS_ELE2)</td></tr>
<tr class="memdesc:a34cd5ba5d5dfec039fa896b5fdc14e9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <a href="namespacemultiphase__1d__engine.html#a34cd5ba5d5dfec039fa896b5fdc14e9f">More...</a><br /></td></tr>
<tr class="separator:a34cd5ba5d5dfec039fa896b5fdc14e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44c487b15ec28694d3d4e75dd952d27f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f">diffus_cal_coeff_stress_or_tensor</a> (Mdims, DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX, STRESS_FORM, STRESS_FORM_STAB, ZERO_OR_TWO_THIRDS, SBUFEN_REVERSED, SBCVFEN_REVERSED, SBCVNGI, SLOC_UDIFFUSION, SLOC_UDIFFUSION_VOL, SLOC2_UDIFFUSION, SLOC2_UDIFFUSION_VOL, DIFF_GI_ADDED, HDC, U_CV_NODJ_IPHA_ALL, U_CV_NODI_IPHA_ALL, UOLD_CV_NODJ_IPHA_ALL, UOLD_CV_NODI_IPHA_ALL, ELE, ELE2, SNORMXN_ALL, SLOC_DUX_ELE_ALL, SLOC2_DUX_ELE_ALL, SLOC_DUOLDX_ELE_ALL, SLOC2_DUOLDX_ELE_ALL, SELE, WIC_U_BC, WIC_U_BC_DIRICHLET, SIMPLE_DIFF_CALC, DIFF_MIN_FRAC, DIFF_MAX_FRAC)</td></tr>
<tr class="memdesc:a44c487b15ec28694d3d4e75dd952d27f"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity.  <a href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f">More...</a><br /></td></tr>
<tr class="separator:a44c487b15ec28694d3d4e75dd952d27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef4ba493db104704c886272f75f1f34"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34">generate_and_solve_laplacian_system</a> (Mdims, state, packed_state, ndgln, Mmat, Mspars, CV_funs, CV_GIdims, Sigma_field, field_name, K_fields, F_fields, intface_val_type, solver_path)</td></tr>
<tr class="memdesc:aeef4ba493db104704c886272f75f1f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error.  <a href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34">More...</a><br /></td></tr>
<tr class="separator:aeef4ba493db104704c886272f75f1f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac978f4c53e089cee150a4c15b117eee5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ac978f4c53e089cee150a4c15b117eee5">impose_strong_bcs_wells</a> (state, pipes_aux, Mdims, Mmat, ndgln, CMC_petsc, pressure, rhs_p)</td></tr>
<tr class="memdesc:ac978f4c53e089cee150a4c15b117eee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pressure boundary conditions for wells ONLY. This is required only when using P0DG-P1 If not imposing strong pressure BCs and using P0DG-P1, the formulation for weak pressure BCs leads to a 0 in the diagonal of the CMC matrix, therefore strong BCs are required.  <a href="namespacemultiphase__1d__engine.html#ac978f4c53e089cee150a4c15b117eee5">More...</a><br /></td></tr>
<tr class="separator:ac978f4c53e089cee150a4c15b117eee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a92d78676878788b54916f9a7e0bc894a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92d78676878788b54916f9a7e0bc894a">&#9670;&nbsp;</a></span>comb_vel_matrix_diag_dist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::comb_vel_matrix_diag_dist </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>DIAG_BIGM_CON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>BIGM_CON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( petsc_csr_matrix ), intent(inout)&#160;</td>
          <td class="paramname"><em>DGM_PETSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(: ), intent(in)&#160;</td>
          <td class="paramname"><em>FINELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>COLELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>TOTELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. For stokes also the diagonal of the matrix is introduced in the mass matrix </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a92d78676878788b54916f9a7e0bc894a_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a92d78676878788b54916f9a7e0bc894a_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a92d78676878788b54916f9a7e0bc894a_icgraph" id="namespacemultiphase__1d__engine_a92d78676878788b54916f9a7e0bc894a_icgraph">
<area shape="rect" title=": This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA...." alt="" coords="724,5,933,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="af8e1dabacd438da77f8e97f5234e6e3e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8e1dabacd438da77f8e97f5234e6e3e">&#9670;&nbsp;</a></span>comb_vel_matrix_diag_dist_lump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::comb_vel_matrix_diag_dist_lump </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>DIAG_BIGM_CON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>BIGM_CON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( petsc_csr_matrix ), intent(inout)&#160;</td>
          <td class="paramname"><em>DGM_PETSC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(: ), intent(in)&#160;</td>
          <td class="paramname"><em>FINELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>COLELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>TOTELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_af8e1dabacd438da77f8e97f5234e6e3e_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_af8e1dabacd438da77f8e97f5234e6e3e_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_af8e1dabacd438da77f8e97f5234e6e3e_icgraph" id="namespacemultiphase__1d__engine_af8e1dabacd438da77f8e97f5234e6e3e_icgraph">
<area shape="rect" title=": This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA." alt="" coords="724,5,903,61"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,13,676,54"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,419,54"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,54"/>
</map>
</div>

</div>
</div>
<a id="a871f4ede396b430a5194023196511192"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a871f4ede396b430a5194023196511192">&#9670;&nbsp;</a></span>compositional_assemble_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::compositional_assemble_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GET_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>USE_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_GDIFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_one_m_theta_flux_j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:In this subroutine the components are solved for all the phases. Systems for each component are assembled and solved by calling INTENERGE_ASSEM_SOLVE </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_cgraph" id="namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_cgraph">
<area shape="rect" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="5,969,240,1011"/>
<area shape="rect" href="namespacecompositional__terms.html#ab7087656dea2acf341899e4e7a7f8eca" title=" " alt="" coords="328,449,517,491"/>
<area shape="rect" href="namespacecompositional__terms.html#ad2f5aa04b8878cd5cd9b0c4c23608bea" title=" " alt="" coords="288,1035,557,1076"/>
<area shape="rect" href="namespacecv__advection.html#ae1eba9d13ff146b1bf390a5de461d421" title=" " alt="" coords="335,693,510,735"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="331,969,515,1011"/>
<area shape="rect" href="namespacesolvers__module.html#a9bba1ef1495c1a4a47a7eea3f2c17719" title="certain tolerance and also sets the saturation to be between bounds" alt="" coords="332,1100,513,1141"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state" alt="" coords="933,136,1115,177"/>
<area shape="rect" href="namespacecompositional__terms.html#a8d067de83d2c706f165e514f8a9ca1c8" title=" " alt="" coords="655,1633,813,1675"/>
<area shape="rect" href="namespacecompositional__terms.html#a84fea13095aadece40e1765da26a2297" title=" " alt="" coords="945,2016,1103,2057"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="936,201,1112,243"/>
<area shape="rect" href="namespacecompositional__terms.html#a5854731522b8b3e1b37deb7cfe6814c2" title=" " alt="" coords="605,71,863,112"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="638,1028,830,1069"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="638,1093,830,1135"/>
<area shape="rect" href="namespacecv__advection.html#a083e26c7f43d55723d9e316ef2069394" title="Generates the transport equation on the CV mesh. Can be also used to generate the gradient matrix for..." alt="" coords="639,977,829,1003"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86" title=": Checks convergence on the temperature field Calculation of the averaged heat capacity and density a..." alt="" coords="655,1159,813,1186"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="637,1211,831,1252"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="623,845,845,887"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="642,911,826,952"/>
<area shape="rect" href="namespacecompositional__terms.html#a747fbf8752c32e5d741465ea409d6319" title=" " alt="" coords="945,5,1103,47"/>
<area shape="rect" href="namespacecompositional__terms.html#ad493264ab6df90982606d40e8b794a2e" title=" " alt="" coords="945,71,1103,112"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title=" " alt="" coords="1185,260,1396,301"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="927,1249,1121,1291"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="966,1315,1082,1342"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="1204,1341,1377,1367"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="933,1417,1115,1459"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title=" " alt="" coords="953,1483,1095,1524"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="929,1549,1119,1575"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title=" " alt="" coords="936,1599,1112,1626"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="925,1651,1123,1692"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="919,1716,1129,1757"/>
<area shape="rect" href="namespacecv__advection.html#a3323eb4932694a86940d81127e40d9fe" title=" " alt="" coords="947,1781,1101,1823"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="957,1847,1091,1874"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title=" " alt="" coords="953,1899,1095,1940"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="952,1965,1096,1991"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="944,318,1104,345"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="938,369,1110,395"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="943,419,1105,446"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="911,470,1137,497"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="914,521,1134,547"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title=" " alt="" coords="979,638,1069,665"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="947,689,1101,731"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title=" " alt="" coords="938,755,1110,796"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="927,820,1121,861"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="953,572,1095,613"/>
<area shape="rect" href="namespacecv__advection.html#a5c177e18f7b1275cc9b308000daaa788" title=" " alt="" coords="946,885,1102,927"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="949,951,1099,978"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="937,1002,1111,1029"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title=" " alt="" coords="947,1053,1101,1095"/>
<area shape="rect" href="namespacecv__advection.html#ad714b20d018bf748c3ad080732b7c9cc" title=" " alt="" coords="943,1119,1105,1160"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab4280b302a2f45375be2df118ed6d100" title=": Sets the boundary condition, if the time has advance and the BCs changed, here they are set to the ..." alt="" coords="931,1184,1117,1225"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_icgraph" id="namespacemultiphase__1d__engine_a871f4ede396b430a5194023196511192_icgraph">
<area shape="rect" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,35,701,76"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,71,396,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a75a4fb88f761b81639c9b81628eddc95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75a4fb88f761b81639c9b81628eddc95">&#9670;&nbsp;</a></span>dg_oscilat_detect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_1d_engine::dg_oscilat_detect </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>SNDOTQ_KEEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>SNDOTQ2_KEEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N_DOT_DU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N_DOT_DU2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>SINCOME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>MASS_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>MASS_ELE2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_cgraph" id="namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_cgraph">
<area shape="rect" title=": Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="5,5,175,47"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="223,13,364,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_icgraph" id="namespacemultiphase__1d__engine_a75a4fb88f761b81639c9b81628eddc95_icgraph">
<area shape="rect" title=": Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="1371,5,1540,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="af5917482b2dae4c57c6e06a839682e42"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5917482b2dae4c57c6e06a839682e42">&#9670;&nbsp;</a></span>dg_visc_lin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::dg_visc_lin </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, u_snloc, 2*u_nloc ), intent(inout)&#160;</td>
          <td class="paramname"><em>S_INV_NNX_MAT12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>NNX_MAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>NNX_MAT2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>NN_MAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>NN_MAT2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi,  u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SBUFEN_REVERSED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>SDETWE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SBCVNGI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, sbcvngi  ), intent(in)&#160;</td>
          <td class="paramname"><em>SNORMXN_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>U_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>U_OTHER_LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC_EXT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>ON_BOUNDARY</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter element coupling for the viscocity discretization. NNX_MAT, NNX_MAT2 contain matricies of first derivative times basis function for current element and neightbouring element. Similarly NN_MAT, NN_MAT2, contain the element-wise mass matrices. Only call this sub if element not next to the boundary... </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_af5917482b2dae4c57c6e06a839682e42_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_af5917482b2dae4c57c6e06a839682e42_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_af5917482b2dae4c57c6e06a839682e42_icgraph" id="namespacemultiphase__1d__engine_af5917482b2dae4c57c6e06a839682e42_icgraph">
<area shape="rect" title=": This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter e..." alt="" coords="1371,5,1540,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a44c487b15ec28694d3d4e75dd952d27f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44c487b15ec28694d3d4e75dd952d27f">&#9670;&nbsp;</a></span>diffus_cal_coeff_stress_or_tensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::diffus_cal_coeff_stress_or_tensor </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>DIFF_COEF_DIVDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>DIFF_COEFOLD_DIVDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>STRESS_FORM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>STRESS_FORM_STAB</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZERO_OR_TWO_THIRDS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SBUFEN_REVERSED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  sbcvngi, mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SBCVFEN_REVERSED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SBCVNGI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%ndim,mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_UDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_UDIFFUSION_VOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%ndim,mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC2_UDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC2_UDIFFUSION_VOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim,mdims%ndim, mdims%nphase, sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>DIFF_GI_ADDED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>HDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>U_CV_NODJ_IPHA_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>U_CV_NODI_IPHA_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>UOLD_CV_NODJ_IPHA_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>UOLD_CV_NODI_IPHA_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>SNORMXN_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_DUX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC2_DUX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_DUOLDX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC2_DUOLDX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( mdims%ndim,mdims%nphase,mdims%stotel ), intent(in)&#160;</td>
          <td class="paramname"><em>WIC_U_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>WIC_U_BC_DIRICHLET</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>SIMPLE_DIFF_CALC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DIFF_MIN_FRAC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DIFF_MAX_FRAC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_cgraph" id="namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_cgraph">
<area shape="rect" title=": This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based o..." alt="" coords="5,5,184,61"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a15505780dc171eceae929e55d7951913" title="This implements the stress and tensor form of diffusion and calculates a jump conidition...." alt="" coords="232,20,397,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_icgraph" id="namespacemultiphase__1d__engine_a44c487b15ec28694d3d4e75dd952d27f_icgraph">
<area shape="rect" title=": This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based o..." alt="" coords="1371,5,1549,61"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,20,1323,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,20,1147,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,20,908,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,13,676,54"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,419,54"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,54"/>
</map>
</div>

</div>
</div>
<a id="af9aedf8b67f5b7198eb4b67601a7fab0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af9aedf8b67f5b7198eb4b67601a7fab0">&#9670;&nbsp;</a></span>enthalpy_assem_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::enthalpy_assem_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>VOLFRA_PORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IGOT_T2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GET_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>USE_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_GDIFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character( len = * ), intent(in), optional&#160;</td>
          <td class="paramname"><em>option_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>thermal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>Permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__magma_1_1magma__phase__diagram.html">magma_phase_diagram</a>)&#160;</td>
          <td class="paramname"><em>magma_phase_coefficients</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the enthalpy equation. This is efectively the temperature equation but making the enthalpy implicit by substituting the temperature by its linear relationship with enthalpy: H = rho Cp Temp + rho Lf phi; Where Lf is the latent heat and phi is the amount of liquid fluid phase. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas, Haiyang Hu </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_cgraph" id="namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the enthalpy equation. This is efectively the temperatur..." alt="" coords="5,981,184,1023"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="247,923,439,964"/>
<area shape="rect" href="namespacecv__advection.html#a083e26c7f43d55723d9e316ef2069394" title="Generates the transport equation on the CV mesh. Can be also used to generate the gradient matrix for..." alt="" coords="248,989,437,1015"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="232,1481,453,1523"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="517,201,712,243"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="557,318,673,345"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="795,150,968,177"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="524,471,705,512"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title=" " alt="" coords="543,536,686,577"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="519,602,710,629"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title=" " alt="" coords="527,653,703,679"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="515,704,714,745"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title=" " alt="" coords="776,792,987,833"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="509,887,720,928"/>
<area shape="rect" href="namespacecv__advection.html#a3323eb4932694a86940d81127e40d9fe" title=" " alt="" coords="538,952,691,993"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="547,1018,682,1045"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title=" " alt="" coords="544,1069,685,1111"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="543,369,687,395"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="535,1135,695,1162"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="529,419,701,446"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="534,1186,695,1213"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state" alt="" coords="524,1237,705,1279"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="501,1303,728,1330"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="505,1354,725,1381"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title=" " alt="" coords="569,1405,660,1431"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="538,1456,691,1497"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title=" " alt="" coords="529,1521,701,1563"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="518,1587,711,1628"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="544,821,685,863"/>
<area shape="rect" href="namespacecv__advection.html#a5c177e18f7b1275cc9b308000daaa788" title=" " alt="" coords="537,1652,693,1693"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="539,1718,690,1745"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="527,1769,703,1811"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="527,1835,702,1862"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title=" " alt="" coords="537,1887,692,1928"/>
<area shape="rect" href="namespacecv__advection.html#ad714b20d018bf748c3ad080732b7c9cc" title=" " alt="" coords="533,5,696,47"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab4280b302a2f45375be2df118ed6d100" title=": Sets the boundary condition, if the time has advance and the BCs changed, here they are set to the ..." alt="" coords="521,71,708,112"/>
<area shape="rect" href="namespacecopy__outof__state.html#a3e466dfb76c8c3e30de12d2f7d36d3bb" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="521,136,708,177"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title=" " alt="" coords="797,201,965,243"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="811,318,952,345"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aad25281c21796ab5cdd1ecf160cdad8f" title=" " alt="" coords="820,267,943,294"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a6b4e2b7cd1b1214a242258cc6f8b753a" title=" " alt="" coords="792,543,971,570"/>
<area shape="rect" href="multi__shape__fct_8_f90.html#a3ac481479452947a759fbb6c9cf743e9" title=" " alt="" coords="792,711,971,738"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=" " alt="" coords="789,989,974,1015"/>
<area shape="rect" href="namespacecv__advection.html#afc0d98d467a15c460d49668d0194344a" title=" " alt="" coords="797,420,966,461"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="807,369,956,395"/>
<area shape="rect" href="namespacemulti__tools.html#ad2dc4462bad46ef99ca0057cb3c91262" title=" " alt="" coords="807,486,956,513"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a5c58181433ef3d6296d003eccb780c6d" title=" " alt="" coords="780,1481,983,1507"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#af8e5cd91f2c7b0d5ffa4d0f3b9c207c1" title=" " alt="" coords="812,1531,951,1558"/>
<area shape="rect" href="namespacecopy__outof__state.html#a1394fdd5e9adcc149eb319739c07f854" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="781,1587,982,1628"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="537,1952,692,1993"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_icgraph" id="namespacemultiphase__1d__engine_af9aedf8b67f5b7198eb4b67601a7fab0_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the enthalpy equation. This is efectively the temperatur..." alt="" coords="467,5,645,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="ae5be4b78c1796fac4008d398a7cdd0aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5be4b78c1796fac4008d398a7cdd0aa">&#9670;&nbsp;</a></span>force_bal_cty_assem_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::force_bal_cty_assem_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>FE_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>FE_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  : , :  ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  :, :  ), intent(in)&#160;</td>
          <td class="paramname"><em>V_SOURCE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  :, :  ), intent(in)&#160;</td>
          <td class="paramname"><em>VOLFRA_PORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IGOT_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>calculate_mass_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>pres_its_taken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>Courant_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix Once these matrices (and corresponding RHSs) are generated the system of equations is solved. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas, Asiri Obeysekara </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_cgraph" id="namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_cgraph">
<area shape="rect" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="5,856,215,897"/>
<area shape="rect" href="namespacemulti__data__types.html#af7028748dfa3e370ed4bfd1db524c87b" title=" " alt="" coords="296,5,463,47"/>
<area shape="rect" href="namespacematrix__operations.html#a1167c3b995711ad4c85718f072beb45e" title=" " alt="" coords="276,71,483,112"/>
<area shape="rect" href="namespacematrix__operations.html#a3cf9d9f54e55a501e927c1ae443093f0" title=": Performs the multiplication CDP_tensor = MmatC * deltap" alt="" coords="593,193,743,235"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="287,623,471,650"/>
<area shape="rect" href="namespacemultiphase__eos.html#add6fbcd53b92e8dd346a9ac6fbc30055" title=": In this subroutine the capilalry pressure is computed based on the saturation and the formula used" alt="" coords="283,791,475,832"/>
<area shape="rect" href="namespacemulti__surface__tension.html#af2ba4e6081b82e255306f98d0e160098" title=" " alt="" coords="263,725,496,767"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0" title=": This subroutine computed the gravity effect, i.e. rho * g" alt="" coords="283,856,475,897"/>
<area shape="rect" href="namespacemultiphase__eos.html#a26eebc3a39a15f39961c783b8558fbef" title=": Computes the viscosity effect as a momemtum diffusion, this is zero for porous media" alt="" coords="283,921,475,963"/>
<area shape="rect" href="namespacematrix__operations.html#a8e0ed666ded4084ef9626e11edb7fee1" title=":Initialize the momentum equation (CMC) and introduces the corresponding values in it...." alt="" coords="305,136,454,177"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a92d78676878788b54916f9a7e0bc894a" title=": This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA...." alt="" coords="275,987,484,1028"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af8e1dabacd438da77f8e97f5234e6e3e" title=": This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA." alt="" coords="290,1053,469,1109"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a53b2f85c6a8345f6316959365e52bd83" title="Calculates the divergence of the velocity by multipliying it by the Ct matrix." alt="" coords="607,325,729,351"/>
<area shape="rect" href="namespacemulti__data__types.html#a65dde4f9748cb3dd200c328f99304c4e" title=" " alt="" coords="274,1133,485,1175"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#ad3c0d8ed87bdfa9ff27a1048406ecd2f" title="Flip P and V BCs for wells. Implemented for ATES applications or other applications when needing to s..." alt="" coords="313,1199,446,1226"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a86babf83394e349a6bb014238237de1f" title="Generates a lumped mass matrix for Stokes. It can either have also the diagonal of A or not." alt="" coords="296,1251,463,1292"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a7a01c78d922871a74af7e6e4a3228868" title=": Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created..." alt="" coords="566,725,770,767"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac978f4c53e089cee150a4c15b117eee5" title=": In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pr..." alt="" coords="281,1316,477,1357"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa5bc5bc1a7d8c32c0a8f667b03648f64" title="Include in the pressure matrix the compressibility terms (based on taylor expansion series) to ensure..." alt="" coords="544,456,792,497"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5" title=": This sub will linearise a p2 field" alt="" coords="295,1381,464,1423"/>
<area shape="rect" href="namespacematrix__operations.html#a7628ec2574e8ee26a9cc526ce1633451" title=": Inversion of the mass matrix. If compacted this is much more efficient" alt="" coords="292,1447,467,1488"/>
<area shape="rect" href="namespacematrix__operations.html#a501c5d1025991dd3e563d635362b475b" title=": U = Mass_matrix * Vector (tipically vector is Grad * P + RHS and this is used to obtain the velocit..." alt="" coords="587,259,749,300"/>
<area shape="rect" href="namespacemulti__pipes.html#a297beee584d63c08823a85520b973ef5" title=": This sub modifies MmatC for 1D pipe modelling" alt="" coords="300,1512,459,1553"/>
<area shape="rect" href="namespacesolvers__module.html#ab1b067219293fc4e2583394acce02bfa" title="In this subroutine the Schur complement is generated and solved using PETSc to update the pressure fi..." alt="" coords="295,1577,463,1619"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a0eb7a61a4dc66651096b6fabc6739ea3" title="Project back the velocity from a non divergent&#45;free space to a divergent free space." alt="" coords="306,253,453,295"/>
<area shape="rect" href="namespacesolvers__module.html#af233b921efdba4e01b5920ccf509ef29" title="In this subroutine the matrix is re&#45;scaled based on the formula D^&#45;0.5 * A * D^&#45;0...." alt="" coords="296,1643,463,1684"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#ae8a4aa21acf8febcc4fec45af279f33d" title="Compute deltaP by solving the pressure equation using the CMC matrix." alt="" coords="567,522,769,549"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a5a525a502553802a5ecbe7a138b1575c" title="Update velocity by solving the momentum equation for a given pressure, the RHS is formed here If resc..." alt="" coords="569,573,767,599"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="270,421,489,447"/>
<area shape="rect" href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48" title=":Computes velocity absorption from diamond information" alt="" coords="290,1708,469,1749"/>
<area shape="rect" href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8" title=":Computes velocity absorption from diamond information" alt="" coords="274,1773,485,1815"/>
<area shape="rect" href="namespacemultiphase__eos.html#a8f7f68ee8d294089b9077c480795eb9c" title=":Computes velocity source from diamond information" alt="" coords="290,1839,469,1880"/>
<area shape="rect" href="namespacematrix__operations.html#a895e0f98ecb17a8541be87879adf8876" title=": CDP=C*DP" alt="" coords="871,139,1020,180"/>
<area shape="rect" href="namespacecv__advection.html#a083e26c7f43d55723d9e316ef2069394" title="Generates the transport equation on the CV mesh. Can be also used to generate the gradient matrix for..." alt="" coords="573,623,763,650"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="573,674,763,701"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="848,791,1043,832"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="846,660,1045,701"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="840,725,1051,767"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="857,595,1033,636"/>
<area shape="rect" href="multi__eos_8_f90.html#acd1caed43acc66691c351206d8dd7b2c" title=":This functions returns the capillary pressure for a certain input saturation" alt="" coords="603,857,733,883"/>
<area shape="rect" href="namespacemulti__surface__tension.html#a5a80b62b8be2aabfa44e733c53908eb4" title=" " alt="" coords="555,791,781,832"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="576,908,760,949"/>
<area shape="rect" href="multi__eos_8_f90.html#ae6d5686c281a2913192491061cfcec88" title="TO BE FILLED BY THE AUTHOR." alt="" coords="643,974,693,1001"/>
<area shape="rect" href="multi__matrix__operations_8_f90.html#a1d78ca7eba32c498b8004c8e140321b7" title=": form pressure matrix CMC using a colouring approach, requires more memory" alt="" coords="579,142,757,169"/>
<area shape="rect" href="multi__matrix__operations_8_f90.html#aabf6daa1fc142c4f465b692f6399ee5b" title=": form pressure matrix CMC using a colouring approach" alt="" coords="576,91,760,118"/>
<area shape="rect" href="namespacematrix__operations.html#aca7d06edf5bee7b9e5c00830ee444478" title=":CV_RHS=CT*U" alt="" coords="871,351,1020,392"/>
<area shape="rect" href="namespacematrix__operations.html#a6aab014a9001ac1cbb2e46bba4171cd9" title=": DP = (C)^T U_ALL" alt="" coords="871,285,1020,327"/>
<area shape="rect" href="namespacematrix__operations.html#afe8e6c53cbc0059363705d48a73708d1" title=": This sub finds the inverse of the matrix A and puts it back in A. MAT, MAT2, X and B are working ve..." alt="" coords="593,1447,743,1488"/>
<area shape="rect" href="namespacesolvers__module.html#aad076a468a68cdb44f63a6290e9c8159" title=": This subroutine converts the C (gradient) and CT (Divergence) matrices into PETSc format Mainly dev..." alt="" coords="577,1570,759,1626"/>
<area shape="rect" href="namespacesolvers__module.html#a119325e40cdcd54b1766472b55920364" title="This subroutine provides a new guess based on previous updates and residuals. Use this subroutine to ..." alt="" coords="580,375,756,431"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_icgraph" id="namespacemultiphase__1d__engine_ae5be4b78c1796fac4008d398a7cdd0aa_icgraph">
<area shape="rect" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a86c48c7bcc5921e6764217e562a7b5d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c48c7bcc5921e6764217e562a7b5d6">&#9670;&nbsp;</a></span>force_min_max_principle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::force_min_max_principle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>entrance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>totally_min_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: To help the stability of the system,if there are no sources/sinks it is known that the temperature must fulfill the min max principle, therefore here values outside this rank are capped. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a86c48c7bcc5921e6764217e562a7b5d6_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a86c48c7bcc5921e6764217e562a7b5d6_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a86c48c7bcc5921e6764217e562a7b5d6_icgraph" id="namespacemultiphase__1d__engine_a86c48c7bcc5921e6764217e562a7b5d6_icgraph">
<area shape="rect" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="981,93,1176,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="749,64,933,105"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="494,123,674,164"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,5,701,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,64,419,105"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,13,396,39"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,64,171,105"/>
</map>
</div>

</div>
</div>
<a id="aeef4ba493db104704c886272f75f1f34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef4ba493db104704c886272f75f1f34">&#9670;&nbsp;</a></span>generate_and_solve_laplacian_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::generate_and_solve_laplacian_system </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>Sigma_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character( len = * ), intent(in), optional&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>K_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>F_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>intface_val_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=option_path_len), intent(in), optional&#160;</td>
          <td class="paramname"><em>solver_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aeef4ba493db104704c886272f75f1f34_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_aeef4ba493db104704c886272f75f1f34_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_aeef4ba493db104704c886272f75f1f34_icgraph" id="namespacemultiphase__1d__engine_aeef4ba493db104704c886272f75f1f34_icgraph">
<area shape="rect" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="664,20,833,76"/>
<area shape="rect" href="namespacemulti__sp.html#a3761caa03a0d114b25c395685b965a73" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="467,27,616,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,5,401,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,57,419,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,171,98"/>
</map>
</div>

</div>
</div>
<a id="acad594ff5e1d219a2e1c7e5fe2a51605"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acad594ff5e1d219a2e1c7e5fe2a51605">&#9670;&nbsp;</a></span>getoverrelaxation_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::getoverrelaxation_parameter </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>Overrelaxation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>Phase_with_Pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), optional&#160;</td>
          <td class="paramname"><em>totally_min_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>for_transport</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more information read: doi.org/10.1016/j.cma.2019.07.004. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_cgraph" id="namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_cgraph">
<area shape="rect" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="5,5,227,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="275,5,429,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_icgraph" id="namespacemultiphase__1d__engine_acad594ff5e1d219a2e1c7e5fe2a51605_icgraph">
<area shape="rect" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="1039,152,1260,193"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af9aedf8b67f5b7198eb4b67601a7fab0" title="Calls to generate the transport equation for the enthalpy equation. This is efectively the temperatur..." alt="" coords="495,123,673,164"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="778,64,962,105"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="494,240,674,281"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="749,181,991,223"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,123,419,164"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,123,171,164"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,5,701,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,13,396,39"/>
</map>
</div>

</div>
</div>
<a id="a7a01c78d922871a74af7e6e4a3228868"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a01c78d922871a74af7e6e4a3228868">&#9670;&nbsp;</a></span>high_order_pressure_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::high_order_pressure_solve </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>u_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_absorbin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created and solved that accounts for the gravity effect in the system. Next, this is introduced as a RHS in the momemtum equation This allows for higher precision for the gravity effect. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_cgraph" id="namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_cgraph">
<area shape="rect" title=": Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created..." alt="" coords="5,376,209,417"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="265,277,460,319"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="263,343,462,384"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="257,408,468,449"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="275,473,451,515"/>
<area shape="rect" href="multi__shape__fct_8_f90.html#a3ac481479452947a759fbb6c9cf743e9" title=" " alt="" coords="516,350,695,377"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a418bc78009a1672bdeb8eb7f0d1ed39f" title=" " alt="" coords="743,204,941,245"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a1e6216e7c417285850e02453ce1f891a" title=" " alt="" coords="743,665,941,707"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a55f7da59b552d475085e9ae74e74f875" title=" " alt="" coords="743,343,941,384"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a9c978f9224bd7a912e1ea02ced195e5d" title=": This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with ..." alt="" coords="758,107,926,148"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a327e5ef3b6b9241997dcf0c6f8cad2dd" title=" " alt="" coords="743,600,941,641"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aaaf113a1f2b0b1043b46f700358de0e8" title=" " alt="" coords="1005,139,1173,180"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a06fcc23267a886a2b3122b3a77667801" title=" " alt="" coords="989,204,1188,245"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a6aa37d81c26106c0d55a961df42387f0" title=": new 1 or 4 pt quadrature set on each CV of a quadratic tetrahedra ..... Compute shape functions N,..." alt="" coords="1267,167,1446,223"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ab0d45b5cca739d6579a00f6a5ac41de7" title=": For quadratic elements. Shape functions associated with volume integration using both CV basis func..." alt="" coords="1273,248,1441,289"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a7124edf2219f0df3e3bdbfc9148bac65" title=": For quadratic elements: Shape functions associated with volume integration using both CV (CVN) and ..." alt="" coords="1005,372,1173,413"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a62013afe2af3b6eb9358b519e41313b8" title=": Compute shape functions N, UN etc for linear trianles. Shape functions associated with volume integ..." alt="" coords="1005,437,1173,479"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ae55e4b96c1fd166b0c386e93ddf53196" title=" " alt="" coords="1525,376,1693,417"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a7da239d41bd2bc9cf80b2d50a0c00554" title="at the Gauss points. NB: We may need to define surface elements for p and (u,v,w)" alt="" coords="1961,487,2133,528"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ad903267339ffe53d619a566ab1451802" title=" " alt="" coords="1741,421,1913,463"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a08898de4c8264828159cf3ab5a812db4" title=" " alt="" coords="1741,356,1913,397"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a0e2b87ea8cbf64e6526d68831575f1d7" title=" " alt="" coords="1741,487,1913,528"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title=" " alt="" coords="1743,221,1911,263"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a37c95193cd7ac8186d5e2a9359793013" title=" " alt="" coords="1963,181,2131,223"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aa8a65df277c132b8c748fc53634ded22" title=": For quadatic elements  shape functions associated with volume integration using both CV basis func..." alt="" coords="1273,313,1441,355"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a01db78dad28836c230edae9db5ce2b49" title=" " alt="" coords="1266,379,1447,420"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a18ed715c7c19cc301ca5152fe8293ef2" title=" " alt="" coords="1240,641,1473,683"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a8e1483fa07acac02ed8dcdcd5355f922" title=": Determine the volume shape functions n, nlx, nly, nlz and weights cvweigh for the cv_nloc_cells CV ..." alt="" coords="1273,576,1441,617"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a364b3f7243c9e7b46dbcd0d3bffe5f6b" title=" " alt="" coords="1525,755,1693,796"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ab33172e32fe449b773531887a2da7894" title=" " alt="" coords="1525,689,1693,731"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a0baef8de3aad5dd6c661809fdd333369" title=" " alt="" coords="1743,692,1911,733"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a257f57afe346a4a6cf4c30b4fb20ca11" title=" " alt="" coords="1525,572,1693,613"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aec7c06f0cf1ffd44899b31601d1c0835" title=" " alt="" coords="1525,441,1693,483"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a3a845aa5e30651da7fb65786056f5591" title=" " alt="" coords="1525,507,1693,548"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a334b2cc04802a89c38ad64fbb302f22d" title=": Provides a number defining the type of element we are dealing with 4,5 Linear tetrahedra,..." alt="" coords="1005,73,1173,115"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a54aa7c2f3b52f8fb9e403339ac85c10b" title=" " alt="" coords="1005,8,1173,49"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a8fe09e952cf3b4ee2627342abc216d66" title=" " alt="" coords="1525,37,1693,79"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a25072ca7508393d73b9e91c2e80ebc6f" title=":This subroutine defines the shape functions M and N and their derivatives at the Gauss points for qu..." alt="" coords="1273,67,1441,108"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a62d482e48ef37a99c81efcdd8e273644" title=" " alt="" coords="1743,5,1911,47"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#afc7053552eace6af239edcd5d1b99cb3" title=" " alt="" coords="1743,71,1911,112"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a8214cb813b277f2423568701a028127f" title=" " alt="" coords="989,699,1188,740"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a8122ed37669278dac47e69b4437a77f0" title=" " alt="" coords="989,764,1188,805"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a4195af5a6506ee13f8145561983082d7" title=" " alt="" coords="989,829,1188,871"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a571a18187866c4248a1cc74e517412d4" title=" " alt="" coords="989,895,1188,936"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a93ebe6ad06c48a17dc648ac697a51085" title=" " alt="" coords="989,568,1188,609"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a26392ba54127e829f1661b9f8a2a9d53" title=": Compute shape functions N, UN etc for linear triangles. Shape functions associated with volume inte..." alt="" coords="1005,503,1173,544"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a61ebf8a017a08936e3c0df9d171b62a7" title=" " alt="" coords="989,633,1188,675"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb29324e9e7ed1c60a8ac2d2dbe93b55" title=": this subroutine calculates shape functions sn, snlx, snly, snlz, sufnlx, sufnly,..." alt="" coords="1236,495,1477,551"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ad2181d02562ea0e3e97902500a65524c" title=" " alt="" coords="1273,707,1441,748"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a7f9befc07f9850d9db51f96c4e6a0cd4" title=": the surface quadrature pts in local coord are l1, l2, l3, l4, and the associated normals normx,..." alt="" coords="1251,772,1463,813"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_icgraph" id="namespacemultiphase__1d__engine_a7a01c78d922871a74af7e6e4a3228868_icgraph">
<area shape="rect" title=": Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created..." alt="" coords="724,5,928,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="ac978f4c53e089cee150a4c15b117eee5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac978f4c53e089cee150a4c15b117eee5">&#9670;&nbsp;</a></span>impose_strong_bcs_wells()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::impose_strong_bcs_wells </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(petsc_csr_matrix), intent(inout)&#160;</td>
          <td class="paramname"><em>CMC_petsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pressure boundary conditions for wells ONLY. This is required only when using P0DG-P1 If not imposing strong pressure BCs and using P0DG-P1, the formulation for weak pressure BCs leads to a 0 in the diagonal of the CMC matrix, therefore strong BCs are required. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas, Geraldine Regnier </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ac978f4c53e089cee150a4c15b117eee5_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_ac978f4c53e089cee150a4c15b117eee5_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_ac978f4c53e089cee150a4c15b117eee5_icgraph" id="namespacemultiphase__1d__engine_ac978f4c53e089cee150a4c15b117eee5_icgraph">
<area shape="rect" title=": In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pr..." alt="" coords="724,5,920,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a98e757b51a04b55df8d38e36470e0b96"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98e757b51a04b55df8d38e36470e0b96">&#9670;&nbsp;</a></span>intenerge_assem_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::intenerge_assem_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>VOLFRA_PORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IGOT_T2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GET_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>USE_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_GDIFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character( len = * ), intent(in), optional&#160;</td>
          <td class="paramname"><em>option_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>thermal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>Permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the transport of energy/temperature and to solve the transport of components. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_cgraph" id="namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="5,1167,189,1208"/>
<area shape="rect" href="namespacecompositional__terms.html#a5854731522b8b3e1b37deb7cfe6814c2" title=" " alt="" coords="237,71,495,112"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="270,1017,462,1059"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="270,1083,462,1124"/>
<area shape="rect" href="namespacecv__advection.html#a083e26c7f43d55723d9e316ef2069394" title="Generates the transport equation on the CV mesh. Can be also used to generate the gradient matrix for..." alt="" coords="271,1149,461,1175"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86" title=": Checks convergence on the temperature field Calculation of the averaged heat capacity and density a..." alt="" coords="287,1199,445,1226"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="269,1251,463,1292"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="255,1500,477,1541"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="274,1933,458,1975"/>
<area shape="rect" href="namespacecompositional__terms.html#a747fbf8752c32e5d741465ea409d6319" title=" " alt="" coords="577,71,735,112"/>
<area shape="rect" href="namespacecompositional__terms.html#ad493264ab6df90982606d40e8b794a2e" title=" " alt="" coords="577,5,735,47"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title=" " alt="" coords="817,397,1028,439"/>
<area shape="rect" href="namespacematrix__operations.html#a11255cf3f07959a2d3e20dd8705755fe" title=" " alt="" coords="848,5,997,47"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="559,463,753,504"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="598,1178,714,1205"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="836,849,1009,875"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="565,631,747,672"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title=" " alt="" coords="585,696,727,737"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="561,762,751,789"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title=" " alt="" coords="568,813,744,839"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="557,864,755,905"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="551,929,761,971"/>
<area shape="rect" href="namespacecv__advection.html#a3323eb4932694a86940d81127e40d9fe" title=" " alt="" coords="579,995,733,1036"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="589,1061,723,1087"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title=" " alt="" coords="585,1112,727,1153"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="584,1797,728,1823"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="576,1229,736,1255"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="570,1279,742,1306"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="575,1330,737,1357"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state" alt="" coords="565,1381,747,1423"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="543,1447,769,1474"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="546,1498,766,1525"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title=" " alt="" coords="611,1549,701,1575"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="579,1600,733,1641"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title=" " alt="" coords="570,1665,742,1707"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="559,1731,753,1772"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="585,397,727,439"/>
<area shape="rect" href="namespacecv__advection.html#a5c177e18f7b1275cc9b308000daaa788" title=" " alt="" coords="578,1848,734,1889"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="581,1914,731,1941"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="568,1965,744,2007"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="569,2031,743,2058"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title=" " alt="" coords="579,136,733,177"/>
<area shape="rect" href="namespacecv__advection.html#ad714b20d018bf748c3ad080732b7c9cc" title=" " alt="" coords="575,201,737,243"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab4280b302a2f45375be2df118ed6d100" title=": Sets the boundary condition, if the time has advance and the BCs changed, here they are set to the ..." alt="" coords="563,267,749,308"/>
<area shape="rect" href="namespacecopy__outof__state.html#a3e466dfb76c8c3e30de12d2f7d36d3bb" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="563,332,749,373"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title=" " alt="" coords="839,1141,1007,1183"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="852,1513,993,1539"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aad25281c21796ab5cdd1ecf160cdad8f" title=" " alt="" coords="861,1207,984,1234"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="579,2083,733,2124"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="569,2148,743,2189"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_icgraph" id="namespacemultiphase__1d__engine_a98e757b51a04b55df8d38e36470e0b96_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="749,35,933,76"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,64,701,105"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,71,396,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a03c49a0f1a67a464bbb77115775ae4d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03c49a0f1a67a464bbb77115775ae4d1">&#9670;&nbsp;</a></span>introduce_grad_rhs_field_term()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::introduce_grad_rhs_field_term </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>RHS_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>FE_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dev__shape__funs.html">multi_dev_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Devfuns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension ( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>LOC_U_RHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>sdetwe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>SNORMXN_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>U_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>CV_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>MAT_OTHER_LOC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example) for the momentum equation. The inout field is RHS_field For capillary pressure: The capillary pressure is a term introduced as a RHS which affects the effective velocity </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a03c49a0f1a67a464bbb77115775ae4d1_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a03c49a0f1a67a464bbb77115775ae4d1_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a03c49a0f1a67a464bbb77115775ae4d1_icgraph" id="namespacemultiphase__1d__engine_a03c49a0f1a67a464bbb77115775ae4d1_icgraph">
<area shape="rect" title=": This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example..." alt="" coords="1371,16,1540,72"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,5,1323,32"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,31,1147,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,31,908,57"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,23,676,65"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,23,419,65"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,23,171,65"/>
</map>
</div>

</div>
</div>
<a id="a8917356adde1eb2aedccd0320529a6c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8917356adde1eb2aedccd0320529a6c5">&#9670;&nbsp;</a></span>linearise_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::linearise_field </td>
          <td>(</td>
          <td class="paramtype">type( tensor_field ), intent(in)&#160;</td>
          <td class="paramname"><em>field_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>field_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This sub will linearise a p2 field </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph" id="namespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph">
<area shape="rect" title=": This sub will linearise a p2 field" alt="" coords="724,5,893,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a34cd5ba5d5dfec039fa896b5fdc14e9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34cd5ba5d5dfec039fa896b5fdc14e9f">&#9670;&nbsp;</a></span>p0_dg_oscilat_detect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_1d_engine::p0_dg_oscilat_detect </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>SNDOTQ_KEEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>SNDOTQ2_KEEP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>N_DOT_DU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>N_DOT_DU2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>SINCOME</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>MASS_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>MASS_ELE2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_cgraph" id="namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_cgraph">
<area shape="rect" title=": Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="5,5,175,47"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="223,13,364,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_icgraph" id="namespacemultiphase__1d__engine_a34cd5ba5d5dfec039fa896b5fdc14e9f_icgraph">
<area shape="rect" title=": Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="1371,5,1540,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="aa5819c18b57b8144faa1885776a2cc8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5819c18b57b8144faa1885776a2cc8b">&#9670;&nbsp;</a></span>tracer_assemble_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::tracer_assemble_solve </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>Tracer_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>VOLFRA_PORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IGOT_T2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GET_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>USE_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_GDIFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>Permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passive_Tracer_N Where N is an integer which is continuous starting from 1 A boussinesq approximation is enforced on these tracers as the are totally INERT CURRENTLY NO DIFFUSION. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_cgraph" id="namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_cgraph">
<area shape="rect" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="5,981,185,1023"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="248,857,440,899"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="248,923,440,964"/>
<area shape="rect" href="namespacecv__advection.html#a083e26c7f43d55723d9e316ef2069394" title="Generates the transport equation on the CV mesh. Can be also used to generate the gradient matrix for..." alt="" coords="249,989,439,1015"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="247,1040,441,1081"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="233,1513,455,1555"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="519,201,713,243"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="558,318,674,345"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="796,150,969,177"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="525,471,707,512"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title=" " alt="" coords="545,536,687,577"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="521,602,711,629"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title=" " alt="" coords="528,653,704,679"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="517,704,715,745"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title=" " alt="" coords="777,792,988,833"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="511,887,721,928"/>
<area shape="rect" href="namespacecv__advection.html#a3323eb4932694a86940d81127e40d9fe" title=" " alt="" coords="539,952,693,993"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="549,1018,683,1045"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title=" " alt="" coords="545,1069,687,1111"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="544,369,688,395"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="536,1135,696,1162"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="530,419,702,446"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="535,1186,697,1213"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state" alt="" coords="525,1237,707,1279"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="503,1303,729,1330"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="506,1354,726,1381"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title=" " alt="" coords="571,1405,661,1431"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="539,1456,693,1497"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title=" " alt="" coords="530,1521,702,1563"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="519,1587,713,1628"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="545,821,687,863"/>
<area shape="rect" href="namespacecv__advection.html#a5c177e18f7b1275cc9b308000daaa788" title=" " alt="" coords="538,1652,694,1693"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="541,1718,691,1745"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="528,1769,704,1811"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="529,1835,703,1862"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title=" " alt="" coords="539,1887,693,1928"/>
<area shape="rect" href="namespacecv__advection.html#ad714b20d018bf748c3ad080732b7c9cc" title=" " alt="" coords="535,5,697,47"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab4280b302a2f45375be2df118ed6d100" title=": Sets the boundary condition, if the time has advance and the BCs changed, here they are set to the ..." alt="" coords="523,71,709,112"/>
<area shape="rect" href="namespacecopy__outof__state.html#a3e466dfb76c8c3e30de12d2f7d36d3bb" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="523,136,709,177"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title=" " alt="" coords="799,201,967,243"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="812,318,953,345"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aad25281c21796ab5cdd1ecf160cdad8f" title=" " alt="" coords="821,267,944,294"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a6b4e2b7cd1b1214a242258cc6f8b753a" title=" " alt="" coords="793,543,972,570"/>
<area shape="rect" href="multi__shape__fct_8_f90.html#a3ac481479452947a759fbb6c9cf743e9" title=" " alt="" coords="793,711,972,738"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=" " alt="" coords="790,989,975,1015"/>
<area shape="rect" href="namespacecv__advection.html#afc0d98d467a15c460d49668d0194344a" title=" " alt="" coords="798,420,967,461"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="808,369,957,395"/>
<area shape="rect" href="namespacemulti__tools.html#ad2dc4462bad46ef99ca0057cb3c91262" title=" " alt="" coords="808,486,957,513"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a5c58181433ef3d6296d003eccb780c6d" title=" " alt="" coords="781,1529,984,1555"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="539,1952,693,1993"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_icgraph" id="namespacemultiphase__1d__engine_aa5819c18b57b8144faa1885776a2cc8b_icgraph">
<area shape="rect" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="467,5,647,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a8e2d722ec8283f1e4d87f7b6d7e427a5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e2d722ec8283f1e4d87f7b6d7e427a5">&#9670;&nbsp;</a></span>use_posinmat_c_store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::use_posinmat_c_store </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>COUNT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_INOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>P_JNOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nonods + 1), intent(in)&#160;</td>
          <td class="paramname"><em>FINDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( ncolc), intent(in)&#160;</td>
          <td class="paramname"><em>COLC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NCOLC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IDO_STORE_AC_SPAR_PT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>STORED_AC_SPAR_PT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc,p_nloc, totele*ido_store_ac_spar_pt), intent(inout)&#160;</td>
          <td class="paramname"><em>POSINMAT_C_STORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_ILOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>P_JLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>TOTELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>P_NLOC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_cgraph" id="namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,47"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="228,5,377,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_icgraph" id="namespacemultiphase__1d__engine_a8e2d722ec8283f1e4d87f7b6d7e427a5_icgraph">
<area shape="rect" title=" " alt="" coords="1371,5,1545,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a25c88bda5ea4082016d39781e111d445"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25c88bda5ea4082016d39781e111d445">&#9670;&nbsp;</a></span>use_posinmat_c_store_suf_dg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::use_posinmat_c_store_suf_dg </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>COUNT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_INOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>P_JNOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nonods + 1), intent(in)&#160;</td>
          <td class="paramname"><em>FINDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( ncolc), intent(in)&#160;</td>
          <td class="paramname"><em>COLC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NCOLC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IDO_STORE_AC_SPAR_PT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>STORED_AC_SPAR_PT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_snloc,p_snloc,nface,totele*ido_store_ac_spar_pt ), intent(inout)&#160;</td>
          <td class="paramname"><em>POSINMAT_C_STORE_SUF_DG</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IFACE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_SILOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>P_SJLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>TOTELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NFACE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>P_SNLOC</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_cgraph" id="namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,180,61"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="228,13,377,54"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_icgraph" id="namespacemultiphase__1d__engine_a25c88bda5ea4082016d39781e111d445_icgraph">
<area shape="rect" title=" " alt="" coords="1371,5,1545,61"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,20,1323,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,20,1147,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,20,908,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,13,676,54"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,419,54"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,54"/>
</map>
</div>

</div>
</div>
<a id="afcedae35a0a37c9b033248d85bb9ad86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afcedae35a0a37c9b033248d85bb9ad86">&#9670;&nbsp;</a></span>viscocity_tensor_les_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::viscocity_tensor_les_calc </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, mat_nonods  ), intent(inout)&#160;</td>
          <td class="paramname"><em>LES_UDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, mat_nonods  ), intent(inout)&#160;</td>
          <td class="paramname"><em>LES_UDIFFUSION_VOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, u_nloc, totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>DUX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>TOTELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, x_nonods  ), intent(in)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( x_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>X_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MAT_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MAT_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( mat_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>MAT_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LES_DISOPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>LES_CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, cv_nonods ), intent(in)&#160;</td>
          <td class="paramname"><em>UDEN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( mat_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>U_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, u_nonods  ), intent(in)&#160;</td>
          <td class="paramname"><em>U_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, cv_nonods ), intent(in)&#160;</td>
          <td class="paramname"><em>DERIV</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_cgraph" id="namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_cgraph">
<area shape="rect" title=": This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL" alt="" coords="5,23,200,65"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="248,23,403,65"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="451,31,568,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="616,31,677,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181" title=" " alt="" coords="725,5,789,32"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="726,56,789,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_icgraph" id="namespacemultiphase__1d__engine_afcedae35a0a37c9b033248d85bb9ad86_icgraph">
<area shape="rect" title=": This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL" alt="" coords="1371,5,1565,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="ad29606c63b241238edd97827aa4564d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad29606c63b241238edd97827aa4564d7">&#9670;&nbsp;</a></span>volumefraction_assemble_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::volumefraction_assemble_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type )&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>V_SOURCE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>VOLFRA_PORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>time_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>SFPI_taken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>SFPI_its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>Courant_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX_J</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_cgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_cgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_cgraph" id="namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="5,1085,247,1127"/>
<area shape="rect" href="namespacematrix__operations.html#ab99709a532cd3a8ace8bd896814bc37b" title=" " alt="" coords="308,425,509,481"/>
<area shape="rect" href="namespacesolvers__module.html#a4e86e8d68a22dcc9e670af385d938bf4" title=" " alt="" coords="327,505,490,547"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="295,571,523,612"/>
<area shape="rect" href="namespacecv__advection.html#a083e26c7f43d55723d9e316ef2069394" title="Generates the transport equation on the CV mesh. Can be also used to generate the gradient matrix for..." alt="" coords="314,1093,503,1119"/>
<area shape="rect" href="namespacesolvers__module.html#a4773b0f364c52ef1ca48a3ead9f6693c" title="this idea is based on the paper SPE&#45;173267&#45;MS. The method ensures convergence &quot;independent&quot; of the ti..." alt="" coords="333,2129,484,2171"/>
<area shape="rect" href="namespacesolvers__module.html#a27f681607a9e40b1e99a8f45cd6a940c" title="certain tolerance and also sets the saturation to be between bounds" alt="" coords="579,2251,789,2292"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="298,2305,519,2347"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="597,5,771,47"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="845,71,1057,98"/>
<area shape="rect" href="multi__eos_8_f90.html#aa152716c3e7e6d83fb9b90b26a9c7be7" title=": For porous media, just sets the viscosity as a scalar" alt="" coords="631,122,737,149"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="855,5,1047,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1105,35,1265,76"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title=" " alt="" coords="587,173,781,215"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="626,290,742,317"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="865,239,1038,266"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="593,341,775,383"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title=" " alt="" coords="613,407,755,448"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="589,473,779,499"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title=" " alt="" coords="596,523,772,550"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title=" " alt="" coords="585,575,783,616"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title=" " alt="" coords="846,1096,1057,1137"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title=" " alt="" coords="579,692,789,733"/>
<area shape="rect" href="namespacecv__advection.html#a3323eb4932694a86940d81127e40d9fe" title=" " alt="" coords="607,757,761,799"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="617,823,751,850"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title=" " alt="" coords="613,875,755,916"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="612,941,756,967"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="604,991,764,1018"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="598,1042,770,1069"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="603,1093,765,1119"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state" alt="" coords="593,1144,775,1185"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="571,1210,797,1237"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="574,1261,794,1287"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title=" " alt="" coords="639,1311,729,1338"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="607,1363,761,1404"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title=" " alt="" coords="598,1428,770,1469"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="587,1493,781,1535"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="613,1559,755,1600"/>
<area shape="rect" href="namespacecv__advection.html#a5c177e18f7b1275cc9b308000daaa788" title=" " alt="" coords="606,1624,762,1665"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="609,1690,759,1717"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="596,1741,772,1783"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="597,1807,771,1834"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title=" " alt="" coords="607,1859,761,1900"/>
<area shape="rect" href="namespacecv__advection.html#ad714b20d018bf748c3ad080732b7c9cc" title=" " alt="" coords="603,1924,765,1965"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab4280b302a2f45375be2df118ed6d100" title=": Sets the boundary condition, if the time has advance and the BCs changed, here they are set to the ..." alt="" coords="591,1989,777,2031"/>
<area shape="rect" href="namespacecopy__outof__state.html#a3e466dfb76c8c3e30de12d2f7d36d3bb" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="591,2055,777,2096"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title=" " alt="" coords="867,291,1035,332"/>
<area shape="rect" href="namespacecopy__outof__state.html#a7d6957a54cc1cc0a38a4a7a90bca1f89" title=": We create a potential to optimize F = sum (f**2), so the solution is when this potential reaches a ..." alt="" coords="592,2120,776,2161"/>
<area shape="rect" href="namespacesolvers__module.html#a9bba1ef1495c1a4a47a7eea3f2c17719" title="certain tolerance and also sets the saturation to be between bounds" alt="" coords="593,2185,775,2227"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="607,2316,761,2357"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_icgraph.png" border="0" usemap="#namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_icgraph" alt=""/></div>
<map name="namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_icgraph" id="namespacemultiphase__1d__engine_ad29606c63b241238edd97827aa4564d7_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,5,708,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
