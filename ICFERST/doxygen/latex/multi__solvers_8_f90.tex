\hypertarget{multi__solvers_8_f90}{}\doxysection{/home/psalinas/\+Documents/workspace/\+Multi\+Fluids\+\_\+\+Dev/\+I\+C\+F\+E\+R\+S\+T/src/multi\+\_\+solvers.F90 File Reference}
\label{multi__solvers_8_f90}\index{/home/psalinas/Documents/workspace/MultiFluids\_Dev/ICFERST/src/multi\_solvers.F90@{/home/psalinas/Documents/workspace/MultiFluids\_Dev/ICFERST/src/multi\_solvers.F90}}
{\ttfamily \#include \char`\"{}fdebug.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}petsc\+\_\+legacy.\+h\char`\"{}}\newline
Include dependency graph for multi\+\_\+solvers.\+F90\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=272pt]{multi__solvers_8_f90__incl}
\end{center}
\end{figure}
\doxysubsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacesolvers__module}{solvers\+\_\+module}}
\begin{DoxyCompactList}\small\item\em All the subroutines associated to solving non-\/linear systems, Schur complement, etc. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_adef72e22883fb36304a2da0099927175}{solvers\+\_\+module\+::boundedsolutioncorrections}} (state, packed\+\_\+state, Mdims, C\+V\+\_\+funs, small\+\_\+findrm, small\+\_\+colm, Field\+\_\+name, for\+\_\+sat, min\+\_\+max\+\_\+limits)
\begin{DoxyCompactList}\small\item\em The sparcity of the local CV connectivity is in\+: small\+\_\+findrm, small\+\_\+colm. ngl\+\_\+its=max no of global iterations e.\+g. 100. error\+\_\+tol = tolerance on the iterations. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a4773b0f364c52ef1ca48a3ead9f6693c}{solvers\+\_\+module\+::fpi\+\_\+backtracking}} (nphase, Mdims, ndgln, state, packed\+\_\+state, sat\+\_\+bak, backtrack\+\_\+sat, backtrack\+\_\+par\+\_\+from\+\_\+schema, Previous\+\_\+convergence, satisfactory\+\_\+convergence, new\+\_\+backtrack\+\_\+par, Max\+\_\+sat\+\_\+its, its, nonlinear\+\_\+iteration, useful\+\_\+sats, res, res\+\_\+ratio, first\+\_\+res)
\begin{DoxyCompactList}\small\item\em \+:In this subroutine we applied some corrections and backtrack\+\_\+par on the saturations obtained from the saturation equation this subroutine is detailed in Salinas et al. 2017 doi\+:10.\+1002/fld.4357 The method ensures convergence \char`\"{}independent\char`\"{} of the time step. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a9bba1ef1495c1a4a47a7eea3f2c17719}{solvers\+\_\+module\+::set\+\_\+saturation\+\_\+to\+\_\+sum\+\_\+one}} (mdims, packed\+\_\+state, state, do\+\_\+not\+\_\+update\+\_\+halos)
\begin{DoxyCompactList}\small\item\em \+:This subroutines eliminates the oscillations in the saturation that are bigger than a certain tolerance and also sets the saturation to be between bounds \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a27f681607a9e40b1e99a8f45cd6a940c}{solvers\+\_\+module\+::non\+\_\+porous\+\_\+ensure\+\_\+sum\+\_\+to\+\_\+one}} (Mdims, packed\+\_\+state, do\+\_\+not\+\_\+update\+\_\+halos)
\begin{DoxyCompactList}\small\item\em \+: This subroutines eliminates the oscillations in the saturation that are bigger than a certain tolerance and also sets the saturation to be between bounds \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a85646e595797edceed6d3be72173ef7f}{solvers\+\_\+module\+::initialise\+\_\+saturation\+\_\+sums\+\_\+one}} (mdims, packed\+\_\+state, find\+\_\+scapegoat\+\_\+phase)
\begin{DoxyCompactList}\small\item\em \+:Ensure that the saturations at the beginning sum to one, if they do not all the error is compensated in the scapegoat\+\_\+phase. Normally the last \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a4e86e8d68a22dcc9e670af385d938bf4}{solvers\+\_\+module\+::auto\+\_\+backtracking}} (Mdims, backtrack\+\_\+par\+\_\+factor, courant\+\_\+number\+\_\+in, first\+\_\+time\+\_\+step, nonlinear\+\_\+iteration, I\+\_\+am\+\_\+temperature)
\begin{DoxyCompactList}\small\item\em \+: The maximum backtracking factor is calculated based on the Courant number and physical effects ocurring in the domain \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a119325e40cdcd54b1766472b55920364}{solvers\+\_\+module\+::get\+\_\+anderson\+\_\+acceleration\+\_\+new\+\_\+guess}} (N, M, New\+Field, History\+\_\+field, stored\+\_\+residuals, max\+\_\+its, prev\+\_\+small\+\_\+matrix, restart\+\_\+now)
\begin{DoxyCompactList}\small\item\em This subroutine provides a new guess based on previous updates and residuals. Use this subroutine to speed up any system being solved by looping. A new guess is computed and returned Method explained in D\+O\+I.\+10.\+1137/10078356X. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_af233b921efdba4e01b5920ccf509ef29}{solvers\+\_\+module\+::scale\+\_\+petsc\+\_\+matrix}} (Mat\+\_\+petsc)
\begin{DoxyCompactList}\small\item\em In this subroutine the matrix is re-\/scaled based on the formula D$^\wedge$-\/0.5 $\ast$ A $\ast$ D$^\wedge$-\/0.5 X\textquotesingle{}= D$^\wedge$-\/0.5 b; and next X = D$^\wedge$-\/0.5 $\ast$ X\textquotesingle{}; I\+M\+P\+O\+R\+T\+A\+NT\+: the step X = D$^\wedge$-\/0.5 $\ast$ X\textquotesingle{} needs to be done elsewhere store the diagonal before calling this This should allow to deal with high ranges of viscosity ratio for example A is-\/written. \end{DoxyCompactList}\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_a76231fdbfc56035f797b1c21675c02ed}{solvers\+\_\+module\+::duplicate\+\_\+petsc\+\_\+matrix}} (M\+A\+T\+\_\+A, M\+A\+T\+\_\+B)
\item 
subroutine, public \mbox{\hyperlink{namespacesolvers__module_ab1b067219293fc4e2583394acce02bfa}{solvers\+\_\+module\+::petsc\+\_\+stokes\+\_\+solver}} (packed\+\_\+state, Mdims, Mmat, ndgln, Mspars, final\+\_\+phase, pmat, P\+\_\+all, deltaP, rhs\+\_\+p, solver\+\_\+option\+\_\+path, Dmat)
\begin{DoxyCompactList}\small\item\em In this subroutine the Schur complement is generated and solved using P\+E\+T\+Sc to update the pressure field Matrices need to be in petsc format and pmat is the preconditioned matrix, i.\+e. pmat = A11-\/ A10(Aprox\+A00$^\wedge$-\/1)A01. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacesolvers__module_aad076a468a68cdb44f63a6290e9c8159}{solvers\+\_\+module\+::convert\+\_\+c\+\_\+and\+\_\+ct\+\_\+mat\+\_\+to\+\_\+petsc\+\_\+format}} (packed\+\_\+state, Mdims, Mmat, ndgln, Mspars, N\+P\+H\+A\+SE)
\begin{DoxyCompactList}\small\item\em \+: This subroutine converts the C (gradient) and CT (Divergence) matrices into P\+E\+T\+Sc format Mainly devoted to be used by the P\+E\+T\+Sc stokes schur solver This can be used when moving from the I\+C\+F\+E\+R\+ST matrix format to P\+E\+T\+Sc as reference \end{DoxyCompactList}\end{DoxyCompactItemize}
