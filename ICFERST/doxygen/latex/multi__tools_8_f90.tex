\hypertarget{multi__tools_8_f90}{}\doxysection{/home/psalinas/\+Documents/workspace/\+Multi\+Fluids\+\_\+\+Dev/\+I\+C\+F\+E\+R\+S\+T/src/multi\+\_\+tools.F90 File Reference}
\label{multi__tools_8_f90}\index{/home/psalinas/Documents/workspace/MultiFluids\_Dev/ICFERST/src/multi\_tools.F90@{/home/psalinas/Documents/workspace/MultiFluids\_Dev/ICFERST/src/multi\_tools.F90}}
{\ttfamily \#include \char`\"{}fdebug.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}petsc\+\_\+legacy.\+h\char`\"{}}\newline
Include dependency graph for multi\+\_\+tools.\+F90\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=261pt]{multi__tools_8_f90__incl}
\end{center}
\end{figure}
\doxysubsection*{Modules}
\begin{DoxyCompactItemize}
\item 
module \mbox{\hyperlink{namespacemulti__tools}{multi\+\_\+tools}}
\begin{DoxyCompactList}\small\item\em This module contains the generic subroutines required by I\+C\+F\+E\+R\+ST, for example quicksort. \end{DoxyCompactList}\end{DoxyCompactItemize}
\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real function \mbox{\hyperlink{namespacemulti__tools_a225d95bb84187e3f0fcee8a3bd08b221}{multi\+\_\+tools\+::r2norm}} (V\+EC, N\+V\+EC)
\item 
real function \mbox{\hyperlink{namespacemulti__tools_a00bc5585e5ce49ad92386eb4acca54ff}{multi\+\_\+tools\+::ptolfun}} (value)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for strictly positive values used as a denominator. If the value of V\+A\+L\+UE less than 1E-\/10, then it returns T\+O\+L\+E\+R\+A\+N\+CE otherwise V\+A\+L\+UE. \end{DoxyCompactList}\item 
pure real function \mbox{\hyperlink{namespacemulti__tools_a9bc979224e98f447e412133da3464728}{multi\+\_\+tools\+::tolfun}} (value)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for a value which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. \end{DoxyCompactList}\item 
pure real function, dimension(size(val)) \mbox{\hyperlink{namespacemulti__tools_a4f90f9b3033bd34d8d52d140a8b6d8cf}{multi\+\_\+tools\+::tolfun\+\_\+many}} (val)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for a scalar which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. \end{DoxyCompactList}\item 
real function \mbox{\hyperlink{namespacemulti__tools_a9455b92cfb559c3b76e4b77580886c47}{multi\+\_\+tools\+::tetvolume}} (x0, y0, z0, x1, y1, z1, x2, y2, z2, x3, y3, z3)
\item 
pure real function, dimension(size(val)) \mbox{\hyperlink{namespacemulti__tools_ad2dc4462bad46ef99ca0057cb3c91262}{multi\+\_\+tools\+::vtolfun}} (val)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for a vector which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_a0670e50b3781879bb4eefa80cd56911f}{multi\+\_\+tools\+::nan\+\_\+check}} (a, k)
\begin{DoxyCompactList}\small\item\em \+:Checks if a number is a Nan \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_af5b0f8124b8423342bd6fb38e7d244ec}{multi\+\_\+tools\+::nan\+\_\+check\+\_\+arr}} (a, k)
\begin{DoxyCompactList}\small\item\em \+:Checks if an array is a Nan \end{DoxyCompactList}\item 
pure real function, dimension(size(uc)) \mbox{\hyperlink{namespacemulti__tools_aeab4bf302bd943e5acf2e70c93cb55cf}{multi\+\_\+tools\+::nvdfunnew\+\_\+many}} (UF, UC, X\+I\+\_\+\+L\+I\+M\+IT)
\begin{DoxyCompactList}\small\item\em \+: The function computes N\+V\+D\+F\+U\+N\+N\+EW, the normalised value of the advected variable on the face of the control volume, based on the normalised value of the advected variable in the donor CV, UC, and the high-\/order estimate of the face value UF. N\+V\+D\+F\+U\+N\+N\+EW is limited so that it is in the non-\/oscillatory region of normalised variable diagram (N\+VD). \end{DoxyCompactList}\item 
real function, dimension(size(uc)) \mbox{\hyperlink{namespacemulti__tools_a524e21621ef6f56629221ac8cea5f343}{multi\+\_\+tools\+::nvdfunnew\+\_\+many\+\_\+sqrt}} (UF, UC, X\+I\+\_\+\+L\+I\+M\+IT)
\begin{DoxyCompactList}\small\item\em \+: The function computes N\+V\+D\+F\+U\+N\+N\+EW, the normalised value of the advected variable on the face of the control volume, based on the normalised value of the advected variable in the donor CV, UC, and the high-\/order estimate of the face value UF. N\+V\+D\+F\+U\+N\+N\+EW is limited so that it is in the non-\/oscillatory region of normalised variable diagram (N\+VD). \end{DoxyCompactList}\item 
integer function, dimension(\+:), pointer \mbox{\hyperlink{namespacemulti__tools_a29b23492be133b01a7eb9bce13adbdfb}{multi\+\_\+tools\+::get\+\_\+ndglno}} (mesh)
\item 
recursive subroutine \mbox{\hyperlink{namespacemulti__tools_a3ac19b56ac30b94f277519bc61d39d21}{multi\+\_\+tools\+::quicksort}} (vec, n)
\begin{DoxyCompactList}\small\item\em \+:Sort a list in increasing order Vec is the vector to sort and n is an starting point, like 1 \end{DoxyCompactList}\item 
integer function \mbox{\hyperlink{multi__tools_8_f90_a054ef005839aa2ad2184eb3a6a28199a}{partition}} (v)
\item 
subroutine \mbox{\hyperlink{multi__tools_8_f90_a1bc37745e090cdc90171cd68ea218026}{insertion\+\_\+sort}} (vec, n)
\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_aedaed2b29fa348112b4f347045e75ab6}{multi\+\_\+tools\+::calc\+\_\+face\+\_\+ele}} (F\+A\+C\+E\+\_\+\+E\+LE, T\+O\+T\+E\+LE, S\+T\+O\+T\+EL, N\+F\+A\+CE, F\+I\+N\+E\+LE, C\+O\+L\+E\+LE, C\+V\+\_\+\+N\+L\+OC, C\+V\+\_\+\+S\+N\+L\+OC, C\+V\+\_\+\+N\+O\+N\+O\+DS, C\+V\+\_\+\+N\+D\+G\+LN, C\+V\+\_\+\+S\+N\+D\+G\+LN, C\+V\+\_\+\+S\+L\+O\+C\+L\+I\+ST, X\+\_\+\+N\+L\+OC, X\+\_\+\+N\+D\+G\+LN)
\begin{DoxyCompactList}\small\item\em \+: Calculate F\+A\+C\+E\+\_\+\+E\+LE -\/ the list of elements surrounding an element and referenced with a face -\/ve values correspond to surface elements. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ac75ade49c065a07b12ef6532bbbd7abb}{multi\+\_\+tools\+::assign\+\_\+val}} (outval, inval)
\begin{DoxyCompactList}\small\item\em \+:Copies the data from inval to outval safely. If the sizes are different outval is populated using the first value of inval \end{DoxyCompactList}\item 
real function \mbox{\hyperlink{namespacemulti__tools_a5e01cea8994467049dde8f8679bf966f}{multi\+\_\+tools\+::table\+\_\+interpolation}} (X\+\_\+points, Y\+\_\+points, input\+\_\+X)
\begin{DoxyCompactList}\small\item\em X\+\_\+points, Y\+\_\+points to form a linear (size == 2) or quadratic (size == 3) interpolation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_a9cf0d43cd5f90a02f337d253ef19d47d}{multi\+\_\+tools\+::read\+\_\+csv\+\_\+table}} (data\+\_\+array, path\+\_\+to\+\_\+table, extra\+\_\+data)
\begin{DoxyCompactList}\small\item\em \+:Template of csv table O\+P\+T\+I\+O\+N\+AL section (header) real1,real2,real3,..., size(extra\+\_\+data) rows,columns 2,3 Pressure,Saturation 1000,0.\+9 250,0.\+5 100,0.\+1 \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_aa621c334a67449127204c9b12f80bc99}{multi\+\_\+tools\+::extract\+\_\+strings\+\_\+from\+\_\+csv\+\_\+file}} (csv\+\_\+table\+\_\+strings, path\+\_\+to\+\_\+table, Nentries)
\begin{DoxyCompactList}\small\item\em \+:This subroutine reads a csv file and returns them in an array \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ad0e757bf71fd38690cf03c4bb28ebc9c}{multi\+\_\+tools\+::printmatrix}} (Matrix)
\begin{DoxyCompactList}\small\item\em \+:Subroutine to print Arrays by (columns,rows) Matrix = 2D Array \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_afb60c42191061e03c2928a7d2e023087}{multi\+\_\+tools\+::rotationmatrix}} (a, R)
\begin{DoxyCompactList}\small\item\em \+: Roates a matrix A using the toration matrix R???? \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ab4b886f97602b31bf8009a4af74510d7}{multi\+\_\+tools\+::read\+\_\+nastran\+\_\+file}} (filepath, node, edges)
\begin{DoxyCompactList}\small\item\em \+:This subroutine reads a nastran file that contains the information defining the 1D path of a well the input relative filepath should include the file format, for example\+: well.\+bdf \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{multi__tools_8_f90_a32ccce1d69fb59cb01d03843a5ef122d}{get\+\_\+nodes\+\_\+edges}} (Nnodes, Nedges)
\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_afe872f374438522cab79b02f6f114cd1}{multi\+\_\+tools\+::least\+\_\+squares\+\_\+solver}} (A, b, rank)
\begin{DoxyCompactList}\small\item\em Subroutine that solves the least squares problem $\vert$\+Ax-\/b$\vert$2 using L\+A\+P\+A\+CK and blas Subroutine tested and compared with Matlab (not recommended changing it since it is a pain!) Only for serial\+: The best option is to solve in each processor the optimisation system by performing A\textquotesingle{} $\ast$ A = A\textquotesingle{} $\ast$b; so the system becomes very small as C\+O\+L\+U\+MS $<$$<$$<$ R\+O\+WS. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ab412a6b9d80984d5739ef227590a9e8d}{multi\+\_\+tools\+::multi\+\_\+compute\+\_\+python\+\_\+field}} (states, iphase, option\+\_\+path\+\_\+python, scalar\+\_\+result, sfield, vfield, tfield)
\begin{DoxyCompactList}\small\item\em \+: This subroutine uses python run string to run the python\+\_\+scalar\+\_\+diagnostic to read a field the only difference with the normal approach is that here the Dummy field is used and the returned field is an array. I\+M\+P\+O\+R\+T\+A\+NT\+: state is used here, N\+OT packed\+\_\+state It can be used for a given array, scalar\+\_\+result, scalar fields, vector fields or tensor fields, but only one at a time \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_a644ea690bc5f7b40185a6fee8e28d711}{multi\+\_\+tools\+::petsc\+\_\+logging}} (func, stage, ierr, default, push\+\_\+no, stage\+\_\+name)
\begin{DoxyCompactList}\small\item\em Subroutines that can initialise, register and start/end a petsc performance profiling routin. The defauly behaviour is initiliased for time-\/loop profiling. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{multi__tools_8_f90_a20ffba2d9f6022b015e7122a1a461a1f}{petsc\+\_\+log\+\_\+init}} (stage\+\_\+name, no, stage, ierr)
\begin{DoxyCompactList}\small\item\em \+: This routine registers the stage for P\+E\+T\+SC logging I\+M\+P\+O\+R\+T\+A\+NT\+: \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{multi__tools_8_f90_a005cd14565f82c0eca81def2d7be6cb2}{petsc\+\_\+log\+\_\+push}} (no, stage, ierr)
\begin{DoxyCompactList}\small\item\em \+: This routine starts the current stage registered for P\+E\+T\+Sc profiling I\+M\+P\+O\+R\+T\+A\+NT\+: \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{multi__tools_8_f90_a04e6e3471cf9b89f5685e91e93e88a6c}{petsc\+\_\+log\+\_\+pop}} (ierr)
\begin{DoxyCompactList}\small\item\em \+: This routine ends the current stage registered for P\+E\+T\+Sc profiling I\+M\+P\+O\+R\+T\+A\+NT\+: \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacemulti__tools_a88fe8456a6aab41a0c9aeff3b0a4f2ec}{multi\+\_\+tools\+::is\+\_\+tracer\+\_\+field}} (input\+\_\+name)
\begin{DoxyCompactList}\small\item\em \+: Returns true if the input name is a Tracer type\+:Passive\+Tracer, Tracer, Species, Concentration or any other reserved word This function is used to easily identify Tracers that may have diffusion, sources/sinks, dispersion, etc. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacemulti__tools_a1ab322da5f344e1d042fb429ebce3637}{multi\+\_\+tools\+::is\+\_\+active\+\_\+tracer\+\_\+field}} (input\+\_\+name, ignore\+\_\+concentration)
\begin{DoxyCompactList}\small\item\em \+: Returns true if the input name is an Active Tracer type, Tracer, Species, Concentration or any other reserved word This function is used to easily identify Tracers that may have diffusion, sources/sinks, dispersion, etc. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacemulti__tools_a81569e130900c1b6a18ff46132f94d12}{multi\+\_\+tools\+::is\+\_\+passivetracer\+\_\+field}} (input\+\_\+name)
\begin{DoxyCompactList}\small\item\em \+: Returns true if the input name is a Passiev\+Tracer type. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{multi__tools_8_f90_a32ccce1d69fb59cb01d03843a5ef122d}\label{multi__tools_8_f90_a32ccce1d69fb59cb01d03843a5ef122d}} 
\index{multi\_tools.F90@{multi\_tools.F90}!get\_nodes\_edges@{get\_nodes\_edges}}
\index{get\_nodes\_edges@{get\_nodes\_edges}!multi\_tools.F90@{multi\_tools.F90}}
\doxysubsubsection{\texorpdfstring{get\_nodes\_edges()}{get\_nodes\_edges()}}
{\footnotesize\ttfamily subroutine read\+\_\+nastran\+\_\+file\+::get\+\_\+nodes\+\_\+edges (\begin{DoxyParamCaption}\item[{integer, intent(inout)}]{Nnodes,  }\item[{integer, intent(inout)}]{Nedges }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{multi__tools_8_f90_a32ccce1d69fb59cb01d03843a5ef122d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{multi__tools_8_f90_a1bc37745e090cdc90171cd68ea218026}\label{multi__tools_8_f90_a1bc37745e090cdc90171cd68ea218026}} 
\index{multi\_tools.F90@{multi\_tools.F90}!insertion\_sort@{insertion\_sort}}
\index{insertion\_sort@{insertion\_sort}!multi\_tools.F90@{multi\_tools.F90}}
\doxysubsubsection{\texorpdfstring{insertion\_sort()}{insertion\_sort()}}
{\footnotesize\ttfamily subroutine quicksort\+::insertion\+\_\+sort (\begin{DoxyParamCaption}\item[{integer, dimension(n)}]{vec,  }\item[{integer}]{n }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{multi__tools_8_f90_a1bc37745e090cdc90171cd68ea218026_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{multi__tools_8_f90_a054ef005839aa2ad2184eb3a6a28199a}\label{multi__tools_8_f90_a054ef005839aa2ad2184eb3a6a28199a}} 
\index{multi\_tools.F90@{multi\_tools.F90}!partition@{partition}}
\index{partition@{partition}!multi\_tools.F90@{multi\_tools.F90}}
\doxysubsubsection{\texorpdfstring{partition()}{partition()}}
{\footnotesize\ttfamily integer function quicksort\+::partition (\begin{DoxyParamCaption}\item[{integer, dimension(\+:), intent(inout)}]{v }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{multi__tools_8_f90_a054ef005839aa2ad2184eb3a6a28199a_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{multi__tools_8_f90_a20ffba2d9f6022b015e7122a1a461a1f}\label{multi__tools_8_f90_a20ffba2d9f6022b015e7122a1a461a1f}} 
\index{multi\_tools.F90@{multi\_tools.F90}!petsc\_log\_init@{petsc\_log\_init}}
\index{petsc\_log\_init@{petsc\_log\_init}!multi\_tools.F90@{multi\_tools.F90}}
\doxysubsubsection{\texorpdfstring{petsc\_log\_init()}{petsc\_log\_init()}}
{\footnotesize\ttfamily subroutine petsc\+\_\+logging\+::petsc\+\_\+log\+\_\+init (\begin{DoxyParamCaption}\item[{character( len = $\ast$ ), intent(in)}]{stage\+\_\+name,  }\item[{integer}]{no,  }\item[{dimension(0\+:9)}]{stage,  }\item[{intent(inout)}]{ierr }\end{DoxyParamCaption})}



\+: This routine registers the stage for P\+E\+T\+SC logging I\+M\+P\+O\+R\+T\+A\+NT\+: 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{multi__tools_8_f90_a20ffba2d9f6022b015e7122a1a461a1f_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{multi__tools_8_f90_a04e6e3471cf9b89f5685e91e93e88a6c}\label{multi__tools_8_f90_a04e6e3471cf9b89f5685e91e93e88a6c}} 
\index{multi\_tools.F90@{multi\_tools.F90}!petsc\_log\_pop@{petsc\_log\_pop}}
\index{petsc\_log\_pop@{petsc\_log\_pop}!multi\_tools.F90@{multi\_tools.F90}}
\doxysubsubsection{\texorpdfstring{petsc\_log\_pop()}{petsc\_log\_pop()}}
{\footnotesize\ttfamily subroutine petsc\+\_\+logging\+::petsc\+\_\+log\+\_\+pop (\begin{DoxyParamCaption}\item[{intent(inout)}]{ierr }\end{DoxyParamCaption})}



\+: This routine ends the current stage registered for P\+E\+T\+Sc profiling I\+M\+P\+O\+R\+T\+A\+NT\+: 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{multi__tools_8_f90_a04e6e3471cf9b89f5685e91e93e88a6c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{multi__tools_8_f90_a005cd14565f82c0eca81def2d7be6cb2}\label{multi__tools_8_f90_a005cd14565f82c0eca81def2d7be6cb2}} 
\index{multi\_tools.F90@{multi\_tools.F90}!petsc\_log\_push@{petsc\_log\_push}}
\index{petsc\_log\_push@{petsc\_log\_push}!multi\_tools.F90@{multi\_tools.F90}}
\doxysubsubsection{\texorpdfstring{petsc\_log\_push()}{petsc\_log\_push()}}
{\footnotesize\ttfamily subroutine petsc\+\_\+logging\+::petsc\+\_\+log\+\_\+push (\begin{DoxyParamCaption}\item[{integer}]{no,  }\item[{dimension(0\+:9)}]{stage,  }\item[{intent(inout)}]{ierr }\end{DoxyParamCaption})}



\+: This routine starts the current stage registered for P\+E\+T\+Sc profiling I\+M\+P\+O\+R\+T\+A\+NT\+: 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{multi__tools_8_f90_a005cd14565f82c0eca81def2d7be6cb2_icgraph}
\end{center}
\end{figure}
