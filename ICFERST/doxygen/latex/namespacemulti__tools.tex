\hypertarget{namespacemulti__tools}{}\doxysection{multi\+\_\+tools Module Reference}
\label{namespacemulti__tools}\index{multi\_tools@{multi\_tools}}


This module contains the generic subroutines required by I\+C\+F\+E\+R\+ST, for example quicksort.  


\doxysubsection*{Functions/\+Subroutines}
\begin{DoxyCompactItemize}
\item 
real function \mbox{\hyperlink{namespacemulti__tools_a225d95bb84187e3f0fcee8a3bd08b221}{r2norm}} (V\+EC, N\+V\+EC)
\item 
real function \mbox{\hyperlink{namespacemulti__tools_a00bc5585e5ce49ad92386eb4acca54ff}{ptolfun}} (value)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for strictly positive values used as a denominator. If the value of V\+A\+L\+UE less than 1E-\/10, then it returns T\+O\+L\+E\+R\+A\+N\+CE otherwise V\+A\+L\+UE. \end{DoxyCompactList}\item 
pure real function \mbox{\hyperlink{namespacemulti__tools_a9bc979224e98f447e412133da3464728}{tolfun}} (value)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for a value which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. \end{DoxyCompactList}\item 
pure real function, dimension(size(val)) \mbox{\hyperlink{namespacemulti__tools_a4f90f9b3033bd34d8d52d140a8b6d8cf}{tolfun\+\_\+many}} (val)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for a scalar which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. \end{DoxyCompactList}\item 
real function \mbox{\hyperlink{namespacemulti__tools_a9455b92cfb559c3b76e4b77580886c47}{tetvolume}} (x0, y0, z0, x1, y1, z1, x2, y2, z2, x3, y3, z3)
\item 
pure real function, dimension(size(val)) \mbox{\hyperlink{namespacemulti__tools_ad2dc4462bad46ef99ca0057cb3c91262}{vtolfun}} (val)
\begin{DoxyCompactList}\small\item\em \+:This function is a tolerance function for a vector which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_a0670e50b3781879bb4eefa80cd56911f}{nan\+\_\+check}} (a, k)
\begin{DoxyCompactList}\small\item\em \+:Checks if a number is a Nan \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_af5b0f8124b8423342bd6fb38e7d244ec}{nan\+\_\+check\+\_\+arr}} (a, k)
\begin{DoxyCompactList}\small\item\em \+:Checks if an array is a Nan \end{DoxyCompactList}\item 
pure real function, dimension(size(uc)) \mbox{\hyperlink{namespacemulti__tools_aeab4bf302bd943e5acf2e70c93cb55cf}{nvdfunnew\+\_\+many}} (UF, UC, X\+I\+\_\+\+L\+I\+M\+IT)
\begin{DoxyCompactList}\small\item\em \+: The function computes N\+V\+D\+F\+U\+N\+N\+EW, the normalised value of the advected variable on the face of the control volume, based on the normalised value of the advected variable in the donor CV, UC, and the high-\/order estimate of the face value UF. N\+V\+D\+F\+U\+N\+N\+EW is limited so that it is in the non-\/oscillatory region of normalised variable diagram (N\+VD). \end{DoxyCompactList}\item 
real function, dimension(size(uc)) \mbox{\hyperlink{namespacemulti__tools_a524e21621ef6f56629221ac8cea5f343}{nvdfunnew\+\_\+many\+\_\+sqrt}} (UF, UC, X\+I\+\_\+\+L\+I\+M\+IT)
\begin{DoxyCompactList}\small\item\em \+: The function computes N\+V\+D\+F\+U\+N\+N\+EW, the normalised value of the advected variable on the face of the control volume, based on the normalised value of the advected variable in the donor CV, UC, and the high-\/order estimate of the face value UF. N\+V\+D\+F\+U\+N\+N\+EW is limited so that it is in the non-\/oscillatory region of normalised variable diagram (N\+VD). \end{DoxyCompactList}\item 
integer function, dimension(\+:), pointer \mbox{\hyperlink{namespacemulti__tools_a29b23492be133b01a7eb9bce13adbdfb}{get\+\_\+ndglno}} (mesh)
\item 
recursive subroutine \mbox{\hyperlink{namespacemulti__tools_a3ac19b56ac30b94f277519bc61d39d21}{quicksort}} (vec, n)
\begin{DoxyCompactList}\small\item\em \+:Sort a list in increasing order Vec is the vector to sort and n is an starting point, like 1 \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_aedaed2b29fa348112b4f347045e75ab6}{calc\+\_\+face\+\_\+ele}} (F\+A\+C\+E\+\_\+\+E\+LE, T\+O\+T\+E\+LE, S\+T\+O\+T\+EL, N\+F\+A\+CE, F\+I\+N\+E\+LE, C\+O\+L\+E\+LE, C\+V\+\_\+\+N\+L\+OC, C\+V\+\_\+\+S\+N\+L\+OC, C\+V\+\_\+\+N\+O\+N\+O\+DS, C\+V\+\_\+\+N\+D\+G\+LN, C\+V\+\_\+\+S\+N\+D\+G\+LN, C\+V\+\_\+\+S\+L\+O\+C\+L\+I\+ST, X\+\_\+\+N\+L\+OC, X\+\_\+\+N\+D\+G\+LN)
\begin{DoxyCompactList}\small\item\em \+: Calculate F\+A\+C\+E\+\_\+\+E\+LE -\/ the list of elements surrounding an element and referenced with a face -\/ve values correspond to surface elements. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ac75ade49c065a07b12ef6532bbbd7abb}{assign\+\_\+val}} (outval, inval)
\begin{DoxyCompactList}\small\item\em \+:Copies the data from inval to outval safely. If the sizes are different outval is populated using the first value of inval \end{DoxyCompactList}\item 
real function \mbox{\hyperlink{namespacemulti__tools_a5e01cea8994467049dde8f8679bf966f}{table\+\_\+interpolation}} (X\+\_\+points, Y\+\_\+points, input\+\_\+X)
\begin{DoxyCompactList}\small\item\em X\+\_\+points, Y\+\_\+points to form a linear (size == 2) or quadratic (size == 3) interpolation. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_a9cf0d43cd5f90a02f337d253ef19d47d}{read\+\_\+csv\+\_\+table}} (data\+\_\+array, path\+\_\+to\+\_\+table, extra\+\_\+data)
\begin{DoxyCompactList}\small\item\em \+:Template of csv table O\+P\+T\+I\+O\+N\+AL section (header) real1,real2,real3,..., size(extra\+\_\+data) rows,columns 2,3 Pressure,Saturation 1000,0.\+9 250,0.\+5 100,0.\+1 \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_aa621c334a67449127204c9b12f80bc99}{extract\+\_\+strings\+\_\+from\+\_\+csv\+\_\+file}} (csv\+\_\+table\+\_\+strings, path\+\_\+to\+\_\+table, Nentries)
\begin{DoxyCompactList}\small\item\em \+:This subroutine reads a csv file and returns them in an array \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ad0e757bf71fd38690cf03c4bb28ebc9c}{printmatrix}} (Matrix)
\begin{DoxyCompactList}\small\item\em \+:Subroutine to print Arrays by (columns,rows) Matrix = 2D Array \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_afb60c42191061e03c2928a7d2e023087}{rotationmatrix}} (a, R)
\begin{DoxyCompactList}\small\item\em \+: Roates a matrix A using the toration matrix R???? \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ab4b886f97602b31bf8009a4af74510d7}{read\+\_\+nastran\+\_\+file}} (filepath, node, edges)
\begin{DoxyCompactList}\small\item\em \+:This subroutine reads a nastran file that contains the information defining the 1D path of a well the input relative filepath should include the file format, for example\+: well.\+bdf \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_afe872f374438522cab79b02f6f114cd1}{least\+\_\+squares\+\_\+solver}} (A, b, rank)
\begin{DoxyCompactList}\small\item\em Subroutine that solves the least squares problem $\vert$\+Ax-\/b$\vert$2 using L\+A\+P\+A\+CK and blas Subroutine tested and compared with Matlab (not recommended changing it since it is a pain!) Only for serial\+: The best option is to solve in each processor the optimisation system by performing A\textquotesingle{} $\ast$ A = A\textquotesingle{} $\ast$b; so the system becomes very small as C\+O\+L\+U\+MS $<$$<$$<$ R\+O\+WS. \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_ab412a6b9d80984d5739ef227590a9e8d}{multi\+\_\+compute\+\_\+python\+\_\+field}} (states, iphase, option\+\_\+path\+\_\+python, scalar\+\_\+result, sfield, vfield, tfield)
\begin{DoxyCompactList}\small\item\em \+: This subroutine uses python run string to run the python\+\_\+scalar\+\_\+diagnostic to read a field the only difference with the normal approach is that here the Dummy field is used and the returned field is an array. I\+M\+P\+O\+R\+T\+A\+NT\+: state is used here, N\+OT packed\+\_\+state It can be used for a given array, scalar\+\_\+result, scalar fields, vector fields or tensor fields, but only one at a time \end{DoxyCompactList}\item 
subroutine \mbox{\hyperlink{namespacemulti__tools_a644ea690bc5f7b40185a6fee8e28d711}{petsc\+\_\+logging}} (func, stage, ierr, default, push\+\_\+no, stage\+\_\+name)
\begin{DoxyCompactList}\small\item\em Subroutines that can initialise, register and start/end a petsc performance profiling routin. The defauly behaviour is initiliased for time-\/loop profiling. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacemulti__tools_a88fe8456a6aab41a0c9aeff3b0a4f2ec}{is\+\_\+tracer\+\_\+field}} (input\+\_\+name)
\begin{DoxyCompactList}\small\item\em \+: Returns true if the input name is a Tracer type\+:Passive\+Tracer, Tracer, Species, Concentration or any other reserved word This function is used to easily identify Tracers that may have diffusion, sources/sinks, dispersion, etc. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacemulti__tools_a1ab322da5f344e1d042fb429ebce3637}{is\+\_\+active\+\_\+tracer\+\_\+field}} (input\+\_\+name, ignore\+\_\+concentration)
\begin{DoxyCompactList}\small\item\em \+: Returns true if the input name is an Active Tracer type, Tracer, Species, Concentration or any other reserved word This function is used to easily identify Tracers that may have diffusion, sources/sinks, dispersion, etc. \end{DoxyCompactList}\item 
logical function \mbox{\hyperlink{namespacemulti__tools_a81569e130900c1b6a18ff46132f94d12}{is\+\_\+passivetracer\+\_\+field}} (input\+\_\+name)
\begin{DoxyCompactList}\small\item\em \+: Returns true if the input name is a Passiev\+Tracer type. \end{DoxyCompactList}\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
This module contains the generic subroutines required by I\+C\+F\+E\+R\+ST, for example quicksort. 

\doxysubsection{Function/\+Subroutine Documentation}
\mbox{\Hypertarget{namespacemulti__tools_ac75ade49c065a07b12ef6532bbbd7abb}\label{namespacemulti__tools_ac75ade49c065a07b12ef6532bbbd7abb}} 
\index{multi\_tools@{multi\_tools}!assign\_val@{assign\_val}}
\index{assign\_val@{assign\_val}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{assign\_val()}{assign\_val()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::assign\+\_\+val (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(inout)}]{outval,  }\item[{real, dimension(\+:), intent(in)}]{inval }\end{DoxyParamCaption})}



\+:Copies the data from inval to outval safely. If the sizes are different outval is populated using the first value of inval 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_ac75ade49c065a07b12ef6532bbbd7abb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_aedaed2b29fa348112b4f347045e75ab6}\label{namespacemulti__tools_aedaed2b29fa348112b4f347045e75ab6}} 
\index{multi\_tools@{multi\_tools}!calc\_face\_ele@{calc\_face\_ele}}
\index{calc\_face\_ele@{calc\_face\_ele}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{calc\_face\_ele()}{calc\_face\_ele()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::calc\+\_\+face\+\_\+ele (\begin{DoxyParamCaption}\item[{integer, dimension( \+:, \+: ), intent(inout)}]{F\+A\+C\+E\+\_\+\+E\+LE,  }\item[{integer, intent(in)}]{T\+O\+T\+E\+LE,  }\item[{integer, intent(in)}]{S\+T\+O\+T\+EL,  }\item[{integer, intent(in)}]{N\+F\+A\+CE,  }\item[{integer, dimension( \+: ), intent(in)}]{F\+I\+N\+E\+LE,  }\item[{integer, dimension( \+: ), intent(in)}]{C\+O\+L\+E\+LE,  }\item[{integer, intent(in)}]{C\+V\+\_\+\+N\+L\+OC,  }\item[{integer, intent(in)}]{C\+V\+\_\+\+S\+N\+L\+OC,  }\item[{integer, intent(in)}]{C\+V\+\_\+\+N\+O\+N\+O\+DS,  }\item[{integer, dimension( \+: ), intent(in)}]{C\+V\+\_\+\+N\+D\+G\+LN,  }\item[{integer, dimension( \+: ), intent(in)}]{C\+V\+\_\+\+S\+N\+D\+G\+LN,  }\item[{integer, dimension( \+:, \+: ), intent(in)}]{C\+V\+\_\+\+S\+L\+O\+C\+L\+I\+ST,  }\item[{integer, intent(in)}]{X\+\_\+\+N\+L\+OC,  }\item[{integer, dimension( \+: ), intent(in)}]{X\+\_\+\+N\+D\+G\+LN }\end{DoxyParamCaption})}



\+: Calculate F\+A\+C\+E\+\_\+\+E\+LE -\/ the list of elements surrounding an element and referenced with a face -\/ve values correspond to surface elements. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_aedaed2b29fa348112b4f347045e75ab6_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_aa621c334a67449127204c9b12f80bc99}\label{namespacemulti__tools_aa621c334a67449127204c9b12f80bc99}} 
\index{multi\_tools@{multi\_tools}!extract\_strings\_from\_csv\_file@{extract\_strings\_from\_csv\_file}}
\index{extract\_strings\_from\_csv\_file@{extract\_strings\_from\_csv\_file}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{extract\_strings\_from\_csv\_file()}{extract\_strings\_from\_csv\_file()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::extract\+\_\+strings\+\_\+from\+\_\+csv\+\_\+file (\begin{DoxyParamCaption}\item[{character(len=option\+\_\+path\+\_\+len), dimension(\+:,\+:), intent(out), allocatable}]{csv\+\_\+table\+\_\+strings,  }\item[{character( len = option\+\_\+path\+\_\+len ), intent(in)}]{path\+\_\+to\+\_\+table,  }\item[{integer, intent(out)}]{Nentries }\end{DoxyParamCaption})}



\+:This subroutine reads a csv file and returns them in an array 


\begin{DoxyParams}{Parameters}
{\em csv\+\_\+table\+\_\+strings} & I\+N\+O\+UT Allocated array of characters to be used to read the C\+VS file \\
\hline
{\em path\+\_\+to\+\_\+table} & absolute/relative path to the .csv file \\
\hline
{\em Nentries} & O\+UT Number of entries in the table \\
\hline
\end{DoxyParams}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_aa621c334a67449127204c9b12f80bc99_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a29b23492be133b01a7eb9bce13adbdfb}\label{namespacemulti__tools_a29b23492be133b01a7eb9bce13adbdfb}} 
\index{multi\_tools@{multi\_tools}!get\_ndglno@{get\_ndglno}}
\index{get\_ndglno@{get\_ndglno}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{get\_ndglno()}{get\_ndglno()}}
{\footnotesize\ttfamily integer function, dimension(\+:), pointer multi\+\_\+tools\+::get\+\_\+ndglno (\begin{DoxyParamCaption}\item[{type(mesh\+\_\+type)}]{mesh }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a29b23492be133b01a7eb9bce13adbdfb_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a1ab322da5f344e1d042fb429ebce3637}\label{namespacemulti__tools_a1ab322da5f344e1d042fb429ebce3637}} 
\index{multi\_tools@{multi\_tools}!is\_active\_tracer\_field@{is\_active\_tracer\_field}}
\index{is\_active\_tracer\_field@{is\_active\_tracer\_field}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{is\_active\_tracer\_field()}{is\_active\_tracer\_field()}}
{\footnotesize\ttfamily logical function multi\+\_\+tools\+::is\+\_\+active\+\_\+tracer\+\_\+field (\begin{DoxyParamCaption}\item[{character( len = $\ast$ ), intent(in)}]{input\+\_\+name,  }\item[{logical, intent(in), optional}]{ignore\+\_\+concentration }\end{DoxyParamCaption})}



\+: Returns true if the input name is an Active Tracer type, Tracer, Species, Concentration or any other reserved word This function is used to easily identify Tracers that may have diffusion, sources/sinks, dispersion, etc. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a1ab322da5f344e1d042fb429ebce3637_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a81569e130900c1b6a18ff46132f94d12}\label{namespacemulti__tools_a81569e130900c1b6a18ff46132f94d12}} 
\index{multi\_tools@{multi\_tools}!is\_passivetracer\_field@{is\_passivetracer\_field}}
\index{is\_passivetracer\_field@{is\_passivetracer\_field}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{is\_passivetracer\_field()}{is\_passivetracer\_field()}}
{\footnotesize\ttfamily logical function multi\+\_\+tools\+::is\+\_\+passivetracer\+\_\+field (\begin{DoxyParamCaption}\item[{character( len = $\ast$ ), intent(in)}]{input\+\_\+name }\end{DoxyParamCaption})}



\+: Returns true if the input name is a Passiev\+Tracer type. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a81569e130900c1b6a18ff46132f94d12_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a88fe8456a6aab41a0c9aeff3b0a4f2ec}\label{namespacemulti__tools_a88fe8456a6aab41a0c9aeff3b0a4f2ec}} 
\index{multi\_tools@{multi\_tools}!is\_tracer\_field@{is\_tracer\_field}}
\index{is\_tracer\_field@{is\_tracer\_field}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{is\_tracer\_field()}{is\_tracer\_field()}}
{\footnotesize\ttfamily logical function multi\+\_\+tools\+::is\+\_\+tracer\+\_\+field (\begin{DoxyParamCaption}\item[{character( len = $\ast$ ), intent(in)}]{input\+\_\+name }\end{DoxyParamCaption})}



\+: Returns true if the input name is a Tracer type\+:Passive\+Tracer, Tracer, Species, Concentration or any other reserved word This function is used to easily identify Tracers that may have diffusion, sources/sinks, dispersion, etc. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a88fe8456a6aab41a0c9aeff3b0a4f2ec_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_afe872f374438522cab79b02f6f114cd1}\label{namespacemulti__tools_afe872f374438522cab79b02f6f114cd1}} 
\index{multi\_tools@{multi\_tools}!least\_squares\_solver@{least\_squares\_solver}}
\index{least\_squares\_solver@{least\_squares\_solver}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{least\_squares\_solver()}{least\_squares\_solver()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::least\+\_\+squares\+\_\+solver (\begin{DoxyParamCaption}\item[{real, dimension(\+:,\+:), intent(inout)}]{A,  }\item[{real, dimension(\+:,\+:), intent(inout)}]{b,  }\item[{integer, intent(inout)}]{rank }\end{DoxyParamCaption})}



Subroutine that solves the least squares problem $\vert$\+Ax-\/b$\vert$2 using L\+A\+P\+A\+CK and blas Subroutine tested and compared with Matlab (not recommended changing it since it is a pain!) Only for serial\+: The best option is to solve in each processor the optimisation system by performing A\textquotesingle{} $\ast$ A = A\textquotesingle{} $\ast$b; so the system becomes very small as C\+O\+L\+U\+MS $<$$<$$<$ R\+O\+WS. 

\begin{DoxyAuthor}{Author}
Pablo Salinas 
\end{DoxyAuthor}

\begin{DoxyParams}{Parameters}
{\em A} & Input matrix to decompose, returns the Q and R combined \\
\hline
{\em b} & Input R\+HS term, returns the X that minimise the system \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemulti__tools_ab412a6b9d80984d5739ef227590a9e8d}\label{namespacemulti__tools_ab412a6b9d80984d5739ef227590a9e8d}} 
\index{multi\_tools@{multi\_tools}!multi\_compute\_python\_field@{multi\_compute\_python\_field}}
\index{multi\_compute\_python\_field@{multi\_compute\_python\_field}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{multi\_compute\_python\_field()}{multi\_compute\_python\_field()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::multi\+\_\+compute\+\_\+python\+\_\+field (\begin{DoxyParamCaption}\item[{type( state\+\_\+type ), dimension(\+:), intent(inout)}]{states,  }\item[{integer, intent(in)}]{iphase,  }\item[{character( len = $\ast$ ), intent(in)}]{option\+\_\+path\+\_\+python,  }\item[{real, dimension(\+:), intent(inout), optional}]{scalar\+\_\+result,  }\item[{type (scalar\+\_\+field), intent(inout), optional}]{sfield,  }\item[{type (vector\+\_\+field), intent(inout), optional}]{vfield,  }\item[{type (tensor\+\_\+field), intent(inout), optional}]{tfield }\end{DoxyParamCaption})}



\+: This subroutine uses python run string to run the python\+\_\+scalar\+\_\+diagnostic to read a field the only difference with the normal approach is that here the Dummy field is used and the returned field is an array. I\+M\+P\+O\+R\+T\+A\+NT\+: state is used here, N\+OT packed\+\_\+state It can be used for a given array, scalar\+\_\+result, scalar fields, vector fields or tensor fields, but only one at a time 


\begin{DoxyParams}{Parameters}
{\em states} & Array of Linked list containing all the fields \\
\hline
{\em iphase} & Current phase \\
\hline
{\em option\+\_\+path\+\_\+python} & Path in the input file to the python code \\
\hline
{\em scalar\+\_\+result} & Field to be provided to the python code as initial value \\
\hline
{\em sfield} & Optional Only one can be picked, depending on the type of field to be used! \\
\hline
{\em vfield} & Optional Only one can be picked, depending on the type of field to be used! \\
\hline
{\em tfield} & Optional Only one can be picked, depending on the type of field to be used! \\
\hline
\end{DoxyParams}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_ab412a6b9d80984d5739ef227590a9e8d_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a0670e50b3781879bb4eefa80cd56911f}\label{namespacemulti__tools_a0670e50b3781879bb4eefa80cd56911f}} 
\index{multi\_tools@{multi\_tools}!nan\_check@{nan\_check}}
\index{nan\_check@{nan\_check}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{nan\_check()}{nan\_check()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::nan\+\_\+check (\begin{DoxyParamCaption}\item[{real}]{a,  }\item[{integer}]{k }\end{DoxyParamCaption})}



\+:Checks if a number is a Nan 

\mbox{\Hypertarget{namespacemulti__tools_af5b0f8124b8423342bd6fb38e7d244ec}\label{namespacemulti__tools_af5b0f8124b8423342bd6fb38e7d244ec}} 
\index{multi\_tools@{multi\_tools}!nan\_check\_arr@{nan\_check\_arr}}
\index{nan\_check\_arr@{nan\_check\_arr}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{nan\_check\_arr()}{nan\_check\_arr()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::nan\+\_\+check\+\_\+arr (\begin{DoxyParamCaption}\item[{real, dimension(\+:,\+:)}]{a,  }\item[{integer}]{k }\end{DoxyParamCaption})}



\+:Checks if an array is a Nan 

\mbox{\Hypertarget{namespacemulti__tools_aeab4bf302bd943e5acf2e70c93cb55cf}\label{namespacemulti__tools_aeab4bf302bd943e5acf2e70c93cb55cf}} 
\index{multi\_tools@{multi\_tools}!nvdfunnew\_many@{nvdfunnew\_many}}
\index{nvdfunnew\_many@{nvdfunnew\_many}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{nvdfunnew\_many()}{nvdfunnew\_many()}}
{\footnotesize\ttfamily pure real function, dimension(size(uc)) multi\+\_\+tools\+::nvdfunnew\+\_\+many (\begin{DoxyParamCaption}\item[{real, dimension( \+: ), intent(in)}]{UF,  }\item[{real, dimension( \+: ), intent(in)}]{UC,  }\item[{real, dimension( \+: ), intent(in)}]{X\+I\+\_\+\+L\+I\+M\+IT }\end{DoxyParamCaption})}



\+: The function computes N\+V\+D\+F\+U\+N\+N\+EW, the normalised value of the advected variable on the face of the control volume, based on the normalised value of the advected variable in the donor CV, UC, and the high-\/order estimate of the face value UF. N\+V\+D\+F\+U\+N\+N\+EW is limited so that it is in the non-\/oscillatory region of normalised variable diagram (N\+VD). 

XI is the parameter in equation 38 of the Riemann paper. If XI is equal to 2 then this corresponds to a T\+VD condition in 1-\/D, a value of XI equal to 3 has been recommended elsewhere Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_aeab4bf302bd943e5acf2e70c93cb55cf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a524e21621ef6f56629221ac8cea5f343}\label{namespacemulti__tools_a524e21621ef6f56629221ac8cea5f343}} 
\index{multi\_tools@{multi\_tools}!nvdfunnew\_many\_sqrt@{nvdfunnew\_many\_sqrt}}
\index{nvdfunnew\_many\_sqrt@{nvdfunnew\_many\_sqrt}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{nvdfunnew\_many\_sqrt()}{nvdfunnew\_many\_sqrt()}}
{\footnotesize\ttfamily real function, dimension(size(uc)) multi\+\_\+tools\+::nvdfunnew\+\_\+many\+\_\+sqrt (\begin{DoxyParamCaption}\item[{real, dimension( \+: ), intent(in)}]{UF,  }\item[{real, dimension( \+: ), intent(in)}]{UC,  }\item[{real, dimension( \+: ), intent(in)}]{X\+I\+\_\+\+L\+I\+M\+IT }\end{DoxyParamCaption})}



\+: The function computes N\+V\+D\+F\+U\+N\+N\+EW, the normalised value of the advected variable on the face of the control volume, based on the normalised value of the advected variable in the donor CV, UC, and the high-\/order estimate of the face value UF. N\+V\+D\+F\+U\+N\+N\+EW is limited so that it is in the non-\/oscillatory region of normalised variable diagram (N\+VD). 

XI is the parameter in equation 38 of the Riemann paper. If XI is equal to 2 then this corresponds to a T\+VD condition in 1-\/D, a value of XI equal to 3 has been recommended elsewhere \mbox{\Hypertarget{namespacemulti__tools_a644ea690bc5f7b40185a6fee8e28d711}\label{namespacemulti__tools_a644ea690bc5f7b40185a6fee8e28d711}} 
\index{multi\_tools@{multi\_tools}!petsc\_logging@{petsc\_logging}}
\index{petsc\_logging@{petsc\_logging}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{petsc\_logging()}{petsc\_logging()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::petsc\+\_\+logging (\begin{DoxyParamCaption}\item[{integer, intent(in)}]{func,  }\item[{dimension(0\+:9)}]{stage,  }\item[{intent(inout)}]{ierr,  }\item[{logical, intent(in), optional}]{default,  }\item[{integer, intent(in), optional}]{push\+\_\+no,  }\item[{character(len=$\ast$), dimension(1), optional}]{stage\+\_\+name }\end{DoxyParamCaption})}



Subroutines that can initialise, register and start/end a petsc performance profiling routin. The defauly behaviour is initiliased for time-\/loop profiling. 

\begin{DoxyAuthor}{Author}
Asiri Obeysekara 
\end{DoxyAuthor}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=312pt]{namespacemulti__tools_a644ea690bc5f7b40185a6fee8e28d711_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a644ea690bc5f7b40185a6fee8e28d711_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_ad0e757bf71fd38690cf03c4bb28ebc9c}\label{namespacemulti__tools_ad0e757bf71fd38690cf03c4bb28ebc9c}} 
\index{multi\_tools@{multi\_tools}!printmatrix@{printmatrix}}
\index{printmatrix@{printmatrix}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{printmatrix()}{printmatrix()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::printmatrix (\begin{DoxyParamCaption}\item[{real, dimension(\+:,\+:), intent(in)}]{Matrix }\end{DoxyParamCaption})}



\+:Subroutine to print Arrays by (columns,rows) Matrix = 2D Array 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_ad0e757bf71fd38690cf03c4bb28ebc9c_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a00bc5585e5ce49ad92386eb4acca54ff}\label{namespacemulti__tools_a00bc5585e5ce49ad92386eb4acca54ff}} 
\index{multi\_tools@{multi\_tools}!ptolfun@{ptolfun}}
\index{ptolfun@{ptolfun}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{ptolfun()}{ptolfun()}}
{\footnotesize\ttfamily real function multi\+\_\+tools\+::ptolfun (\begin{DoxyParamCaption}\item[{real, intent(in)}]{value }\end{DoxyParamCaption})}



\+:This function is a tolerance function for strictly positive values used as a denominator. If the value of V\+A\+L\+UE less than 1E-\/10, then it returns T\+O\+L\+E\+R\+A\+N\+CE otherwise V\+A\+L\+UE. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a00bc5585e5ce49ad92386eb4acca54ff_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a3ac19b56ac30b94f277519bc61d39d21}\label{namespacemulti__tools_a3ac19b56ac30b94f277519bc61d39d21}} 
\index{multi\_tools@{multi\_tools}!quicksort@{quicksort}}
\index{quicksort@{quicksort}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{quicksort()}{quicksort()}}
{\footnotesize\ttfamily recursive  subroutine multi\+\_\+tools\+::quicksort (\begin{DoxyParamCaption}\item[{integer, dimension(n), intent(inout)}]{vec,  }\item[{integer, intent(in)}]{n }\end{DoxyParamCaption})}



\+:Sort a list in increasing order Vec is the vector to sort and n is an starting point, like 1 

Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=321pt]{namespacemulti__tools_a3ac19b56ac30b94f277519bc61d39d21_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a3ac19b56ac30b94f277519bc61d39d21_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a225d95bb84187e3f0fcee8a3bd08b221}\label{namespacemulti__tools_a225d95bb84187e3f0fcee8a3bd08b221}} 
\index{multi\_tools@{multi\_tools}!r2norm@{r2norm}}
\index{r2norm@{r2norm}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{r2norm()}{r2norm()}}
{\footnotesize\ttfamily real function multi\+\_\+tools\+::r2norm (\begin{DoxyParamCaption}\item[{real, dimension( nvec )}]{V\+EC,  }\item[{integer}]{N\+V\+EC }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a225d95bb84187e3f0fcee8a3bd08b221_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a9cf0d43cd5f90a02f337d253ef19d47d}\label{namespacemulti__tools_a9cf0d43cd5f90a02f337d253ef19d47d}} 
\index{multi\_tools@{multi\_tools}!read\_csv\_table@{read\_csv\_table}}
\index{read\_csv\_table@{read\_csv\_table}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{read\_csv\_table()}{read\_csv\_table()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::read\+\_\+csv\+\_\+table (\begin{DoxyParamCaption}\item[{real, dimension(\+:,\+:), intent(inout), allocatable}]{data\+\_\+array,  }\item[{character( len = option\+\_\+path\+\_\+len ), intent(in)}]{path\+\_\+to\+\_\+table,  }\item[{real, dimension(\+:), intent(inout), optional}]{extra\+\_\+data }\end{DoxyParamCaption})}



\+:Template of csv table O\+P\+T\+I\+O\+N\+AL section (header) real1,real2,real3,..., size(extra\+\_\+data) rows,columns 2,3 Pressure,Saturation 1000,0.\+9 250,0.\+5 100,0.\+1 


\begin{DoxyParams}{Parameters}
{\em data\+\_\+array} & I\+N\+O\+UT the data in memory \\
\hline
{\em path\+\_\+to\+\_\+table} & absolute/relative path to the .csv file \\
\hline
{\em extra\+\_\+data} & The extra data is composed of one line of headers that we ignore plus one extra line with the data \\
\hline
\end{DoxyParams}
\mbox{\Hypertarget{namespacemulti__tools_ab4b886f97602b31bf8009a4af74510d7}\label{namespacemulti__tools_ab4b886f97602b31bf8009a4af74510d7}} 
\index{multi\_tools@{multi\_tools}!read\_nastran\_file@{read\_nastran\_file}}
\index{read\_nastran\_file@{read\_nastran\_file}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{read\_nastran\_file()}{read\_nastran\_file()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::read\+\_\+nastran\+\_\+file (\begin{DoxyParamCaption}\item[{character( len = $\ast$ ), intent(in)}]{filepath,  }\item[{real, dimension(\+:,\+:), intent(inout), allocatable}]{node,  }\item[{integer, dimension(\+:,\+:), intent(inout), allocatable}]{edges }\end{DoxyParamCaption})}



\+:This subroutine reads a nastran file that contains the information defining the 1D path of a well the input relative filepath should include the file format, for example\+: well.\+bdf 


\begin{DoxyParams}{Parameters}
{\em filepath} & Relative path to the .bdf file \\
\hline
{\em node} & I\+N\+O\+UT. Nodes stored \\
\hline
{\em edges} & Edges connecting nodes \\
\hline
\end{DoxyParams}
Here is the call graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_ab4b886f97602b31bf8009a4af74510d7_cgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_afb60c42191061e03c2928a7d2e023087}\label{namespacemulti__tools_afb60c42191061e03c2928a7d2e023087}} 
\index{multi\_tools@{multi\_tools}!rotationmatrix@{rotationmatrix}}
\index{rotationmatrix@{rotationmatrix}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{rotationmatrix()}{rotationmatrix()}}
{\footnotesize\ttfamily subroutine multi\+\_\+tools\+::rotationmatrix (\begin{DoxyParamCaption}\item[{real, dimension(3), intent(in)}]{a,  }\item[{real, dimension(3,3), intent(out)}]{R }\end{DoxyParamCaption})}



\+: Roates a matrix A using the toration matrix R???? 

\mbox{\Hypertarget{namespacemulti__tools_a5e01cea8994467049dde8f8679bf966f}\label{namespacemulti__tools_a5e01cea8994467049dde8f8679bf966f}} 
\index{multi\_tools@{multi\_tools}!table\_interpolation@{table\_interpolation}}
\index{table\_interpolation@{table\_interpolation}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{table\_interpolation()}{table\_interpolation()}}
{\footnotesize\ttfamily real function multi\+\_\+tools\+::table\+\_\+interpolation (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{X\+\_\+points,  }\item[{real, dimension(\+:), intent(in)}]{Y\+\_\+points,  }\item[{real, intent(in)}]{input\+\_\+X }\end{DoxyParamCaption})}



X\+\_\+points, Y\+\_\+points to form a linear (size == 2) or quadratic (size == 3) interpolation. 

\mbox{\Hypertarget{namespacemulti__tools_a9455b92cfb559c3b76e4b77580886c47}\label{namespacemulti__tools_a9455b92cfb559c3b76e4b77580886c47}} 
\index{multi\_tools@{multi\_tools}!tetvolume@{tetvolume}}
\index{tetvolume@{tetvolume}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{tetvolume()}{tetvolume()}}
{\footnotesize\ttfamily real function multi\+\_\+tools\+::tetvolume (\begin{DoxyParamCaption}\item[{real, intent(in)}]{x0,  }\item[{real, intent(in)}]{y0,  }\item[{real, intent(in)}]{z0,  }\item[{real, intent(in)}]{x1,  }\item[{real, intent(in)}]{y1,  }\item[{real, intent(in)}]{z1,  }\item[{real, intent(in)}]{x2,  }\item[{real, intent(in)}]{y2,  }\item[{real, intent(in)}]{z2,  }\item[{real, intent(in)}]{x3,  }\item[{real, intent(in)}]{y3,  }\item[{real, intent(in)}]{z3 }\end{DoxyParamCaption})}

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a9455b92cfb559c3b76e4b77580886c47_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a9bc979224e98f447e412133da3464728}\label{namespacemulti__tools_a9bc979224e98f447e412133da3464728}} 
\index{multi\_tools@{multi\_tools}!tolfun@{tolfun}}
\index{tolfun@{tolfun}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{tolfun()}{tolfun()}}
{\footnotesize\ttfamily pure real function multi\+\_\+tools\+::tolfun (\begin{DoxyParamCaption}\item[{real, intent(in)}]{value }\end{DoxyParamCaption})}



\+:This function is a tolerance function for a value which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a9bc979224e98f447e412133da3464728_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_a4f90f9b3033bd34d8d52d140a8b6d8cf}\label{namespacemulti__tools_a4f90f9b3033bd34d8d52d140a8b6d8cf}} 
\index{multi\_tools@{multi\_tools}!tolfun\_many@{tolfun\_many}}
\index{tolfun\_many@{tolfun\_many}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{tolfun\_many()}{tolfun\_many()}}
{\footnotesize\ttfamily pure real function, dimension(size(val)) multi\+\_\+tools\+::tolfun\+\_\+many (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{val }\end{DoxyParamCaption})}



\+:This function is a tolerance function for a scalar which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_a4f90f9b3033bd34d8d52d140a8b6d8cf_icgraph}
\end{center}
\end{figure}
\mbox{\Hypertarget{namespacemulti__tools_ad2dc4462bad46ef99ca0057cb3c91262}\label{namespacemulti__tools_ad2dc4462bad46ef99ca0057cb3c91262}} 
\index{multi\_tools@{multi\_tools}!vtolfun@{vtolfun}}
\index{vtolfun@{vtolfun}!multi\_tools@{multi\_tools}}
\doxysubsubsection{\texorpdfstring{vtolfun()}{vtolfun()}}
{\footnotesize\ttfamily pure real function, dimension(size(val)) multi\+\_\+tools\+::vtolfun (\begin{DoxyParamCaption}\item[{real, dimension(\+:), intent(in)}]{val }\end{DoxyParamCaption})}



\+:This function is a tolerance function for a vector which is used as a denominator. If the absolute value of V\+A\+L\+UE less than 1E-\/10, then it returns S\+I\+G\+N(\+A,\+B) i.\+e. the absolute value of A times the sign of B where A is T\+O\+L\+E\+R\+A\+N\+CE and B is V\+A\+L\+UE. 

Here is the caller graph for this function\+:\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{namespacemulti__tools_ad2dc4462bad46ef99ca0057cb3c91262_icgraph}
\end{center}
\end{figure}
