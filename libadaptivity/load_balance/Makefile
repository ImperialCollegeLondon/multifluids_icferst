# Copyright (C) 2006 Imperial College London and others.
#
# Please see the AUTHORS file in the main source directory for a full list
# of copyright holders.
#
# Dr Gerard J Gorman
# Applied Modelling and Computation Group
# Department of Earth Science and Engineering
# Imperial College London
#
# g.gorman@imperial.ac.uk
#
# This library is free software; you can redistribute it and/or
# modify it under the terms of the GNU Lesser General Public
# License as published by the Free Software Foundation; either
# version 2.1 of the License.
#
# This library is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
# Lesser General Public License for more details.
#
# You should have received a copy of the GNU Lesser General Public
# License along with this library; if not, write to the Free Software
# Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA  02111-1307
# USA

# Generated automatically from g
SHELL = /bin/bash

LIB	= ../lib/libadaptivity.a

srcdir 	= .
VPATH 	= .:./src

FC      = mpif90
CC      = mpicc
CXX     = mpicxx

LINKER 	= mpicxx

MAKE   	= make
RANLIB	= ranlib
AR	= ar
ARFLAGS = cr

INSTALL = /usr/bin/install -c

CPPFLAGS= -I./include -I../include -I/usr/include/vtk-5.8  -I/usr/include/vtk-5.8 -DHAVE_VTK=1 -DHAVE_VTK=1 

CFLAGS	= $(CPPFLAGS)   -O3
CXXFLAGS= $(CPPFLAGS)   -O3
FCFLAGS = $(CPPFLAGS) -ffast-math -frecord-marker=4    -ffree-line-length-none -ffixed-line-length-none  -O3 -fdefault-real-8

LFLAGS	= -L./lib -lparmetis -lmetis  -llapack -lblas -lvtkIO -lvtkGraphics -lvtkFiltering -lvtkCommon -ldl -lpthread -lm -lstdc++   -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../lib -L/lib/x86_64-linux-gnu -L/lib/../lib -L/usr/lib/x86_64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../.. -lgfortran -lm -lquadmath -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../lib -L/lib/x86_64-linux-gnu -L/lib/../lib -L/usr/lib/x86_64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../.. -lgfortran -lm -lquadmath -L./lib -L/usr/lib/gcc/x86_64-linux-gnu/4.8 -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../x86_64-linux-gnu -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../../../lib -L/lib/x86_64-linux-gnu -L/lib/../lib -L/usr/lib/x86_64-linux-gnu -L/usr/lib/../lib -L/usr/lib/gcc/x86_64-linux-gnu/4.8/../../.. -lgfortran -lm -lquadmath   

# List library objects.
ifeq (yes,yes)
OBJS = 	main.o      Node.o      Element.o Mesh.o    imports.o      \
	exports.o   MI5.o       migrate.o packing.o Graph.o          \
	formHalo2.o ParMetis.o  mtetin.o  mtetin.o  PressureNode.o \
	fixate.o    flstripH2.o fluidity_sam.o  		                     \
	c++debuglog.o invent_pressure_mesh.o errorHandling.o graph_partitioning.o \
  functional_2d.o 
else
OBJS = fluidity_sam.o
endif

# Set up appropriate suffix list & define double suffix rules:
.SUFFIXES: .o .cpp .f .F .f90 .a

.F.o:
	$(FC) $(FCFLAGS) -c $<

.f.o:
	$(FC) $(FCFLAGS) -c $<

.f90.o:
	$(FC) $(FCFLAGS) -cpp -c $<

.cpp.o:
	$(CXX) $(CXXFLAGS) -c $<

.c.o:
	$(CC) $(CFLAGS) -c $<


#+
# Build specific programs...
#-
default: $(OBJS)
	@$(AR) $(ARFLAGS) $(LIB) $(OBJS)

install:
	$(INSTALL) $(LIB) /usr/local/lib/

clean:
	rm -f *.o $(LIB) core so_locations config.status config.log 
	rm -rf *.cache lib/lib*

formHalo2.o: formHalo2.cpp include/comTools.h
fixate.o:    fixate.cpp include/comTools.h
packing.o:   packing.cpp include/comTools.h

