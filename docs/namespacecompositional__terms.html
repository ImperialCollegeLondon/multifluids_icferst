<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: compositional_terms Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ICFERST<span id="projectnumber">&#160;25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacecompositional__terms.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">compositional_terms Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This module contains all that is required to perform compositional modelling. NOTE THAT THIS FUNCTIONALITY HAS NEVER BEEN FULLY IMPLEMENTED ONLY INERT COMPOSITIONAL WORKS CURRENTLY.  
<a href="namespacecompositional__terms.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a66bd32a7cfb204a4ceafac3c09cb188b" id="r_a66bd32a7cfb204a4ceafac3c09cb188b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b">calculate_componentabsorptionterm</a> (packed_state, icomp, cv_ndgln, mdims, denold, volfra_pore, mass_ele, comp_absorb)</td></tr>
<tr class="memdesc:a66bd32a7cfb204a4ceafac3c09cb188b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the previous time step so its easier to converge. alpha_beta is the scaling coeff. of the compositional model e.g. =1.0.  <br /></td></tr>
<tr class="separator:a66bd32a7cfb204a4ceafac3c09cb188b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9091a40e5dcfbb5b4ebbce9242c7d0c4" id="r_a9091a40e5dcfbb5b4ebbce9242c7d0c4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#a9091a40e5dcfbb5b4ebbce9242c7d0c4">calculate_componentdiffusionterm</a> (packed_state, mdims, cv_gidims, cv_funs, mat_ndgln, u_ndgln, x_ndgln, ncomp_diff_coef, comp_diffusion_opt, comp_diff_coef, comp_diffusion)</td></tr>
<tr class="memdesc:a9091a40e5dcfbb5b4ebbce9242c7d0c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Reservoir-Simulation-Mathematical-Techniques-In-Oil-Recovery-(2007).pdf COMP_DIFFUSION_OPT, integer option defining diffusion coeff NCOMP_DIFF_COEF, integer defining how many coeff's are needed to define the diffusion COMP_DIFF_COEF( Mdimsncomp, NCOMP_DIFF_COEF, Mdimsnphase )  <br /></td></tr>
<tr class="separator:a9091a40e5dcfbb5b4ebbce9242c7d0c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ade3a2016f1b239160f844f3db8622b63" id="r_ade3a2016f1b239160f844f3db8622b63"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#ade3a2016f1b239160f844f3db8622b63">proj_u2mat</a> (comp_diffusion_opt, mdims, cv_gidims, cv_funs, comp_diffusion, ncomp_diff_coef, comp_diff_coef, x_all, nu, nv, nw, mat_ndgln, u_ndgln, x_ndgln, mat_u)</td></tr>
<tr class="memdesc:ade3a2016f1b239160f844f3db8622b63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Determine MAT_U from NU,NV,NW which are variables mapped to material mesh.  <br /></td></tr>
<tr class="separator:ade3a2016f1b239160f844f3db8622b63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a355b7b6ba8282f659fa0ecd18973e031" id="r_a355b7b6ba8282f659fa0ecd18973e031"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#a355b7b6ba8282f659fa0ecd18973e031">calc_comp_dif_ten</a> (ndim, ud, diff_molecular, diff_longitudinal, diff_transverse, diff_ten)</td></tr>
<tr class="memdesc:a355b7b6ba8282f659fa0ecd18973e031"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Reservoir-Simulation-Mathematical-Techniques-In-Oil-Recovery-(2007).pdf.  <br /></td></tr>
<tr class="separator:a355b7b6ba8282f659fa0ecd18973e031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23481f5d5ce42c14c00cbc93e4a7bfa2" id="r_a23481f5d5ce42c14c00cbc93e4a7bfa2"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#a23481f5d5ce42c14c00cbc93e4a7bfa2">calc_kcomp2</a> (cv_nonods, nphase, icomp, kcomp_sigmoid, satura, k_comp, max_k, min_k, k_comp2)</td></tr>
<tr class="memdesc:a23481f5d5ce42c14c00cbc93e4a7bfa2"><td class="mdescLeft">&#160;</td><td class="mdescRight">Method to flash components.  <br /></td></tr>
<tr class="separator:a23481f5d5ce42c14c00cbc93e4a7bfa2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1d9985f8ba66b85d7ac0905db70ec6a" id="r_ac1d9985f8ba66b85d7ac0905db70ec6a"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#ac1d9985f8ba66b85d7ac0905db70ec6a">sigmoid_function</a> (y, y0, width, lowmag, upmag)</td></tr>
<tr class="memdesc:ac1d9985f8ba66b85d7ac0905db70ec6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag, UpMag ). Y is the variable of the function and Y0 is the centre of the function.  <br /></td></tr>
<tr class="separator:ac1d9985f8ba66b85d7ac0905db70ec6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a221de77cdfcebf8981dbb91811e30c38" id="r_a221de77cdfcebf8981dbb91811e30c38"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#a221de77cdfcebf8981dbb91811e30c38">exprep</a> (m)</td></tr>
<tr class="separator:a221de77cdfcebf8981dbb91811e30c38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48e5e1d75323094a1b7d6cd01ebde0a1" id="r_a48e5e1d75323094a1b7d6cd01ebde0a1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecompositional__terms.html#a48e5e1d75323094a1b7d6cd01ebde0a1">cal_comp_sum2one_sou</a> (packed_state, mdims)</td></tr>
<tr class="memdesc:a48e5e1d75323094a1b7d6cd01ebde0a1"><td class="mdescLeft">&#160;</td><td class="mdescRight">make sure the composition sums to 1.0  <br /></td></tr>
<tr class="separator:a48e5e1d75323094a1b7d6cd01ebde0a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains all that is required to perform compositional modelling. NOTE THAT THIS FUNCTIONALITY HAS NEVER BEEN FULLY IMPLEMENTED ONLY INERT COMPOSITIONAL WORKS CURRENTLY. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a48e5e1d75323094a1b7d6cd01ebde0a1" name="a48e5e1d75323094a1b7d6cd01ebde0a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48e5e1d75323094a1b7d6cd01ebde0a1">&#9670;&#160;</a></span>cal_comp_sum2one_sou()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_terms::cal_comp_sum2one_sou </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( <a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a> ), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>make sure the composition sums to 1.0 </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a48e5e1d75323094a1b7d6cd01ebde0a1_icgraph.png" border="0" usemap="#anamespacecompositional__terms_a48e5e1d75323094a1b7d6cd01ebde0a1_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a48e5e1d75323094a1b7d6cd01ebde0a1_icgraph" id="anamespacecompositional__terms_a48e5e1d75323094a1b7d6cd01ebde0a1_icgraph">
<area shape="rect" title="make sure the composition sums to 1.0" alt="" coords="1037,26,1227,66"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,26,989,66"/>
<area shape="poly" title=" " alt="" coords="1024,48,990,48,990,43,1024,43"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,26,417,66"/>
<area shape="poly" title=" " alt="" coords="770,26,706,16,586,8,466,16,397,28,396,23,465,11,586,3,707,11,771,20"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,26,707,66"/>
<area shape="poly" title=" " alt="" coords="741,48,707,48,707,43,741,43"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,90,685,145"/>
<area shape="poly" title=" " alt="" coords="779,72,686,95,685,90,778,66"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,26,171,66"/>
<area shape="poly" title=" " alt="" coords="205,48,171,48,171,43,205,43"/>
<area shape="poly" title=" " alt="" coords="452,48,417,48,417,43,452,43"/>
<area shape="poly" title=" " alt="" coords="473,90,393,68,394,63,474,85"/>
</map>
</div>

</div>
</div>
<a id="a355b7b6ba8282f659fa0ecd18973e031" name="a355b7b6ba8282f659fa0ecd18973e031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a355b7b6ba8282f659fa0ecd18973e031">&#9670;&#160;</a></span>calc_comp_dif_ten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_terms::calc_comp_dif_ten </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ud</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>diff_molecular</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>diff_longitudinal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>diff_transverse</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>diff_ten</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Reservoir-Simulation-Mathematical-Techniques-In-Oil-Recovery-(2007).pdf. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a355b7b6ba8282f659fa0ecd18973e031_icgraph.png" border="0" usemap="#anamespacecompositional__terms_a355b7b6ba8282f659fa0ecd18973e031_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a355b7b6ba8282f659fa0ecd18973e031_icgraph" id="anamespacecompositional__terms_a355b7b6ba8282f659fa0ecd18973e031_icgraph">
<area shape="rect" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="1573,139,1732,179"/>
<area shape="rect" href="namespacecompositional__terms.html#a9091a40e5dcfbb5b4ebbce9242c7d0c4" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="1269,139,1525,179"/>
<area shape="poly" title=" " alt="" coords="1559,162,1526,162,1526,157,1559,157"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,139,1221,179"/>
<area shape="poly" title=" " alt="" coords="1256,162,1221,162,1221,157,1256,157"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,70,989,110"/>
<area shape="poly" title=" " alt="" coords="1041,138,946,113,948,107,1042,133"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,70,417,110"/>
<area shape="poly" title=" " alt="" coords="1024,179,908,191,767,198,692,197,615,193,539,183,465,169,431,158,400,143,347,112,349,108,402,139,433,153,466,163,540,178,615,187,692,192,767,193,908,186,1023,173"/>
<area shape="poly" title=" " alt="" coords="821,66,767,43,706,25,639,13,586,8,533,12,466,25,405,46,353,72,351,67,403,41,465,19,532,7,586,3,640,7,707,19,769,38,823,62"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,34,707,74"/>
<area shape="poly" title=" " alt="" coords="741,76,707,72,707,67,742,71"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,99,685,153"/>
<area shape="poly" title=" " alt="" coords="741,109,686,116,685,111,741,104"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,70,171,110"/>
<area shape="poly" title=" " alt="" coords="205,93,171,93,171,87,205,87"/>
<area shape="poly" title=" " alt="" coords="452,75,418,79,417,74,451,69"/>
<area shape="poly" title=" " alt="" coords="473,114,417,106,418,101,474,108"/>
</map>
</div>

</div>
</div>
<a id="a23481f5d5ce42c14c00cbc93e4a7bfa2" name="a23481f5d5ce42c14c00cbc93e4a7bfa2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23481f5d5ce42c14c00cbc93e4a7bfa2">&#9670;&#160;</a></span>calc_kcomp2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_terms::calc_kcomp2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>kcomp_sigmoid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>satura</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>k_comp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>max_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>min_k</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>k_comp2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Method to flash components. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_cgraph.png" border="0" usemap="#anamespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_cgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_cgraph" id="anamespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_cgraph">
<area shape="rect" title="Method to flash components." alt="" coords="5,29,164,69"/>
<area shape="rect" href="namespacecompositional__terms.html#ac1d9985f8ba66b85d7ac0905db70ec6a" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="212,29,371,69"/>
<area shape="poly" title=" " alt="" coords="164,47,198,47,198,52,164,52"/>
<area shape="poly" title=" " alt="" coords="253,30,250,20,257,11,270,5,291,3,315,6,329,13,326,18,314,11,291,8,272,10,260,15,256,21,258,28"/>
<area shape="rect" href="namespacecompositional__terms.html#a221de77cdfcebf8981dbb91811e30c38" title=" " alt="" coords="419,29,577,69"/>
<area shape="poly" title=" " alt="" coords="371,47,405,47,405,52,371,52"/>
<area shape="poly" title=" " alt="" coords="459,30,457,20,463,11,477,5,498,3,522,6,535,13,533,18,520,11,498,8,478,10,467,15,462,21,464,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_icgraph.png" border="0" usemap="#anamespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_icgraph" id="anamespacecompositional__terms_a23481f5d5ce42c14c00cbc93e4a7bfa2_icgraph">
<area shape="rect" title="Method to flash components." alt="" coords="1355,26,1513,66"/>
<area shape="rect" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="1037,26,1307,66"/>
<area shape="poly" title=" " alt="" coords="1341,48,1307,48,1307,43,1341,43"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,26,989,66"/>
<area shape="poly" title=" " alt="" coords="1024,48,990,48,990,43,1024,43"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,26,417,66"/>
<area shape="poly" title=" " alt="" coords="770,26,706,16,586,8,466,16,397,28,396,23,465,11,586,3,707,11,771,20"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,26,707,66"/>
<area shape="poly" title=" " alt="" coords="741,48,707,48,707,43,741,43"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,90,685,145"/>
<area shape="poly" title=" " alt="" coords="779,72,686,95,685,90,778,66"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,26,171,66"/>
<area shape="poly" title=" " alt="" coords="205,48,171,48,171,43,205,43"/>
<area shape="poly" title=" " alt="" coords="452,48,417,48,417,43,452,43"/>
<area shape="poly" title=" " alt="" coords="473,90,393,68,394,63,474,85"/>
</map>
</div>

</div>
</div>
<a id="a66bd32a7cfb204a4ceafac3c09cb188b" name="a66bd32a7cfb204a4ceafac3c09cb188b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66bd32a7cfb204a4ceafac3c09cb188b">&#9670;&#160;</a></span>calculate_componentabsorptionterm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_terms::calculate_componentabsorptionterm </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>denold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>comp_absorb</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the previous time step so its easier to converge. alpha_beta is the scaling coeff. of the compositional model e.g. =1.0. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_cgraph.png" border="0" usemap="#anamespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_cgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_cgraph" id="anamespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_cgraph">
<area shape="rect" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="5,29,275,69"/>
<area shape="rect" href="namespacecompositional__terms.html#a23481f5d5ce42c14c00cbc93e4a7bfa2" title="Method to flash components." alt="" coords="323,29,481,69"/>
<area shape="poly" title=" " alt="" coords="275,47,309,47,309,52,275,52"/>
<area shape="rect" href="namespacecompositional__terms.html#ac1d9985f8ba66b85d7ac0905db70ec6a" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="529,29,688,69"/>
<area shape="poly" title=" " alt="" coords="482,47,516,47,516,52,482,52"/>
<area shape="poly" title=" " alt="" coords="570,30,568,20,574,11,588,5,609,3,633,6,646,13,643,18,631,11,609,8,589,10,577,15,573,21,575,28"/>
<area shape="rect" href="namespacecompositional__terms.html#a221de77cdfcebf8981dbb91811e30c38" title=" " alt="" coords="736,29,895,69"/>
<area shape="poly" title=" " alt="" coords="688,47,722,47,722,52,688,52"/>
<area shape="poly" title=" " alt="" coords="777,30,774,20,781,11,794,5,815,3,839,6,853,13,850,18,838,11,815,8,796,10,784,15,780,21,782,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_icgraph.png" border="0" usemap="#anamespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_icgraph" id="anamespacecompositional__terms_a66bd32a7cfb204a4ceafac3c09cb188b_icgraph">
<area shape="rect" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="1037,26,1307,66"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,26,989,66"/>
<area shape="poly" title=" " alt="" coords="1024,48,990,48,990,43,1024,43"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,26,417,66"/>
<area shape="poly" title=" " alt="" coords="770,26,706,16,586,8,466,16,397,28,396,23,465,11,586,3,707,11,771,20"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,26,707,66"/>
<area shape="poly" title=" " alt="" coords="741,48,707,48,707,43,741,43"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,90,685,145"/>
<area shape="poly" title=" " alt="" coords="779,72,686,95,685,90,778,66"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,26,171,66"/>
<area shape="poly" title=" " alt="" coords="205,48,171,48,171,43,205,43"/>
<area shape="poly" title=" " alt="" coords="452,48,417,48,417,43,452,43"/>
<area shape="poly" title=" " alt="" coords="473,90,393,68,394,63,474,85"/>
</map>
</div>

</div>
</div>
<a id="a9091a40e5dcfbb5b4ebbce9242c7d0c4" name="a9091a40e5dcfbb5b4ebbce9242c7d0c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9091a40e5dcfbb5b4ebbce9242c7d0c4">&#9670;&#160;</a></span>calculate_componentdiffusionterm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_terms::calculate_componentdiffusionterm </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mat_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncomp_diff_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>comp_diffusion_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>comp_diff_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>comp_diffusion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Reservoir-Simulation-Mathematical-Techniques-In-Oil-Recovery-(2007).pdf COMP_DIFFUSION_OPT, integer option defining diffusion coeff NCOMP_DIFF_COEF, integer defining how many coeff's are needed to define the diffusion COMP_DIFF_COEF( Mdimsncomp, NCOMP_DIFF_COEF, Mdimsnphase ) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_cgraph.png" border="0" usemap="#anamespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_cgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_cgraph" id="anamespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_cgraph">
<area shape="rect" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="5,37,261,77"/>
<area shape="rect" href="namespacecompositional__terms.html#a355b7b6ba8282f659fa0ecd18973e031" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="309,5,468,45"/>
<area shape="poly" title=" " alt="" coords="261,39,295,34,296,40,262,44"/>
<area shape="rect" href="namespacecompositional__terms.html#ade3a2016f1b239160f844f3db8622b63" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="309,69,468,109"/>
<area shape="poly" title=" " alt="" coords="262,71,296,75,295,80,261,76"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="516,37,727,77"/>
<area shape="poly" title=" " alt="" coords="468,76,502,71,503,76,469,81"/>
<area shape="rect" href="namespacematrix__operations.html#a1ce0b2be2d80aa729f46ed7cad39e46e" title="calculate DMATINV" alt="" coords="547,101,696,141"/>
<area shape="poly" title=" " alt="" coords="469,98,533,107,532,112,468,103"/>
<area shape="rect" href="namespacematrix__operations.html#ab5e53c63c307421782aa3a9be48b95e9" title=": This sub finds the inverse of the matrix A and puts it back in A. MAT, MAT2, X and B are working ve..." alt="" coords="775,101,924,141"/>
<area shape="poly" title=" " alt="" coords="696,119,761,119,761,124,696,124"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_icgraph.png" border="0" usemap="#anamespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_icgraph" id="anamespacecompositional__terms_a9091a40e5dcfbb5b4ebbce9242c7d0c4_icgraph">
<area shape="rect" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="1269,139,1525,179"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,139,1221,179"/>
<area shape="poly" title=" " alt="" coords="1256,162,1221,162,1221,157,1256,157"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,70,989,110"/>
<area shape="poly" title=" " alt="" coords="1041,138,946,113,948,107,1042,133"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,70,417,110"/>
<area shape="poly" title=" " alt="" coords="1024,179,908,191,767,198,692,197,615,193,539,183,465,169,431,158,400,143,347,112,349,108,402,139,433,153,466,163,540,178,615,187,692,192,767,193,908,186,1023,173"/>
<area shape="poly" title=" " alt="" coords="821,66,767,43,706,25,639,13,586,8,533,12,466,25,405,46,353,72,351,67,403,41,465,19,532,7,586,3,640,7,707,19,769,38,823,62"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,34,707,74"/>
<area shape="poly" title=" " alt="" coords="741,76,707,72,707,67,742,71"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,99,685,153"/>
<area shape="poly" title=" " alt="" coords="741,109,686,116,685,111,741,104"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,70,171,110"/>
<area shape="poly" title=" " alt="" coords="205,93,171,93,171,87,205,87"/>
<area shape="poly" title=" " alt="" coords="452,75,418,79,417,74,451,69"/>
<area shape="poly" title=" " alt="" coords="473,114,417,106,418,101,474,108"/>
</map>
</div>

</div>
</div>
<a id="a221de77cdfcebf8981dbb91811e30c38" name="a221de77cdfcebf8981dbb91811e30c38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a221de77cdfcebf8981dbb91811e30c38">&#9670;&#160;</a></span>exprep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function compositional_terms::exprep </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>m</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_cgraph.png" border="0" usemap="#anamespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_cgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_cgraph" id="anamespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,164,69"/>
<area shape="poly" title=" " alt="" coords="54,29,53,20,57,11,68,5,85,3,104,6,114,13,111,17,101,11,85,8,70,10,61,14,58,21,60,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_icgraph.png" border="0" usemap="#anamespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_icgraph" id="anamespacecompositional__terms_a221de77cdfcebf8981dbb91811e30c38_icgraph">
<area shape="rect" title=" " alt="" coords="1768,29,1927,69"/>
<area shape="poly" title=" " alt="" coords="1882,18,1870,11,1847,8,1828,10,1816,15,1812,21,1814,28,1809,30,1806,20,1813,11,1826,5,1847,3,1871,6,1885,13"/>
<area shape="rect" href="namespacecompositional__terms.html#ac1d9985f8ba66b85d7ac0905db70ec6a" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="1561,29,1720,69"/>
<area shape="poly" title=" " alt="" coords="1754,52,1720,52,1720,47,1754,47"/>
<area shape="poly" title=" " alt="" coords="1675,18,1663,11,1641,8,1621,10,1609,15,1605,21,1607,28,1602,30,1600,20,1606,11,1620,5,1641,3,1665,6,1678,13"/>
<area shape="rect" href="namespacecompositional__terms.html#a23481f5d5ce42c14c00cbc93e4a7bfa2" title="Method to flash components." alt="" coords="1355,29,1513,69"/>
<area shape="poly" title=" " alt="" coords="1547,52,1513,52,1513,47,1547,47"/>
<area shape="rect" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="1037,29,1307,69"/>
<area shape="poly" title=" " alt="" coords="1341,52,1307,52,1307,47,1341,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,29,989,69"/>
<area shape="poly" title=" " alt="" coords="1024,52,990,52,990,47,1024,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,29,417,69"/>
<area shape="poly" title=" " alt="" coords="770,29,706,20,586,12,466,20,397,32,396,27,465,15,586,6,707,15,771,24"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,29,707,69"/>
<area shape="poly" title=" " alt="" coords="741,52,707,52,707,47,741,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,94,685,149"/>
<area shape="poly" title=" " alt="" coords="779,75,686,99,685,94,778,70"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,29,171,69"/>
<area shape="poly" title=" " alt="" coords="205,52,171,52,171,47,205,47"/>
<area shape="poly" title=" " alt="" coords="452,52,417,52,417,47,452,47"/>
<area shape="poly" title=" " alt="" coords="473,94,393,72,394,67,474,89"/>
</map>
</div>

</div>
</div>
<a id="ade3a2016f1b239160f844f3db8622b63" name="ade3a2016f1b239160f844f3db8622b63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ade3a2016f1b239160f844f3db8622b63">&#9670;&#160;</a></span>proj_u2mat()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_terms::proj_u2mat </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>comp_diffusion_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>comp_diffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncomp_diff_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>comp_diff_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>nu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>nv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>nw</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mat_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(inout)&#160;</td>
          <td class="paramname"><em>mat_u</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Determine MAT_U from NU,NV,NW which are variables mapped to material mesh. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_cgraph.png" border="0" usemap="#anamespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_cgraph" alt=""/></div>
<map name="anamespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_cgraph" id="anamespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_cgraph">
<area shape="rect" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="5,37,164,77"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="212,5,423,45"/>
<area shape="poly" title=" " alt="" coords="164,44,198,39,199,44,165,49"/>
<area shape="rect" href="namespacematrix__operations.html#a1ce0b2be2d80aa729f46ed7cad39e46e" title="calculate DMATINV" alt="" coords="243,69,392,109"/>
<area shape="poly" title=" " alt="" coords="165,66,229,75,228,80,164,71"/>
<area shape="rect" href="namespacematrix__operations.html#ab5e53c63c307421782aa3a9be48b95e9" title=": This sub finds the inverse of the matrix A and puts it back in A. MAT, MAT2, X and B are working ve..." alt="" coords="471,69,620,109"/>
<area shape="poly" title=" " alt="" coords="392,87,457,87,457,92,392,92"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_icgraph.png" border="0" usemap="#anamespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_icgraph" id="anamespacecompositional__terms_ade3a2016f1b239160f844f3db8622b63_icgraph">
<area shape="rect" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="1573,139,1732,179"/>
<area shape="rect" href="namespacecompositional__terms.html#a9091a40e5dcfbb5b4ebbce9242c7d0c4" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="1269,139,1525,179"/>
<area shape="poly" title=" " alt="" coords="1559,162,1526,162,1526,157,1559,157"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,139,1221,179"/>
<area shape="poly" title=" " alt="" coords="1256,162,1221,162,1221,157,1256,157"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,70,989,110"/>
<area shape="poly" title=" " alt="" coords="1041,138,946,113,948,107,1042,133"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,70,417,110"/>
<area shape="poly" title=" " alt="" coords="1024,179,908,191,767,198,692,197,615,193,539,183,465,169,431,158,400,143,347,112,349,108,402,139,433,153,466,163,540,178,615,187,692,192,767,193,908,186,1023,173"/>
<area shape="poly" title=" " alt="" coords="821,66,767,43,706,25,639,13,586,8,533,12,466,25,405,46,353,72,351,67,403,41,465,19,532,7,586,3,640,7,707,19,769,38,823,62"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,34,707,74"/>
<area shape="poly" title=" " alt="" coords="741,76,707,72,707,67,742,71"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,99,685,153"/>
<area shape="poly" title=" " alt="" coords="741,109,686,116,685,111,741,104"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,70,171,110"/>
<area shape="poly" title=" " alt="" coords="205,93,171,93,171,87,205,87"/>
<area shape="poly" title=" " alt="" coords="452,75,418,79,417,74,451,69"/>
<area shape="poly" title=" " alt="" coords="473,114,417,106,418,101,474,108"/>
</map>
</div>

</div>
</div>
<a id="ac1d9985f8ba66b85d7ac0905db70ec6a" name="ac1d9985f8ba66b85d7ac0905db70ec6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1d9985f8ba66b85d7ac0905db70ec6a">&#9670;&#160;</a></span>sigmoid_function()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function compositional_terms::sigmoid_function </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>width</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>lowmag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>upmag</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag, UpMag ). Y is the variable of the function and Y0 is the centre of the function. </p>
<h2><a class="anchor" id="autotoc_md7"></a>
The function looks like:</h2>
<p>/ </p>
<h2><a class="anchor" id="autotoc_md8"></a>
/</h2>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_cgraph.png" border="0" usemap="#anamespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_cgraph" alt=""/></div>
<map name="anamespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_cgraph" id="anamespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_cgraph">
<area shape="rect" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="5,29,164,69"/>
<area shape="poly" title=" " alt="" coords="46,30,44,20,50,11,64,5,85,3,109,6,122,13,119,18,107,11,85,8,65,10,53,15,49,21,51,28"/>
<area shape="rect" href="namespacecompositional__terms.html#a221de77cdfcebf8981dbb91811e30c38" title=" " alt="" coords="212,29,371,69"/>
<area shape="poly" title=" " alt="" coords="164,47,198,47,198,52,164,52"/>
<area shape="poly" title=" " alt="" coords="253,30,250,20,257,11,270,5,291,3,315,6,329,13,326,18,314,11,291,8,272,10,260,15,256,21,258,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_icgraph.png" border="0" usemap="#anamespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_icgraph" alt=""/></div>
<map name="anamespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_icgraph" id="anamespacecompositional__terms_ac1d9985f8ba66b85d7ac0905db70ec6a_icgraph">
<area shape="rect" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="1561,29,1720,69"/>
<area shape="poly" title=" " alt="" coords="1675,18,1663,11,1641,8,1621,10,1609,15,1605,21,1607,28,1602,30,1600,20,1606,11,1620,5,1641,3,1665,6,1678,13"/>
<area shape="rect" href="namespacecompositional__terms.html#a23481f5d5ce42c14c00cbc93e4a7bfa2" title="Method to flash components." alt="" coords="1355,29,1513,69"/>
<area shape="poly" title=" " alt="" coords="1547,52,1513,52,1513,47,1547,47"/>
<area shape="rect" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="1037,29,1307,69"/>
<area shape="poly" title=" " alt="" coords="1341,52,1307,52,1307,47,1341,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,29,989,69"/>
<area shape="poly" title=" " alt="" coords="1024,52,990,52,990,47,1024,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,29,417,69"/>
<area shape="poly" title=" " alt="" coords="770,29,706,20,586,12,466,20,397,32,396,27,465,15,586,6,707,15,771,24"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,29,707,69"/>
<area shape="poly" title=" " alt="" coords="741,52,707,52,707,47,741,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,94,685,149"/>
<area shape="poly" title=" " alt="" coords="779,75,686,99,685,94,778,70"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,29,171,69"/>
<area shape="poly" title=" " alt="" coords="205,52,171,52,171,47,205,47"/>
<area shape="poly" title=" " alt="" coords="452,52,417,52,417,47,452,47"/>
<area shape="poly" title=" " alt="" coords="473,94,393,72,394,67,474,89"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecompositional__terms.html">compositional_terms</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
