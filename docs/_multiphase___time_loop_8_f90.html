<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: /home/mbahlali/Softwares/multifluids_icferst/ICFERST/src/Multiphase_TimeLoop.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICFERST
   &#160;<span id="projectnumber">25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('_multiphase___time_loop_8_f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">Multiphase_TimeLoop.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;fdebug.h&quot;</code><br />
<code>#include &quot;petsc/finclude/petsc.h&quot;</code><br />
<code>#include &quot;petsc_legacy.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for Multiphase_TimeLoop.F90:</div>
<div class="dyncontent">
<div class="center"><img src="_multiphase___time_loop_8_f90__incl.png" border="0" usemap="#_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2_multiphase___time_loop_8_f90" alt=""/></div>
<map name="_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2_multiphase___time_loop_8_f90" id="_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2_multiphase___time_loop_8_f90">
<area shape="rect" title=" " alt="" coords="77,5,278,61"/>
<area shape="rect" title=" " alt="" coords="5,109,77,136"/>
<area shape="rect" title=" " alt="" coords="102,109,253,136"/>
<area shape="rect" title=" " alt="" coords="277,109,385,136"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemultiphase__time__loop"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__time__loop.html">multiphase_time_loop</a></td></tr>
<tr class="memdesc:namespacemultiphase__time__loop"><td class="mdescLeft">&#160;</td><td class="mdescRight">Time-loop module of IC-FERST. This module contains the time-loop and the non-linear loop. The time-loop consists many steps: 1) Data initialisation including shape functions, memory allocation, sparsity, porous media properties, etc. 2) Initialisation of the actual time loop. 3) Non-linear loop. IC-FERST uses a modified Anderson-acceleration non-linear solver, which is based in a Picard iterative non-linear solver. In this way, the different equations are solved independently and coupled through the Anderson non-linear solver. First the momentum and continuity equations are assembled and solved for, next the different transport equations are solved, for example: saturation, temperature, concentration, etc. ActiveTracers and Species are solved within the non-linear solver while PassiveTracers are solved outside the non-linear solver. 4) Once the non-linear solver has converged, we proceed to jump to the next time-level but first we check if we need to adapt the mesh and/or generate a vtu file. etc. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a04598d33bda1f46f9537570dbc0119bc"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc">multiphase_time_loop::multifluids_solvetimeloop</a> (state, dt, nonlinear_iterations, dump_no)</td></tr>
<tr class="memdesc:a04598d33bda1f46f9537570dbc0119bc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the main subroutine from which everything is called. It performs the time-loop and therefore calls all the necessary blocks to solve for the system of equations, adapt the mesh, etc. See Salinas et al. 2016 doi: 10.1002/fld.4357, for a description of the time-loop and non-linear solver.  <a href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc">More...</a><br /></td></tr>
<tr class="separator:a04598d33bda1f46f9537570dbc0119bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acdc79e479d6b4674e9471ef506d78b2f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f">linearise_components</a> ()</td></tr>
<tr class="separator:acdc79e479d6b4674e9471ef506d78b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="acdc79e479d6b4674e9471ef506d78b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acdc79e479d6b4674e9471ef506d78b2f">&#9670;&nbsp;</a></span>linearise_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multifluids_solvetimeloop::linearise_components</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="_multiphase___time_loop_8_f90_acdc79e479d6b4674e9471ef506d78b2f_cgraph.png" border="0" usemap="#_multiphase___time_loop_8_f90_acdc79e479d6b4674e9471ef506d78b2f_cgraph" alt=""/></div>
<map name="_multiphase___time_loop_8_f90_acdc79e479d6b4674e9471ef506d78b2f_cgraph" id="_multiphase___time_loop_8_f90_acdc79e479d6b4674e9471ef506d78b2f_cgraph">
<area shape="rect" title=" " alt="" coords="5,1060,153,1087"/>
<area shape="rect" href="namespacemulti__data__types.html#add33a9072dfc14b1ee94cf90d53c030a" title="This subroutine allocates the global to local conversors." alt="" coords="213,35,388,77"/>
<area shape="rect" href="namespacemulti__data__types.html#a086d82f299fc3e1148cd44350b8cff0e" title="Allocates the memory for the advection coefficients for porous media." alt="" coords="213,101,388,142"/>
<area shape="rect" href="namespacemulti__sp.html#a3761caa03a0d114b25c395685b965a73" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="233,166,368,207"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="214,385,387,426"/>
<area shape="rect" href="namespacecopy__outof__state.html#abba0b467480d0b56c11d18f70e8c680e" title="This subroutine calculates the global node numbers requested to operates in ICFERST." alt="" coords="211,523,391,565"/>
<area shape="rect" href="namespacecv__advection.html#ae1eba9d13ff146b1bf390a5de461d421" title="This subroutine counts then number of faces in the control volume space." alt="" coords="462,1246,622,1287"/>
<area shape="rect" href="namespacemulti__data__types.html#a5ea8066a0ecf9104dd8ca9d9f18e11c9" title="Deallocates Global to local fields NOTE that Only deallocates suf_cv, suf_p and suf_u since the other..." alt="" coords="207,823,395,865"/>
<area shape="rect" href="namespacemulti__data__types.html#a8d4980a0b1c7eaa7e55faa42e636eebe" title="Deallocates the necessary memory for multi_pipe_package." alt="" coords="207,889,395,930"/>
<area shape="rect" href="namespacemulti__data__types.html#a3137e48a49f7bb16cf337ff1834703b6" title="This subroutine deallocates all the memory inside Mspars." alt="" coords="448,582,636,623"/>
<area shape="rect" href="namespacemulti__phreeqc.html#a42b4f2e1448e657fbfda8a497fac99df" title=" " alt="" coords="215,954,386,995"/>
<area shape="rect" href="namespacemulti__data__types.html#a30f2b1810cafa7b1e675ca9c08eb12c7" title="Deallocates the memory for the advection coefficients for porous media." alt="" coords="207,1019,395,1061"/>
<area shape="rect" href="namespacemulti__data__types.html#abf63a6f60bfdf10af1503d0cb8787096" title="This subroutine deallocates projection matrices CV2FE &amp; FE2CV stored in shape_fun." alt="" coords="207,1085,395,1126"/>
<area shape="rect" href="namespacespact.html#a6f9b1937afa54fae50f7dd86b942f3cb" title=" " alt="" coords="210,1150,391,1191"/>
<area shape="rect" href="namespacemulti__data__types.html#a0b85017f5919b415d7e7ec8cc29bdc6b" title="Deallocates and nullifies the memory generated for the matrices, it is to be used after adapting the ..." alt="" coords="215,1215,387,1257"/>
<area shape="rect" href="namespacecopy__outof__state.html#a25e9236f15044530da105400e0e3e3f4" title=": Obtain the type of element u_ele_type = cv_ele_type = p_ele_type will flag the dimension and type o..." alt="" coords="227,1281,375,1322"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab5c876f8f241119d1dedc0bffa8fa159" title="This subroutine extracts all primary variables associated with the mesh from state,..." alt="" coords="225,1346,377,1387"/>
<area shape="rect" href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990" title=":Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed st..." alt="" coords="231,1411,370,1453"/>
<area shape="rect" href="namespacespact.html#aeaf3853765a92827bf24c599fe79364e" title="Allocate and obtain the sparsity patterns of the two types of matricies for (momentum + cty) and for ..." alt="" coords="234,706,367,747"/>
<area shape="rect" href="namespacemulti__data__types.html#aa99e43604028836507ef0ebc746beafa" title="Read in the surface IDs of the boundaries (if any) that you wish to integrate over into the (integer ..." alt="" coords="213,1477,389,1518"/>
<area shape="rect" href="namespacemulti__pipes.html#adf22cecb27df6cddfd856d95c388868b" title="This subroutine reads information from diamond and populates the necessary fields For P0DGP1 gamma is..." alt="" coords="203,1542,398,1583"/>
<area shape="rect" href="namespacemulti__interpolation.html#a4f1475bd24977140d41a9601fce62e7f" title="Mehs to mesh interpollation method, in Diamond DG_Galerkin." alt="" coords="236,1607,365,1649"/>
<area shape="rect" href="namespacemulti__interpolation.html#adb81d167c7226e84c335c34c9a7e98e6" title=" " alt="" coords="201,1673,400,1714"/>
<area shape="rect" href="namespacecopy__outof__state.html#afca89971343f6586b89f1cddda00b2c8" title=": This subroutine creates packed_state from state(:) and links the appropiate memory so it is acessib..." alt="" coords="221,261,380,302"/>
<area shape="rect" href="namespacecopy__outof__state.html#adba75f9a3f64d519ecf58b2b9159d629" title=": Prepares the memory to compute absorption fields" alt="" coords="214,1738,387,1779"/>
<area shape="rect" href="namespacemulti__pipes.html#aa27e23615cb61d7b64663cda62a2e7da" title=": In this subroutine the elements that contain pipes are identified The pipes can either be defined u..." alt="" coords="231,1803,370,1845"/>
<area shape="rect" href="namespacecopy__outof__state.html#af6fb85b60c7bb747b61c41c24b07b785" title=" " alt="" coords="221,1869,380,1910"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="467,5,617,61"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="459,86,625,127"/>
<area shape="rect" href="namespacemulti__tools.html#ab412a6b9d80984d5739ef227590a9e8d" title=": This subroutine uses python run string to run the python_scalar_diagnostic to read a field the only..." alt="" coords="464,151,620,193"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="463,269,621,310"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="465,217,619,244"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab548da6c93ce257b9cec9b1c27a9390a" title="In this subroutine we calculate and update the density of the porous media based on the compressibili..." alt="" coords="455,334,629,375"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee" title=": Computes the density and the derivative of the density" alt="" coords="455,399,629,441"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa45791df12ab50edf07b075fc8c83335" title=": Computes the bulk density for components and the derivatives of the density" alt="" coords="471,465,613,506"/>
<area shape="rect" href="namespacemulti__tools.html#a29b23492be133b01a7eb9bce13adbdfb" title=" " alt="" coords="464,531,620,557"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="684,1090,841,1131"/>
<area shape="rect" href="namespacephreeqcrm.html#aa18cd6cf17f8ac7b5552880340d5a3d2" title="Destroys a reaction module." alt="" coords="464,1312,620,1339"/>
<area shape="rect" href="namespacemultiphase__eos.html#a29b9750459911134c7e711f15fa42614" title=" " alt="" coords="453,1387,631,1429"/>
<area shape="rect" href="multi__eos_8_f90.html#a098f3f1c27b74be5d61f21fcff4c50a7" title=": This internal subroutine checks the if we are flipping from drainage to imbibition,..." alt="" coords="455,1453,629,1480"/>
<area shape="rect" href="namespacemulti__data__types.html#a99a3adeb20eae3cd7f9c1ee1760473c3" title="This subroutine allocates part of the memory inside Mspars, i.e. sparsities of the different matrices..." alt="" coords="455,765,629,806"/>
<area shape="rect" href="namespacesparsity__nd.html#ad2675c1d6e4a4f583ae88aca4f1c0698" title=" " alt="" coords="463,831,621,857"/>
<area shape="rect" href="namespacespact.html#aaa6676a57a39f977170aba9c14e142d9" title=" " alt="" coords="469,881,615,908"/>
<area shape="rect" href="namespacesparsity__nd.html#a455ef657aa7fb1aaa3bff1b71aaa24a5" title=" " alt="" coords="455,933,629,974"/>
<area shape="rect" href="namespacesparsity__1d.html#a71b686e37752d791fc7d1ee0ed8f2e99" title="define sparsity..." alt="" coords="469,999,615,1025"/>
<area shape="rect" href="namespacesparsity__1d.html#aef815576501475f4594796f76cf24cd1" title="define sparsity..." alt="" coords="469,1050,615,1091"/>
<area shape="rect" href="namespacesparsity__nd.html#a153ed29261138396f681d34481052706" title="Extend the sparsity to a multiphase sparsity." alt="" coords="469,1115,615,1157"/>
<area shape="rect" href="namespacesparsity__nd.html#afd69d7ff0e0711f9339ea44001f52fa9" title="Extend the sparsity to a multiphase sparsity." alt="" coords="457,1181,627,1222"/>
<area shape="rect" href="namespacesparsity__nd.html#ae461c112b56d8320a70df9e84a8e3cd9" title="Form the sparsity of the phase coupled DG discretised matrix from the element&#45;wise multi&#45;phase sparsi..." alt="" coords="465,647,619,689"/>
<area shape="rect" href="namespacesparsity__nd.html#a353ce2dc64a8fd11e0a28b7935cdf7ae" title="This subroutine forms the matrix operating on the pressure vector. It is found from C1T ML C1 + C2T M..." alt="" coords="471,713,613,740"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="_multiphase___time_loop_8_f90.html">Multiphase_TimeLoop.F90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
