<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: copy_outof_state Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ICFERST<span id="projectnumber">&#160;25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacecopy__outof__state.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">copy_outof_state Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This module enables the multiphase prototype code to interact with state by copying everything required from state to ICFERST, adaptive time-stepping, outfluxes computation, tunneled BCs and Darcy velocity.  
<a href="namespacecopy__outof__state.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a60bda55d8fe3fd82eed3fbb6c17cd8be" id="r_a60bda55d8fe3fd82eed3fbb6c17cd8be"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a60bda55d8fe3fd82eed3fbb6c17cd8be">get_primary_scalars_new</a> (state, mdims)</td></tr>
<tr class="memdesc:a60bda55d8fe3fd82eed3fbb6c17cd8be"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine extracts all primary variables associated with the mesh from state, and associated them with the variables used in the MultiFluids model.  <br /></td></tr>
<tr class="separator:a60bda55d8fe3fd82eed3fbb6c17cd8be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abba0b467480d0b56c11d18f70e8c680e" id="r_abba0b467480d0b56c11d18f70e8c680e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#abba0b467480d0b56c11d18f70e8c680e">compute_node_global_numbers</a> (state, ndgln)</td></tr>
<tr class="memdesc:abba0b467480d0b56c11d18f70e8c680e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine calculates the global node numbers requested to operates in ICFERST.  <br /></td></tr>
<tr class="separator:abba0b467480d0b56c11d18f70e8c680e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25e9236f15044530da105400e0e3e3f4" id="r_a25e9236f15044530da105400e0e3e3f4"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a25e9236f15044530da105400e0e3e3f4">get_ele_type</a> (x_nloc, cv_ele_type, p_ele_type, u_ele_type, mat_ele_type, u_sele_type, cv_sele_type)</td></tr>
<tr class="memdesc:a25e9236f15044530da105400e0e3e3f4"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Obtain the type of element u_ele_type = cv_ele_type = p_ele_type will flag the dimension and type of element: = 1 or 2: 1D (linear and quadratic, respectively) -NOT SUPPORTED- = 3 or 4: triangle (linear or quadratic, respectively) = 5 or 6: quadrilateral (bi-linear or tri-linear, respectively)-NOT SUPPORTED- = 7 or 8: tetrahedron (linear or quadratic, respectively) = 9 or 10: hexahedron (bi-linear or tri-linear, respectively) -NOT SUPPORTED-  <br /></td></tr>
<tr class="separator:a25e9236f15044530da105400e0e3e3f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c8ae22869d79032fd250ea6cc0651c9" id="r_a8c8ae22869d79032fd250ea6cc0651c9"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a8c8ae22869d79032fd250ea6cc0651c9">get_ele_type_new</a> (mdims, mdisopt)</td></tr>
<tr class="memdesc:a8c8ae22869d79032fd250ea6cc0651c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Obtains the element type Mdisoptu_ele_type = Mdisoptcv_ele_type = Mdisoptp_ele_type will flag the dimension and type of element: = 1 or 2: 1D (linear and quadratic, respectively) -NOT SUPPORTED- = 3 or 4: triangle (linear or quadratic, respectively) = 5 or 6: quadrilateral (bi-linear or tri-linear, respectively) -NOT SUPPORTED- = 7 or 8: tetrahedron (linear or quadratic, respectively) = 9 or 10: hexahedron (bi-linear or tri-linear, respectively) -NOT SUPPORTED-  <br /></td></tr>
<tr class="separator:a8c8ae22869d79032fd250ea6cc0651c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a977c4aa970124056f8138a72ed4a1612" id="r_a977c4aa970124056f8138a72ed4a1612"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a977c4aa970124056f8138a72ed4a1612">get_discretisation_options</a> (state, mdims, mdisopt)</td></tr>
<tr class="memdesc:a977c4aa970124056f8138a72ed4a1612"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine extract all discretisation options from the schema DISOPT Options: =0 1st order in space Theta=specified UNIVERSAL =1 1st order in space Theta=non-linear UNIVERSAL =2 Trapezoidal rule in space Theta=specified UNIVERSAL =2 if isotropic limiter then FEM-quadratic &amp; stratification adjust. Theta=non-linear =3 Trapezoidal rule in space Theta=non-linear UNIVERSAL =4 Finite elements in space Theta=specified UNIVERSAL =5 Finite elements in space Theta=non-linear UNIVERSAL =6 Finite elements in space Theta=specified NONE =7 Finite elements in space Theta=non-linear NONE =8 Finite elements in space Theta=specified DOWNWIND+INTERFACE TRACKING =9 Finite elements in space Theta=non-linear DOWNWIND+INTERFACE TRACKING  <br /></td></tr>
<tr class="separator:a977c4aa970124056f8138a72ed4a1612"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afca89971343f6586b89f1cddda00b2c8" id="r_afca89971343f6586b89f1cddda00b2c8"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#afca89971343f6586b89f1cddda00b2c8">pack_multistate</a> (npres, state, packed_state, multiphase_state, multicomponent_state, pmulti_state)</td></tr>
<tr class="memdesc:afca89971343f6586b89f1cddda00b2c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine creates packed_state from state(:) and links the appropiate memory so it is acessible from both states. This subroutine also introduces fields not used by fludity but required by IC-FERST  <br /></td></tr>
<tr class="separator:afca89971343f6586b89f1cddda00b2c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52b23a7607a135aaa7f055b36d531f41" id="r_a52b23a7607a135aaa7f055b36d531f41"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a52b23a7607a135aaa7f055b36d531f41">prepare_absorptions</a> (state, mdims, multi_absorp)</td></tr>
<tr class="memdesc:a52b23a7607a135aaa7f055b36d531f41"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Prepares the memory to compute absorption fields  <br /></td></tr>
<tr class="separator:a52b23a7607a135aaa7f055b36d531f41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfa3817b7e0890e5009c4905376a5688" id="r_abfa3817b7e0890e5009c4905376a5688"><td class="memItemLeft" align="right" valign="top">type(vector_field) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#abfa3817b7e0890e5009c4905376a5688">as_vector</a> (tfield, dim, slice)</td></tr>
<tr class="memdesc:abfa3817b7e0890e5009c4905376a5688"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This function points a tensor field as a vector field type This is necessary when solving for tensor fields that are actually multiphase vector fields.  <br /></td></tr>
<tr class="separator:abfa3817b7e0890e5009c4905376a5688"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6bc946977b60a10ae77f86013eb499e7" id="r_a6bc946977b60a10ae77f86013eb499e7"><td class="memItemLeft" align="right" valign="top">type(vector_field) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a6bc946977b60a10ae77f86013eb499e7">as_packed_vector</a> (tfield)</td></tr>
<tr class="memdesc:a6bc946977b60a10ae77f86013eb499e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This function points a tensor field as a vector field type This is necessary when solving for tensor fields that are actually multiphase vector fields.  <br /></td></tr>
<tr class="separator:a6bc946977b60a10ae77f86013eb499e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a60ec84623fb582762f2139794470ba13" id="r_a60ec84623fb582762f2139794470ba13"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a60ec84623fb582762f2139794470ba13">finalise_multistate</a> (packed_state, multiphase_state, multicomponent_state)</td></tr>
<tr class="memdesc:a60ec84623fb582762f2139794470ba13"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Destrys packed_state and the passed down states  <br /></td></tr>
<tr class="separator:a60ec84623fb582762f2139794470ba13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25b2882fb5f551e74ea186c313d5419d" id="r_a25b2882fb5f551e74ea186c313d5419d"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a25b2882fb5f551e74ea186c313d5419d">adaptive_nonlinear</a> (mdims, packed_state, reference_field, its, itime, repeat_time_step, exitnonlinearloop, nonlinearadaptts, old_acctim, order, calculate_mass_delta, adapt_mesh_in_fpi, accum_courant, courant_tol, current_courant, first_time_step)</td></tr>
<tr class="memdesc:a25b2882fb5f551e74ea186c313d5419d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonlinear iterations are going and depending on that increase the timestep or decreases the timestep and repeats that timestep  <br /></td></tr>
<tr class="separator:a25b2882fb5f551e74ea186c313d5419d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad775c010bade229fba0416002e6928a6" id="r_ad775c010bade229fba0416002e6928a6"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ad775c010bade229fba0416002e6928a6">inf_norm_scalar_normalised</a> (tracer, reference_tracer, dumping, totally_min_max)</td></tr>
<tr class="memdesc:ad775c010bade229fba0416002e6928a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate the inf norm of the normalised field, so the field goes from 0 to 1 It requires as inputs the tracer to be used and the reference tracer to normallise, the dumping to be set to 1.0 and totally_min_max which includes the min max values of the field across all processors also for normalisation.  <br /></td></tr>
<tr class="separator:ad775c010bade229fba0416002e6928a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6957a54cc1cc0a38a4a7a90bca1f89" id="r_a7d6957a54cc1cc0a38a4a7a90bca1f89"><td class="memItemLeft" align="right" valign="top">real function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a7d6957a54cc1cc0a38a4a7a90bca1f89">get_convergence_functional</a> (phasevolumefraction, reference_sat, dumping, its)</td></tr>
<tr class="memdesc:a7d6957a54cc1cc0a38a4a7a90bca1f89"><td class="mdescLeft">&#160;</td><td class="mdescRight">: We create a potential to optimize F = sum (f**2), so the solution is when this potential reaches a minimum. Typically the value to consider convergence is the sqrt(epsilon of the machine), i.e. 10^-8 f = (NewSat-OldSat)/Number of nodes; this is the typical approach for algebraic non linear systems  <br /></td></tr>
<tr class="separator:a7d6957a54cc1cc0a38a4a7a90bca1f89"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4e108d42b18611e2908d988a6155b70" id="r_ad4e108d42b18611e2908d988a6155b70"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70">get_var_from_packed_state</a> (packed_state, fedensity, oldfedensity, iteratedfedensity, density, olddensity, iterateddensity, phasevolumefraction, oldphasevolumefraction, iteratedphasevolumefraction, velocity, oldvelocity, iteratedvelocity, fephasevolumefraction, oldfephasevolumefraction, iteratedfephasevolumefraction, nonlinearvelocity, oldnonlinearvelocity, iteratednonlinearvelocity, componentdensity, oldcomponentdensity, iteratedcomponentdensity, componentmassfraction, oldcomponentmassfraction, temperature, oldtemperature, iteratedtemperature, fetemperature, oldfetemperature, iteratedfetemperature, iteratedcomponentmassfraction, fecomponentdensity, oldfecomponentdensity, iteratedfecomponentdensity, fecomponentmassfraction, oldfecomponentmassfraction, iteratedfecomponentmassfraction, pressure, fepressure, oldfepressure, cvpressure, oldcvpressure, cv_immobile_fraction, coordinate, velocitycoordinate, pressurecoordinate, materialcoordinate, cappressure, immobile_fraction, endpointrelperm, relpermexponent, cap_entry_pressure, cap_exponent, imbibition_term, concentration, oldconcentration, iteratedconcentration, feconcentration, oldfeconcentration, iteratedfeconcentration, enthalpy, oldenthalpy, iteratedenthalpy, feenthalpy, oldfeenthalpy, iteratedfeenthalpy)</td></tr>
<tr class="memdesc:ad4e108d42b18611e2908d988a6155b70"><td class="mdescLeft">&#160;</td><td class="mdescRight">@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of a variable stored in packed state All the input variables (but packed_stated) are pointers following the structure of the *_ALL variables and also all of them are optional, hence you can obtaine whichever you want  <br /></td></tr>
<tr class="separator:ad4e108d42b18611e2908d988a6155b70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6c28692d04b581272d173fcc445b3c7" id="r_ac6c28692d04b581272d173fcc445b3c7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ac6c28692d04b581272d173fcc445b3c7">printcsrmatrix</a> (matrix, find, col, dim_same_row)</td></tr>
<tr class="memdesc:ac6c28692d04b581272d173fcc445b3c7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine to print CSR matrix by (row, column) Dimensions and phases are printed in different rows So for example Matrix(2,2,10) with two rows would be presented as a matrix ( 8 x 10)  <br /></td></tr>
<tr class="separator:ac6c28692d04b581272d173fcc445b3c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c981b328d9950b1c375aaacaa3cda0" id="r_ab7c981b328d9950b1c375aaacaa3cda0"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0">is_constant</a> (tfield)</td></tr>
<tr class="memdesc:ab7c981b328d9950b1c375aaacaa3cda0"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Checks whether a field is constant or not  <br /></td></tr>
<tr class="separator:ab7c981b328d9950b1c375aaacaa3cda0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc850cced2fb9b525f015e758e4b45da" id="r_abc850cced2fb9b525f015e758e4b45da"><td class="memItemLeft" align="right" valign="top">character(len=field_name_len) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da">getoldname</a> (tfield)</td></tr>
<tr class="memdesc:abc850cced2fb9b525f015e758e4b45da"><td class="mdescLeft">&#160;</td><td class="mdescRight">: For a given field, retrieve the associated old field name  <br /></td></tr>
<tr class="separator:abc850cced2fb9b525f015e758e4b45da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac1305d6f3dc1c1ec92a4135ea55947b9" id="r_ac1305d6f3dc1c1ec92a4135ea55947b9"><td class="memItemLeft" align="right" valign="top">character(len=field_name_len) function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9">getfemname</a> (tfield)</td></tr>
<tr class="memdesc:ac1305d6f3dc1c1ec92a4135ea55947b9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: For a given field, retrieve the associated finite element field name  <br /></td></tr>
<tr class="separator:ac1305d6f3dc1c1ec92a4135ea55947b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab14ee9b4425c63a84854359e22ea1007" id="r_ab14ee9b4425c63a84854359e22ea1007"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007">calculate_internal_volume</a> (packed_state, mdims, mass_ele, calculate_mass, cv_ndgln, den_all, eles_with_pipe)</td></tr>
<tr class="memdesc:ab14ee9b4425c63a84854359e22ea1007"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine to calculate the integrated mass inside the domain  <br /></td></tr>
<tr class="separator:ab14ee9b4425c63a84854359e22ea1007"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acea2acdccf9091776be013ade24bcd97" id="r_acea2acdccf9091776be013ade24bcd97"><td class="memItemLeft" align="right" valign="top">logical function, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#acea2acdccf9091776be013ade24bcd97">have_option_for_any_phase</a> (path, nphase)</td></tr>
<tr class="memdesc:acea2acdccf9091776be013ade24bcd97"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine to check whether an option is true for any phase in diamond, if any is true it returns true. The path must be the part of the path inside the phase, i.e. /multiphase_properties/capillary_pressure  <br /></td></tr>
<tr class="separator:acea2acdccf9091776be013ade24bcd97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec4e2450672b43ae176fc5a459424126" id="r_aec4e2450672b43ae176fc5a459424126"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#aec4e2450672b43ae176fc5a459424126">get_darcyvelocity</a> (mdims, ndgln, state, packed_state, upwnd)</td></tr>
<tr class="memdesc:aec4e2450672b43ae176fc5a459424126"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine calculates the actual Darcy velocity, but with P0DG precision only!  <br /></td></tr>
<tr class="separator:aec4e2450672b43ae176fc5a459424126"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbfe914b0d919d92535a188ab7c0e384" id="r_adbfe914b0d919d92535a188ab7c0e384"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#adbfe914b0d919d92535a188ab7c0e384">dump_outflux</a> (current_time, itime, outfluxes)</td></tr>
<tr class="memdesc:adbfe914b0d919d92535a188ab7c0e384"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine that dumps the total flux at a given timestep across all specified boundaries to a file called 'simulation_name_outfluxes.csv'. In addition, the time integrated flux up to the current timestep is also outputted to this file. Integration boundaries are specified in diamond via surface_ids. (In diamond this option can be found under "/io/dump_boundaryflux/surface_ids" and the user should specify an integer array containing the IDs of every boundary they wish to integrate over).  <br /></td></tr>
<tr class="separator:adbfe914b0d919d92535a188ab7c0e384"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0358bf9293883d5a332167bc0558b985" id="r_a0358bf9293883d5a332167bc0558b985"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a0358bf9293883d5a332167bc0558b985">update_outfluxes</a> (bcs_outfluxes, outfluxes, sele, cv_nodi, suf_area, vol_flux, mass_flux, tracer, outfluxes_fields, start_phase, end_phase)</td></tr>
<tr class="memdesc:a0358bf9293883d5a332167bc0558b985"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a given GI point in a certain element This subroutine should only be called if SELE is on the BOUNDARY Example of Mass_flux: ndotq(iphase) * SdevFunsDETWEI(gi) * LIMT(iphase) Example of Vol_flux: ndotq(iphase) * SdevFunsDETWEI(gi) * LIMDT(iphase)  <br /></td></tr>
<tr class="separator:a0358bf9293883d5a332167bc0558b985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc3a3dde8f1e1a2af432f5475d43482e" id="r_adc3a3dde8f1e1a2af432f5475d43482e"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#adc3a3dde8f1e1a2af432f5475d43482e">enterforcebalanceequation</a> (entersolve, its, itime, acctim, t_adapt_threshold, after_adapt, after_adapt_itime, pvf_cfl)</td></tr>
<tr class="memdesc:adc3a3dde8f1e1a2af432f5475d43482e"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&ndash;A Subroutine that returns a Logical, either to Enter the Force Balance Eqs or Not = given a requested_cfl_pressure it will skip the ForceBalanceEquation that many times = while if I have adaptive mesh it will solve the ForceBalanceEquation after each adapt_time_steps = The Subroutive also account for delaying adaptivity and swich between cfl_pressure and after_adapt=  <br /></td></tr>
<tr class="separator:adc3a3dde8f1e1a2af432f5475d43482e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8739357084387e6b6fce7d59602dfd7" id="r_ab8739357084387e6b6fce7d59602dfd7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#ab8739357084387e6b6fce7d59602dfd7">impose_connected_bcs</a> (outfluxes, packed_state, mdims, acctime)</td></tr>
<tr class="memdesc:ab8739357084387e6b6fce7d59602dfd7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Using the outfluxes values, it imposes as BC the averaged value of another BC(from within the domain) It is a basic method to get this functionality but it will work in parallel. However, it does not guarantee mass conservation as it uses the value from the previous time-step although it can still be used for many cases such as ATES, or ventilation. Overwrites the dirichlet BC values. Currently it uses the information from outfluxes so it is MANDATORY to use and request outfluxes for those BCs  <br /></td></tr>
<tr class="separator:ab8739357084387e6b6fce7d59602dfd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d23340ebea84c65fde71abdf1444071" id="r_a4d23340ebea84c65fde71abdf1444071"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a4d23340ebea84c65fde71abdf1444071">getoutputconverter</a> (fieldname, factor, shft)</td></tr>
<tr class="memdesc:a4d23340ebea84c65fde71abdf1444071"><td class="mdescLeft">&#160;</td><td class="mdescRight">Returns the factor to convert from internal (SI) to the output system For temperature it returns the shift term not the factor.  <br /></td></tr>
<tr class="separator:a4d23340ebea84c65fde71abdf1444071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6fc8d031030fe04b455bd92ca32e4d08" id="r_a6fc8d031030fe04b455bd92ca32e4d08"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecopy__outof__state.html#a6fc8d031030fe04b455bd92ca32e4d08">converttooutunits</a> (state, mdims, convertback)</td></tr>
<tr class="memdesc:a6fc8d031030fe04b455bd92ca32e4d08"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Convert fields to out units. Also has a backwards options as we need to undo this after dumping the VTK files  <br /></td></tr>
<tr class="separator:a6fc8d031030fe04b455bd92ca32e4d08"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module enables the multiphase prototype code to interact with state by copying everything required from state to ICFERST, adaptive time-stepping, outfluxes computation, tunneled BCs and Darcy velocity. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a25b2882fb5f551e74ea186c313d5419d" name="a25b2882fb5f551e74ea186c313d5419d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25b2882fb5f551e74ea186c313d5419d">&#9670;&#160;</a></span>adaptive_nonlinear()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::adaptive_nonlinear </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>reference_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>itime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>repeat_time_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>exitnonlinearloop</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinearadaptts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>old_acctim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional&#160;</td>
          <td class="paramname"><em>calculate_mass_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>adapt_mesh_in_fpi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>accum_courant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>courant_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>current_courant</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>first_time_step</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonlinear iterations are going and depending on that increase the timestep or decreases the timestep and repeats that timestep </p>
<dl class="section author"><dt>Author</dt><dd>: Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list with the fields for ICFERST </td></tr>
    <tr><td class="paramname">reference_field</td><td>Field stored at the beginning of the non-linear loop to check convergence </td></tr>
    <tr><td class="paramname">old_acctim</td><td>Previous actual time </td></tr>
    <tr><td class="paramname">Repeat_time_step,ExitNonLinearLoop</td><td></td></tr>
    <tr><td class="paramname">its</td><td>Non-linear time iteration WARNING: not to be modified unless VERY sure </td></tr>
    <tr><td class="paramname">nonLinearAdaptTs</td><td>Flag controlling if we have adaptive time-step or not </td></tr>
    <tr><td class="paramname">order</td><td>Flag controlling what are we doing. 1)Store or get from backup; 2)Calculate and store reference_field; </td></tr>
    <tr><td class="paramname">adapt_mesh_in_FPI,first_time_step</td><td></td></tr>
    <tr><td class="paramname">Accum_Courant,Courant_tol,Current_Courant</td><td></td></tr>
    <tr><td class="paramname">calculate_mass_delta</td><td>1st item holds the mass at previous Linear time step, 2nd item is the delta between mass at the current FPI and 1st item </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_cgraph" id="anamespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_cgraph">
<area shape="rect" title=": This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonl..." alt="" coords="5,137,204,177"/>
<area shape="rect" href="namespacecopy__outof__state.html#a7d6957a54cc1cc0a38a4a7a90bca1f89" title=": We create a potential to optimize F = sum (f**2), so the solution is when this potential reaches a ..." alt="" coords="255,29,439,69"/>
<area shape="poly" title=" " alt="" coords="140,135,251,79,269,72,271,77,253,84,142,139"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="256,93,437,133"/>
<area shape="poly" title=" " alt="" coords="204,137,242,130,243,135,205,142"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad775c010bade229fba0416002e6928a6" title="Calculate the inf norm of the normalised field, so the field goes from 0 to 1 It requires as inputs t..." alt="" coords="252,181,441,221"/>
<area shape="poly" title=" " alt="" coords="205,173,239,179,238,184,204,178"/>
<area shape="rect" href="namespacemulti__tools.html#a1ab322da5f344e1d042fb429ebce3637" title=": Returns true if the input name is an Active Tracer type, Tracer, Species, Concentration or any othe..." alt="" coords="266,269,427,309"/>
<area shape="poly" title=" " alt="" coords="144,175,299,261,296,265,141,180"/>
<area shape="poly" title=" " alt="" coords="302,30,299,20,306,10,322,5,347,3,375,6,390,13,388,18,373,11,347,8,323,10,310,15,304,21,307,28"/>
<area shape="poly" title=" " alt="" coords="302,182,299,172,306,162,322,157,347,155,375,158,390,165,388,170,373,163,347,160,323,162,310,167,304,173,307,180"/>
<area shape="poly" title=" " alt="" coords="302,270,299,260,306,250,322,245,347,243,375,246,390,253,388,258,373,251,347,248,323,250,310,255,304,261,307,268"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_icgraph" id="anamespacecopy__outof__state_a25b2882fb5f551e74ea186c313d5419d_icgraph">
<area shape="rect" title=": This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonl..." alt="" coords="465,5,664,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="451,28,418,28,418,23,451,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a6bc946977b60a10ae77f86013eb499e7" name="a6bc946977b60a10ae77f86013eb499e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6bc946977b60a10ae77f86013eb499e7">&#9670;&#160;</a></span>as_packed_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(vector_field) function, public copy_outof_state::as_packed_vector </td>
          <td>(</td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tfield</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This function points a tensor field as a vector field type This is necessary when solving for tensor fields that are actually multiphase vector fields. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a6bc946977b60a10ae77f86013eb499e7_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a6bc946977b60a10ae77f86013eb499e7_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a6bc946977b60a10ae77f86013eb499e7_icgraph" id="anamespacecopy__outof__state_a6bc946977b60a10ae77f86013eb499e7_icgraph">
<area shape="rect" title=": This function points a tensor field as a vector field type This is necessary when solving for tenso..." alt="" coords="723,5,880,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="abfa3817b7e0890e5009c4905376a5688" name="abfa3817b7e0890e5009c4905376a5688"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abfa3817b7e0890e5009c4905376a5688">&#9670;&#160;</a></span>as_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">type(vector_field) function, public copy_outof_state::as_vector </td>
          <td>(</td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>slice</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This function points a tensor field as a vector field type This is necessary when solving for tensor fields that are actually multiphase vector fields. </p>

</div>
</div>
<a id="ab14ee9b4425c63a84854359e22ea1007" name="ab14ee9b4425c63a84854359e22ea1007"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab14ee9b4425c63a84854359e22ea1007">&#9670;&#160;</a></span>calculate_internal_volume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::calculate_internal_volume </td>
          <td>(</td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>calculate_mass</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Subroutine to calculate the integrated mass inside the domain </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packed_state</td><td></td></tr>
    <tr><td class="paramname">Mdims</td><td></td></tr>
    <tr><td class="paramname">mass_ele</td><td>volume of the element, split into cv_nloc equally sized pieces (barycenter) </td></tr>
    <tr><td class="paramname">cv_ndgln</td><td>local to global of the CV mesh only </td></tr>
    <tr><td class="paramname">DEN_ALL</td><td>density of the field </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>list of element that contain a well/pipe </td></tr>
  </table>
  </dd>
</dl>
<dl class="retval"><dt>Return values</dt><dd>
  <table class="retval">
    <tr><td class="paramname">calculate_mass</td><td>Output field containing all the mass within the domain </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ab14ee9b4425c63a84854359e22ea1007_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_ab14ee9b4425c63a84854359e22ea1007_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ab14ee9b4425c63a84854359e22ea1007_icgraph" id="anamespacecopy__outof__state_ab14ee9b4425c63a84854359e22ea1007_icgraph">
<area shape="rect" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="1507,208,1708,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="abba0b467480d0b56c11d18f70e8c680e" name="abba0b467480d0b56c11d18f70e8c680e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abba0b467480d0b56c11d18f70e8c680e">&#9670;&#160;</a></span>compute_node_global_numbers()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::compute_node_global_numbers </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>ndgln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine calculates the global node numbers requested to operates in ICFERST. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_cgraph" id="anamespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_cgraph">
<area shape="rect" title="This subroutine calculates the global node numbers requested to operates in ICFERST." alt="" coords="5,5,204,45"/>
<area shape="rect" href="namespacemulti__tools.html#a29b23492be133b01a7eb9bce13adbdfb" title=" " alt="" coords="252,13,427,38"/>
<area shape="poly" title=" " alt="" coords="204,23,238,23,238,28,204,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_icgraph" id="anamespacecopy__outof__state_abba0b467480d0b56c11d18f70e8c680e_icgraph">
<area shape="rect" title="This subroutine calculates the global node numbers requested to operates in ICFERST." alt="" coords="465,5,664,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="451,28,418,28,418,23,451,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a6fc8d031030fe04b455bd92ca32e4d08" name="a6fc8d031030fe04b455bd92ca32e4d08"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6fc8d031030fe04b455bd92ca32e4d08">&#9670;&#160;</a></span>converttooutunits()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::converttooutunits </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>convertback</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Convert fields to out units. Also has a backwards options as we need to undo this after dumping the VTK files </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a6fc8d031030fe04b455bd92ca32e4d08_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_a6fc8d031030fe04b455bd92ca32e4d08_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a6fc8d031030fe04b455bd92ca32e4d08_cgraph" id="anamespacecopy__outof__state_a6fc8d031030fe04b455bd92ca32e4d08_cgraph">
<area shape="rect" title=": Convert fields to out units. Also has a backwards options as we need to undo this after dumping the..." alt="" coords="5,5,263,31"/>
<area shape="rect" href="namespacecopy__outof__state.html#a4d23340ebea84c65fde71abdf1444071" title="Returns the factor to convert from internal (SI) to the output system For temperature it returns the ..." alt="" coords="311,5,577,31"/>
<area shape="poly" title=" " alt="" coords="263,15,297,15,297,21,263,21"/>
</map>
</div>

</div>
</div>
<a id="adbfe914b0d919d92535a188ab7c0e384" name="adbfe914b0d919d92535a188ab7c0e384"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adbfe914b0d919d92535a188ab7c0e384">&#9670;&#160;</a></span>dump_outflux()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::dump_outflux </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>outfluxes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Subroutine that dumps the total flux at a given timestep across all specified boundaries to a file called 'simulation_name_outfluxes.csv'. In addition, the time integrated flux up to the current timestep is also outputted to this file. Integration boundaries are specified in diamond via surface_ids. (In diamond this option can be found under "/io/dump_boundaryflux/surface_ids" and the user should specify an integer array containing the IDs of every boundary they wish to integrate over). </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">current_time</td><td>actual time </td></tr>
    <tr><td class="paramname">itime</td><td>time-level in integer format </td></tr>
    <tr><td class="paramname">outfluxes</td><td>multi_outfluxes field containing the data required to create the output csv file </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_cgraph" id="anamespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_cgraph">
<area shape="rect" title=": Subroutine that dumps the total flux at a given timestep across all specified boundaries to a file ..." alt="" coords="5,5,184,45"/>
<area shape="rect" href="namespacecopy__outof__state.html#a4d23340ebea84c65fde71abdf1444071" title="Returns the factor to convert from internal (SI) to the output system For temperature it returns the ..." alt="" coords="232,13,499,38"/>
<area shape="poly" title=" " alt="" coords="184,23,218,23,218,28,184,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_icgraph" id="anamespacecopy__outof__state_adbfe914b0d919d92535a188ab7c0e384_icgraph">
<area shape="rect" title=": Subroutine that dumps the total flux at a given timestep across all specified boundaries to a file ..." alt="" coords="465,5,644,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="451,28,418,28,418,23,451,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="adc3a3dde8f1e1a2af432f5475d43482e" name="adc3a3dde8f1e1a2af432f5475d43482e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc3a3dde8f1e1a2af432f5475d43482e">&#9670;&#160;</a></span>enterforcebalanceequation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::enterforcebalanceequation </td>
          <td>(</td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>entersolve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>itime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>acctim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>t_adapt_threshold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>after_adapt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>after_adapt_itime</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>pvf_cfl</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:&ndash;A Subroutine that returns a Logical, either to Enter the Force Balance Eqs or Not = given a requested_cfl_pressure it will skip the ForceBalanceEquation that many times = while if I have adaptive mesh it will solve the ForceBalanceEquation after each adapt_time_steps = The Subroutive also account for delaying adaptivity and swich between cfl_pressure and after_adapt= </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_adc3a3dde8f1e1a2af432f5475d43482e_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_adc3a3dde8f1e1a2af432f5475d43482e_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_adc3a3dde8f1e1a2af432f5475d43482e_icgraph" id="anamespacecopy__outof__state_adc3a3dde8f1e1a2af432f5475d43482e_icgraph">
<area shape="rect" title=":A Subroutine that returns a Logical, either to Enter the Force Balance Eqs or Not = given a request..." alt="" coords="465,13,783,38"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a60ec84623fb582762f2139794470ba13" name="a60ec84623fb582762f2139794470ba13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60ec84623fb582762f2139794470ba13">&#9670;&#160;</a></span>finalise_multistate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::finalise_multistate </td>
          <td>(</td>
          <td class="paramtype">type(state_type)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), pointer&#160;</td>
          <td class="paramname"><em>multiphase_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), pointer&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Destrys packed_state and the passed down states </p>

</div>
</div>
<a id="a7d6957a54cc1cc0a38a4a7a90bca1f89" name="a7d6957a54cc1cc0a38a4a7a90bca1f89"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6957a54cc1cc0a38a4a7a90bca1f89">&#9670;&#160;</a></span>get_convergence_functional()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public copy_outof_state::get_convergence_functional </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>phasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>reference_sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: We create a potential to optimize F = sum (f**2), so the solution is when this potential reaches a minimum. Typically the value to consider convergence is the sqrt(epsilon of the machine), i.e. 10^-8 f = (NewSat-OldSat)/Number of nodes; this is the typical approach for algebraic non linear systems </p>
<p>The convergence is independent of the dumping parameter and measures how the previous iteration (i.e. using the previous dumping parameter) performed </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_cgraph" id="anamespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_cgraph">
<area shape="rect" title=": We create a potential to optimize F = sum (f**2), so the solution is when this potential reaches a ..." alt="" coords="5,29,189,69"/>
<area shape="poly" title=" " alt="" coords="62,30,60,20,66,11,78,5,97,3,119,6,131,13,128,17,117,11,97,8,80,10,69,15,66,21,68,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_icgraph" id="anamespacecopy__outof__state_a7d6957a54cc1cc0a38a4a7a90bca1f89_icgraph">
<area shape="rect" title=": We create a potential to optimize F = sum (f**2), so the solution is when this potential reaches a ..." alt="" coords="953,39,1137,79"/>
<area shape="poly" title=" " alt="" coords="1081,27,1069,20,1045,17,1025,19,1013,24,1008,30,1010,38,1005,39,1003,29,1009,20,1024,14,1045,12,1070,15,1084,22"/>
<area shape="rect" href="namespacecopy__outof__state.html#a25b2882fb5f551e74ea186c313d5419d" title=": This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonl..." alt="" coords="487,5,685,45"/>
<area shape="poly" title=" " alt="" coords="940,54,685,35,686,30,940,48"/>
<area shape="rect" href="namespacesolvers__module.html#aa6838cee9b9a7eb08de040686134a9ed" title=":In this subroutine we applied some corrections and backtrack_par on the saturations obtained from th..." alt="" coords="755,67,905,107"/>
<area shape="poly" title=" " alt="" coords="940,75,906,80,905,74,939,70"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,37,417,77"/>
<area shape="poly" title=" " alt="" coords="474,41,418,48,417,43,473,36"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,37,171,77"/>
<area shape="poly" title=" " alt="" coords="205,60,171,60,171,55,205,55"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,69,707,109"/>
<area shape="poly" title=" " alt="" coords="741,90,707,91,707,85,741,85"/>
<area shape="poly" title=" " alt="" coords="451,76,417,72,418,67,452,71"/>
</map>
</div>

</div>
</div>
<a id="aec4e2450672b43ae176fc5a459424126" name="aec4e2450672b43ae176fc5a459424126"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec4e2450672b43ae176fc5a459424126">&#9670;&#160;</a></span>get_darcyvelocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::get_darcyvelocity </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(in)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine calculates the actual Darcy velocity, but with P0DG precision only! </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_aec4e2450672b43ae176fc5a459424126_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_aec4e2450672b43ae176fc5a459424126_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_aec4e2450672b43ae176fc5a459424126_icgraph" id="anamespacecopy__outof__state_aec4e2450672b43ae176fc5a459424126_icgraph">
<area shape="rect" title=": This subroutine calculates the actual Darcy velocity, but with P0DG precision only!" alt="" coords="755,5,917,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="741,25,707,24,465,24,418,25,417,20,465,19,707,19,741,19"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,33,707,73"/>
<area shape="poly" title=" " alt="" coords="741,39,707,42,706,37,741,33"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
<area shape="poly" title=" " alt="" coords="451,42,417,38,418,33,452,37"/>
</map>
</div>

</div>
</div>
<a id="a977c4aa970124056f8138a72ed4a1612" name="a977c4aa970124056f8138a72ed4a1612"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a977c4aa970124056f8138a72ed4a1612">&#9670;&#160;</a></span>get_discretisation_options()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::get_discretisation_options </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine extract all discretisation options from the schema DISOPT Options: =0 1st order in space Theta=specified UNIVERSAL =1 1st order in space Theta=non-linear UNIVERSAL =2 Trapezoidal rule in space Theta=specified UNIVERSAL =2 if isotropic limiter then FEM-quadratic &amp; stratification adjust. Theta=non-linear =3 Trapezoidal rule in space Theta=non-linear UNIVERSAL =4 Finite elements in space Theta=specified UNIVERSAL =5 Finite elements in space Theta=non-linear UNIVERSAL =6 Finite elements in space Theta=specified NONE =7 Finite elements in space Theta=non-linear NONE =8 Finite elements in space Theta=specified DOWNWIND+INTERFACE TRACKING =9 Finite elements in space Theta=non-linear DOWNWIND+INTERFACE TRACKING </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a977c4aa970124056f8138a72ed4a1612_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a977c4aa970124056f8138a72ed4a1612_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a977c4aa970124056f8138a72ed4a1612_icgraph" id="anamespacecopy__outof__state_a977c4aa970124056f8138a72ed4a1612_icgraph">
<area shape="rect" title=": This subroutine extract all discretisation options from the schema DISOPT Options: =0 1st order in ..." alt="" coords="465,5,637,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="451,28,417,28,417,23,451,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a25e9236f15044530da105400e0e3e3f4" name="a25e9236f15044530da105400e0e3e3f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25e9236f15044530da105400e0e3e3f4">&#9670;&#160;</a></span>get_ele_type()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::get_ele_type </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>cv_ele_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>p_ele_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>u_ele_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout), optional&#160;</td>
          <td class="paramname"><em>mat_ele_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout), optional&#160;</td>
          <td class="paramname"><em>u_sele_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout), optional&#160;</td>
          <td class="paramname"><em>cv_sele_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Obtain the type of element u_ele_type = cv_ele_type = p_ele_type will flag the dimension and type of element: = 1 or 2: 1D (linear and quadratic, respectively) -NOT SUPPORTED- = 3 or 4: triangle (linear or quadratic, respectively) = 5 or 6: quadrilateral (bi-linear or tri-linear, respectively)-NOT SUPPORTED- = 7 or 8: tetrahedron (linear or quadratic, respectively) = 9 or 10: hexahedron (bi-linear or tri-linear, respectively) -NOT SUPPORTED- </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a25e9236f15044530da105400e0e3e3f4_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a25e9236f15044530da105400e0e3e3f4_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a25e9236f15044530da105400e0e3e3f4_icgraph" id="anamespacecopy__outof__state_a25e9236f15044530da105400e0e3e3f4_icgraph">
<area shape="rect" title=": Obtain the type of element u_ele_type = cv_ele_type = p_ele_type will flag the dimension and type o..." alt="" coords="465,5,628,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,418,28,418,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a8c8ae22869d79032fd250ea6cc0651c9" name="a8c8ae22869d79032fd250ea6cc0651c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c8ae22869d79032fd250ea6cc0651c9">&#9670;&#160;</a></span>get_ele_type_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::get_ele_type_new </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Obtains the element type Mdisoptu_ele_type = Mdisoptcv_ele_type = Mdisoptp_ele_type will flag the dimension and type of element: = 1 or 2: 1D (linear and quadratic, respectively) -NOT SUPPORTED- = 3 or 4: triangle (linear or quadratic, respectively) = 5 or 6: quadrilateral (bi-linear or tri-linear, respectively) -NOT SUPPORTED- = 7 or 8: tetrahedron (linear or quadratic, respectively) = 9 or 10: hexahedron (bi-linear or tri-linear, respectively) -NOT SUPPORTED- </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a8c8ae22869d79032fd250ea6cc0651c9_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a8c8ae22869d79032fd250ea6cc0651c9_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a8c8ae22869d79032fd250ea6cc0651c9_icgraph" id="anamespacecopy__outof__state_a8c8ae22869d79032fd250ea6cc0651c9_icgraph">
<area shape="rect" title=": Obtains the element type Mdisoptu_ele_type = Mdisoptcv_ele_type = Mdisoptp_ele_type will flag the d..." alt="" coords="465,5,628,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,418,28,418,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a60bda55d8fe3fd82eed3fbb6c17cd8be" name="a60bda55d8fe3fd82eed3fbb6c17cd8be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a60bda55d8fe3fd82eed3fbb6c17cd8be">&#9670;&#160;</a></span>get_primary_scalars_new()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::get_primary_scalars_new </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>)&#160;</td>
          <td class="paramname"><em>mdims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine extracts all primary variables associated with the mesh from state, and associated them with the variables used in the MultiFluids model. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a60bda55d8fe3fd82eed3fbb6c17cd8be_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a60bda55d8fe3fd82eed3fbb6c17cd8be_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a60bda55d8fe3fd82eed3fbb6c17cd8be_icgraph" id="anamespacecopy__outof__state_a60bda55d8fe3fd82eed3fbb6c17cd8be_icgraph">
<area shape="rect" title="This subroutine extracts all primary variables associated with the mesh from state,..." alt="" coords="465,5,632,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="451,28,417,28,417,23,451,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="ad4e108d42b18611e2908d988a6155b70" name="ad4e108d42b18611e2908d988a6155b70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4e108d42b18611e2908d988a6155b70">&#9670;&#160;</a></span>get_var_from_packed_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::get_var_from_packed_state </td>
          <td>(</td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>fedensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfedensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfedensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>olddensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iterateddensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>phasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldphasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedphasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>fephasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfephasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfephasevolumefraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>nonlinearvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldnonlinearvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratednonlinearvelocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>componentdensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldcomponentdensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedcomponentdensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>componentmassfraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldcomponentmassfraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldtemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedtemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>fetemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfetemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfetemperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedcomponentmassfraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>fecomponentdensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfecomponentdensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfecomponentdensity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>fecomponentmassfraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfecomponentmassfraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfecomponentmassfraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>fepressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfepressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>cvpressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldcvpressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>cv_immobile_fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>coordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>velocitycoordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>pressurecoordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>materialcoordinate</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>cappressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>immobile_fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>endpointrelperm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>relpermexponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>cap_entry_pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>cap_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>imbibition_term</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>concentration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldconcentration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedconcentration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>feconcentration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfeconcentration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfeconcentration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>enthalpy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldenthalpy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedenthalpy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>feenthalpy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>oldfeenthalpy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>iteratedfeenthalpy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of a variable stored in packed state All the input variables (but packed_stated) are pointers following the structure of the *_ALL variables and also all of them are optional, hence you can obtaine whichever you want </p>
<h6>################EXAMPLE OF USAGE OF THIS SUBROUTINE:</h6>
<p>If we want to get the velocity and the phasevolumefraction one should proceed this way: Define variables: real, dimension(:,:,:), pointer :: Velocity_pointer real, dimension(:,:), pointer :: PhaseVolumeFraction_pointer Assign the pointers call get_var_from_packed_state(packed_state, Velocity = Velocity_pointer, PhaseVolumeFraction = PhaseVolumeFraction_pointer)</p>
<p>In this way we only have to introduce the name of the variables we want to get from packed_state </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ad4e108d42b18611e2908d988a6155b70_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_ad4e108d42b18611e2908d988a6155b70_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ad4e108d42b18611e2908d988a6155b70_icgraph" id="anamespacecopy__outof__state_ad4e108d42b18611e2908d988a6155b70_icgraph">
<area shape="rect" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="1639,267,1820,307"/>
<area shape="rect" href="namespacecopy__outof__state.html#a25b2882fb5f551e74ea186c313d5419d" title=": This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonl..." alt="" coords="773,7,971,47"/>
<area shape="poly" title=" " alt="" coords="1712,256,1692,219,1665,177,1631,137,1589,105,1513,69,1431,42,1346,24,1262,14,1180,9,1102,9,972,16,972,11,1102,3,1180,3,1262,8,1347,19,1432,37,1515,64,1592,101,1635,133,1670,174,1697,216,1716,253"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="1037,159,1229,199"/>
<area shape="poly" title=" " alt="" coords="1624,274,1461,247,1277,214,1220,202,1221,196,1278,208,1462,242,1625,269"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,208,685,262"/>
<area shape="poly" title=" " alt="" coords="1706,257,1686,229,1659,199,1626,171,1590,149,1554,138,1513,129,1413,120,1299,120,1177,128,1054,141,938,157,755,190,682,210,681,205,754,184,938,152,1054,136,1176,123,1299,115,1413,115,1513,124,1556,133,1592,145,1629,166,1662,195,1690,226,1711,254"/>
<area shape="rect" href="namespacemulti__sp.html#a0bfcd312d07ac4982048c03a3980c5e6" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="797,71,947,111"/>
<area shape="poly" title=" " alt="" coords="1625,298,1501,300,1351,292,1271,281,1190,265,1111,243,1036,213,994,190,955,164,893,113,897,109,958,159,997,186,1038,209,1113,238,1191,260,1271,276,1351,287,1501,295,1625,293"/>
<area shape="rect" href="namespacesolvers__module.html#ac9869d27925198c5c3a95232b79cbb97" title="The sparcity of the local CV connectivity is in: small_findrm, small_colm. ngl_its=max no of global i..." alt="" coords="1277,658,1591,684"/>
<area shape="poly" title=" " alt="" coords="1728,321,1717,389,1694,474,1676,519,1654,563,1626,603,1592,638,1574,651,1553,661,1551,656,1571,647,1589,634,1622,600,1649,560,1671,517,1689,473,1712,387,1722,320"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1339,446,1529,472"/>
<area shape="poly" title=" " alt="" coords="1689,317,1592,379,1462,449,1460,444,1589,374,1686,313"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,452,707,492"/>
<area shape="poly" title=" " alt="" coords="1718,321,1700,361,1673,407,1637,452,1616,471,1592,487,1531,516,1467,539,1401,557,1334,569,1265,577,1197,580,1062,576,935,561,820,540,722,516,648,495,649,490,724,511,821,535,936,556,1063,570,1197,574,1265,571,1333,564,1400,552,1465,534,1529,511,1589,482,1612,467,1633,448,1669,404,1695,359,1714,319"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="1323,324,1545,364"/>
<area shape="poly" title=" " alt="" coords="1626,310,1538,327,1537,322,1625,305"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="1343,159,1525,199"/>
<area shape="poly" title=" " alt="" coords="1680,263,1637,240,1590,220,1525,200,1526,195,1592,215,1639,236,1683,258"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,338,417,378"/>
<area shape="poly" title=" " alt="" coords="759,38,689,50,613,69,537,98,501,117,467,138,441,161,417,186,377,242,348,296,329,339,324,337,343,294,372,239,413,183,437,157,464,134,498,112,534,93,611,64,688,45,759,33"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,338,171,378"/>
<area shape="poly" title=" " alt="" coords="205,360,171,360,171,355,205,355"/>
<area shape="poly" title=" " alt="" coords="1024,193,686,228,685,222,1023,188"/>
<area shape="poly" title=" " alt="" coords="499,270,466,284,357,340,354,335,464,279,497,265"/>
<area shape="poly" title=" " alt="" coords="784,101,712,112,630,131,546,159,467,197,424,230,386,269,334,339,330,336,382,265,420,226,464,193,544,154,629,126,711,107,783,96"/>
<area shape="rect" href="namespacemulti__interpolation.html#a1bbe85c775a5dcbd634c33cb5414f944" title="Mehs to mesh interpollation method, in Diamond DG_Galerkin." alt="" coords="799,655,945,695"/>
<area shape="poly" title=" " alt="" coords="1264,675,946,677,946,672,1264,670"/>
<area shape="poly" title=" " alt="" coords="785,677,711,670,628,654,542,627,502,608,464,585,436,563,412,536,371,479,342,423,324,379,329,377,347,420,376,476,416,533,440,559,467,581,504,604,544,622,629,649,712,664,785,671"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="481,531,691,571"/>
<area shape="poly" title=" " alt="" coords="1369,477,1230,504,1084,522,937,535,691,550,691,545,937,530,1083,517,1229,499,1368,472"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1041,324,1225,364"/>
<area shape="poly" title=" " alt="" coords="1386,444,1186,367,1188,362,1388,439"/>
<area shape="poly" title=" " alt="" coords="1355,477,1230,494,1089,500,948,499,707,486,707,481,949,494,1089,495,1229,488,1355,472"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1043,439,1223,479"/>
<area shape="poly" title=" " alt="" coords="1326,462,1224,462,1224,456,1326,456"/>
<area shape="poly" title=" " alt="" coords="505,528,464,507,423,476,387,441,333,380,337,376,391,437,427,472,467,502,508,524"/>
<area shape="poly" title=" " alt="" coords="1028,332,989,328,842,321,727,322,613,329,466,342,418,347,417,341,465,336,612,324,727,316,842,316,990,323,1028,326"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,338,989,378"/>
<area shape="poly" title=" " alt="" coords="1028,352,990,354,989,349,1028,347"/>
<area shape="poly" title=" " alt="" coords="741,360,417,360,417,355,741,355"/>
<area shape="poly" title=" " alt="" coords="810,334,650,265,652,260,812,329"/>
<area shape="poly" title=" " alt="" coords="809,385,638,455,636,450,807,381"/>
<area shape="poly" title=" " alt="" coords="502,450,464,436,405,408,353,380,355,375,407,403,466,431,504,445"/>
<area shape="poly" title=" " alt="" coords="1029,449,417,373,418,367,1030,444"/>
<area shape="poly" title=" " alt="" coords="1383,320,1170,202,1172,197,1386,315"/>
<area shape="poly" title=" " alt="" coords="1309,327,1229,315,932,277,685,248,686,243,933,272,1230,310,1310,322"/>
<area shape="poly" title=" " alt="" coords="1309,347,1226,347,1226,342,1309,342"/>
<area shape="poly" title=" " alt="" coords="1310,366,1230,379,707,457,706,452,1229,374,1309,361"/>
<area shape="poly" title=" " alt="" coords="1369,372,1188,441,1186,436,1367,367"/>
<area shape="poly" title=" " alt="" coords="1329,182,1230,182,1230,176,1329,176"/>
</map>
</div>

</div>
</div>
<a id="ac1305d6f3dc1c1ec92a4135ea55947b9" name="ac1305d6f3dc1c1ec92a4135ea55947b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac1305d6f3dc1c1ec92a4135ea55947b9">&#9670;&#160;</a></span>getfemname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character (len=field_name_len) function, public copy_outof_state::getfemname </td>
          <td>(</td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>tfield</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: For a given field, retrieve the associated finite element field name </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ac1305d6f3dc1c1ec92a4135ea55947b9_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_ac1305d6f3dc1c1ec92a4135ea55947b9_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ac1305d6f3dc1c1ec92a4135ea55947b9_icgraph" id="anamespacecopy__outof__state_ac1305d6f3dc1c1ec92a4135ea55947b9_icgraph">
<area shape="rect" title=": For a given field, retrieve the associated finite element field name" alt="" coords="1507,215,1733,241"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="abc850cced2fb9b525f015e758e4b45da" name="abc850cced2fb9b525f015e758e4b45da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc850cced2fb9b525f015e758e4b45da">&#9670;&#160;</a></span>getoldname()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">character (len=field_name_len) function, public copy_outof_state::getoldname </td>
          <td>(</td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>tfield</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: For a given field, retrieve the associated old field name </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_abc850cced2fb9b525f015e758e4b45da_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_abc850cced2fb9b525f015e758e4b45da_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_abc850cced2fb9b525f015e758e4b45da_icgraph" id="anamespacecopy__outof__state_abc850cced2fb9b525f015e758e4b45da_icgraph">
<area shape="rect" title=": For a given field, retrieve the associated old field name" alt="" coords="1507,182,1727,207"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,125,1459,150"/>
<area shape="poly" title=" " alt="" coords="1546,182,1420,153,1421,147,1547,176"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="1273,203,1455,243"/>
<area shape="poly" title=" " alt="" coords="1493,211,1456,215,1455,210,1493,206"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,60,977,100"/>
<area shape="poly" title=" " alt="" coords="1255,126,1221,121,977,94,977,88,1222,116,1256,120"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,175,1221,215"/>
<area shape="poly" title=" " alt="" coords="1299,156,1212,177,1211,172,1297,151"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,117,707,157"/>
<area shape="poly" title=" " alt="" coords="1256,140,707,140,707,135,1256,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,5,1219,45"/>
<area shape="poly" title=" " alt="" coords="1325,120,1220,68,1176,48,1179,43,1222,63,1327,116"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,80,615,86,540,94,466,108,409,126,358,149,356,144,407,122,465,103,539,89,615,80,754,74"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1043,220,990,229,911,235,830,237,671,228,527,210,411,189,412,184,528,204,672,222,830,231,911,230,989,224,1042,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,175,989,215"/>
<area shape="poly" title=" " alt="" coords="1024,197,990,197,990,192,1024,192"/>
<area shape="poly" title=" " alt="" coords="741,191,417,174,418,169,741,185"/>
<area shape="poly" title=" " alt="" coords="758,175,686,160,687,155,759,169"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,286,685,341"/>
<area shape="poly" title=" " alt="" coords="811,223,654,288,652,284,809,218"/>
<area shape="poly" title=" " alt="" coords="452,155,418,158,417,153,451,149"/>
<area shape="poly" title=" " alt="" coords="493,283,464,269,398,228,344,189,347,185,401,224,467,264,496,278"/>
<area shape="poly" title=" " alt="" coords="1025,19,909,16,767,20,691,27,615,38,539,53,466,75,431,90,397,109,344,149,341,144,395,105,428,85,464,69,538,48,614,32,691,21,767,14,909,10,1026,14"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="776,289,968,329"/>
<area shape="poly" title=" " alt="" coords="1259,244,969,295,968,290,1258,238"/>
<area shape="poly" title=" " alt="" coords="762,314,685,315,685,309,762,308"/>
</map>
</div>

</div>
</div>
<a id="a4d23340ebea84c65fde71abdf1444071" name="a4d23340ebea84c65fde71abdf1444071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d23340ebea84c65fde71abdf1444071">&#9670;&#160;</a></span>getoutputconverter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::getoutputconverter </td>
          <td>(</td>
          <td class="paramtype">character( len = * ), intent(in)&#160;</td>
          <td class="paramname"><em>fieldname</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>factor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>shft</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Returns the factor to convert from internal (SI) to the output system For temperature it returns the shift term not the factor. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a4d23340ebea84c65fde71abdf1444071_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a4d23340ebea84c65fde71abdf1444071_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a4d23340ebea84c65fde71abdf1444071_icgraph" id="anamespacecopy__outof__state_a4d23340ebea84c65fde71abdf1444071_icgraph">
<area shape="rect" title="Returns the factor to convert from internal (SI) to the output system For temperature it returns the ..." alt="" coords="771,35,1037,60"/>
<area shape="rect" href="namespacecopy__outof__state.html#a6fc8d031030fe04b455bd92ca32e4d08" title=": Convert fields to out units. Also has a backwards options as we need to undo this after dumping the..." alt="" coords="465,5,723,31"/>
<area shape="poly" title=" " alt="" coords="757,36,723,33,723,28,757,31"/>
<area shape="rect" href="namespacecopy__outof__state.html#adbfe914b0d919d92535a188ab7c0e384" title=": Subroutine that dumps the total flux at a given timestep across all specified boundaries to a file ..." alt="" coords="505,55,683,95"/>
<area shape="poly" title=" " alt="" coords="757,63,684,70,683,65,757,58"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,55,417,95"/>
<area shape="poly" title=" " alt="" coords="491,78,418,78,418,73,491,73"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,55,171,95"/>
<area shape="poly" title=" " alt="" coords="205,78,171,78,171,73,205,73"/>
</map>
</div>

</div>
</div>
<a id="acea2acdccf9091776be013ade24bcd97" name="acea2acdccf9091776be013ade24bcd97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acea2acdccf9091776be013ade24bcd97">&#9670;&#160;</a></span>have_option_for_any_phase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public copy_outof_state::have_option_for_any_phase </td>
          <td>(</td>
          <td class="paramtype">character (len=*), intent(in)&#160;</td>
          <td class="paramname"><em>path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Subroutine to check whether an option is true for any phase in diamond, if any is true it returns true. The path must be the part of the path inside the phase, i.e. /multiphase_properties/capillary_pressure </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_cgraph" id="anamespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_cgraph">
<area shape="rect" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="5,29,180,69"/>
<area shape="poly" title=" " alt="" coords="60,30,58,20,63,11,75,5,93,3,113,6,124,13,122,17,111,11,93,8,76,10,67,15,63,21,65,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_icgraph" id="anamespacecopy__outof__state_acea2acdccf9091776be013ade24bcd97_icgraph">
<area shape="rect" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="1512,105,1687,145"/>
<area shape="poly" title=" " alt="" coords="1639,94,1625,87,1599,84,1577,86,1564,91,1559,97,1561,104,1556,106,1553,96,1560,86,1576,81,1599,79,1626,82,1641,89"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1550,101,1509,82,1463,67,1334,42,1203,28,1080,23,977,24,977,18,1080,18,1203,23,1335,37,1465,61,1511,77,1552,96"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,193,417,233"/>
<area shape="poly" title=" " alt="" coords="1498,114,1326,95,1228,88,1131,85,871,85,799,89,726,97,586,127,462,163,370,196,368,191,461,158,584,122,725,92,798,83,871,80,1131,80,1229,83,1327,89,1498,108"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="1269,159,1464,199"/>
<area shape="poly" title=" " alt="" coords="1499,151,1455,161,1454,156,1498,146"/>
<area shape="rect" href="namespacecopy__outof__state.html#afca89971343f6586b89f1cddda00b2c8" title=": This subroutine creates packed_state from state(:) and links the appropiate memory so it is acessib..." alt="" coords="1280,309,1453,349"/>
<area shape="poly" title=" " alt="" coords="1567,157,1393,311,1389,307,1563,153"/>
<area shape="poly" title=" " alt="" coords="753,18,686,19,612,26,537,41,467,66,423,94,386,129,356,164,334,195,330,191,352,161,382,125,420,90,464,62,536,35,611,20,685,14,753,13"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,193,171,233"/>
<area shape="poly" title=" " alt="" coords="205,216,171,216,171,211,205,211"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,159,1221,199"/>
<area shape="poly" title=" " alt="" coords="1256,181,1221,181,1221,176,1256,176"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,268,1219,308"/>
<area shape="poly" title=" " alt="" coords="1311,207,1175,270,1173,265,1309,202"/>
<area shape="poly" title=" " alt="" coords="1024,179,769,179,617,183,466,193,418,199,417,194,465,188,617,178,769,173,1024,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,196,989,236"/>
<area shape="poly" title=" " alt="" coords="1024,197,990,202,989,196,1023,191"/>
<area shape="poly" title=" " alt="" coords="741,213,707,212,465,212,418,213,417,208,465,207,707,207,741,208"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,221,707,261"/>
<area shape="poly" title=" " alt="" coords="741,230,707,233,707,228,741,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,286,685,341"/>
<area shape="poly" title=" " alt="" coords="802,243,708,276,670,288,669,283,706,271,800,238"/>
<area shape="poly" title=" " alt="" coords="451,230,417,226,418,221,452,225"/>
<area shape="poly" title=" " alt="" coords="487,284,464,276,365,236,367,231,466,271,488,279"/>
<area shape="poly" title=" " alt="" coords="1066,315,950,351,877,369,798,382,714,390,629,390,545,378,464,354,421,330,383,298,352,264,330,235,335,232,356,260,387,294,424,326,466,350,546,373,630,384,714,385,797,377,876,364,949,346,1064,310"/>
<area shape="poly" title=" " alt="" coords="1303,357,1235,380,1148,406,1046,430,934,449,816,458,695,455,636,448,577,436,519,419,464,396,438,381,415,362,375,317,345,272,326,235,331,232,350,269,379,314,418,358,441,376,467,391,521,414,578,431,636,443,696,450,816,453,934,443,1045,424,1147,400,1233,375,1301,352"/>
</map>
</div>

</div>
</div>
<a id="ab8739357084387e6b6fce7d59602dfd7" name="ab8739357084387e6b6fce7d59602dfd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8739357084387e6b6fce7d59602dfd7">&#9670;&#160;</a></span>impose_connected_bcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::impose_connected_bcs </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(in)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>acctime</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Using the outfluxes values, it imposes as BC the averaged value of another BC(from within the domain) It is a basic method to get this functionality but it will work in parallel. However, it does not guarantee mass conservation as it uses the value from the previous time-step although it can still be used for many cases such as ATES, or ventilation. Overwrites the dirichlet BC values. Currently it uses the information from outfluxes so it is MANDATORY to use and request outfluxes for those BCs </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ab8739357084387e6b6fce7d59602dfd7_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_ab8739357084387e6b6fce7d59602dfd7_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ab8739357084387e6b6fce7d59602dfd7_icgraph" id="anamespacecopy__outof__state_ab8739357084387e6b6fce7d59602dfd7_icgraph">
<area shape="rect" title=": Using the outfluxes values, it imposes as BC the averaged value of another BC(from within the domai..." alt="" coords="465,5,656,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="451,28,418,28,418,23,451,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="ad775c010bade229fba0416002e6928a6" name="ad775c010bade229fba0416002e6928a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad775c010bade229fba0416002e6928a6">&#9670;&#160;</a></span>inf_norm_scalar_normalised()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, public copy_outof_state::inf_norm_scalar_normalised </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>reference_tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dumping</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(in)&#160;</td>
          <td class="paramname"><em>totally_min_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate the inf norm of the normalised field, so the field goes from 0 to 1 It requires as inputs the tracer to be used and the reference tracer to normallise, the dumping to be set to 1.0 and totally_min_max which includes the min max values of the field across all processors also for normalisation. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_cgraph" id="anamespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_cgraph">
<area shape="rect" title="Calculate the inf norm of the normalised field, so the field goes from 0 to 1 It requires as inputs t..." alt="" coords="5,29,195,69"/>
<area shape="poly" title=" " alt="" coords="64,30,62,20,68,11,81,5,100,3,122,6,135,13,132,17,121,11,100,8,82,10,71,15,67,21,69,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_icgraph" id="anamespacecopy__outof__state_ad775c010bade229fba0416002e6928a6_icgraph">
<area shape="rect" title="Calculate the inf norm of the normalised field, so the field goes from 0 to 1 It requires as inputs t..." alt="" coords="723,37,912,77"/>
<area shape="poly" title=" " alt="" coords="859,26,844,19,817,16,794,18,779,23,774,29,777,36,772,38,769,28,776,18,793,13,817,11,846,14,861,21"/>
<area shape="rect" href="namespacecopy__outof__state.html#a25b2882fb5f551e74ea186c313d5419d" title=": This subroutine either store variables before the nonlinear timeloop starts, or checks how the nonl..." alt="" coords="471,5,669,45"/>
<area shape="poly" title=" " alt="" coords="709,46,669,41,670,36,709,41"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,69,675,109"/>
<area shape="poly" title=" " alt="" coords="710,74,675,78,675,73,709,69"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,37,417,77"/>
<area shape="poly" title=" " alt="" coords="457,42,418,47,417,42,457,37"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,37,171,77"/>
<area shape="poly" title=" " alt="" coords="205,60,171,60,171,55,205,55"/>
<area shape="poly" title=" " alt="" coords="451,77,417,73,418,67,452,72"/>
</map>
</div>

</div>
</div>
<a id="ab7c981b328d9950b1c375aaacaa3cda0" name="ab7c981b328d9950b1c375aaacaa3cda0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7c981b328d9950b1c375aaacaa3cda0">&#9670;&#160;</a></span>is_constant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function, public copy_outof_state::is_constant </td>
          <td>(</td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>tfield</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Checks whether a field is constant or not </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_cgraph" id="anamespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_cgraph">
<area shape="rect" title=": Checks whether a field is constant or not" alt="" coords="5,29,159,69"/>
<area shape="poly" title=" " alt="" coords="53,29,51,20,56,11,66,5,82,3,100,6,110,13,107,17,98,11,82,8,68,10,59,14,56,21,58,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_icgraph" id="anamespacecopy__outof__state_ab7c981b328d9950b1c375aaacaa3cda0_icgraph">
<area shape="rect" title=": Checks whether a field is constant or not" alt="" coords="1507,208,1660,248"/>
<area shape="poly" title=" " alt="" coords="1620,196,1607,189,1583,187,1562,189,1550,193,1545,199,1547,207,1542,208,1540,198,1546,189,1561,183,1583,181,1609,184,1623,192"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="afca89971343f6586b89f1cddda00b2c8" name="afca89971343f6586b89f1cddda00b2c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afca89971343f6586b89f1cddda00b2c8">&#9670;&#160;</a></span>pack_multistate()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::pack_multistate </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>npres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>multiphase_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout), pointer&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:,:), optional, pointer&#160;</td>
          <td class="paramname"><em>pmulti_state</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine creates packed_state from state(:) and links the appropiate memory so it is acessible from both states. This subroutine also introduces fields not used by fludity but required by IC-FERST </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_cgraph" id="anamespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_cgraph">
<area shape="rect" title=": This subroutine creates packed_state from state(:) and links the appropiate memory so it is acessib..." alt="" coords="5,79,179,119"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="228,5,400,31"/>
<area shape="poly" title=" " alt="" coords="137,77,226,41,252,32,254,37,228,46,139,82"/>
<area shape="rect" href="namespacecopy__outof__state.html#acea2acdccf9091776be013ade24bcd97" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="227,79,401,119"/>
<area shape="poly" title=" " alt="" coords="179,97,213,97,213,102,179,102"/>
<area shape="rect" href="namespacemulti__tools.html#a88fe8456a6aab41a0c9aeff3b0a4f2ec" title=": Returns true if the input name is a Tracer type:PassiveTracer, Tracer, Species, Concentration or an..." alt="" coords="235,167,393,207"/>
<area shape="poly" title=" " alt="" coords="145,117,251,160,249,165,143,122"/>
<area shape="poly" title=" " alt="" coords="273,80,270,70,277,60,292,55,314,53,340,56,354,63,352,68,338,61,314,58,293,60,280,65,275,71,278,78"/>
<area shape="poly" title=" " alt="" coords="273,168,270,158,277,148,292,143,314,141,340,144,354,151,352,156,338,149,314,146,293,148,280,153,275,159,278,166"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_icgraph" id="anamespacecopy__outof__state_afca89971343f6586b89f1cddda00b2c8_icgraph">
<area shape="rect" title=": This subroutine creates packed_state from state(:) and links the appropiate memory so it is acessib..." alt="" coords="465,5,639,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a52b23a7607a135aaa7f055b36d531f41" name="a52b23a7607a135aaa7f055b36d531f41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52b23a7607a135aaa7f055b36d531f41">&#9670;&#160;</a></span>prepare_absorptions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::prepare_absorptions </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Prepares the memory to compute absorption fields </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_cgraph.png" border="0" usemap="#anamespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_cgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_cgraph" id="anamespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_cgraph">
<area shape="rect" title=": Prepares the memory to compute absorption fields" alt="" coords="5,5,197,45"/>
<area shape="rect" href="namespacemulti__data__types.html#aacf7345cba9f7c9760a4f8e1c68ee0ca" title="Deallocation of all of the multi field types within multi_absorp." alt="" coords="245,5,456,45"/>
<area shape="poly" title=" " alt="" coords="198,23,231,23,231,28,198,28"/>
<area shape="rect" href="namespacemulti__data__types.html#a65dde4f9748cb3dd200c328f99304c4e" title="Deallocation of a multi field type." alt="" coords="504,5,715,45"/>
<area shape="poly" title=" " alt="" coords="456,23,491,23,491,28,456,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_icgraph" id="anamespacecopy__outof__state_a52b23a7607a135aaa7f055b36d531f41_icgraph">
<area shape="rect" title=": Prepares the memory to compute absorption fields" alt="" coords="465,5,657,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,418,28,418,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="ac6c28692d04b581272d173fcc445b3c7" name="ac6c28692d04b581272d173fcc445b3c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6c28692d04b581272d173fcc445b3c7">&#9670;&#160;</a></span>printcsrmatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::printcsrmatrix </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>matrix</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>find</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>col</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>dim_same_row</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Subroutine to print CSR matrix by (row, column) Dimensions and phases are printed in different rows So for example Matrix(2,2,10) with two rows would be presented as a matrix ( 8 x 10) </p>

</div>
</div>
<a id="a0358bf9293883d5a332167bc0558b985" name="a0358bf9293883d5a332167bc0558b985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0358bf9293883d5a332167bc0558b985">&#9670;&#160;</a></span>update_outfluxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public copy_outof_state::update_outfluxes </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:, :,0:), intent(inout)&#160;</td>
          <td class="paramname"><em>bcs_outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nodi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>suf_area</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>vol_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>mass_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (tensor_field), intent(in), pointer&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (tensor_field_pointer), dimension(:)&#160;</td>
          <td class="paramname"><em>outfluxes_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>end_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a given GI point in a certain element This subroutine should only be called if SELE is on the BOUNDARY Example of Mass_flux: ndotq(iphase) * SdevFunsDETWEI(gi) * LIMT(iphase) Example of Vol_flux: ndotq(iphase) * SdevFunsDETWEI(gi) * LIMDT(iphase) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bcs_outfluxes</td><td>the total mass entering the domain is captured by 'bcs_outfluxes' </td></tr>
    <tr><td class="paramname">outfluxes</td><td>multi_outfluxes field containing the data required to create the output csv file </td></tr>
    <tr><td class="paramname">sele</td><td>current surface element </td></tr>
    <tr><td class="paramname">cv_nodi</td><td>current control volume </td></tr>
    <tr><td class="paramname">suf_area</td><td>surface area </td></tr>
    <tr><td class="paramname">Vol_flux</td><td>ndotq(iphase) * SdevFunsDETWEI(gi) * LIMT(iphase) </td></tr>
    <tr><td class="paramname">Mass_flux</td><td>ndotq(iphase) * SdevFunsDETWEI(gi) * LIMDT(iphase) (includes tracer and density!) </td></tr>
    <tr><td class="paramname">tracer</td><td>field being transported/computed </td></tr>
    <tr><td class="paramname">outfluxes_fields</td><td>to extract also from active/passive tracers </td></tr>
    <tr><td class="paramname">start_phase,end_phase</td><td>Initial and final phase to be considered here </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecopy__outof__state_a0358bf9293883d5a332167bc0558b985_icgraph.png" border="0" usemap="#anamespacecopy__outof__state_a0358bf9293883d5a332167bc0558b985_icgraph" alt=""/></div>
<map name="anamespacecopy__outof__state_a0358bf9293883d5a332167bc0558b985_icgraph" id="anamespacecopy__outof__state_a0358bf9293883d5a332167bc0558b985_icgraph">
<area shape="rect" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="1507,208,1693,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecopy__outof__state.html">copy_outof_state</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
