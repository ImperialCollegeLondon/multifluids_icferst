<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: /home/mbahlali/Softwares/multifluids_icferst/ICFERST/src/multi_dyncore_dg.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ICFERST<span id="projectnumber">&#160;25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('multi__dyncore__dg_8_f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">multi_dyncore_dg.F90 File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;fdebug.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for multi_dyncore_dg.F90:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90__incl.png" border="0" usemap="#a_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2multi__dyncore__dg_8_f90" alt=""/></div>
<map name="a_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2multi__dyncore__dg_8_f90" id="a_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2multi__dyncore__dg_8_f90">
<area shape="rect" title=" " alt="" coords="5,5,207,60"/>
<area shape="rect" title=" " alt="" coords="67,108,145,133"/>
<area shape="poly" title=" " alt="" coords="109,60,109,94,103,94,103,60"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemultiphase__1d__engine" id="r_namespacemultiphase__1d__engine"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html">multiphase_1d_engine</a></td></tr>
<tr class="memdesc:namespacemultiphase__1d__engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module contain all the necessary subroutines to deal with FE-wise equations and fields. Assembling and solving of the momentum equation and associated fields such as capillary pressure, hydrostatic pressure solver, and stabilisation techniques. Also includes the assembly and solving of a Laplacian system (for zeta potential mainly) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8b8466b21f31e369fc0ae74a939444cd" id="r_a8b8466b21f31e369fc0ae74a939444cd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd">multiphase_1d_engine::intenerge_assem_solve</a> (state, packed_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, tracer, velocity, density, multi_absorp, dt, suf_sig_diagten_bc, volfra_pore, volfra_pore_total, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_gdiff, eles_with_pipe, pipes_aux, option_path, mass_ele_transp, thermal, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, icomp, saturation, permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:a8b8466b21f31e369fc0ae74a939444cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the transport of energy/temperature and to solve the transport of components.  <br /></td></tr>
<tr class="separator:a8b8466b21f31e369fc0ae74a939444cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8eddee3d8387917a7563c83c7ebbe9d" id="r_ae8eddee3d8387917a7563c83c7ebbe9d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d">multiphase_1d_engine::force_min_max_principle</a> (mdims, entrance, tracer, nonlinear_iteration, totally_min_max)</td></tr>
<tr class="memdesc:ae8eddee3d8387917a7563c83c7ebbe9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: To help the stability of the system,if there are no sources/sinks it is known that the temperature must fulfill the min max principle, therefore here values outside this rank are capped.  <br /></td></tr>
<tr class="separator:ae8eddee3d8387917a7563c83c7ebbe9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08ee439502a499a77b44ecdd504846a" id="r_ae08ee439502a499a77b44ecdd504846a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a">multiphase_1d_engine::tracer_assemble_solve</a> (tracer_name, state, packed_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, tracer, velocity, density, multi_absorp, dt, suf_sig_diagten_bc, volfra_pore, volfra_pore_total, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_gdiff, eles_with_pipe, pipes_aux, mass_ele_transp, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, icomp, saturation, permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:ae08ee439502a499a77b44ecdd504846a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passive_Tracer_N Where N is an integer which is continuous starting from 1.  <br /></td></tr>
<tr class="separator:ae08ee439502a499a77b44ecdd504846a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ed1c2e68fd75835c3794475805554c" id="r_aa8ed1c2e68fd75835c3794475805554c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c">multiphase_1d_engine::volumefraction_assemble_solve</a> (state, packed_state, multicomponent_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, dt, suf_sig_diagten_bc, v_source, volfra_pore, volfra_pore_total, igot_theta_flux, mass_ele_transp, nonlinear_iteration, time_step, sfpi_taken, sfpi_its, courant_number, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j)</td></tr>
<tr class="memdesc:aa8ed1c2e68fd75835c3794475805554c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded.  <br /></td></tr>
<tr class="separator:aa8ed1c2e68fd75835c3794475805554c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a7956a7419e82fb8f059cae3ded083" id="r_a07a7956a7419e82fb8f059cae3ded083"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083">multiphase_1d_engine::volumefraction_assemble_solve_newton</a> (state, packed_state, multicomponent_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, dt, suf_sig_diagten_bc, prev_sat, v_source, volfra_pore, igot_theta_flux, mass_ele_transp, nonlinear_iteration, time_step, sfpi_taken, sfpi_its, courant_number, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j)</td></tr>
<tr class="memdesc:a07a7956a7419e82fb8f059cae3ded083"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jacobian. Solves using Newton's method.  <br /></td></tr>
<tr class="separator:a07a7956a7419e82fb8f059cae3ded083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1ce62fd9e2240cf8992447180a0152c" id="r_aa1ce62fd9e2240cf8992447180a0152c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c">multiphase_1d_engine::assemb_sat_jac_and_res</a> (state, packed_state, final_phase, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, sat_field, sat_bak, velocity, density, multi_absorp, diag_scale_pres, diag_scale_pres_coup, inv_b, den_all, denold_all, cv_disopt, cv_dg_vel_int_opt, dt, cv_theta, cv_beta, suf_sig_diagten_bc, deriv, cv_p, sourct_all, absorbt_all, volfra_pore, getcv_disc, getct, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, theta_gdiff, mean_pore_cv, mass_mn_pres, thermal, got_free_surf, mass_suf, mass_ele_transp, tdiffusion, saturation, vad_parameter, phase_with_pc, courant_number, permeability_tensor_field, calculate_mass_delta, eles_with_pipe, pipes_aux, porous_heat_coef, porous_heat_coef_old, outfluxes, solving_compositional, nonlinear_iteration, assemble_collapsed_to_one_phase)</td></tr>
<tr class="memdesc:aa1ce62fd9e2240cf8992447180a0152c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of the saturation. The Jacobian is stored in MmatPETSC_ACV and the residual in MmatCV_RHS.  <br /></td></tr>
<tr class="separator:aa1ce62fd9e2240cf8992447180a0152c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72540721ea2ef4651301189e8973481" id="r_ad72540721ea2ef4651301189e8973481"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481">multiphase_1d_engine::compositional_assemble_solve</a> (state, packed_state, multicomponent_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, multi_absorp, dt, suf_sig_diagten_bc, get_theta_flux, use_theta_flux, theta_gdiff, eles_with_pipe, pipes_aux, mass_ele, sum_theta_flux, sum_one_m_theta_flux, sum_theta_flux_j, sum_one_m_theta_flux_j)</td></tr>
<tr class="memdesc:ad72540721ea2ef4651301189e8973481"><td class="mdescLeft">&#160;</td><td class="mdescRight">:In this subroutine the components are solved for all the phases. Systems for each component are assembled and solved by calling INTENERGE_ASSEM_SOLVE  <br /></td></tr>
<tr class="separator:ad72540721ea2ef4651301189e8973481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2644f81b959a9c66d17c6ae96e452faf" id="r_a2644f81b959a9c66d17c6ae96e452faf"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf">multiphase_1d_engine::force_bal_cty_assem_solve</a> (state, packed_state, mdims, cv_gidims, fe_gidims, cv_funs, fe_funs, mspars, ndgln, mdisopt, mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, velocity, pressure, dt, suf_sig_diagten_bc, v_source, volfra_pore, volfra_pore_total, igot_theta_flux, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, calculate_mass_delta, outfluxes, pres_its_taken, nonlinear_its, courant_number)</td></tr>
<tr class="memdesc:a2644f81b959a9c66d17c6ae96e452faf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix Once these matrices (and corresponding RHSs) are generated the system of equations is solved using the projection method.  <br /></td></tr>
<tr class="separator:a2644f81b959a9c66d17c6ae96e452faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1438bf1da042b7b9b7d65fd2836aace" id="r_aa1438bf1da042b7b9b7d65fd2836aace"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa1438bf1da042b7b9b7d65fd2836aace">multiphase_1d_engine::dg_visc_lin</a> (s_inv_nnx_mat12, nnx_mat, nnx_mat2, nn_mat, nn_mat2, u_snloc, u_nloc, sbufen_reversed, sdetwe, sbcvngi, snormxn_all, ndim, u_sloc2loc, u_other_loc, u_nloc_ext, on_boundary)</td></tr>
<tr class="memdesc:aa1438bf1da042b7b9b7d65fd2836aace"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter element coupling for the viscocity discretization. NNX_MAT, NNX_MAT2 contain matricies of first derivative times basis function for current element and neightbouring element. Similarly NN_MAT, NN_MAT2, contain the element-wise mass matrices. Only call this sub if element not next to the boundary...  <br /></td></tr>
<tr class="separator:aa1438bf1da042b7b9b7d65fd2836aace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a425257d37d64d5ef1b27cd666391fc" id="r_a4a425257d37d64d5ef1b27cd666391fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a4a425257d37d64d5ef1b27cd666391fc">multiphase_1d_engine::viscocity_tensor_les_calc</a> (les_udiffusion, les_udiffusion_vol, dux_ele_all, ndim, nphase, u_nloc, x_nloc, totele, x_nonods, x_all, x_ndgln, mat_nonods, mat_nloc, mat_ndgln, les_disopt, les_cs, uden, cv_nonods, cv_ndgln, u_ndgln, u_nonods, u_all, deriv)</td></tr>
<tr class="memdesc:a4a425257d37d64d5ef1b27cd666391fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL  <br /></td></tr>
<tr class="separator:a4a425257d37d64d5ef1b27cd666391fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d7e6111d2e2ffcc4a22cb168d15f34" id="r_ac4d7e6111d2e2ffcc4a22cb168d15f34"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ac4d7e6111d2e2ffcc4a22cb168d15f34">multiphase_1d_engine::comb_vel_matrix_diag_dist</a> (diag_bigm_con, bigm_con, dgm_petsc, finele, colele, ndim, nphase, u_nloc, totele, velocity, pressure, mmat)</td></tr>
<tr class="memdesc:ac4d7e6111d2e2ffcc4a22cb168d15f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. For stokes also the diagonal of the matrix is introduced in the mass matrix  <br /></td></tr>
<tr class="separator:ac4d7e6111d2e2ffcc4a22cb168d15f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a154e187ad1fef3c04332b9b757a7240d" id="r_a154e187ad1fef3c04332b9b757a7240d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a154e187ad1fef3c04332b9b757a7240d">multiphase_1d_engine::comb_vel_matrix_diag_dist_lump</a> (diag_bigm_con, bigm_con, dgm_petsc, finele, colele, ndim, nphase, u_nloc, totele, velocity, pressure)</td></tr>
<tr class="memdesc:a154e187ad1fef3c04332b9b757a7240d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA.  <br /></td></tr>
<tr class="separator:a154e187ad1fef3c04332b9b757a7240d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a3d87102acd36c65500df29796b9ec" id="r_a19a3d87102acd36c65500df29796b9ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a19a3d87102acd36c65500df29796b9ec">multiphase_1d_engine::use_posinmat_c_store</a> (count, u_inod, p_jnod, u_nonods, findc, colc, ncolc, ido_store_ac_spar_pt, stored_ac_spar_pt, posinmat_c_store, ele, u_iloc, p_jloc, totele, u_nloc, p_nloc)</td></tr>
<tr class="memdesc:a19a3d87102acd36c65500df29796b9ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to assemble the C matrix in the ICFERST format.  <br /></td></tr>
<tr class="separator:a19a3d87102acd36c65500df29796b9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7f591c0dd6fb3817df338933c82990" id="r_a5f7f591c0dd6fb3817df338933c82990"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a5f7f591c0dd6fb3817df338933c82990">multiphase_1d_engine::use_posinmat_c_store_suf_dg</a> (count, u_inod, p_jnod, u_nonods, findc, colc, ncolc, ido_store_ac_spar_pt, stored_ac_spar_pt, posinmat_c_store_suf_dg, ele, iface, u_siloc, p_sjloc, totele, nface, u_snloc, p_snloc)</td></tr>
<tr class="memdesc:a5f7f591c0dd6fb3817df338933c82990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to assemble the C matrix in the ICFERST format (for DG?)  <br /></td></tr>
<tr class="separator:a5f7f591c0dd6fb3817df338933c82990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8917356adde1eb2aedccd0320529a6c5" id="r_a8917356adde1eb2aedccd0320529a6c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5">multiphase_1d_engine::linearise_field</a> (field_in, field_out)</td></tr>
<tr class="memdesc:a8917356adde1eb2aedccd0320529a6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field  <br /></td></tr>
<tr class="separator:a8917356adde1eb2aedccd0320529a6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c69484b7aa3fadf3b433fb3d1c06e4" id="r_a69c69484b7aa3fadf3b433fb3d1c06e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a69c69484b7aa3fadf3b433fb3d1c06e4">multiphase_1d_engine::introduce_grad_rhs_field_term</a> (packed_state, mdims, mmat, rhs_field, fe_funs, devfuns, x_all, loc_u_rhs, ele, cv_ndgln, x_ndgln, ele2, iface, sdetwe, snormxn_all, u_sloc2loc, cv_sloc2loc, mat_other_loc)</td></tr>
<tr class="memdesc:a69c69484b7aa3fadf3b433fb3d1c06e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example) for the momentum equation. It has two options (hard-coded) integrations by parts (activated) or voluemtric integration, For capillary pressure: The capillary pressure is a term introduced as a RHS which affects the effective velocity  <br /></td></tr>
<tr class="separator:a69c69484b7aa3fadf3b433fb3d1c06e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de595767a445b64e2d2c03a88413f2a" id="r_a9de595767a445b64e2d2c03a88413f2a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a">multiphase_1d_engine::getoverrelaxation_parameter</a> (state, packed_state, mdims, ndgln, overrelaxation, phase_with_pc, totally_min_max, for_transport)</td></tr>
<tr class="memdesc:a9de595767a445b64e2d2c03a88413f2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more information read: doi.org/10.1016/j.cma.2019.07.004.  <br /></td></tr>
<tr class="separator:a9de595767a445b64e2d2c03a88413f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f51328ef034efd7e4104db3a9b58d4e" id="r_a5f51328ef034efd7e4104db3a9b58d4e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a5f51328ef034efd7e4104db3a9b58d4e">multiphase_1d_engine::high_order_pressure_solve</a> (mdims, ndgln, u_rhs, state, packed_state, nphase, u_absorbin)</td></tr>
<tr class="memdesc:a5f51328ef034efd7e4104db3a9b58d4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created and solved that accounts for the gravity effect in the system. Next, this is introduced as a RHS in the momemtum equation This allows for higher precision for the gravity effect. &gt;  <br /></td></tr>
<tr class="separator:a5f51328ef034efd7e4104db3a9b58d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab407ee959b55313b7b395f5eeac47e0e" id="r_ab407ee959b55313b7b395f5eeac47e0e"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ab407ee959b55313b7b395f5eeac47e0e">multiphase_1d_engine::dg_oscilat_detect</a> (sndotq_keep, sndotq2_keep, n_dot_du, n_dot_du2, sincome, mass_ele, mass_ele2)</td></tr>
<tr class="memdesc:ab407ee959b55313b7b395f5eeac47e0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <br /></td></tr>
<tr class="separator:ab407ee959b55313b7b395f5eeac47e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427e8757a259e6a8828dc992c757fff9" id="r_a427e8757a259e6a8828dc992c757fff9"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a427e8757a259e6a8828dc992c757fff9">multiphase_1d_engine::p0_dg_oscilat_detect</a> (sndotq_keep, sndotq2_keep, n_dot_du, n_dot_du2, sincome, mass_ele, mass_ele2)</td></tr>
<tr class="memdesc:a427e8757a259e6a8828dc992c757fff9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <br /></td></tr>
<tr class="separator:a427e8757a259e6a8828dc992c757fff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23b4fbb2a0c5d2c452d01d480d46b64" id="r_ac23b4fbb2a0c5d2c452d01d480d46b64"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ac23b4fbb2a0c5d2c452d01d480d46b64">multiphase_1d_engine::diffus_cal_coeff_stress_or_tensor</a> (mdims, diff_coef_divdx, diff_coefold_divdx, stress_form, stress_form_stab, zero_or_two_thirds, sbufen_reversed, sbcvfen_reversed, sbcvngi, sloc_udiffusion, sloc_udiffusion_vol, sloc2_udiffusion, sloc2_udiffusion_vol, diff_gi_added, hdc, u_cv_nodj_ipha_all, u_cv_nodi_ipha_all, uold_cv_nodj_ipha_all, uold_cv_nodi_ipha_all, ele, ele2, snormxn_all, sloc_dux_ele_all, sloc2_dux_ele_all, sloc_duoldx_ele_all, sloc2_duoldx_ele_all, sele, wic_u_bc, <a class="el" href="namespacecv__advection.html#a7ceb6fac2898be0cae2d603d5226f631">wic_u_bc_dirichlet</a>, simple_diff_calc, diff_min_frac, diff_max_frac)</td></tr>
<tr class="memdesc:ac23b4fbb2a0c5d2c452d01d480d46b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity.  <br /></td></tr>
<tr class="separator:ac23b4fbb2a0c5d2c452d01d480d46b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b7967a62e580d633d9c828e05cac7ae" id="r_a0b7967a62e580d633d9c828e05cac7ae"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a0b7967a62e580d633d9c828e05cac7ae">multiphase_1d_engine::generate_and_solve_laplacian_system</a> (mdims, state, packed_state, ndgln, mmat, mspars, cv_funs, cv_gidims, sigma_field, field_name, k_fields, f_fields, intface_val_type, solver_path)</td></tr>
<tr class="memdesc:a0b7967a62e580d633d9c828e05cac7ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. &gt;  <br /></td></tr>
<tr class="separator:a0b7967a62e580d633d9c828e05cac7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0c5dfb1b3480e8ae2df59b05e12348" id="r_afe0c5dfb1b3480e8ae2df59b05e12348"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#afe0c5dfb1b3480e8ae2df59b05e12348">multiphase_1d_engine::impose_strong_bcs_wells</a> (state, pipes_aux, mdims, mmat, ndgln, cmc_petsc, pressure, rhs_p)</td></tr>
<tr class="memdesc:afe0c5dfb1b3480e8ae2df59b05e12348"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pressure boundary conditions for wells ONLY. This is required only when using P0DG-P1 If not imposing strong pressure BCs and using P0DG-P1, the formulation for weak pressure BCs leads to a 0 in the diagonal of the CMC matrix, therefore strong BCs are required.  <br /></td></tr>
<tr class="separator:afe0c5dfb1b3480e8ae2df59b05e12348"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="multi__dyncore__dg_8_f90.html">multi_dyncore_dg.F90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
