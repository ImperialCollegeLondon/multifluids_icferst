<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: /home/mbahlali/Softwares/MultiFluids_Dev/ICFERST/src/multi_dyncore_dg.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICFERST
   &#160;<span id="projectnumber">22-06</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('multi__dyncore__dg_8_f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle">
<div class="title">multi_dyncore_dg.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;fdebug.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for multi_dyncore_dg.F90:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90__incl.png" border="0" usemap="#_2home_2mbahlali_2_softwares_2_multi_fluids___dev_2_i_c_f_e_r_s_t_2src_2multi__dyncore__dg_8_f90" alt=""/></div>
<map name="_2home_2mbahlali_2_softwares_2_multi_fluids___dev_2_i_c_f_e_r_s_t_2src_2multi__dyncore__dg_8_f90" id="_2home_2mbahlali_2_softwares_2_multi_fluids___dev_2_i_c_f_e_r_s_t_2src_2multi__dyncore__dg_8_f90">
<area shape="rect" title=" " alt="" coords="5,5,199,61"/>
<area shape="rect" title=" " alt="" coords="63,109,141,136"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemultiphase__1d__engine"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html">multiphase_1d_engine</a></td></tr>
<tr class="memdesc:namespacemultiphase__1d__engine"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module contain all the necessary subroutines to deal with FE-wise equations and fields. Assembling and solving of the momentum equation and associated fields such as capillary pressure, hydrostatic pressure solver, and stabilisation techniques. Also includes the assembly and solving of a Laplacian system (for zeta potential mainly) <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a98e757b51a04b55df8d38e36470e0b96"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96">multiphase_1d_engine::intenerge_assem_solve</a> (state, packed_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, tracer, velocity, density, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, VOLFRA_PORE, IGOT_T2, igot_theta_flux, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, option_path, mass_ele_transp, thermal, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, icomp, saturation, Permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:a98e757b51a04b55df8d38e36470e0b96"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the transport of energy/temperature and to solve the transport of components.  <a href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96">More...</a><br /></td></tr>
<tr class="separator:a98e757b51a04b55df8d38e36470e0b96"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9996f3a8552933cf3c0fc9672de6ec86"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86">effective_cp_density</a> (porous_heat_coef, porous_heat_coef_old)</td></tr>
<tr class="memdesc:a9996f3a8552933cf3c0fc9672de6ec86"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Checks convergence on the temperature field Calculation of the averaged heat capacity and density average = porosity * Cp_f*rho_f + (1-porosity) * CP_p*rho_p Since porous promerties is defined element-wise and fluid properties CV-wise we perform an average as it is stored cv-wise  <a href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86">More...</a><br /></td></tr>
<tr class="separator:a9996f3a8552933cf3c0fc9672de6ec86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c48c7bcc5921e6764217e562a7b5d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6">multiphase_1d_engine::force_min_max_principle</a> (Mdims, entrance, tracer, nonlinear_iteration, totally_min_max)</td></tr>
<tr class="memdesc:a86c48c7bcc5921e6764217e562a7b5d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">: To help the stability of the system,if there are no sources/sinks it is known that the temperature must fulfill the min max principle, therefore here values outside this rank are capped.  <a href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6">More...</a><br /></td></tr>
<tr class="separator:a86c48c7bcc5921e6764217e562a7b5d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5819c18b57b8144faa1885776a2cc8b"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b">multiphase_1d_engine::tracer_assemble_solve</a> (Tracer_name, state, packed_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, tracer, velocity, density, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, VOLFRA_PORE, IGOT_T2, igot_theta_flux, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, mass_ele_transp, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, icomp, saturation, Permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:aa5819c18b57b8144faa1885776a2cc8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passive_Tracer_N Where N is an integer which is continuous starting from 1.  <a href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b">More...</a><br /></td></tr>
<tr class="separator:aa5819c18b57b8144faa1885776a2cc8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29606c63b241238edd97827aa4564d7"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7">multiphase_1d_engine::volumefraction_assemble_solve</a> (state, packed_state, multicomponent_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, DT, SUF_SIG_DIAGTEN_BC, V_SOURCE, VOLFRA_PORE, igot_theta_flux, mass_ele_transp, nonlinear_iteration, time_step, SFPI_taken, SFPI_its, Courant_number, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J)</td></tr>
<tr class="memdesc:ad29606c63b241238edd97827aa4564d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded.  <a href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7">More...</a><br /></td></tr>
<tr class="separator:ad29606c63b241238edd97827aa4564d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a171ba3eb037458ea0b2f128257e43588"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588">update_components</a> ()</td></tr>
<tr class="memdesc:a171ba3eb037458ea0b2f128257e43588"><td class="mdescLeft">&#160;</td><td class="mdescRight">WARNING: Still work in progress.  <a href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588">More...</a><br /></td></tr>
<tr class="separator:a171ba3eb037458ea0b2f128257e43588"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a871f4ede396b430a5194023196511192"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192">multiphase_1d_engine::compositional_assemble_solve</a> (state, packed_state, multicomponent_state, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, multi_absorp, DT, SUF_SIG_DIAGTEN_BC, GET_THETA_FLUX, USE_THETA_FLUX, THETA_GDIFF, eles_with_pipe, pipes_aux, mass_ele, sum_theta_flux, sum_one_m_theta_flux, sum_theta_flux_j, sum_one_m_theta_flux_j)</td></tr>
<tr class="memdesc:a871f4ede396b430a5194023196511192"><td class="mdescLeft">&#160;</td><td class="mdescRight">:In this subroutine the components are solved for all the phases. Systems for each component are assembled and solved by calling INTENERGE_ASSEM_SOLVE  <a href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192">More...</a><br /></td></tr>
<tr class="separator:a871f4ede396b430a5194023196511192"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ca070e362a90a07dcb98eada12a622f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f">ensure_components_sum_to_one</a> (packed_state)</td></tr>
<tr class="memdesc:a2ca070e362a90a07dcb98eada12a622f"><td class="mdescLeft">&#160;</td><td class="mdescRight">WARNING: It is currently not working well...better to use Chris' method which uses a RHS.  <a href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f">More...</a><br /></td></tr>
<tr class="separator:a2ca070e362a90a07dcb98eada12a622f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5be4b78c1796fac4008d398a7cdd0aa"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa">multiphase_1d_engine::force_bal_cty_assem_solve</a> (state, packed_state, Mdims, CV_GIdims, FE_GIdims, CV_funs, FE_funs, Mspars, ndgln, Mdisopt, Mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, velocity, pressure, DT, SUF_SIG_DIAGTEN_BC, V_SOURCE, VOLFRA_PORE, IGOT_THETA_FLUX, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, calculate_mass_delta, outfluxes, pres_its_taken, nonlinear_its, Courant_number)</td></tr>
<tr class="memdesc:ae5be4b78c1796fac4008d398a7cdd0aa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix Once these matrices (and corresponding RHSs) are generated the system of equations is solved using the projection method.  <a href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa">More...</a><br /></td></tr>
<tr class="separator:ae5be4b78c1796fac4008d398a7cdd0aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09c428fa5a27cf3407e6a1bcc917f161"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161">stokes_anderson_acceleration</a> (packed_state, Mdims, Mmat, Mspars, INV_B, rhs_p, ndgln, MASS_ELE, diagonal_A, velocity, P_all, deltap, cmc_petsc, stokes_max_its)</td></tr>
<tr class="memdesc:a09c428fa5a27cf3407e6a1bcc917f161"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results for a system that converges based on a FPI and finding an optimal combination of all of these results that minimise the residual Method explained in DOI.10.1137/16M1076770.  <a href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161">More...</a><br /></td></tr>
<tr class="separator:a09c428fa5a27cf3407e6a1bcc917f161"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3c0d8ed87bdfa9ff27a1048406ecd2f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#ad3c0d8ed87bdfa9ff27a1048406ecd2f">flip_p_and_v_bcs</a> (Mdims, WIC_P_BC_ALL, pressure_BCs, WIC_FLIP_P_VEL_BCS)</td></tr>
<tr class="memdesc:ad3c0d8ed87bdfa9ff27a1048406ecd2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Flip P and V BCs for wells. Implemented for ATES applications or other applications when needing to switch on and off wells. For this to work, need to define boundary conditions for wells for both pressure and velocity in a time-dependent manner through Diamond using a python function. When the user wants the pressure BC to be ignored and the velocity BC to be applied, specify negative pressure. When the user wants the pressure BC to applied, specify normal positive pressure. Specify velocity BCs for both wells as a constant.  <a href="multi__dyncore__dg_8_f90.html#ad3c0d8ed87bdfa9ff27a1048406ecd2f">More...</a><br /></td></tr>
<tr class="separator:ad3c0d8ed87bdfa9ff27a1048406ecd2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68747c78369c5abd8f6bce5ae5d0bec7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a68747c78369c5abd8f6bce5ae5d0bec7">mult_inv_mass_vel_vector</a> (Mdims, ndgln, vel_vector, MASS_ELE)</td></tr>
<tr class="memdesc:a68747c78369c5abd8f6bce5ae5d0bec7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplies the inv of the lumped mass matrix times the vel_vector vel_vector = vel_vector / (mass_ele/vel_local_nodes)  <a href="multi__dyncore__dg_8_f90.html#a68747c78369c5abd8f6bce5ae5d0bec7">More...</a><br /></td></tr>
<tr class="separator:a68747c78369c5abd8f6bce5ae5d0bec7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86babf83394e349a6bb014238237de1f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a86babf83394e349a6bb014238237de1f">generate_pivit_matrix_stokes</a> (Mdims, Mmat, MASS_ELE, diagonal_A)</td></tr>
<tr class="memdesc:a86babf83394e349a6bb014238237de1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Generates a lumped mass matrix for Stokes. It can either have also the diagonal of A or not.  <a href="multi__dyncore__dg_8_f90.html#a86babf83394e349a6bb014238237de1f">More...</a><br /></td></tr>
<tr class="separator:a86babf83394e349a6bb014238237de1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a525a502553802a5ecbe7a138b1575c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a5a525a502553802a5ecbe7a138b1575c">solve_and_update_velocity</a> (Mmat, Velocity, CDP_tensor, U_RHS, diagonal_A)</td></tr>
<tr class="memdesc:a5a525a502553802a5ecbe7a138b1575c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Update velocity by solving the momentum equation for a given pressure, the RHS is formed here If rescale_mom_matrices = .true., here the RHS rescaled.  <a href="multi__dyncore__dg_8_f90.html#a5a525a502553802a5ecbe7a138b1575c">More...</a><br /></td></tr>
<tr class="separator:a5a525a502553802a5ecbe7a138b1575c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a4aa21acf8febcc4fec45af279f33d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#ae8a4aa21acf8febcc4fec45af279f33d">solve_and_update_pressure</a> (Mdims, rhs_p, P_all, deltap, cmc_petsc, diagonal_CMC, update_pres)</td></tr>
<tr class="memdesc:ae8a4aa21acf8febcc4fec45af279f33d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Compute deltaP by solving the pressure equation using the CMC matrix.  <a href="multi__dyncore__dg_8_f90.html#ae8a4aa21acf8febcc4fec45af279f33d">More...</a><br /></td></tr>
<tr class="separator:ae8a4aa21acf8febcc4fec45af279f33d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0eb7a61a4dc66651096b6fabc6739ea3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a0eb7a61a4dc66651096b6fabc6739ea3">project_velocity_to_affine_space</a> (Mdims, Mmat, Mspars, ndgln, velocity, deltap, cdp_tensor)</td></tr>
<tr class="memdesc:a0eb7a61a4dc66651096b6fabc6739ea3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Project back the velocity from a non divergent-free space to a divergent free space.  <a href="multi__dyncore__dg_8_f90.html#a0eb7a61a4dc66651096b6fabc6739ea3">More...</a><br /></td></tr>
<tr class="separator:a0eb7a61a4dc66651096b6fabc6739ea3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b2f85c6a8345f6316959365e52bd83"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a53b2f85c6a8345f6316959365e52bd83">compute_div_u</a> (Mdims, Mmat, Mspars, velocity, INV_B, rhs_p, force_transpose_C)</td></tr>
<tr class="memdesc:a53b2f85c6a8345f6316959365e52bd83"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates the divergence of the velocity by multipliying it by the Ct matrix.  <a href="multi__dyncore__dg_8_f90.html#a53b2f85c6a8345f6316959365e52bd83">More...</a><br /></td></tr>
<tr class="separator:a53b2f85c6a8345f6316959365e52bd83"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5bc5bc1a7d8c32c0a8f667b03648f64"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#aa5bc5bc1a7d8c32c0a8f667b03648f64">include_wells_and_compressibility_into_rhs</a> (Mdims, rhs_p, DIAG_SCALE_PRES, MASS_MN_PRES, MASS_SUF, pipes_aux, DIAG_SCALE_PRES_COUP)</td></tr>
<tr class="memdesc:aa5bc5bc1a7d8c32c0a8f667b03648f64"><td class="mdescLeft">&#160;</td><td class="mdescRight">Include in the pressure matrix the compressibility terms (based on taylor expansion series) to ensure that we account for this term as implicitly as possible. For wells it introduces the coupling between pressures.  <a href="multi__dyncore__dg_8_f90.html#aa5bc5bc1a7d8c32c0a8f667b03648f64">More...</a><br /></td></tr>
<tr class="separator:aa5bc5bc1a7d8c32c0a8f667b03648f64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1329a9f2f2cb2da28424447b49428e34"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34">calc_cvpres_from_fepres</a> ()</td></tr>
<tr class="separator:a1329a9f2f2cb2da28424447b49428e34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa2eb04d27443c785084566c701903207"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207">porous_assemb_force_cty</a> (packed_state, pressure, Mdims, FE_GIdims, FE_funs, Mspars, ndgln, Mmat, X_ALL, U_SOURCE_CV_ALL)</td></tr>
<tr class="memdesc:aa2eb04d27443c785084566c701903207"><td class="mdescLeft">&#160;</td><td class="mdescRight">and faster to compute than for Navier-Stokes. Therefore, here the RHS and the Mass matrix are computed for this case  <a href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207">More...</a><br /></td></tr>
<tr class="separator:aa2eb04d27443c785084566c701903207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a7f0d36d29011eddc120ea33cb763db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db">get_massmatrix</a> (ELE, Mdims, DevFuns, Mmat, X_ALL, UFEN_REVERSED)</td></tr>
<tr class="memdesc:a6a7f0d36d29011eddc120ea33cb763db"><td class="mdescLeft">&#160;</td><td class="mdescRight">Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE, AND GET_POROUS_MASS_MATRIX IS KEPT FOR THE DIAGONAL SCALING METHOD.  <a href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db">More...</a><br /></td></tr>
<tr class="separator:a6a7f0d36d29011eddc120ea33cb763db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2e637a6ef27761363d224b3d7869c6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#ae2e637a6ef27761363d224b3d7869c6a">get_all_in_mass_matrix</a> (Mdims, Mmat, DIAG_BIGM_CON, LUMP_PIVIT_ON_ALL, LUMP_DIAG_MOM)</td></tr>
<tr class="memdesc:ae2e637a6ef27761363d224b3d7869c6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">WARNING****this is under testing****.  <a href="multi__dyncore__dg_8_f90.html#ae2e637a6ef27761363d224b3d7869c6a">More...</a><br /></td></tr>
<tr class="separator:ae2e637a6ef27761363d224b3d7869c6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24c9e30f49053a0f6dfe4ad7f5f73de9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a24c9e30f49053a0f6dfe4ad7f5f73de9">p0_limiter</a> ()</td></tr>
<tr class="memdesc:a24c9e30f49053a0f6dfe4ad7f5f73de9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes a limited velocity when using a P0DG velocity discretisation  <a href="multi__dyncore__dg_8_f90.html#a24c9e30f49053a0f6dfe4ad7f5f73de9">More...</a><br /></td></tr>
<tr class="separator:a24c9e30f49053a0f6dfe4ad7f5f73de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5917482b2dae4c57c6e06a839682e42"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#af5917482b2dae4c57c6e06a839682e42">multiphase_1d_engine::dg_visc_lin</a> (S_INV_NNX_MAT12, NNX_MAT, NNX_MAT2, NN_MAT, NN_MAT2, U_SNLOC, U_NLOC, SBUFEN_REVERSED, SDETWE, SBCVNGI, SNORMXN_ALL, NDIM, U_SLOC2LOC, U_OTHER_LOC, U_NLOC_EXT, ON_BOUNDARY)</td></tr>
<tr class="memdesc:af5917482b2dae4c57c6e06a839682e42"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter element coupling for the viscocity discretization. NNX_MAT, NNX_MAT2 contain matricies of first derivative times basis function for current element and neightbouring element. Similarly NN_MAT, NN_MAT2, contain the element-wise mass matrices. Only call this sub if element not next to the boundary...  <a href="namespacemultiphase__1d__engine.html#af5917482b2dae4c57c6e06a839682e42">More...</a><br /></td></tr>
<tr class="separator:af5917482b2dae4c57c6e06a839682e42"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afcedae35a0a37c9b033248d85bb9ad86"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86">multiphase_1d_engine::viscocity_tensor_les_calc</a> (LES_UDIFFUSION, LES_UDIFFUSION_VOL, DUX_ELE_ALL, NDIM, NPHASE, U_NLOC, X_NLOC, TOTELE, X_NONODS, X_ALL, X_NDGLN, MAT_NONODS, MAT_NLOC, MAT_NDGLN, LES_DISOPT, LES_CS, UDEN, CV_NONODS, CV_NDGLN, U_NDGLN, U_NONODS, U_ALL, DERIV)</td></tr>
<tr class="memdesc:afcedae35a0a37c9b033248d85bb9ad86"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL  <a href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86">More...</a><br /></td></tr>
<tr class="separator:afcedae35a0a37c9b033248d85bb9ad86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac4e80d22e26450266e054deedd13fc9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9">viscocity_tensor_les_calc_u</a> (LES_U_UDIFFUSION, LES_U_UDIFFUSION_VOL, Q_SCHEME_ABS_CONT_VOL, DUX_ELE_ALL, NDIM, NPHASE, U_NLOC, X_NLOC, TOTELE, X_NONODS, X_ALL, X_NDGLN, LES_DISOPT, CS, U_NDGLN, U_NONODS, U_ALL)</td></tr>
<tr class="separator:aac4e80d22e26450266e054deedd13fc9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a41b4850724ffd0c17e8300f4eaa60296"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296">oneeletens_all</a> (LOC_X_ALL, LES_DISOPT, ONE_OVER_H2, TENSXX_ALL, X_NLOC, NDIM, MEAN_UDER_U, NPHASE)</td></tr>
<tr class="memdesc:a41b4850724ffd0c17e8300f4eaa60296"><td class="mdescLeft">&#160;</td><td class="mdescRight">REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option.  <a href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296">More...</a><br /></td></tr>
<tr class="separator:a41b4850724ffd0c17e8300f4eaa60296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a5112eda36874919ad0ce46f54978c4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4">jacdia</a> (AA, V, D, N, A)</td></tr>
<tr class="memdesc:a7a5112eda36874919ad0ce46f54978c4"><td class="mdescLeft">&#160;</td><td class="mdescRight">find the eigen-vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal. It uses the algorithm of Matrix Computations 2nd edition, p196. sprint_to_do!!!!MOVE TO FORTRAN 90  <a href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4">More...</a><br /></td></tr>
<tr class="separator:a7a5112eda36874919ad0ce46f54978c4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a58cac3905be09f7b7a02061cfef6ef01"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01">jacpre</a> (SINALF, COSALF, P, Q, A, N)</td></tr>
<tr class="memdesc:a58cac3905be09f7b7a02061cfef6ef01"><td class="mdescLeft">&#160;</td><td class="mdescRight">PRE-MULTIPLY matrix A by transpose of Rotation matrix is realised by passing -SINALF down into SINALF.  <a href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01">More...</a><br /></td></tr>
<tr class="separator:a58cac3905be09f7b7a02061cfef6ef01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09643136688e87eec9171d22ab63d181"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181">jacpos</a> (SINALF, COSALF, P, Q, A, N)</td></tr>
<tr class="separator:a09643136688e87eec9171d22ab63d181"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92d78676878788b54916f9a7e0bc894a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a92d78676878788b54916f9a7e0bc894a">multiphase_1d_engine::comb_vel_matrix_diag_dist</a> (DIAG_BIGM_CON, BIGM_CON, DGM_PETSC, FINELE, COLELE, NDIM, NPHASE, U_NLOC, TOTELE, velocity, pressure, Mmat)</td></tr>
<tr class="memdesc:a92d78676878788b54916f9a7e0bc894a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. For stokes also the diagonal of the matrix is introduced in the mass matrix  <a href="namespacemultiphase__1d__engine.html#a92d78676878788b54916f9a7e0bc894a">More...</a><br /></td></tr>
<tr class="separator:a92d78676878788b54916f9a7e0bc894a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8e1dabacd438da77f8e97f5234e6e3e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#af8e1dabacd438da77f8e97f5234e6e3e">multiphase_1d_engine::comb_vel_matrix_diag_dist_lump</a> (DIAG_BIGM_CON, BIGM_CON, DGM_PETSC, FINELE, COLELE, NDIM, NPHASE, U_NLOC, TOTELE, velocity, pressure)</td></tr>
<tr class="memdesc:af8e1dabacd438da77f8e97f5234e6e3e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA.  <a href="namespacemultiphase__1d__engine.html#af8e1dabacd438da77f8e97f5234e6e3e">More...</a><br /></td></tr>
<tr class="separator:af8e1dabacd438da77f8e97f5234e6e3e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e2d722ec8283f1e4d87f7b6d7e427a5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8e2d722ec8283f1e4d87f7b6d7e427a5">multiphase_1d_engine::use_posinmat_c_store</a> (COUNT, U_INOD, P_JNOD, U_NONODS, FINDC, COLC, NCOLC, IDO_STORE_AC_SPAR_PT, STORED_AC_SPAR_PT, POSINMAT_C_STORE, ELE, U_ILOC, P_JLOC, TOTELE, U_NLOC, P_NLOC)</td></tr>
<tr class="memdesc:a8e2d722ec8283f1e4d87f7b6d7e427a5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to assemble the C matrix in the ICFERST format.  <a href="namespacemultiphase__1d__engine.html#a8e2d722ec8283f1e4d87f7b6d7e427a5">More...</a><br /></td></tr>
<tr class="separator:a8e2d722ec8283f1e4d87f7b6d7e427a5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25c88bda5ea4082016d39781e111d445"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a25c88bda5ea4082016d39781e111d445">multiphase_1d_engine::use_posinmat_c_store_suf_dg</a> (COUNT, U_INOD, P_JNOD, U_NONODS, FINDC, COLC, NCOLC, IDO_STORE_AC_SPAR_PT, STORED_AC_SPAR_PT, POSINMAT_C_STORE_SUF_DG, ELE, IFACE, U_SILOC, P_SJLOC, TOTELE, NFACE, U_SNLOC, P_SNLOC)</td></tr>
<tr class="memdesc:a25c88bda5ea4082016d39781e111d445"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to assemble the C matrix in the ICFERST format (for DG?)  <a href="namespacemultiphase__1d__engine.html#a25c88bda5ea4082016d39781e111d445">More...</a><br /></td></tr>
<tr class="separator:a25c88bda5ea4082016d39781e111d445"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8917356adde1eb2aedccd0320529a6c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5">multiphase_1d_engine::linearise_field</a> (field_in, field_out)</td></tr>
<tr class="memdesc:a8917356adde1eb2aedccd0320529a6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field  <a href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5">More...</a><br /></td></tr>
<tr class="separator:a8917356adde1eb2aedccd0320529a6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03c49a0f1a67a464bbb77115775ae4d1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1">multiphase_1d_engine::introduce_grad_rhs_field_term</a> (packed_state, Mdims, Mmat, RHS_field, FE_funs, Devfuns, X_ALL, LOC_U_RHS, ele, cv_ndgln, x_ndgln, ele2, iface, sdetwe, SNORMXN_ALL, U_SLOC2LOC, CV_SLOC2LOC, MAT_OTHER_LOC)</td></tr>
<tr class="memdesc:a03c49a0f1a67a464bbb77115775ae4d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example) for the momentum equation. It has two options (hard-coded) integrations by parts (activated) or voluemtric integration, For capillary pressure: The capillary pressure is a term introduced as a RHS which affects the effective velocity  <a href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1">More...</a><br /></td></tr>
<tr class="separator:a03c49a0f1a67a464bbb77115775ae4d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acad594ff5e1d219a2e1c7e5fe2a51605"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605">multiphase_1d_engine::getoverrelaxation_parameter</a> (state, packed_state, Mdims, ndgln, Overrelaxation, Phase_with_Pc, totally_min_max, for_transport)</td></tr>
<tr class="memdesc:acad594ff5e1d219a2e1c7e5fe2a51605"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more information read: doi.org/10.1016/j.cma.2019.07.004.  <a href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605">More...</a><br /></td></tr>
<tr class="separator:acad594ff5e1d219a2e1c7e5fe2a51605"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a01c78d922871a74af7e6e4a3228868"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a7a01c78d922871a74af7e6e4a3228868">multiphase_1d_engine::high_order_pressure_solve</a> (Mdims, ndgln, u_rhs, state, packed_state, nphase, u_absorbin)</td></tr>
<tr class="memdesc:a7a01c78d922871a74af7e6e4a3228868"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created and solved that accounts for the gravity effect in the system. Next, this is introduced as a RHS in the momemtum equation This allows for higher precision for the gravity effect. &gt;  <a href="namespacemultiphase__1d__engine.html#a7a01c78d922871a74af7e6e4a3228868">More...</a><br /></td></tr>
<tr class="separator:a7a01c78d922871a74af7e6e4a3228868"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75a4fb88f761b81639c9b81628eddc95"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a75a4fb88f761b81639c9b81628eddc95">multiphase_1d_engine::dg_oscilat_detect</a> (SNDOTQ_KEEP, SNDOTQ2_KEEP, N_DOT_DU, N_DOT_DU2, SINCOME, MASS_ELE, MASS_ELE2)</td></tr>
<tr class="memdesc:a75a4fb88f761b81639c9b81628eddc95"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <a href="namespacemultiphase__1d__engine.html#a75a4fb88f761b81639c9b81628eddc95">More...</a><br /></td></tr>
<tr class="separator:a75a4fb88f761b81639c9b81628eddc95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34cd5ba5d5dfec039fa896b5fdc14e9f"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a34cd5ba5d5dfec039fa896b5fdc14e9f">multiphase_1d_engine::p0_dg_oscilat_detect</a> (SNDOTQ_KEEP, SNDOTQ2_KEEP, N_DOT_DU, N_DOT_DU2, SINCOME, MASS_ELE, MASS_ELE2)</td></tr>
<tr class="memdesc:a34cd5ba5d5dfec039fa896b5fdc14e9f"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <a href="namespacemultiphase__1d__engine.html#a34cd5ba5d5dfec039fa896b5fdc14e9f">More...</a><br /></td></tr>
<tr class="separator:a34cd5ba5d5dfec039fa896b5fdc14e9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44c487b15ec28694d3d4e75dd952d27f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f">multiphase_1d_engine::diffus_cal_coeff_stress_or_tensor</a> (Mdims, DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX, STRESS_FORM, STRESS_FORM_STAB, ZERO_OR_TWO_THIRDS, SBUFEN_REVERSED, SBCVFEN_REVERSED, SBCVNGI, SLOC_UDIFFUSION, SLOC_UDIFFUSION_VOL, SLOC2_UDIFFUSION, SLOC2_UDIFFUSION_VOL, DIFF_GI_ADDED, HDC, U_CV_NODJ_IPHA_ALL, U_CV_NODI_IPHA_ALL, UOLD_CV_NODJ_IPHA_ALL, UOLD_CV_NODI_IPHA_ALL, ELE, ELE2, SNORMXN_ALL, SLOC_DUX_ELE_ALL, SLOC2_DUX_ELE_ALL, SLOC_DUOLDX_ELE_ALL, SLOC2_DUOLDX_ELE_ALL, SELE, WIC_U_BC, WIC_U_BC_DIRICHLET, SIMPLE_DIFF_CALC, DIFF_MIN_FRAC, DIFF_MAX_FRAC)</td></tr>
<tr class="memdesc:a44c487b15ec28694d3d4e75dd952d27f"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity.  <a href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f">More...</a><br /></td></tr>
<tr class="separator:a44c487b15ec28694d3d4e75dd952d27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15505780dc171eceae929e55d7951913"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a15505780dc171eceae929e55d7951913">for_tens_derivs_ndots</a> (DIFF_STAND_DIVDX_U, N_DOT_DKDU, N_DOT_DKDUOLD, DIFF_GI_ADDED, SLOC_DUX_ELE_ALL, SLOC_DUOLDX_ELE_ALL, SLOC_UDIFFUSION, SLOC_UDIFFUSION_VOL, NDIM_VEL, NDIM, NPHASE, U_SNLOC, CV_SNLOC, SBCVNGI, SBUFEN_REVERSED, SBCVFEN_REVERSED, SNORMXN_ALL, HDC, ZERO_OR_TWO_THIRDS, STRESS_FORM, STRESS_FORM_STAB)</td></tr>
<tr class="memdesc:a15505780dc171eceae929e55d7951913"><td class="mdescLeft">&#160;</td><td class="mdescRight">This implements the stress and tensor form of diffusion and calculates a jump conidition. DIFF_STAND_DIVDX_U is the minimal amount of diffusion.  <a href="multi__dyncore__dg_8_f90.html#a15505780dc171eceae929e55d7951913">More...</a><br /></td></tr>
<tr class="separator:a15505780dc171eceae929e55d7951913"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef4ba493db104704c886272f75f1f34"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34">multiphase_1d_engine::generate_and_solve_laplacian_system</a> (Mdims, state, packed_state, ndgln, Mmat, Mspars, CV_funs, CV_GIdims, Sigma_field, field_name, K_fields, F_fields, intface_val_type, solver_path)</td></tr>
<tr class="memdesc:aeef4ba493db104704c886272f75f1f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. &gt;  <a href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34">More...</a><br /></td></tr>
<tr class="separator:aeef4ba493db104704c886272f75f1f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac978f4c53e089cee150a4c15b117eee5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ac978f4c53e089cee150a4c15b117eee5">multiphase_1d_engine::impose_strong_bcs_wells</a> (state, pipes_aux, Mdims, Mmat, ndgln, CMC_petsc, pressure, rhs_p)</td></tr>
<tr class="memdesc:ac978f4c53e089cee150a4c15b117eee5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pressure boundary conditions for wells ONLY. This is required only when using P0DG-P1 If not imposing strong pressure BCs and using P0DG-P1, the formulation for weak pressure BCs leads to a 0 in the diagonal of the CMC matrix, therefore strong BCs are required.  <a href="namespacemultiphase__1d__engine.html#ac978f4c53e089cee150a4c15b117eee5">More...</a><br /></td></tr>
<tr class="separator:ac978f4c53e089cee150a4c15b117eee5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae48bbf14b3a637156be0ca7daefc590c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae48bbf14b3a637156be0ca7daefc590c">multiphase_1d_engine::ai_backtracking_parameters</a> (Mdims, ndgln, packed_state, state, courant_number_in, backtrack_par_factor, overrelaxation, res, resold, outer_nonlinear_iteration, for_transport)</td></tr>
<tr class="memdesc:ae48bbf14b3a637156be0ca7daefc590c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subroutine that calculates the backtrack_par_factor based on Machine Learning. The inputs of the Machine learning model are dimensionless numbers and configurations of the system. This subroutine also generates several dimensionless numbers cv-wise.  <a href="namespacemultiphase__1d__engine.html#ae48bbf14b3a637156be0ca7daefc590c">More...</a><br /></td></tr>
<tr class="separator:ae48bbf14b3a637156be0ca7daefc590c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44f668c16758cc5da708c38932a4e53e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a44f668c16758cc5da708c38932a4e53e">get_relative_permeability</a> (Mdims, saturation, Imble_frac, end_point_relperm, exponent_relperm, relperm)</td></tr>
<tr class="separator:a44f668c16758cc5da708c38932a4e53e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13ad5090251312f4fc0f9aaf83b05e8c"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a13ad5090251312f4fc0f9aaf83b05e8c">shock_front_mobility_ratio</a> (ele, Mdims, sat, ndgln, Imble_frac, total_mobility)</td></tr>
<tr class="separator:a13ad5090251312f4fc0f9aaf83b05e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d12626bedcc63285cc6c18affa3842e"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__dyncore__dg_8_f90.html#a4d12626bedcc63285cc6c18affa3842e">shock_front_in_ele</a> (ele, Mdims, sat, ndgln, Imble_frac)</td></tr>
<tr class="separator:a4d12626bedcc63285cc6c18affa3842e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a1329a9f2f2cb2da28424447b49428e34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1329a9f2f2cb2da28424447b49428e34">&#9670;&nbsp;</a></span>calc_cvpres_from_fepres()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::calc_cvpres_from_fepres</td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_cgraph" id="multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_cgraph">
<area shape="rect" title=" " alt="" coords="5,1519,189,1545"/>
<area shape="rect" href="namespacecv__advection.html#a34e0fcace33673c6460aef98e962709e" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="238,965,427,992"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="237,2039,428,2065"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="492,1055,687,1097"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="531,443,647,469"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="777,303,950,329"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="499,1238,680,1279"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="518,625,661,666"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="768,1988,959,2015"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="501,1420,677,1447"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="490,1121,689,1162"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="758,1813,969,1854"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="484,1587,695,1629"/>
<area shape="rect" href="namespacecv__advection.html#a98ae89956725fc2c1d2ad41642f6fe04" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="513,1303,666,1345"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="522,1187,657,1213"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="519,1770,660,1811"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="517,1369,661,1396"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="509,1836,669,1863"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="503,1471,675,1497"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="509,5,670,32"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="499,57,680,98"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="476,123,703,149"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="479,173,699,200"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a96760a6f67a04d4191273b6a034697fb" title=" " alt="" coords="495,224,683,251"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title="If PACK then pack T_ALL into LOC_F as long at IGOT_T==1 and STORE and not already in storage." alt="" coords="544,325,635,352"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="513,377,666,418"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="503,1522,675,1563"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="493,494,686,535"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="519,1705,660,1746"/>
<area shape="rect" href="namespacecv__advection.html#af3ad992b05f1087fdb1d5bcd7d6c500e" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="511,559,667,601"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="514,691,665,717"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="501,742,677,783"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="502,808,677,835"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title="Detects whether the element has a shockfront or not." alt="" coords="512,859,667,901"/>
<area shape="rect" href="namespacecv__advection.html#ad714b20d018bf748c3ad080732b7c9cc" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="508,925,671,966"/>
<area shape="rect" href="namespacecopy__outof__state.html#a3e466dfb76c8c3e30de12d2f7d36d3bb" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="496,990,683,1031"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="779,409,947,450"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="793,1285,934,1312"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aad25281c21796ab5cdd1ecf160cdad8f" title=" " alt="" coords="802,475,925,501"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a6b4e2b7cd1b1214a242258cc6f8b753a" title=" " alt="" coords="774,632,953,659"/>
<area shape="rect" href="multi__shape__fct_8_f90.html#a3ac481479452947a759fbb6c9cf743e9" title=" " alt="" coords="774,1128,953,1155"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="771,1219,956,1245"/>
<area shape="rect" href="namespacecv__advection.html#afc0d98d467a15c460d49668d0194344a" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="779,1405,948,1446"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="789,1353,938,1380"/>
<area shape="rect" href="namespacemulti__tools.html#ad2dc4462bad46ef99ca0057cb3c91262" title=":This function is a tolerance function for a vector which is used as a denominator...." alt="" coords="789,1471,938,1497"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a5c58181433ef3d6296d003eccb780c6d" title="Populate limiting matrix based on max and min values For each node, find the largest and smallest val..." alt="" coords="762,1529,965,1556"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a29b95710b57b76fd0d961ec749a71304" title=" " alt="" coords="779,2042,947,2083"/>
<area shape="rect" href="namespacecv__advection.html#aba06a5f3680d58e1db30e740119dd5dc" title="Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))" alt="" coords="751,2113,976,2140"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="525,2089,653,2116"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1" title=": This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example..." alt="" coords="779,2173,948,2229"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_icgraph" id="multi__dyncore__dg_8_f90_a1329a9f2f2cb2da28424447b49428e34_icgraph">
<area shape="rect" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a53b2f85c6a8345f6316959365e52bd83"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b2f85c6a8345f6316959365e52bd83">&#9670;&nbsp;</a></span>compute_div_u()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::compute_div_u </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(in)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_sparsities), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>INV_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>force_transpose_C</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates the divergence of the velocity by multipliying it by the Ct matrix. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_cgraph" id="multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_cgraph">
<area shape="rect" title="Calculates the divergence of the velocity by multipliying it by the Ct matrix." alt="" coords="5,46,127,73"/>
<area shape="rect" href="namespacematrix__operations.html#aca7d06edf5bee7b9e5c00830ee444478" title=":CV_RHS=CT*U" alt="" coords="175,5,324,47"/>
<area shape="rect" href="namespacematrix__operations.html#a6aab014a9001ac1cbb2e46bba4171cd9" title=": DP = (C)^T U_ALL" alt="" coords="175,71,324,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_icgraph" id="multi__dyncore__dg_8_f90_a53b2f85c6a8345f6316959365e52bd83_icgraph">
<area shape="rect" title="Calculates the divergence of the velocity by multipliying it by the Ct matrix." alt="" coords="991,13,1112,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="724,38,943,65"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a9996f3a8552933cf3c0fc9672de6ec86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9996f3a8552933cf3c0fc9672de6ec86">&#9670;&nbsp;</a></span>effective_cp_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine intenerge_assem_solve::effective_cp_density </td>
          <td>(</td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>porous_heat_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>porous_heat_coef_old</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Checks convergence on the temperature field Calculation of the averaged heat capacity and density average = porosity * Cp_f*rho_f + (1-porosity) * CP_p*rho_p Since porous promerties is defined element-wise and fluid properties CV-wise we perform an average as it is stored cv-wise </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a9996f3a8552933cf3c0fc9672de6ec86_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a9996f3a8552933cf3c0fc9672de6ec86_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a9996f3a8552933cf3c0fc9672de6ec86_icgraph" id="multi__dyncore__dg_8_f90_a9996f3a8552933cf3c0fc9672de6ec86_icgraph">
<area shape="rect" title=": Checks convergence on the temperature field Calculation of the averaged heat capacity and density a..." alt="" coords="981,42,1139,69"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="749,35,933,76"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,64,701,105"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,71,396,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a2ca070e362a90a07dcb98eada12a622f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ca070e362a90a07dcb98eada12a622f">&#9670;&nbsp;</a></span>ensure_components_sum_to_one()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine compositional_assemble_solve::ensure_components_sum_to_one </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WARNING: It is currently not working well...better to use Chris' method which uses a RHS. </p>

</div>
</div>
<a id="ad3c0d8ed87bdfa9ff27a1048406ecd2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3c0d8ed87bdfa9ff27a1048406ecd2f">&#9670;&nbsp;</a></span>flip_p_and_v_bcs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::flip_p_and_v_bcs </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :,:,: ), intent(in)&#160;</td>
          <td class="paramname"><em>WIC_P_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field)&#160;</td>
          <td class="paramname"><em>pressure_BCs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( 1,mdims%npres,surface_element_count(pressure)), intent(out)&#160;</td>
          <td class="paramname"><em>WIC_FLIP_P_VEL_BCS</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Flip P and V BCs for wells. Implemented for ATES applications or other applications when needing to switch on and off wells. For this to work, need to define boundary conditions for wells for both pressure and velocity in a time-dependent manner through Diamond using a python function. When the user wants the pressure BC to be ignored and the velocity BC to be applied, specify negative pressure. When the user wants the pressure BC to applied, specify normal positive pressure. Specify velocity BCs for both wells as a constant. </p>
<dl class="section author"><dt>Author</dt><dd>Geraldine Regnier </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_ad3c0d8ed87bdfa9ff27a1048406ecd2f_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_ad3c0d8ed87bdfa9ff27a1048406ecd2f_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_ad3c0d8ed87bdfa9ff27a1048406ecd2f_icgraph" id="multi__dyncore__dg_8_f90_ad3c0d8ed87bdfa9ff27a1048406ecd2f_icgraph">
<area shape="rect" title="Flip P and V BCs for wells. Implemented for ATES applications or other applications when needing to s..." alt="" coords="724,13,857,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a15505780dc171eceae929e55d7951913"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15505780dc171eceae929e55d7951913">&#9670;&nbsp;</a></span>for_tens_derivs_ndots()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine diffus_cal_coeff_stress_or_tensor::for_tens_derivs_ndots </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim,nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>DIFF_STAND_DIVDX_U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim_vel,nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>N_DOT_DKDU</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim_vel,nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>N_DOT_DKDUOLD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim_vel, ndim,ndim, nphase, sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>DIFF_GI_ADDED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim_vel, ndim , nphase, u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_DUX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim_vel, ndim , nphase, u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_DUOLDX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim,ndim,nphase,cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_UDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase,cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SLOC_UDIFFUSION_VOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM_VEL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SBCVNGI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi, u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SBUFEN_REVERSED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi, cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>SBCVFEN_REVERSED</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>SNORMXN_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>HDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ZERO_OR_TWO_THIRDS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>STRESS_FORM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>STRESS_FORM_STAB</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This implements the stress and tensor form of diffusion and calculates a jump conidition. DIFF_STAND_DIVDX_U is the minimal amount of diffusion. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a15505780dc171eceae929e55d7951913_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a15505780dc171eceae929e55d7951913_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a15505780dc171eceae929e55d7951913_icgraph" id="multi__dyncore__dg_8_f90_a15505780dc171eceae929e55d7951913_icgraph">
<area shape="rect" title="This implements the stress and tensor form of diffusion and calculates a jump conidition...." alt="" coords="1597,20,1763,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f" title=": &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,..." alt="" coords="1371,5,1549,61"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,20,1323,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,20,1147,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,20,908,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,13,676,54"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,419,54"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,54"/>
</map>
</div>

</div>
</div>
<a id="a86babf83394e349a6bb014238237de1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86babf83394e349a6bb014238237de1f">&#9670;&nbsp;</a></span>generate_pivit_matrix_stokes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::generate_pivit_matrix_stokes </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>MASS_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(in)&#160;</td>
          <td class="paramname"><em>diagonal_A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generates a lumped mass matrix for Stokes. It can either have also the diagonal of A or not. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a86babf83394e349a6bb014238237de1f_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a86babf83394e349a6bb014238237de1f_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a86babf83394e349a6bb014238237de1f_icgraph" id="multi__dyncore__dg_8_f90_a86babf83394e349a6bb014238237de1f_icgraph">
<area shape="rect" title="Generates a lumped mass matrix for Stokes. It can either have also the diagonal of A or not." alt="" coords="724,5,891,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="ae2e637a6ef27761363d224b3d7869c6a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2e637a6ef27761363d224b3d7869c6a">&#9670;&nbsp;</a></span>get_all_in_mass_matrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine assemb_force_cty::get_all_in_mass_matrix </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension ( :, :, :,   :, :, :,   : ), intent(in)&#160;</td>
          <td class="paramname"><em>DIAG_BIGM_CON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>LUMP_PIVIT_ON_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>LUMP_DIAG_MOM</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WARNING****this is under testing****. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_ae2e637a6ef27761363d224b3d7869c6a_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_ae2e637a6ef27761363d224b3d7869c6a_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_ae2e637a6ef27761363d224b3d7869c6a_icgraph" id="multi__dyncore__dg_8_f90_ae2e637a6ef27761363d224b3d7869c6a_icgraph">
<area shape="rect" title="WARNING****this is under testing****." alt="" coords="1371,13,1548,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a6a7f0d36d29011eddc120ea33cb763db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a7f0d36d29011eddc120ea33cb763db">&#9670;&nbsp;</a></span>get_massmatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_assemb_force_cty::get_massmatrix </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dev_shape_funs), intent(in)&#160;</td>
          <td class="paramname"><em>DevFuns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>UFEN_REVERSED</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE, AND GET_POROUS_MASS_MATRIX IS KEPT FOR THE DIAGONAL SCALING METHOD. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_cgraph" id="multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_cgraph">
<area shape="rect" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="5,516,133,543"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="199,5,389,32"/>
<area shape="rect" href="namespacecv__advection.html#aa3ef74a90808188963586069f9231675" title="determine stress form of viscocity..." alt="" coords="467,353,610,394"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="189,122,399,163"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a75a4fb88f761b81639c9b81628eddc95" title=": &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="209,647,379,689"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af5917482b2dae4c57c6e06a839682e42" title=":&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used t..." alt="" coords="209,269,379,310"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a29b95710b57b76fd0d961ec749a71304" title=" " alt="" coords="210,57,378,98"/>
<area shape="rect" href="namespacecv__advection.html#aba06a5f3680d58e1db30e740119dd5dc" title="Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))" alt="" coords="181,385,407,412"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f" title=": &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,..." alt="" coords="205,188,383,244"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#ae2e637a6ef27761363d224b3d7869c6a" title="WARNING****this is under testing****." alt="" coords="205,516,383,543"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1" title=": This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example..." alt="" coords="209,567,379,623"/>
<area shape="rect" href="namespacecv__advection.html#a3778683fc29bd4646b518eec834d1b2b" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="211,436,377,492"/>
<area shape="rect" href="namespacematrix__operations.html#a11255cf3f07959a2d3e20dd8705755fe" title="calculate DMATINV" alt="" coords="219,778,369,819"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a34cd5ba5d5dfec039fa896b5fdc14e9f" title=": &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="209,713,379,754"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a24c9e30f49053a0f6dfe4ad7f5f73de9" title=": Computes a limited velocity when using a P0DG velocity discretisation" alt="" coords="250,844,338,871"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8e2d722ec8283f1e4d87f7b6d7e427a5" title="Used to assemble the C matrix in the ICFERST format." alt="" coords="207,975,381,1017"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a25c88bda5ea4082016d39781e111d445" title="Used to assemble the C matrix in the ICFERST format (for DG?)" alt="" coords="207,895,381,951"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="197,1041,391,1082"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="468,688,609,715"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a915ed0656cc376f20e85f62cd9cec4de" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="455,57,623,98"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a15505780dc171eceae929e55d7951913" title="This implements the stress and tensor form of diffusion and calculates a jump conidition...." alt="" coords="456,203,621,229"/>
<area shape="rect" href="namespacecv__advection.html#a6f557f5a7dfeffca4640671937d7e141" title="determine stress form of viscocity..." alt="" coords="465,443,612,485"/>
<area shape="rect" href="namespacematrix__operations.html#a3795359fc116fe5770ad11a89bbccc00" title=": This sub finds the inverse of the matrix A and puts it back in A. MAT, MAT2, X and B are working ve..." alt="" coords="464,778,613,819"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="464,939,613,981"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="461,1041,616,1082"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="671,1048,788,1075"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="836,1048,897,1075"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181" title=" " alt="" coords="945,1023,1009,1049"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="946,1073,1009,1100"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_icgraph" id="multi__dyncore__dg_8_f90_a6a7f0d36d29011eddc120ea33cb763db_icgraph">
<area shape="rect" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a44f668c16758cc5da708c38932a4e53e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44f668c16758cc5da708c38932a4e53e">&#9670;&nbsp;</a></span>get_relative_permeability()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine ai_backtracking_parameters::get_relative_permeability </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>Imble_frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>end_point_relperm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>exponent_relperm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(out)&#160;</td>
          <td class="paramname"><em>relperm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a44f668c16758cc5da708c38932a4e53e_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a44f668c16758cc5da708c38932a4e53e_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a44f668c16758cc5da708c38932a4e53e_icgraph" id="multi__dyncore__dg_8_f90_a44f668c16758cc5da708c38932a4e53e_icgraph">
<area shape="rect" title=" " alt="" coords="1019,13,1209,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae48bbf14b3a637156be0ca7daefc590c" title="Subroutine that calculates the backtrack_par_factor based on Machine Learning. The inputs of the Mach..." alt="" coords="756,5,971,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,5,708,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="aa5bc5bc1a7d8c32c0a8f667b03648f64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5bc5bc1a7d8c32c0a8f667b03648f64">&#9670;&nbsp;</a></span>include_wells_and_compressibility_into_rhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::include_wells_and_compressibility_into_rhs </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>DIAG_SCALE_PRES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>MASS_MN_PRES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>MASS_SUF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_pipe_package), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>DIAG_SCALE_PRES_COUP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Include in the pressure matrix the compressibility terms (based on taylor expansion series) to ensure that we account for this term as implicitly as possible. For wells it introduces the coupling between pressures. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_aa5bc5bc1a7d8c32c0a8f667b03648f64_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_aa5bc5bc1a7d8c32c0a8f667b03648f64_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_aa5bc5bc1a7d8c32c0a8f667b03648f64_icgraph" id="multi__dyncore__dg_8_f90_aa5bc5bc1a7d8c32c0a8f667b03648f64_icgraph">
<area shape="rect" title="Include in the pressure matrix the compressibility terms (based on taylor expansion series) to ensure..." alt="" coords="991,5,1239,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="724,38,943,65"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a7a5112eda36874919ad0ce46f54978c4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a5112eda36874919ad0ce46f54978c4">&#9670;&nbsp;</a></span>jacdia()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine viscocity_tensor_les_calc::jacdia </td>
          <td>(</td>
          <td class="paramtype">real, dimension(n,n)&#160;</td>
          <td class="paramname"><em>AA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n,n)&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n)&#160;</td>
          <td class="paramname"><em>D</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n,n)&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find the eigen-vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal. It uses the algorithm of Matrix Computations 2nd edition, p196. sprint_to_do!!!!MOVE TO FORTRAN 90 </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_cgraph" id="multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_cgraph">
<area shape="rect" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="5,31,67,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181" title=" " alt="" coords="115,5,179,32"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="115,56,178,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_icgraph" id="multi__dyncore__dg_8_f90_a7a5112eda36874919ad0ce46f54978c4_icgraph">
<area shape="rect" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="1981,13,2043,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="1816,13,1933,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="1613,5,1768,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="1371,5,1565,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a09643136688e87eec9171d22ab63d181"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09643136688e87eec9171d22ab63d181">&#9670;&nbsp;</a></span>jacpos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine viscocity_tensor_les_calc::jacpos </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>SINALF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>COSALF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n,n)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a09643136688e87eec9171d22ab63d181_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a09643136688e87eec9171d22ab63d181_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a09643136688e87eec9171d22ab63d181_icgraph" id="multi__dyncore__dg_8_f90_a09643136688e87eec9171d22ab63d181_icgraph">
<area shape="rect" title=" " alt="" coords="2091,13,2155,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="1981,13,2043,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="1816,13,1933,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="1613,5,1768,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="1371,5,1565,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a58cac3905be09f7b7a02061cfef6ef01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a58cac3905be09f7b7a02061cfef6ef01">&#9670;&nbsp;</a></span>jacpre()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine viscocity_tensor_les_calc::jacpre </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>SINALF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>COSALF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>Q</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(n,n)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>N</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>PRE-MULTIPLY matrix A by transpose of Rotation matrix is realised by passing -SINALF down into SINALF. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a58cac3905be09f7b7a02061cfef6ef01_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a58cac3905be09f7b7a02061cfef6ef01_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a58cac3905be09f7b7a02061cfef6ef01_icgraph" id="multi__dyncore__dg_8_f90_a58cac3905be09f7b7a02061cfef6ef01_icgraph">
<area shape="rect" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="2091,13,2153,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="1981,13,2043,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="1816,13,1933,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="1613,5,1768,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="1371,5,1565,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a68747c78369c5abd8f6bce5ae5d0bec7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68747c78369c5abd8f6bce5ae5d0bec7">&#9670;&nbsp;</a></span>mult_inv_mass_vel_vector()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::mult_inv_mass_vel_vector </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>vel_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>MASS_ELE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Multiplies the inv of the lumped mass matrix times the vel_vector vel_vector = vel_vector / (mass_ele/vel_local_nodes) </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a68747c78369c5abd8f6bce5ae5d0bec7_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a68747c78369c5abd8f6bce5ae5d0bec7_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a68747c78369c5abd8f6bce5ae5d0bec7_icgraph" id="multi__dyncore__dg_8_f90_a68747c78369c5abd8f6bce5ae5d0bec7_icgraph">
<area shape="rect" title="Multiplies the inv of the lumped mass matrix times the vel_vector vel_vector = vel_vector / (mass_ele..." alt="" coords="991,13,1187,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="724,13,943,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a41b4850724ffd0c17e8300f4eaa60296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a41b4850724ffd0c17e8300f4eaa60296">&#9670;&nbsp;</a></span>oneeletens_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine viscocity_tensor_les_calc::oneeletens_all </td>
          <td>(</td>
          <td class="paramtype">real, dimension(ndim,x_nloc), intent(in)&#160;</td>
          <td class="paramname"><em>LOC_X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LES_DISOPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>ONE_OVER_H2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ndim,ndim, nphase), intent(inout)&#160;</td>
          <td class="paramname"><em>TENSXX_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(ndim,ndim, nphase), intent(in)&#160;</td>
          <td class="paramname"><em>MEAN_UDER_U</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_cgraph" id="multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_cgraph">
<area shape="rect" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="5,31,123,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="171,31,232,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181" title=" " alt="" coords="280,5,344,32"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="281,56,343,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_icgraph" id="multi__dyncore__dg_8_f90_a41b4850724ffd0c17e8300f4eaa60296_icgraph">
<area shape="rect" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="1816,13,1933,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="1613,5,1768,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="1371,5,1565,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a24c9e30f49053a0f6dfe4ad7f5f73de9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24c9e30f49053a0f6dfe4ad7f5f73de9">&#9670;&nbsp;</a></span>p0_limiter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine assemb_force_cty::p0_limiter</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes a limited velocity when using a P0DG velocity discretisation </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a24c9e30f49053a0f6dfe4ad7f5f73de9_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a24c9e30f49053a0f6dfe4ad7f5f73de9_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a24c9e30f49053a0f6dfe4ad7f5f73de9_icgraph" id="multi__dyncore__dg_8_f90_a24c9e30f49053a0f6dfe4ad7f5f73de9_icgraph">
<area shape="rect" title=": Computes a limited velocity when using a P0DG velocity discretisation" alt="" coords="1371,13,1459,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="aa2eb04d27443c785084566c701903207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa2eb04d27443c785084566c701903207">&#9670;&nbsp;</a></span>porous_assemb_force_cty()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_assemb_force_cty::porous_assemb_force_cty </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_gi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>FE_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_shape_funs), intent(in)&#160;</td>
          <td class="paramname"><em>FE_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_sparsities), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>U_SOURCE_CV_ALL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>and faster to compute than for Navier-Stokes. Therefore, here the RHS and the Mass matrix are computed for this case </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_cgraph" id="multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_cgraph">
<area shape="rect" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="5,161,196,188"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="437,5,628,32"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="427,57,638,98"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a29b95710b57b76fd0d961ec749a71304" title=" " alt="" coords="449,122,617,163"/>
<area shape="rect" href="namespacecv__advection.html#aba06a5f3680d58e1db30e740119dd5dc" title="Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))" alt="" coords="420,188,645,215"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="244,484,372,511"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a03c49a0f1a67a464bbb77115775ae4d1" title=": This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example..." alt="" coords="448,1027,617,1083"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a915ed0656cc376f20e85f62cd9cec4de" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="693,122,861,163"/>
<area shape="rect" href="namespacecv__advection.html#aa3ef74a90808188963586069f9231675" title="determine stress form of viscocity..." alt="" coords="706,450,849,491"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a75a4fb88f761b81639c9b81628eddc95" title=": &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="448,647,617,689"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af5917482b2dae4c57c6e06a839682e42" title=":&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used t..." alt="" coords="448,713,617,754"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a44c487b15ec28694d3d4e75dd952d27f" title=": &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,..." alt="" coords="443,779,622,835"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#ae2e637a6ef27761363d224b3d7869c6a" title="WARNING****this is under testing****." alt="" coords="444,859,621,885"/>
<area shape="rect" href="namespacecv__advection.html#a3778683fc29bd4646b518eec834d1b2b" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="449,501,616,557"/>
<area shape="rect" href="namespacematrix__operations.html#a11255cf3f07959a2d3e20dd8705755fe" title="calculate DMATINV" alt="" coords="458,910,607,951"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a34cd5ba5d5dfec039fa896b5fdc14e9f" title=": &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="448,582,617,623"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a24c9e30f49053a0f6dfe4ad7f5f73de9" title=": Computes a limited velocity when using a P0DG velocity discretisation" alt="" coords="489,976,577,1003"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8e2d722ec8283f1e4d87f7b6d7e427a5" title="Used to assemble the C matrix in the ICFERST format." alt="" coords="445,319,620,361"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a25c88bda5ea4082016d39781e111d445" title="Used to assemble the C matrix in the ICFERST format (for DG?)" alt="" coords="445,239,620,295"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="435,385,630,426"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="707,623,848,649"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a15505780dc171eceae929e55d7951913" title="This implements the stress and tensor form of diffusion and calculates a jump conidition...." alt="" coords="695,793,860,820"/>
<area shape="rect" href="namespacecv__advection.html#a6f557f5a7dfeffca4640671937d7e141" title="determine stress form of viscocity..." alt="" coords="704,515,851,557"/>
<area shape="rect" href="namespacematrix__operations.html#a3795359fc116fe5770ad11a89bbccc00" title=": This sub finds the inverse of the matrix A and puts it back in A. MAT, MAT2, X and B are working ve..." alt="" coords="703,910,852,951"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="703,283,852,325"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aac4e80d22e26450266e054deedd13fc9" title=" " alt="" coords="700,385,855,426"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="909,392,1027,419"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="1075,392,1136,419"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181" title=" " alt="" coords="1184,367,1248,393"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="1185,417,1247,444"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_icgraph" id="multi__dyncore__dg_8_f90_aa2eb04d27443c785084566c701903207_icgraph">
<area shape="rect" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a0eb7a61a4dc66651096b6fabc6739ea3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0eb7a61a4dc66651096b6fabc6739ea3">&#9670;&nbsp;</a></span>project_velocity_to_affine_space()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::project_velocity_to_affine_space </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(in)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_sparsities), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>deltap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>cdp_tensor</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Project back the velocity from a non divergent-free space to a divergent free space. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_cgraph" id="multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_cgraph">
<area shape="rect" title="Project back the velocity from a non divergent&#45;free space to a divergent free space." alt="" coords="5,39,152,80"/>
<area shape="rect" href="namespacematrix__operations.html#a3cf9d9f54e55a501e927c1ae443093f0" title=": Performs the multiplication CDP_tensor = MmatC * deltap" alt="" coords="206,5,357,47"/>
<area shape="rect" href="namespacematrix__operations.html#a501c5d1025991dd3e563d635362b475b" title=": U = Mass_matrix * Vector (tipically vector is Grad * P + RHS and this is used to obtain the velocit..." alt="" coords="200,71,363,112"/>
<area shape="rect" href="namespacematrix__operations.html#a895e0f98ecb17a8541be87879adf8876" title=": CDP=C*DP" alt="" coords="411,5,560,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_icgraph" id="multi__dyncore__dg_8_f90_a0eb7a61a4dc66651096b6fabc6739ea3_icgraph">
<area shape="rect" title="Project back the velocity from a non divergent&#45;free space to a divergent free space." alt="" coords="724,5,871,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a4d12626bedcc63285cc6c18affa3842e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d12626bedcc63285cc6c18affa3842e">&#9670;&nbsp;</a></span>shock_front_in_ele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function ai_backtracking_parameters::shock_front_in_ele </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>Imble_frac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a4d12626bedcc63285cc6c18affa3842e_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a4d12626bedcc63285cc6c18affa3842e_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a4d12626bedcc63285cc6c18affa3842e_icgraph" id="multi__dyncore__dg_8_f90_a4d12626bedcc63285cc6c18affa3842e_icgraph">
<area shape="rect" title=" " alt="" coords="1019,13,1163,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae48bbf14b3a637156be0ca7daefc590c" title="Subroutine that calculates the backtrack_par_factor based on Machine Learning. The inputs of the Mach..." alt="" coords="756,5,971,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,5,708,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a13ad5090251312f4fc0f9aaf83b05e8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13ad5090251312f4fc0f9aaf83b05e8c">&#9670;&nbsp;</a></span>shock_front_mobility_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function ai_backtracking_parameters::shock_front_mobility_ratio </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>Imble_frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>total_mobility</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a13ad5090251312f4fc0f9aaf83b05e8c_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a13ad5090251312f4fc0f9aaf83b05e8c_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a13ad5090251312f4fc0f9aaf83b05e8c_icgraph" id="multi__dyncore__dg_8_f90_a13ad5090251312f4fc0f9aaf83b05e8c_icgraph">
<area shape="rect" title=" " alt="" coords="1019,5,1177,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae48bbf14b3a637156be0ca7daefc590c" title="Subroutine that calculates the backtrack_par_factor based on Machine Learning. The inputs of the Mach..." alt="" coords="756,5,971,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,5,708,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="ae8a4aa21acf8febcc4fec45af279f33d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8a4aa21acf8febcc4fec45af279f33d">&#9670;&nbsp;</a></span>solve_and_update_pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::solve_and_update_pressure </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%npres, mdims%cv_nonods), intent(inout)&#160;</td>
          <td class="paramname"><em>P_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>deltap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(petsc_csr_matrix), intent(inout)&#160;</td>
          <td class="paramname"><em>cmc_petsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%npres, mdims%cv_nonods), intent(in)&#160;</td>
          <td class="paramname"><em>diagonal_CMC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>update_pres</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Compute deltaP by solving the pressure equation using the CMC matrix. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_ae8a4aa21acf8febcc4fec45af279f33d_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_ae8a4aa21acf8febcc4fec45af279f33d_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_ae8a4aa21acf8febcc4fec45af279f33d_icgraph" id="multi__dyncore__dg_8_f90_ae8a4aa21acf8febcc4fec45af279f33d_icgraph">
<area shape="rect" title="Compute deltaP by solving the pressure equation using the CMC matrix." alt="" coords="991,13,1193,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="724,38,943,65"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a5a525a502553802a5ecbe7a138b1575c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a525a502553802a5ecbe7a138b1575c">&#9670;&nbsp;</a></span>solve_and_update_velocity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::solve_and_update_velocity </td>
          <td>(</td>
          <td class="paramtype">type (multi_matrices), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>Velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>CDP_tensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim * mdims%nphase, mdims%u_nonods), intent(in)&#160;</td>
          <td class="paramname"><em>U_RHS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>diagonal_A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Update velocity by solving the momentum equation for a given pressure, the RHS is formed here If rescale_mom_matrices = .true., here the RHS rescaled. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a5a525a502553802a5ecbe7a138b1575c_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a5a525a502553802a5ecbe7a138b1575c_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a5a525a502553802a5ecbe7a138b1575c_icgraph" id="multi__dyncore__dg_8_f90_a5a525a502553802a5ecbe7a138b1575c_icgraph">
<area shape="rect" title="Update velocity by solving the momentum equation for a given pressure, the RHS is formed here If resc..." alt="" coords="991,13,1189,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09c428fa5a27cf3407e6a1bcc917f161" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="724,38,943,65"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a09c428fa5a27cf3407e6a1bcc917f161"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09c428fa5a27cf3407e6a1bcc917f161">&#9670;&nbsp;</a></span>stokes_anderson_acceleration()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine force_bal_cty_assem_solve::stokes_anderson_acceleration </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_matrices), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_sparsities), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>INV_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>MASS_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>diagonal_A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>P_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( vector_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>deltap</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(petsc_csr_matrix), intent(inout)&#160;</td>
          <td class="paramname"><em>cmc_petsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>stokes_max_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results for a system that converges based on a FPI and finding an optimal combination of all of these results that minimise the residual Method explained in DOI.10.1137/16M1076770. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_cgraph" id="multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_cgraph">
<area shape="rect" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="5,217,224,243"/>
<area shape="rect" href="namespacematrix__operations.html#a3cf9d9f54e55a501e927c1ae443093f0" title=": Performs the multiplication CDP_tensor = MmatC * deltap" alt="" coords="321,9,471,51"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a53b2f85c6a8345f6316959365e52bd83" title="Calculates the divergence of the velocity by multipliying it by the Ct matrix." alt="" coords="335,78,457,105"/>
<area shape="rect" href="namespacesolvers__module.html#a119325e40cdcd54b1766472b55920364" title="This subroutine provides a new guess based on previous updates and residuals. Use this subroutine to ..." alt="" coords="308,129,484,185"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa5bc5bc1a7d8c32c0a8f667b03648f64" title="Include in the pressure matrix the compressibility terms (based on taylor expansion series) to ensure..." alt="" coords="272,209,520,251"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a68747c78369c5abd8f6bce5ae5d0bec7" title="Multiplies the inv of the lumped mass matrix times the vel_vector vel_vector = vel_vector / (mass_ele..." alt="" coords="298,275,494,302"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#ae8a4aa21acf8febcc4fec45af279f33d" title="Compute deltaP by solving the pressure equation using the CMC matrix." alt="" coords="295,326,497,353"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a5a525a502553802a5ecbe7a138b1575c" title="Update velocity by solving the momentum equation for a given pressure, the RHS is formed here If resc..." alt="" coords="297,377,495,403"/>
<area shape="rect" href="namespacematrix__operations.html#a895e0f98ecb17a8541be87879adf8876" title=": CDP=C*DP" alt="" coords="568,5,717,47"/>
<area shape="rect" href="namespacematrix__operations.html#aca7d06edf5bee7b9e5c00830ee444478" title=":CV_RHS=CT*U" alt="" coords="568,71,717,112"/>
<area shape="rect" href="namespacematrix__operations.html#a6aab014a9001ac1cbb2e46bba4171cd9" title=": DP = (C)^T U_ALL" alt="" coords="568,136,717,177"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_icgraph" id="multi__dyncore__dg_8_f90_a09c428fa5a27cf3407e6a1bcc917f161_icgraph">
<area shape="rect" title="Generic subroutine that perform the Anderson acceleration solver. This is storing a set of results fo..." alt="" coords="724,13,943,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a171ba3eb037458ea0b2f128257e43588"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a171ba3eb037458ea0b2f128257e43588">&#9670;&nbsp;</a></span>update_components()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine volumefraction_assemble_solve::update_components</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>WARNING: Still work in progress. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_a171ba3eb037458ea0b2f128257e43588_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_a171ba3eb037458ea0b2f128257e43588_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_a171ba3eb037458ea0b2f128257e43588_cgraph" id="multi__dyncore__dg_8_f90_a171ba3eb037458ea0b2f128257e43588_cgraph">
<area shape="rect" title="WARNING: Still work in progress." alt="" coords="5,983,160,1010"/>
<area shape="rect" href="namespacematrix__operations.html#ab99709a532cd3a8ace8bd896814bc37b" title=" " alt="" coords="225,895,426,951"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="208,976,443,1017"/>
<area shape="rect" href="namespacesolvers__module.html#a9bba1ef1495c1a4a47a7eea3f2c17719" title=":This subroutines eliminates the oscillations in the saturation that are bigger than a certain tolera..." alt="" coords="535,1073,716,1115"/>
<area shape="rect" href="namespacecompositional__terms.html#ab7087656dea2acf341899e4e7a7f8eca" title="make sure the composition sums to 1.0" alt="" coords="531,1008,720,1049"/>
<area shape="rect" href="namespacecompositional__terms.html#ad2f5aa04b8878cd5cd9b0c4c23608bea" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="491,692,760,733"/>
<area shape="rect" href="namespacecv__advection.html#ae1eba9d13ff146b1bf390a5de461d421" title="This subroutine counts then number of faces in the control volume space." alt="" coords="538,797,713,839"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="533,943,717,984"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="1136,1737,1317,1779"/>
<area shape="rect" href="namespacecompositional__terms.html#a8d067de83d2c706f165e514f8a9ca1c8" title="Method to flash components." alt="" coords="857,147,1016,188"/>
<area shape="rect" href="namespacecompositional__terms.html#a84fea13095aadece40e1765da26a2297" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="1147,5,1306,47"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="1139,71,1315,112"/>
<area shape="rect" href="namespacecompositional__terms.html#a5854731522b8b3e1b37deb7cfe6814c2" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="808,1803,1065,1844"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="841,768,1033,809"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="841,833,1033,875"/>
<area shape="rect" href="namespacecv__advection.html#a34e0fcace33673c6460aef98e962709e" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="842,899,1031,926"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86" title=": Checks convergence on the temperature field Calculation of the averaged heat capacity and density a..." alt="" coords="858,950,1015,977"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a86c48c7bcc5921e6764217e562a7b5d6" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="839,1001,1034,1043"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="826,1067,1047,1108"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="845,1132,1029,1173"/>
<area shape="rect" href="namespacecompositional__terms.html#a747fbf8752c32e5d741465ea409d6319" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="1147,1868,1306,1909"/>
<area shape="rect" href="namespacecompositional__terms.html#ad493264ab6df90982606d40e8b794a2e" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="1147,1803,1306,1844"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="1388,863,1599,904"/>
<area shape="rect" href="namespacemulti__data__types.html#a0a02226803b07ac9bb8cbf05f9d0ab6a" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="1129,921,1324,963"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaff0fabb63f42671a6a051512b761705" title=" " alt="" coords="1169,238,1285,265"/>
<area shape="rect" href="namespacecv__advection.html#ad76059547a9ad0bf6e0fdac35af6d724" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="1407,263,1580,290"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="1136,987,1317,1028"/>
<area shape="rect" href="namespacecv__advection.html#a46d56280fc42d8db708b1658f9d4d6cb" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="1155,1052,1298,1093"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="1131,1118,1322,1145"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="1139,1169,1315,1195"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ae23b2b5b8e264b0e1b498f4e28f1c18d" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="1127,1220,1326,1261"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="1121,1285,1332,1327"/>
<area shape="rect" href="namespacecv__advection.html#a98ae89956725fc2c1d2ad41642f6fe04" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="1150,1351,1303,1392"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#afb4e96858b9341a76e72da5321bb4562" title=" " alt="" coords="1159,1417,1294,1443"/>
<area shape="rect" href="namespacecv__advection.html#a581f8fe3e0c643ca294adf375008b018" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="1156,1468,1297,1509"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a427571cc398104aab11b15662262c017" title="Computes the flux between CVs." alt="" coords="1155,1534,1299,1561"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a721d9557da90724f09df1b2086a97119" title="Computes the flux between CVs." alt="" coords="1147,1585,1307,1611"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a89933f3d5d5183f002dece1a1e67174c" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="1141,1635,1313,1662"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a613230535e80cb2894e9b6447ce613e9" title=" " alt="" coords="1146,1686,1307,1713"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="1113,137,1340,163"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="1117,187,1337,214"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a96760a6f67a04d4191273b6a034697fb" title=" " alt="" coords="1133,339,1321,366"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a7c45215f7bff94897216c155967c06e4" title="If PACK then pack T_ALL into LOC_F as long at IGOT_T==1 and STORE and not already in storage." alt="" coords="1181,390,1272,417"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="1150,441,1303,483"/>
<area shape="rect" href="namespacecv__advection.html#ae629d3a52942059265356baccf02b919" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="1141,507,1313,548"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="1130,572,1323,613"/>
<area shape="rect" href="namespacecv__advection.html#a33cb5d5dfd5eced81d2952c7dcd294d5" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="1156,637,1297,679"/>
<area shape="rect" href="namespacecv__advection.html#af3ad992b05f1087fdb1d5bcd7d6c500e" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="1149,703,1305,744"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="1151,769,1302,795"/>
<area shape="rect" href="namespacecv__advection.html#a7a433d2f6b47e86ffdbc1fc4af1e7a05" title=" " alt="" coords="1139,819,1314,846"/>
</map>
</div>

</div>
</div>
<a id="aac4e80d22e26450266e054deedd13fc9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac4e80d22e26450266e054deedd13fc9">&#9670;&nbsp;</a></span>viscocity_tensor_les_calc_u()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine viscocity_tensor_les_calc::viscocity_tensor_les_calc_u </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, u_nloc, totele  ), intent(inout)&#160;</td>
          <td class="paramname"><em>LES_U_UDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, u_nloc, totele  ), intent(inout)&#160;</td>
          <td class="paramname"><em>LES_U_UDIFFUSION_VOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, u_nloc, totele  ), intent(inout)&#160;</td>
          <td class="paramname"><em>Q_SCHEME_ABS_CONT_VOL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, u_nloc, totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>DUX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>TOTELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, x_nonods  ), intent(in)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( x_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>X_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>LES_DISOPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>U_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>U_NONODS</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, u_nonods  ), intent(in)&#160;</td>
          <td class="paramname"><em>U_ALL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_cgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_cgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_cgraph" id="multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_cgraph">
<area shape="rect" title=" " alt="" coords="5,23,160,65"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a41b4850724ffd0c17e8300f4eaa60296" title="REPRESENTS THE SIZE AND SHAPE OF THE SURROUNDING ELEMENTS. LES_DISOPT=LES option." alt="" coords="208,31,325,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a7a5112eda36874919ad0ce46f54978c4" title="find the eigen&#45;vectors V and the eigen values A so that AA=V^T D V &amp; D is diagonal...." alt="" coords="373,31,435,57"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a09643136688e87eec9171d22ab63d181" title=" " alt="" coords="483,5,547,32"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a58cac3905be09f7b7a02061cfef6ef01" title="PRE&#45;MULTIPLY matrix A by transpose of Rotation matrix is realised by passing &#45;SINALF down into SINALF..." alt="" coords="483,56,546,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_icgraph.png" border="0" usemap="#multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_icgraph" alt=""/></div>
<map name="multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_icgraph" id="multi__dyncore__dg_8_f90_aac4e80d22e26450266e054deedd13fc9_icgraph">
<area shape="rect" title=" " alt="" coords="1613,5,1768,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afcedae35a0a37c9b033248d85bb9ad86" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="1371,5,1565,47"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a6a7f0d36d29011eddc120ea33cb763db" title="Here no homogenisation can be performed. NOTE: FOR THE TIME BEING ONLY ROW_SUM IS ACTIVATED HERE,..." alt="" coords="1195,13,1323,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="956,13,1147,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a1329a9f2f2cb2da28424447b49428e34" title=" " alt="" coords="724,13,908,39"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="multi__dyncore__dg_8_f90.html">multi_dyncore_dg.F90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
