<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: multiphase_eos Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICFERST
   &#160;<span id="projectnumber">25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacemultiphase__eos.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">multiphase_eos Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains subroutines related to the equations of state and other properties such as relative permeabilities, capillary, flash, etc.  
<a href="namespacemultiphase__eos.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ab16c45da0af88c69945beac4e3334349"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349">calculate_all_rhos</a> (state, packed_state, Mdims, get_RhoCp)</td></tr>
<tr class="memdesc:ab16c45da0af88c69945beac4e3334349"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density for the phases and the derivatives of the density  <a href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349">More...</a><br /></td></tr>
<tr class="separator:ab16c45da0af88c69945beac4e3334349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45791df12ab50edf07b075fc8c83335"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa45791df12ab50edf07b075fc8c83335">cap_bulk_rho</a> (state, ncomp, nphase, cv_nonods, Density_Component, Density, Density_Cp, compute_rhoCP)</td></tr>
<tr class="memdesc:aa45791df12ab50edf07b075fc8c83335"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the bulk density for components and the derivatives of the density  <a href="namespacemultiphase__eos.html#aa45791df12ab50edf07b075fc8c83335">More...</a><br /></td></tr>
<tr class="separator:aa45791df12ab50edf07b075fc8c83335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c4f57d9c50b3421a8059d73fb260dd5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5">calculate_component_rho</a> (state, packed_state, Mdims)</td></tr>
<tr class="memdesc:a3c4f57d9c50b3421a8059d73fb260dd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density for the components and the derivatives of the density This is were the action is actually done, the other calculate rhos are wrappers  <a href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5">More...</a><br /></td></tr>
<tr class="separator:a3c4f57d9c50b3421a8059d73fb260dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6a1c7227872bf2073b960ddfabedee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee">calculate_rho_drhodp</a> (state, packed_state, iphase, icomp, nphase, ncomp, eos_option_path, rho, drhodp)</td></tr>
<tr class="memdesc:a3f6a1c7227872bf2073b960ddfabedee"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density and the derivative of the density  <a href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee">More...</a><br /></td></tr>
<tr class="separator:a3f6a1c7227872bf2073b960ddfabedee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab548da6c93ce257b9cec9b1c27a9390a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ab548da6c93ce257b9cec9b1c27a9390a">calculate_porous_rho_drhop</a> (state, packed_state, Mdims, cv_ndgln, drhodp_porous)</td></tr>
<tr class="memdesc:ab548da6c93ce257b9cec9b1c27a9390a"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine we calculate and update the density of the porous media based on the compressibility given in Diamond (ele-wise). We also calculate the drho/dp term for the porous media which then goes into the DERIV term in the continuity equation (cv-wise).  <a href="namespacemultiphase__eos.html#ab548da6c93ce257b9cec9b1c27a9390a">More...</a><br /></td></tr>
<tr class="separator:ab548da6c93ce257b9cec9b1c27a9390a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44aebb6e29a5271abb6ec2b04f213b56"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56">density_polynomial</a> (eos_coefs, pressure, temperature, Density_Field)</td></tr>
<tr class="memdesc:a44aebb6e29a5271abb6ec2b04f213b56"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Define de density as a polynomial  <a href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56">More...</a><br /></td></tr>
<tr class="separator:a44aebb6e29a5271abb6ec2b04f213b56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13395594592fe917fc20b7c3c2b7a5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d">assign_equation_of_state</a> (eos_option_path_out)</td></tr>
<tr class="memdesc:ac13395594592fe917fc20b7c3c2b7a5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Read from diamond and decide which sort of density representation do we have  <a href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d">More...</a><br /></td></tr>
<tr class="separator:ac13395594592fe917fc20b7c3c2b7a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d4a7655cae6c58eae3fc141d80d5639"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639">calculate_porousmedia_absorptionterms</a> (nphase, state, packed_state, PorousMedia_absorp, Mdims, CV_funs, CV_GIdims, Mspars, ndgln, upwnd, suf_sig_diagten_bc)</td></tr>
<tr class="memdesc:a1d4a7655cae6c58eae3fc141d80d5639"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Here we compute the absorption for porous media This is the sigma term defined in the papers and contains The permeability, the relative permeability, the viscosity and the saturation  <a href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639">More...</a><br /></td></tr>
<tr class="separator:a1d4a7655cae6c58eae3fc141d80d5639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659427fd61af753266767259b441a345"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345">calculate_absorption2</a> (nphase, packed_state, PorousMedia_absorp, Mdims, ndgln, SATURA, viscosities, inv_PorousMedia_absorp)</td></tr>
<tr class="memdesc:a659427fd61af753266767259b441a345"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine where the absorption for the porous media is actually computed  <a href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345">More...</a><br /></td></tr>
<tr class="separator:a659427fd61af753266767259b441a345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af235dd0c336c71b8afbfb65399766c10"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10">get_material_absorption</a> (nphase, iphase, material_absorption, sat, visc, CV_Immobile_fract, Corey_exponent, Endpoint_relperm)</td></tr>
<tr class="memdesc:af235dd0c336c71b8afbfb65399766c10"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases  <a href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10">More...</a><br /></td></tr>
<tr class="separator:af235dd0c336c71b8afbfb65399766c10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa5bc056e9d4cafeb1706afca8e780c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1">get_relperm</a> (nphase, iphase, sat, CV_Immobile_fract, Corey_exponent, Endpoint_relperm, Kr)</td></tr>
<tr class="memdesc:afa5bc056e9d4cafeb1706afca8e780c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases  <a href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1">More...</a><br /></td></tr>
<tr class="separator:afa5bc056e9d4cafeb1706afca8e780c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b9750459911134c7e711f15fa42614"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a29b9750459911134c7e711f15fa42614">normalise_relperm_tables</a> (nphase)</td></tr>
<tr class="separator:a29b9750459911134c7e711f15fa42614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af14c426951c2a3fd50666548b0e17472"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472">compute_normalised_saturation</a> (S_phase, Simm_phase, Simm_all, nphase, iphase)</td></tr>
<tr class="memdesc:af14c426951c2a3fd50666548b0e17472"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes normalised saturation for Land trapping with tabulated relperm  <a href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472">More...</a><br /></td></tr>
<tr class="separator:af14c426951c2a3fd50666548b0e17472"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6fbcd53b92e8dd346a9ac6fbc30055"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#add6fbcd53b92e8dd346a9ac6fbc30055">calculate_capillary_pressure</a> (packed_state, NDGLN, totele, cv_nloc, CV_funs)</td></tr>
<tr class="memdesc:add6fbcd53b92e8dd346a9ac6fbc30055"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine the capilalry pressure is computed based on the saturation and the formula used  <a href="namespacemultiphase__eos.html#add6fbcd53b92e8dd346a9ac6fbc30055">More...</a><br /></td></tr>
<tr class="separator:add6fbcd53b92e8dd346a9ac6fbc30055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfd3eac29921ca66854cebaa01162f9"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9">get_devcappressure</a> (sat, Pe, a, CV_Immobile_Fraction, iphase, nphase)</td></tr>
<tr class="memdesc:a7dfd3eac29921ca66854cebaa01162f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">:This functions returns the derivative of the capillary pressure with respect to the saturation  <a href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9">More...</a><br /></td></tr>
<tr class="separator:a7dfd3eac29921ca66854cebaa01162f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac21530a3f76ed685a2ce5fcb0bb11bd0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0">calculate_u_source_cv</a> (Mdims, state, packed_state, den, u_source_cv)</td></tr>
<tr class="memdesc:ac21530a3f76ed685a2ce5fcb0bb11bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine computed the gravity effect, i.e. rho * g  <a href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0">More...</a><br /></td></tr>
<tr class="separator:ac21530a3f76ed685a2ce5fcb0bb11bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fff87db23a4e3474815ee4a821e1cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd">calculate_diffusivity</a> (state, packed_state, Mdims, ndgln, ScalarAdvectionField_Diffusion, TracerName, divide_by_rho_CP)</td></tr>
<tr class="memdesc:aa7fff87db23a4e3474815ee4a821e1cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Here we compute component/solute/thermal diffusion coefficient  <a href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd">More...</a><br /></td></tr>
<tr class="separator:aa7fff87db23a4e3474815ee4a821e1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae417127536bdb365fbdde3951524a9d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6">calculate_solute_dispersity</a> (state, packed_state, Mdims, ndgln, density, SoluteDispersion)</td></tr>
<tr class="memdesc:ae417127536bdb365fbdde3951524a9d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Dispersion for porous media For thermal, the field density needs to be passed down, which ensures that even for boussinesq a reference density is still used  <a href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6">More...</a><br /></td></tr>
<tr class="separator:ae417127536bdb365fbdde3951524a9d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26eebc3a39a15f39961c783b8558fbef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a26eebc3a39a15f39961c783b8558fbef">calculate_viscosity</a> (state, Mdims, ndgln, Momentum_Diffusion, Momentum_Diffusion2)</td></tr>
<tr class="memdesc:a26eebc3a39a15f39961c783b8558fbef"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the viscosity effect as a momemtum diffusion, this is zero for porous media  <a href="namespacemultiphase__eos.html#a26eebc3a39a15f39961c783b8558fbef">More...</a><br /></td></tr>
<tr class="separator:a26eebc3a39a15f39961c783b8558fbef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2170c291d049cf032d6b1a253aa276"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aba2170c291d049cf032d6b1a253aa276">compute_viscosity_eos</a> (state, Mdims)</td></tr>
<tr class="memdesc:aba2170c291d049cf032d6b1a253aa276"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine we compute the viscosity EOS. Options for different EOS.  <a href="namespacemultiphase__eos.html#aba2170c291d049cf032d6b1a253aa276">More...</a><br /></td></tr>
<tr class="separator:aba2170c291d049cf032d6b1a253aa276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48">update_velocity_absorption</a> (states, ndim, nphase, velocity_absorption)</td></tr>
<tr class="memdesc:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&lt;INERTIA ONLY&gt;Computes velocity absorption from diamond information  <a href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48">More...</a><br /></td></tr>
<tr class="separator:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98927879ae36867eabec1a9e6a5f22d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8">update_velocity_absorption_coriolis</a> (states, ndim, nphase, velocity_absorption)</td></tr>
<tr class="memdesc:a98927879ae36867eabec1a9e6a5f22d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Computes velocity absorption associated to coriolis forces from diamond information  <a href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8">More...</a><br /></td></tr>
<tr class="separator:a98927879ae36867eabec1a9e6a5f22d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7f68ee8d294089b9077c480795eb9c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a8f7f68ee8d294089b9077c480795eb9c">update_velocity_source</a> (states, Mdims, u_source)</td></tr>
<tr class="memdesc:a8f7f68ee8d294089b9077c480795eb9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Computes velocity source from diamond information  <a href="namespacemultiphase__eos.html#a8f7f68ee8d294089b9077c480795eb9c">More...</a><br /></td></tr>
<tr class="separator:a8f7f68ee8d294089b9077c480795eb9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2591de41e9c67340b83129722447923b"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2591de41e9c67340b83129722447923b">saturation_temperature</a> (pressure)</td></tr>
<tr class="memdesc:a2591de41e9c67340b83129722447923b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: ????  <a href="namespacemultiphase__eos.html#a2591de41e9c67340b83129722447923b">More...</a><br /></td></tr>
<tr class="separator:a2591de41e9c67340b83129722447923b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb644e3565a7e33c61f0e40e73a3c990"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990">get_rockfluidprop</a> (state, packed_state, Mdims, ndgln, current_time, update_only)</td></tr>
<tr class="memdesc:aeb644e3565a7e33c61f0e40e73a3c990"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed state By index this is: 1) immobile fraction, 2) relperm max, 3)relperm exponent 4)Capillary entry pressure 5) Capillary exponent 6) Capillary imbition term The effective inmobile fraction is the min(inmobile,saturation_flipping formula), being the saturation the value after a succesful non-linear solver convergence! This NEEDS to be called after a succesful non-linear solver (with update_only)  <a href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990">More...</a><br /></td></tr>
<tr class="separator:aeb644e3565a7e33c61f0e40e73a3c990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac01c010ab184f242b5ca90a44d40affa"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac01c010ab184f242b5ca90a44d40affa">jwl</a> (A, B, w, R1, R2, E0, p, roe, ro)</td></tr>
<tr class="memdesc:ac01c010ab184f242b5ca90a44d40affa"><td class="mdescLeft">&#160;</td><td class="mdescRight">JWL equation functions.  <a href="namespacemultiphase__eos.html#ac01c010ab184f242b5ca90a44d40affa">More...</a><br /></td></tr>
<tr class="separator:ac01c010ab184f242b5ca90a44d40affa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7870c763c81a10948617345c3d0ca219"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7870c763c81a10948617345c3d0ca219">diffjwl</a> (A, B, w, R1, R2, E0, roe, ro)</td></tr>
<tr class="memdesc:a7870c763c81a10948617345c3d0ca219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diff of JWL equation functions.  <a href="namespacemultiphase__eos.html#a7870c763c81a10948617345c3d0ca219">More...</a><br /></td></tr>
<tr class="separator:a7870c763c81a10948617345c3d0ca219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8585fdea6dd3d2ca6508cf37236a7cc0"><td class="memItemLeft" align="right" valign="top">real function, dimension(jwln)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a8585fdea6dd3d2ca6508cf37236a7cc0">jwldensity</a> (eos_coefs, pressure, ro0, JWLn)</td></tr>
<tr class="memdesc:a8585fdea6dd3d2ca6508cf37236a7cc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density of JWL equation functions.  <a href="namespacemultiphase__eos.html#a8585fdea6dd3d2ca6508cf37236a7cc0">More...</a><br /></td></tr>
<tr class="separator:a8585fdea6dd3d2ca6508cf37236a7cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5f7836734b85fb788ba57a2793eda7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3f5f7836734b85fb788ba57a2793eda7">initialise_porous_media</a> (Mdims, ndgln, packed_state, state, exit_initialise_porous_media)</td></tr>
<tr class="memdesc:a3f5f7836734b85fb788ba57a2793eda7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Initialising porous media models Given a free water level (FWL) we simulate capillary gravity equilibration, control volumes below FWL is kept at residual lighter phase saturation This subroutine is called after each timestep and saturations overidden below FWL with the heavier phase  <a href="namespacemultiphase__eos.html#a3f5f7836734b85fb788ba57a2793eda7">More...</a><br /></td></tr>
<tr class="separator:a3f5f7836734b85fb788ba57a2793eda7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282f02f39508adfb64d99bf4659af86c"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c">retrieve_reference_density</a> (state, packed_state, iphase, icomp, nphase)</td></tr>
<tr class="memdesc:a282f02f39508adfb64d99bf4659af86c"><td class="mdescLeft">&#160;</td><td class="mdescRight">: For boussinesq porous media we need the reference density to ensure consistency when mixing with the porous density/Cp etc. In this subroutine we retrieve the value given a phase, component.  <a href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c">More...</a><br /></td></tr>
<tr class="separator:a282f02f39508adfb64d99bf4659af86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439637e5906b37a16646c186d7fc0daf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a439637e5906b37a16646c186d7fc0daf">flash_gas_dissolution</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:a439637e5906b37a16646c186d7fc0daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to dissolv phase2 into phase1. Currently only for system for phase 1 = water, phase 2 = gas Dissolve instantaneously the amount introduced in diamond in mol/m3 for CO2 a reference number is 38 mol/m3. Requires the first phase to have a concentration field  <a href="namespacemultiphase__eos.html#a439637e5906b37a16646c186d7fc0daf">More...</a><br /></td></tr>
<tr class="separator:a439637e5906b37a16646c186d7fc0daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7403abd4f0f6b2a8237aaa49bee9081e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7403abd4f0f6b2a8237aaa49bee9081e">metal_dissolution</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:a7403abd4f0f6b2a8237aaa49bee9081e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the partition coefficient, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not.  <a href="namespacemultiphase__eos.html#a7403abd4f0f6b2a8237aaa49bee9081e">More...</a><br /></td></tr>
<tr class="separator:a7403abd4f0f6b2a8237aaa49bee9081e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad552bb5fe3f1a7753cb81faaf6097893"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ad552bb5fe3f1a7753cb81faaf6097893">metal_precipitation</a> (state, packed_state, Mdims, ndgln, dt)</td></tr>
<tr class="memdesc:ad552bb5fe3f1a7753cb81faaf6097893"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the precipitation rate, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not.  <a href="namespacemultiphase__eos.html#ad552bb5fe3f1a7753cb81faaf6097893">More...</a><br /></td></tr>
<tr class="separator:ad552bb5fe3f1a7753cb81faaf6097893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4ed816844055b0ed8990bbbc37f11a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2c4ed816844055b0ed8990bbbc37f11a">total_mass_metal</a> (state, packed_state, Mdims, ndgln, CV_funs, metal_total_mass)</td></tr>
<tr class="memdesc:a2c4ed816844055b0ed8990bbbc37f11a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to calculate the metal total mass (in kg).  <a href="namespacemultiphase__eos.html#a2c4ed816844055b0ed8990bbbc37f11a">More...</a><br /></td></tr>
<tr class="separator:a2c4ed816844055b0ed8990bbbc37f11a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8db613abbe75c163af30406a36bfc49"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac8db613abbe75c163af30406a36bfc49">bound_metal_concentrations</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:ac8db613abbe75c163af30406a36bfc49"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to bound the metal concentrations after an adapt, in order to avoid unphysical values.  <a href="namespacemultiphase__eos.html#ac8db613abbe75c163af30406a36bfc49">More...</a><br /></td></tr>
<tr class="separator:ac8db613abbe75c163af30406a36bfc49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3f9c0b2e55a90103c72b4570f45e48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2e3f9c0b2e55a90103c72b4570f45e48">correction_mass_metal</a> (state, packed_state, Mdims, ndgln, total_mass_before, total_mass_after)</td></tr>
<tr class="memdesc:a2e3f9c0b2e55a90103c72b4570f45e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to apply a correction factor to the metal concentrations in order to conserve mass if needed.  <a href="namespacemultiphase__eos.html#a2e3f9c0b2e55a90103c72b4570f45e48">More...</a><br /></td></tr>
<tr class="separator:a2e3f9c0b2e55a90103c72b4570f45e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84fa5e7155dc42f6e8365fc6a0dfd899"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a84fa5e7155dc42f6e8365fc6a0dfd899">copy_metal_field</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:a84fa5e7155dc42f6e8365fc6a0dfd899"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to copy a Metal Field into a copied field BEFORE the exchange steps happen (dissolution or precipitation). This can be used to have access to a liquid or solid metal field before the exchange step has happened.  <a href="namespacemultiphase__eos.html#a84fa5e7155dc42f6e8365fc6a0dfd899">More...</a><br /></td></tr>
<tr class="separator:a84fa5e7155dc42f6e8365fc6a0dfd899"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae1ce91e74714b2c125d7a764aaa79ff3"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae1ce91e74714b2c125d7a764aaa79ff3">flooding_hmin</a> = 1e-5</td></tr>
<tr class="separator:ae1ce91e74714b2c125d7a764aaa79ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e26a6e715bbcea0e5f3d124871a8b2"><td class="memItemLeft" align="right" valign="top">logical, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac9e26a6e715bbcea0e5f3d124871a8b2">tables_loaded</a> = .false.</td></tr>
<tr class="separator:ac9e26a6e715bbcea0e5f3d124871a8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82391e55c623b151745a9ef5fe09e97"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa82391e55c623b151745a9ef5fe09e97">relperm_table_data</a></td></tr>
<tr class="separator:aa82391e55c623b151745a9ef5fe09e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad75fdebae56a34f58313eb37d69fae6e"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ad75fdebae56a34f58313eb37d69fae6e">pc_table_data</a></td></tr>
<tr class="separator:ad75fdebae56a34f58313eb37d69fae6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadda55c84c6fbe47425442430dc79dd4"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aadda55c84c6fbe47425442430dc79dd4">relperm_table_norm_data</a></td></tr>
<tr class="separator:aadda55c84c6fbe47425442430dc79dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede48d1965af522f9a3bfcf4148a9395"><td class="memItemLeft" align="right" valign="top">logical, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aede48d1965af522f9a3bfcf4148a9395">tables_normalised</a> = .false.</td></tr>
<tr class="separator:aede48d1965af522f9a3bfcf4148a9395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac225ca863b2915b70181fe53abe4d779"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac225ca863b2915b70181fe53abe4d779">original_immobile_per_phase</a></td></tr>
<tr class="separator:ac225ca863b2915b70181fe53abe4d779"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains subroutines related to the equations of state and other properties such as relative permeabilities, capillary, flash, etc. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="ac13395594592fe917fc20b7c3c2b7a5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac13395594592fe917fc20b7c3c2b7a5d">&#9670;&nbsp;</a></span>assign_equation_of_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::assign_equation_of_state </td>
          <td>(</td>
          <td class="paramtype">character( len = option_path_len ), intent(inout)&#160;</td>
          <td class="paramname"><em>eos_option_path_out</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Read from diamond and decide which sort of density representation do we have </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">eos_option_path_out</td><td>Diamond path of the EOS to be used </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ac13395594592fe917fc20b7c3c2b7a5d_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ac13395594592fe917fc20b7c3c2b7a5d_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ac13395594592fe917fc20b7c3c2b7a5d_icgraph" id="namespacemultiphase__eos_ac13395594592fe917fc20b7c3c2b7a5d_icgraph">
<area shape="rect" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="1567,107,1725,149"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="1345,49,1519,90"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5" title=": Computes the density for the components and the derivatives of the density This is were the action ..." alt="" coords="669,107,843,149"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="1350,425,1514,466"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="1137,5,1285,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,329,376,370"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,329,152,370"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0" title=": This subroutine computed the gravity effect, i.e. rho * g" alt="" coords="1124,250,1297,291"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86" title=": Checks convergence on the temperature field Calculation of the averaged heat capacity and density a..." alt="" coords="1139,340,1282,367"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a30f5738db096842f8f2890cec8440814" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="909,331,1076,373"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7403abd4f0f6b2a8237aaa49bee9081e" title=": subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously t..." alt="" coords="916,441,1069,482"/>
<area shape="rect" href="namespacemultiphase__eos.html#ad552bb5fe3f1a7753cb81faaf6097893" title=": subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in d..." alt="" coords="679,502,833,543"/>
<area shape="rect" href="namespacemultiphase__eos.html#a2c4ed816844055b0ed8990bbbc37f11a" title=": subroutine to calculate the metal total mass (in kg)." alt="" coords="440,561,587,602"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad44e4be750a57ea3ecab7c4307a75b67" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="911,619,1075,661"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="660,173,852,214"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="651,331,861,373"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#af1bf5a11afa118074e812449240b70cb" title="WARNING: Still work in progress." alt="" coords="444,328,583,355"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="424,379,603,435"/>
</map>
</div>

</div>
</div>
<a id="ac8db613abbe75c163af30406a36bfc49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8db613abbe75c163af30406a36bfc49">&#9670;&nbsp;</a></span>bound_metal_concentrations()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::bound_metal_concentrations </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to bound the metal concentrations after an adapt, in order to avoid unphysical values. </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ac8db613abbe75c163af30406a36bfc49_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ac8db613abbe75c163af30406a36bfc49_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ac8db613abbe75c163af30406a36bfc49_icgraph" id="namespacemultiphase__eos_ac8db613abbe75c163af30406a36bfc49_icgraph">
<area shape="rect" title=": subroutine to bound the metal concentrations after an adapt, in order to avoid unphysical values." alt="" coords="424,5,580,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a659427fd61af753266767259b441a345"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a659427fd61af753266767259b441a345">&#9670;&nbsp;</a></span>calculate_absorption2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_absorption2 </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_field)&#160;</td>
          <td class="paramname"><em>PorousMedia_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SATURA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>viscosities</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>inv_PorousMedia_absorp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Subroutine where the absorption for the porous media is actually computed </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">PorousMedia_absorp</td><td>INOUT Absorption associated to the porous media </td></tr>
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">SATURA</td><td>PhasevolumeFraction field </td></tr>
    <tr><td class="paramname">viscosities</td><td>viscosity field </td></tr>
    <tr><td class="paramname">inv_PorousMedia_absorp</td><td>(optional) INOUT inverse of the absorption term </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a659427fd61af753266767259b441a345_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a659427fd61af753266767259b441a345_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a659427fd61af753266767259b441a345_cgraph" id="namespacemultiphase__eos_a659427fd61af753266767259b441a345_cgraph">
<area shape="rect" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="5,74,179,115"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="227,74,369,115"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="417,74,556,115"/>
<area shape="rect" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="606,5,758,32"/>
<area shape="rect" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="630,56,734,83"/>
<area shape="rect" href="multi__eos_8_f90.html#a1c26bc7b22b8141f8c07f7aff66de2d1" title=": Tabulated relperm. This subroutine computes the relperm based on tabulated data that the user provi..." alt="" coords="619,107,745,133"/>
<area shape="rect" href="multi__eos_8_f90.html#aceb42bfefda5357e6464aec48d828dcd" title=": Tabulated relperm with Land trapping using normalised saturation" alt="" coords="604,157,760,184"/>
<area shape="rect" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="808,150,979,191"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a659427fd61af753266767259b441a345_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a659427fd61af753266767259b441a345_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a659427fd61af753266767259b441a345_icgraph" id="namespacemultiphase__eos_a659427fd61af753266767259b441a345_icgraph">
<area shape="rect" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1368,78,1541,119"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1165,78,1320,119"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="915,78,1117,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a245ebfb2c63f41aaf90233ccb819bad4" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="688,17,867,58"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,78,376,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="424,137,640,178"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="443,5,621,61"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,78,152,119"/>
</map>
</div>

</div>
</div>
<a id="ab16c45da0af88c69945beac4e3334349"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab16c45da0af88c69945beac4e3334349">&#9670;&nbsp;</a></span>calculate_all_rhos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_all_rhos </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>get_RhoCp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the density for the phases and the derivatives of the density </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">get_RhoCp</td><td>This flags computes rhoCp instead of rho </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_cgraph.png" border="0" usemap="#namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_cgraph" id="namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_cgraph">
<area shape="rect" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="5,123,197,164"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="254,5,429,47"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="255,71,427,98"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab548da6c93ce257b9cec9b1c27a9390a" title="In this subroutine we calculate and update the density of the porous media based on the compressibili..." alt="" coords="245,123,437,164"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee" title=": Computes the density and the derivative of the density" alt="" coords="245,188,437,229"/>
<area shape="rect" href="namespacemultiphase__eos.html#aa45791df12ab50edf07b075fc8c83335" title=": Computes the bulk density for components and the derivatives of the density" alt="" coords="263,253,419,295"/>
<area shape="rect" href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56" title=": Define de density as a polynomial" alt="" coords="485,159,667,200"/>
<area shape="rect" href="multi__eos_8_f90.html#a5d9a124e3bfdcebea01989fde6ea5cd1" title=" " alt="" coords="503,225,649,251"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_icgraph" id="namespacemultiphase__eos_ab16c45da0af88c69945beac4e3334349_icgraph">
<area shape="rect" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="467,27,659,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,5,401,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,57,419,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,171,98"/>
</map>
</div>

</div>
</div>
<a id="add6fbcd53b92e8dd346a9ac6fbc30055"></a>
<h2 class="memtitle"><span class="permalink"><a href="#add6fbcd53b92e8dd346a9ac6fbc30055">&#9670;&nbsp;</a></span>calculate_capillary_pressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_capillary_pressure </td>
          <td>(</td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_shape_funs)&#160;</td>
          <td class="paramname"><em>CV_funs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this subroutine the capilalry pressure is computed based on the saturation and the formula used </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Totele</td><td>Total number of elements </td></tr>
    <tr><td class="paramname">cv_nloc</td><td>Total number of CVs per element </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_cgraph.png" border="0" usemap="#namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_cgraph" id="namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_cgraph">
<area shape="rect" title=": In this subroutine the capilalry pressure is computed based on the saturation and the formula used" alt="" coords="5,5,197,47"/>
<area shape="rect" href="multi__eos_8_f90.html#acd1caed43acc66691c351206d8dd7b2c" title=":This functions returns the capillary pressure for a certain input saturation" alt="" coords="245,13,375,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_icgraph.png" border="0" usemap="#namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_icgraph" id="namespacemultiphase__eos_add6fbcd53b92e8dd346a9ac6fbc30055_icgraph">
<area shape="rect" title=": In this subroutine the capilalry pressure is computed based on the saturation and the formula used" alt="" coords="664,5,837,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="424,5,616,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a3c4f57d9c50b3421a8059d73fb260dd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c4f57d9c50b3421a8059d73fb260dd5">&#9670;&nbsp;</a></span>calculate_component_rho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_component_rho </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the density for the components and the derivatives of the density This is were the action is actually done, the other calculate rhos are wrappers </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_cgraph" id="namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_cgraph">
<area shape="rect" title=": Computes the density for the components and the derivatives of the density This is were the action ..." alt="" coords="5,39,197,80"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="254,5,429,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee" title=": Computes the density and the derivative of the density" alt="" coords="245,71,437,112"/>
<area shape="rect" href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56" title=": Define de density as a polynomial" alt="" coords="485,41,667,83"/>
<area shape="rect" href="multi__eos_8_f90.html#a5d9a124e3bfdcebea01989fde6ea5cd1" title=" " alt="" coords="503,107,649,134"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_icgraph" id="namespacemultiphase__eos_a3c4f57d9c50b3421a8059d73fb260dd5_icgraph">
<area shape="rect" title=": Computes the density for the components and the derivatives of the density This is were the action ..." alt="" coords="467,5,659,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="aa7fff87db23a4e3474815ee4a821e1cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa7fff87db23a4e3474815ee4a821e1cd">&#9670;&nbsp;</a></span>calculate_diffusivity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_diffusivity </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:, :, :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>ScalarAdvectionField_Diffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=*), intent(in), optional&#160;</td>
          <td class="paramname"><em>TracerName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>divide_by_rho_CP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Here we compute component/solute/thermal diffusion coefficient </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">ScalarAdvectionField_Diffusion</td><td>INOUT Field containing the diffusion </td></tr>
    <tr><td class="paramname">divide_by_rho_CP</td><td>! If we want to normlise the equation by rho CP we can return the diffusion coefficient divided by rho Cp </td></tr>
    <tr><td class="paramname">TracerName</td><td>! For PassiveTracer with diffusion we pass down the name of the tracer </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_aa7fff87db23a4e3474815ee4a821e1cd_icgraph.png" border="0" usemap="#namespacemultiphase__eos_aa7fff87db23a4e3474815ee4a821e1cd_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_aa7fff87db23a4e3474815ee4a821e1cd_icgraph" id="namespacemultiphase__eos_aa7fff87db23a4e3474815ee4a821e1cd_icgraph">
<area shape="rect" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="1124,185,1297,226"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a30f5738db096842f8f2890cec8440814" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="909,156,1076,197"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad44e4be750a57ea3ecab7c4307a75b67" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="674,214,838,256"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="651,58,861,100"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,124,376,165"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#af1bf5a11afa118074e812449240b70cb" title="WARNING: Still work in progress." alt="" coords="444,32,583,59"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="424,83,603,139"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,124,152,165"/>
</map>
</div>

</div>
</div>
<a id="ab548da6c93ce257b9cec9b1c27a9390a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab548da6c93ce257b9cec9b1c27a9390a">&#9670;&nbsp;</a></span>calculate_porous_rho_drhop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_porous_rho_drhop </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>drhodp_porous</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In this subroutine we calculate and update the density of the porous media based on the compressibility given in Diamond (ele-wise). We also calculate the drho/dp term for the porous media which then goes into the DERIV term in the continuity equation (cv-wise). </p>
<dl class="section author"><dt>Author</dt><dd>Geraldine Regnier </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">cv_ndgln</td><td>Global to local variables for the CV mesh </td></tr>
    <tr><td class="paramname">drhodp.</td><td>Derivative of the porous density </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ab548da6c93ce257b9cec9b1c27a9390a_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ab548da6c93ce257b9cec9b1c27a9390a_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ab548da6c93ce257b9cec9b1c27a9390a_icgraph" id="namespacemultiphase__eos_ab548da6c93ce257b9cec9b1c27a9390a_icgraph">
<area shape="rect" title="In this subroutine we calculate and update the density of the porous media based on the compressibili..." alt="" coords="707,27,899,69"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="467,27,659,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,5,401,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,57,419,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,171,98"/>
</map>
</div>

</div>
</div>
<a id="a1d4a7655cae6c58eae3fc141d80d5639"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d4a7655cae6c58eae3fc141d80d5639">&#9670;&nbsp;</a></span>calculate_porousmedia_absorptionterms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_porousmedia_absorptionterms </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_field)&#160;</td>
          <td class="paramname"><em>PorousMedia_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_shape_funs), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_gi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_sparsities), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (porous_adv_coefs), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Here we compute the absorption for porous media This is the sigma term defined in the papers and contains The permeability, the relative permeability, the viscosity and the saturation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">PorousMedia_absorp</td><td>INOUT Absorption associated to the porous media </td></tr>
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_cgraph" id="namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_cgraph">
<area shape="rect" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="5,133,208,174"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="264,45,419,86"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="475,111,668,137"/>
<area shape="rect" href="namespacemultiphase__eos.html#aba2170c291d049cf032d6b1a253aa276" title="In this subroutine we compute the viscosity EOS. Options for different EOS." alt="" coords="256,162,427,203"/>
<area shape="rect" href="multi__eos_8_f90.html#aa152716c3e7e6d83fb9b90b26a9c7be7" title=": For porous media, just sets the viscosity as a scalar" alt="" coords="292,228,391,255"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="485,45,658,86"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="716,74,859,115"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="907,74,1045,115"/>
<area shape="rect" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="1095,5,1247,32"/>
<area shape="rect" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="1119,56,1223,83"/>
<area shape="rect" href="multi__eos_8_f90.html#a1c26bc7b22b8141f8c07f7aff66de2d1" title=": Tabulated relperm. This subroutine computes the relperm based on tabulated data that the user provi..." alt="" coords="1109,107,1234,133"/>
<area shape="rect" href="multi__eos_8_f90.html#aceb42bfefda5357e6464aec48d828dcd" title=": Tabulated relperm with Land trapping using normalised saturation" alt="" coords="1093,157,1249,184"/>
<area shape="rect" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="1297,150,1468,191"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_icgraph" id="namespacemultiphase__eos_a1d4a7655cae6c58eae3fc141d80d5639_icgraph">
<area shape="rect" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="915,78,1117,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a245ebfb2c63f41aaf90233ccb819bad4" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="688,17,867,58"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,78,376,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="424,137,640,178"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="443,5,621,61"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,78,152,119"/>
</map>
</div>

</div>
</div>
<a id="a3f6a1c7227872bf2073b960ddfabedee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f6a1c7227872bf2073b960ddfabedee">&#9670;&nbsp;</a></span>calculate_rho_drhodp()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_rho_drhodp </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character( len = option_path_len ), intent(in)&#160;</td>
          <td class="paramname"><em>eos_option_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>rho</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>drhodp</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the density and the derivative of the density </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">iphase</td><td>current phase </td></tr>
    <tr><td class="paramname">icomp</td><td>current component </td></tr>
    <tr><td class="paramname">nphase</td><td>number of phases </td></tr>
    <tr><td class="paramname">ncomp</td><td>number of components </td></tr>
    <tr><td class="paramname">eos_option_path</td><td>Path in diamond of the EOS to be used </td></tr>
    <tr><td class="paramname">rho</td><td>density </td></tr>
    <tr><td class="paramname">drhodp.</td><td>Dderivative of density </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_cgraph" id="namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_cgraph">
<area shape="rect" title=": Computes the density and the derivative of the density" alt="" coords="5,35,179,76"/>
<area shape="rect" href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56" title=": Define de density as a polynomial" alt="" coords="227,5,389,47"/>
<area shape="rect" href="multi__eos_8_f90.html#a5d9a124e3bfdcebea01989fde6ea5cd1" title=" " alt="" coords="243,71,373,98"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_icgraph" id="namespacemultiphase__eos_a3f6a1c7227872bf2073b960ddfabedee_icgraph">
<area shape="rect" title=": Computes the density and the derivative of the density" alt="" coords="645,39,819,80"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="424,5,597,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5" title=": Computes the density for the components and the derivatives of the density This is were the action ..." alt="" coords="424,71,597,112"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="214,13,362,39"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,67,376,108"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,67,152,108"/>
</map>
</div>

</div>
</div>
<a id="ae417127536bdb365fbdde3951524a9d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae417127536bdb365fbdde3951524a9d6">&#9670;&nbsp;</a></span>calculate_solute_dispersity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_solute_dispersity </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in), target&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:, :, :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>SoluteDispersion</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Dispersion for porous media For thermal, the field density needs to be passed down, which ensures that even for boussinesq a reference density is still used </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">density</td><td>Density of the field (If present density means that we need to use a reference density to ensure consistency with the rest of the equation) </td></tr>
    <tr><td class="paramname">SoluteDispersion</td><td>INOUT The field containing the dispersivity controbution for the given field </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ae417127536bdb365fbdde3951524a9d6_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ae417127536bdb365fbdde3951524a9d6_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ae417127536bdb365fbdde3951524a9d6_icgraph" id="namespacemultiphase__eos_ae417127536bdb365fbdde3951524a9d6_icgraph">
<area shape="rect" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="1124,185,1297,226"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a30f5738db096842f8f2890cec8440814" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="909,156,1076,197"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad44e4be750a57ea3ecab7c4307a75b67" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="674,214,838,256"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="651,58,861,100"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,124,376,165"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#af1bf5a11afa118074e812449240b70cb" title="WARNING: Still work in progress." alt="" coords="444,32,583,59"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="424,83,603,139"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,124,152,165"/>
</map>
</div>

</div>
</div>
<a id="ac21530a3f76ed685a2ce5fcb0bb11bd0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac21530a3f76ed685a2ce5fcb0bb11bd0">&#9670;&nbsp;</a></span>calculate_u_source_cv()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_u_source_cv </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>den</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>u_source_cv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine computed the gravity effect, i.e. rho * g </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">den</td><td>Density field </td></tr>
    <tr><td class="paramname">u_source_cv</td><td>INOUT Source term having now the gravity term </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_cgraph.png" border="0" usemap="#namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_cgraph" id="namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_cgraph">
<area shape="rect" title=": This subroutine computed the gravity effect, i.e. rho * g" alt="" coords="5,5,197,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="245,5,429,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="477,5,652,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_icgraph" id="namespacemultiphase__eos_ac21530a3f76ed685a2ce5fcb0bb11bd0_icgraph">
<area shape="rect" title=": This subroutine computed the gravity effect, i.e. rho * g" alt="" coords="664,5,837,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="424,5,616,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a26eebc3a39a15f39961c783b8558fbef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26eebc3a39a15f39961c783b8558fbef">&#9670;&nbsp;</a></span>calculate_viscosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::calculate_viscosity </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_ndgln ), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>Momentum_Diffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>Momentum_Diffusion2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the viscosity effect as a momemtum diffusion, this is zero for porous media </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">Mdims</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Momentum_Diffusion</td><td>Viscosity term for Stokes/Navier-Stokes </td></tr>
    <tr><td class="paramname">Momentum_Diffusion2</td><td>Shear viscosity? </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a26eebc3a39a15f39961c783b8558fbef_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a26eebc3a39a15f39961c783b8558fbef_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a26eebc3a39a15f39961c783b8558fbef_icgraph" id="namespacemultiphase__eos_a26eebc3a39a15f39961c783b8558fbef_icgraph">
<area shape="rect" title=": Computes the viscosity effect as a momemtum diffusion, this is zero for porous media" alt="" coords="664,5,837,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="424,5,616,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="aa45791df12ab50edf07b075fc8c83335"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa45791df12ab50edf07b075fc8c83335">&#9670;&nbsp;</a></span>cap_bulk_rho()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::cap_bulk_rho </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension( : )&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( cv_nonods * nphase * ncomp ), intent(in)&#160;</td>
          <td class="paramname"><em>Density_Component</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( cv_nonods * nphase ), intent(inout)&#160;</td>
          <td class="paramname"><em>Density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( cv_nonods * nphase ), intent(inout)&#160;</td>
          <td class="paramname"><em>Density_Cp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>compute_rhoCP</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the bulk density for components and the derivatives of the density </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">ncomp</td><td>number of components </td></tr>
    <tr><td class="paramname">nphase</td><td>number of phases </td></tr>
    <tr><td class="paramname">cv_nonods</td><td>number of CV nodes </td></tr>
    <tr><td class="paramname">Density_Component</td><td>density of a component for compositional modelling </td></tr>
    <tr><td class="paramname">Density</td><td>(self descriptive) </td></tr>
    <tr><td class="paramname">Density_Cp.</td><td>Density times Cp </td></tr>
    <tr><td class="paramname">compute_rhoCP</td><td>This flags computes rhoCp instead of rho </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_aa45791df12ab50edf07b075fc8c83335_icgraph.png" border="0" usemap="#namespacemultiphase__eos_aa45791df12ab50edf07b075fc8c83335_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_aa45791df12ab50edf07b075fc8c83335_icgraph" id="namespacemultiphase__eos_aa45791df12ab50edf07b075fc8c83335_icgraph">
<area shape="rect" title=": Computes the bulk density for components and the derivatives of the density" alt="" coords="707,27,863,69"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="467,27,659,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,5,401,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,57,419,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,171,98"/>
</map>
</div>

</div>
</div>
<a id="af14c426951c2a3fd50666548b0e17472"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af14c426951c2a3fd50666548b0e17472">&#9670;&nbsp;</a></span>compute_normalised_saturation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_eos::compute_normalised_saturation </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>S_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Simm_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>Simm_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes normalised saturation for Land trapping with tabulated relperm </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_af14c426951c2a3fd50666548b0e17472_icgraph.png" border="0" usemap="#namespacemultiphase__eos_af14c426951c2a3fd50666548b0e17472_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_af14c426951c2a3fd50666548b0e17472_icgraph" id="namespacemultiphase__eos_af14c426951c2a3fd50666548b0e17472_icgraph">
<area shape="rect" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="2236,79,2407,121"/>
<area shape="rect" href="namespacemultiphase__eos.html#a29b9750459911134c7e711f15fa42614" title=" " alt="" coords="2011,49,2188,90"/>
<area shape="rect" href="multi__eos_8_f90.html#aceb42bfefda5357e6464aec48d828dcd" title=": Tabulated relperm with Land trapping using normalised saturation" alt="" coords="2021,116,2177,143"/>
<area shape="rect" href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990" title=":Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed st..." alt="" coords="1824,46,1963,87"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="1628,5,1776,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,133,376,174"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,133,152,174"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1824,111,1963,153"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1631,111,1773,153"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1407,109,1580,150"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="1165,175,1359,201"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1185,109,1339,150"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="915,165,1117,206"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a245ebfb2c63f41aaf90233ccb819bad4" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="688,165,867,206"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="424,238,640,279"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="443,157,621,213"/>
</map>
</div>

</div>
</div>
<a id="aba2170c291d049cf032d6b1a253aa276"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba2170c291d049cf032d6b1a253aa276">&#9670;&nbsp;</a></span>compute_viscosity_eos()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::compute_viscosity_eos </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>In this subroutine we compute the viscosity EOS. Options for different EOS. </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_aba2170c291d049cf032d6b1a253aa276_icgraph.png" border="0" usemap="#namespacemultiphase__eos_aba2170c291d049cf032d6b1a253aa276_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_aba2170c291d049cf032d6b1a253aa276_icgraph" id="namespacemultiphase__eos_aba2170c291d049cf032d6b1a253aa276_icgraph">
<area shape="rect" title="In this subroutine we compute the viscosity EOS. Options for different EOS." alt="" coords="1165,166,1336,207"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="915,107,1117,149"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,107,376,149"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a245ebfb2c63f41aaf90233ccb819bad4" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="688,17,867,58"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="424,137,640,178"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="443,5,621,61"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,107,152,149"/>
</map>
</div>

</div>
</div>
<a id="a84fa5e7155dc42f6e8365fc6a0dfd899"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84fa5e7155dc42f6e8365fc6a0dfd899">&#9670;&nbsp;</a></span>copy_metal_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::copy_metal_field </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to copy a Metal Field into a copied field BEFORE the exchange steps happen (dissolution or precipitation). This can be used to have access to a liquid or solid metal field before the exchange step has happened. </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a84fa5e7155dc42f6e8365fc6a0dfd899_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a84fa5e7155dc42f6e8365fc6a0dfd899_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a84fa5e7155dc42f6e8365fc6a0dfd899_icgraph" id="namespacemultiphase__eos_a84fa5e7155dc42f6e8365fc6a0dfd899_icgraph">
<area shape="rect" title=": subroutine to copy a Metal Field into a copied field BEFORE the exchange steps happen (dissolution ..." alt="" coords="424,5,573,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a2e3f9c0b2e55a90103c72b4570f45e48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e3f9c0b2e55a90103c72b4570f45e48">&#9670;&nbsp;</a></span>correction_mass_metal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::correction_mass_metal </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>total_mass_before</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>total_mass_after</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to apply a correction factor to the metal concentrations in order to conserve mass if needed. </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a2e3f9c0b2e55a90103c72b4570f45e48_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a2e3f9c0b2e55a90103c72b4570f45e48_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a2e3f9c0b2e55a90103c72b4570f45e48_icgraph" id="namespacemultiphase__eos_a2e3f9c0b2e55a90103c72b4570f45e48_icgraph">
<area shape="rect" title=": subroutine to apply a correction factor to the metal concentrations in order to conserve mass if ne..." alt="" coords="424,5,603,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a44aebb6e29a5271abb6ec2b04f213b56"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a44aebb6e29a5271abb6ec2b04f213b56">&#9670;&nbsp;</a></span>density_polynomial()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::density_polynomial </td>
          <td>(</td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>eos_coefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>temperature</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>Density_Field</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Define de density as a polynomial </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a44aebb6e29a5271abb6ec2b04f213b56_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a44aebb6e29a5271abb6ec2b04f213b56_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a44aebb6e29a5271abb6ec2b04f213b56_icgraph" id="namespacemultiphase__eos_a44aebb6e29a5271abb6ec2b04f213b56_icgraph">
<area shape="rect" title=": Define de density as a polynomial" alt="" coords="947,39,1128,80"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee" title=": Computes the density and the derivative of the density" alt="" coords="707,39,899,80"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="467,5,659,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5" title=": Computes the density for the components and the derivatives of the density This is were the action ..." alt="" coords="467,71,659,112"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,13,401,39"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,67,419,108"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,67,171,108"/>
</map>
</div>

</div>
</div>
<a id="a7870c763c81a10948617345c3d0ca219"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7870c763c81a10948617345c3d0ca219">&#9670;&nbsp;</a></span>diffjwl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_eos::diffjwl </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>R1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>R2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>E0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>roe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Diff of JWL equation functions. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a7870c763c81a10948617345c3d0ca219_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a7870c763c81a10948617345c3d0ca219_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a7870c763c81a10948617345c3d0ca219_icgraph" id="namespacemultiphase__eos_a7870c763c81a10948617345c3d0ca219_icgraph">
<area shape="rect" title="Diff of JWL equation functions." alt="" coords="253,5,428,32"/>
<area shape="rect" href="namespacemultiphase__eos.html#a8585fdea6dd3d2ca6508cf37236a7cc0" title="Density of JWL equation functions." alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a439637e5906b37a16646c186d7fc0daf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a439637e5906b37a16646c186d7fc0daf">&#9670;&nbsp;</a></span>flash_gas_dissolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::flash_gas_dissolution </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to dissolv phase2 into phase1. Currently only for system for phase 1 = water, phase 2 = gas Dissolve instantaneously the amount introduced in diamond in mol/m3 for CO2 a reference number is 38 mol/m3. Requires the first phase to have a concentration field </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a439637e5906b37a16646c186d7fc0daf_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a439637e5906b37a16646c186d7fc0daf_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a439637e5906b37a16646c186d7fc0daf_icgraph" id="namespacemultiphase__eos_a439637e5906b37a16646c186d7fc0daf_icgraph">
<area shape="rect" title=": subroutine to dissolv phase2 into phase1. Currently only for system for phase 1 = water,..." alt="" coords="467,5,632,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a7dfd3eac29921ca66854cebaa01162f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dfd3eac29921ca66854cebaa01162f9">&#9670;&nbsp;</a></span>get_devcappressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_eos::get_devcappressure </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>CV_Immobile_Fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:This functions returns the derivative of the capillary pressure with respect to the saturation </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Sat</td><td>Phase Volume fraction at current CV </td></tr>
    <tr><td class="paramname">Pe</td><td>Entry pressure at current ELE </td></tr>
    <tr><td class="paramname">a</td><td>Exponent at current ELE </td></tr>
    <tr><td class="paramname">CV_Immobile_Fraction</td><td>Immobile fraction at current CV </td></tr>
    <tr><td class="paramname">iphase</td><td>current phase </td></tr>
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a7dfd3eac29921ca66854cebaa01162f9_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a7dfd3eac29921ca66854cebaa01162f9_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a7dfd3eac29921ca66854cebaa01162f9_icgraph" id="namespacemultiphase__eos_a7dfd3eac29921ca66854cebaa01162f9_icgraph">
<area shape="rect" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="1416,184,1555,226"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#acad594ff5e1d219a2e1c7e5fe2a51605" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="1173,184,1368,226"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a30f5738db096842f8f2890cec8440814" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="934,94,1101,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="424,152,603,208"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad44e4be750a57ea3ecab7c4307a75b67" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="674,216,838,258"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="909,272,1125,314"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="651,94,861,135"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,159,376,200"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#af1bf5a11afa118074e812449240b70cb" title="WARNING: Still work in progress." alt="" coords="444,50,583,77"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,159,152,200"/>
</map>
</div>

</div>
</div>
<a id="af235dd0c336c71b8afbfb65399766c10"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af235dd0c336c71b8afbfb65399766c10">&#9670;&nbsp;</a></span>get_material_absorption()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::get_material_absorption </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>material_absorption</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>visc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>CV_Immobile_fract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>Corey_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>Endpoint_relperm</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
    <tr><td class="paramname">iphase</td><td>current phase </td></tr>
    <tr><td class="paramname">material_absorption</td><td>INOUT Absorption associated to the porous media </td></tr>
    <tr><td class="paramname">sat</td><td>saturation at current CV </td></tr>
    <tr><td class="paramname">visco</td><td>viscosity at current CV </td></tr>
    <tr><td class="paramname">CV_Immobile_fract</td><td>Immobile fraction at current CV </td></tr>
    <tr><td class="paramname">Corey_exponent</td><td>Exponent of the relperm curve at current ELE </td></tr>
    <tr><td class="paramname">Endpoint_relperm</td><td>End point of the relperm curve at current ELE </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_cgraph.png" border="0" usemap="#namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_cgraph" id="namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_cgraph">
<area shape="rect" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="5,74,148,115"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="196,74,335,115"/>
<area shape="rect" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="385,5,537,32"/>
<area shape="rect" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="409,56,513,83"/>
<area shape="rect" href="multi__eos_8_f90.html#a1c26bc7b22b8141f8c07f7aff66de2d1" title=": Tabulated relperm. This subroutine computes the relperm based on tabulated data that the user provi..." alt="" coords="398,107,523,133"/>
<area shape="rect" href="multi__eos_8_f90.html#aceb42bfefda5357e6464aec48d828dcd" title=": Tabulated relperm with Land trapping using normalised saturation" alt="" coords="383,157,539,184"/>
<area shape="rect" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="587,150,757,191"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_icgraph.png" border="0" usemap="#namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_icgraph" id="namespacemultiphase__eos_af235dd0c336c71b8afbfb65399766c10_icgraph">
<area shape="rect" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1628,78,1771,119"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1407,49,1580,90"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="1165,115,1359,141"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1185,49,1339,90"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="915,78,1117,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a245ebfb2c63f41aaf90233ccb819bad4" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="688,17,867,58"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,78,376,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="424,137,640,178"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="443,5,621,61"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,78,152,119"/>
</map>
</div>

</div>
</div>
<a id="afa5bc056e9d4cafeb1706afca8e780c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa5bc056e9d4cafeb1706afca8e780c1">&#9670;&nbsp;</a></span>get_relperm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::get_relperm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>CV_Immobile_fract</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>Corey_exponent</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>Endpoint_relperm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>Kr</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
    <tr><td class="paramname">iphase</td><td>current phase </td></tr>
    <tr><td class="paramname">sat</td><td>saturation at current CV </td></tr>
    <tr><td class="paramname">CV_Immobile_fract</td><td>Immobile fraction at current CV </td></tr>
    <tr><td class="paramname">Corey_exponent</td><td>Exponent of the relperm curve at current ELE </td></tr>
    <tr><td class="paramname">Endpoint_relperm</td><td>End point of the relperm curve at current ELE </td></tr>
    <tr><td class="paramname">Kr</td><td>INOUT Relative permeability at current CV </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_cgraph.png" border="0" usemap="#namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_cgraph" id="namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_cgraph">
<area shape="rect" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="5,74,144,115"/>
<area shape="rect" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="194,5,346,32"/>
<area shape="rect" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="218,56,322,83"/>
<area shape="rect" href="multi__eos_8_f90.html#a1c26bc7b22b8141f8c07f7aff66de2d1" title=": Tabulated relperm. This subroutine computes the relperm based on tabulated data that the user provi..." alt="" coords="207,107,333,133"/>
<area shape="rect" href="multi__eos_8_f90.html#aceb42bfefda5357e6464aec48d828dcd" title=": Tabulated relperm with Land trapping using normalised saturation" alt="" coords="192,157,348,184"/>
<area shape="rect" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="396,150,567,191"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_icgraph.png" border="0" usemap="#namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_icgraph" id="namespacemultiphase__eos_afa5bc056e9d4cafeb1706afca8e780c1_icgraph">
<area shape="rect" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1819,78,1957,119"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1628,78,1771,119"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1407,49,1580,90"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="1165,115,1359,141"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1185,49,1339,90"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="915,78,1117,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a245ebfb2c63f41aaf90233ccb819bad4" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="688,17,867,58"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,78,376,119"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#af3db1ae3b84a80d4754b797d31be7983" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="424,137,640,178"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="443,5,621,61"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,78,152,119"/>
</map>
</div>

</div>
</div>
<a id="aeb644e3565a7e33c61f0e40e73a3c990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb644e3565a7e33c61f0e40e73a3c990">&#9670;&nbsp;</a></span>get_rockfluidprop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::get_rockfluidprop </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_ndgln ), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in), optional&#160;</td>
          <td class="paramname"><em>current_time</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>update_only</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed state By index this is: 1) immobile fraction, 2) relperm max, 3)relperm exponent 4)Capillary entry pressure 5) Capillary exponent 6) Capillary imbition term The effective inmobile fraction is the min(inmobile,saturation_flipping formula), being the saturation the value after a succesful non-linear solver convergence! This NEEDS to be called after a succesful non-linear solver (with update_only) </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">current_time</td><td>current time in type(real). Only for the first time ever, not for checkpointing, overwrite the saturation flipping value with the initial one </td></tr>
    <tr><td class="paramname">update_only</td><td>If true then only the Immobile fraction is updated (for Land trapping modelling only) </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_cgraph.png" border="0" usemap="#namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_cgraph" id="namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_cgraph">
<area shape="rect" title=":Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed st..." alt="" coords="5,35,144,76"/>
<area shape="rect" href="namespacemultiphase__eos.html#a29b9750459911134c7e711f15fa42614" title=" " alt="" coords="192,5,369,47"/>
<area shape="rect" href="multi__eos_8_f90.html#a098f3f1c27b74be5d61f21fcff4c50a7" title=": This internal subroutine checks the if we are flipping from drainage to imbibition,..." alt="" coords="194,71,367,98"/>
<area shape="rect" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="417,5,588,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_icgraph.png" border="0" usemap="#namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_icgraph" id="namespacemultiphase__eos_aeb644e3565a7e33c61f0e40e73a3c990_icgraph">
<area shape="rect" title=":Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed st..." alt="" coords="467,27,621,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,5,401,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,57,419,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,171,98"/>
</map>
</div>

</div>
</div>
<a id="a3f5f7836734b85fb788ba57a2793eda7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f5f7836734b85fb788ba57a2793eda7">&#9670;&nbsp;</a></span>initialise_porous_media()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::initialise_porous_media </td>
          <td>(</td>
          <td class="paramtype">type(multi_dimensions), optional&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), optional&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), optional&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension(:), optional&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>exit_initialise_porous_media</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Initialising porous media models Given a free water level (FWL) we simulate capillary gravity equilibration, control volumes below FWL is kept at residual lighter phase saturation This subroutine is called after each timestep and saturations overidden below FWL with the heavier phase </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">exit_initialise_porous_media</td><td>Activates the option to after initialising stop the simulation </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a3f5f7836734b85fb788ba57a2793eda7_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a3f5f7836734b85fb788ba57a2793eda7_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a3f5f7836734b85fb788ba57a2793eda7_icgraph" id="namespacemultiphase__eos_a3f5f7836734b85fb788ba57a2793eda7_icgraph">
<area shape="rect" title=": Initialising porous media models Given a free water level (FWL) we simulate capillary gravity equil..." alt="" coords="467,5,656,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="ac01c010ab184f242b5ca90a44d40affa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac01c010ab184f242b5ca90a44d40affa">&#9670;&nbsp;</a></span>jwl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_eos::jwl </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>A</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>w</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>R1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>R2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>E0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>roe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ro</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>JWL equation functions. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ac01c010ab184f242b5ca90a44d40affa_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ac01c010ab184f242b5ca90a44d40affa_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ac01c010ab184f242b5ca90a44d40affa_icgraph" id="namespacemultiphase__eos_ac01c010ab184f242b5ca90a44d40affa_icgraph">
<area shape="rect" title="JWL equation functions." alt="" coords="253,5,405,32"/>
<area shape="rect" href="namespacemultiphase__eos.html#a8585fdea6dd3d2ca6508cf37236a7cc0" title="Density of JWL equation functions." alt="" coords="5,5,205,32"/>
</map>
</div>

</div>
</div>
<a id="a8585fdea6dd3d2ca6508cf37236a7cc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8585fdea6dd3d2ca6508cf37236a7cc0">&#9670;&nbsp;</a></span>jwldensity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function, dimension( jwln ) multiphase_eos::jwldensity </td>
          <td>(</td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>eos_coefs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ro0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>JWLn</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Density of JWL equation functions. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a8585fdea6dd3d2ca6508cf37236a7cc0_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a8585fdea6dd3d2ca6508cf37236a7cc0_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a8585fdea6dd3d2ca6508cf37236a7cc0_cgraph" id="namespacemultiphase__eos_a8585fdea6dd3d2ca6508cf37236a7cc0_cgraph">
<area shape="rect" title="Density of JWL equation functions." alt="" coords="5,31,205,57"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7870c763c81a10948617345c3d0ca219" title="Diff of JWL equation functions." alt="" coords="253,5,428,32"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac01c010ab184f242b5ca90a44d40affa" title="JWL equation functions." alt="" coords="265,56,417,83"/>
</map>
</div>

</div>
</div>
<a id="a7403abd4f0f6b2a8237aaa49bee9081e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7403abd4f0f6b2a8237aaa49bee9081e">&#9670;&nbsp;</a></span>metal_dissolution()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::metal_dissolution </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the partition coefficient, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not. </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_cgraph" id="namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_cgraph">
<area shape="rect" title=": subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously t..." alt="" coords="5,5,159,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="207,5,371,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="419,5,577,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_icgraph" id="namespacemultiphase__eos_a7403abd4f0f6b2a8237aaa49bee9081e_icgraph">
<area shape="rect" title=": subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously t..." alt="" coords="424,5,577,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="ad552bb5fe3f1a7753cb81faaf6097893"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad552bb5fe3f1a7753cb81faaf6097893">&#9670;&nbsp;</a></span>metal_precipitation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::metal_precipitation </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the precipitation rate, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not. </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_cgraph.png" border="0" usemap="#namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_cgraph" id="namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_cgraph">
<area shape="rect" title=": subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in d..." alt="" coords="5,5,159,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="207,5,371,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="419,5,577,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_icgraph.png" border="0" usemap="#namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_icgraph" id="namespacemultiphase__eos_ad552bb5fe3f1a7753cb81faaf6097893_icgraph">
<area shape="rect" title=": subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in d..." alt="" coords="424,5,577,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a29b9750459911134c7e711f15fa42614"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29b9750459911134c7e711f15fa42614">&#9670;&nbsp;</a></span>normalise_relperm_tables()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::normalise_relperm_tables </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_cgraph" id="namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,183,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#af14c426951c2a3fd50666548b0e17472" title=": Computes normalised saturation for Land trapping with tabulated relperm" alt="" coords="231,5,401,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_icgraph" id="namespacemultiphase__eos_a29b9750459911134c7e711f15fa42614_icgraph">
<area shape="rect" title=" " alt="" coords="611,27,788,69"/>
<area shape="rect" href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990" title=":Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed st..." alt="" coords="424,27,563,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="214,5,362,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,57,376,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,152,98"/>
</map>
</div>

</div>
</div>
<a id="a282f02f39508adfb64d99bf4659af86c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282f02f39508adfb64d99bf4659af86c">&#9670;&nbsp;</a></span>retrieve_reference_density()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_eos::retrieve_reference_density </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: For boussinesq porous media we need the reference density to ensure consistency when mixing with the porous density/Cp etc. In this subroutine we retrieve the value given a phase, component. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">iphase</td><td>Current phase </td></tr>
    <tr><td class="paramname">icomp</td><td>current component </td></tr>
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_cgraph" id="namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_cgraph">
<area shape="rect" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="5,5,169,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="217,5,376,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_icgraph" id="namespacemultiphase__eos_a282f02f39508adfb64d99bf4659af86c_icgraph">
<area shape="rect" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="1371,253,1535,294"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0" title=": This subroutine computed the gravity effect, i.e. rho * g" alt="" coords="1149,53,1323,94"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a9996f3a8552933cf3c0fc9672de6ec86" title=": Checks convergence on the temperature field Calculation of the averaged heat capacity and density a..." alt="" coords="1165,150,1307,176"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a30f5738db096842f8f2890cec8440814" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="922,140,1089,181"/>
<area shape="rect" href="namespacemultiphase__eos.html#a7403abd4f0f6b2a8237aaa49bee9081e" title=": subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously t..." alt="" coords="679,253,833,294"/>
<area shape="rect" href="namespacemultiphase__eos.html#ad552bb5fe3f1a7753cb81faaf6097893" title=": subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in d..." alt="" coords="929,312,1082,353"/>
<area shape="rect" href="namespacemultiphase__eos.html#a2c4ed816844055b0ed8990bbbc37f11a" title=": subroutine to calculate the metal total mass (in kg)." alt="" coords="683,370,829,412"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad44e4be750a57ea3ecab7c4307a75b67" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="431,425,595,466"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="909,26,1101,68"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,230,376,272"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,230,152,272"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="651,137,861,178"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#af1bf5a11afa118074e812449240b70cb" title="WARNING: Still work in progress." alt="" coords="444,139,583,166"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a1eb9efc0b06941858a54239da8c431a0" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="424,190,603,246"/>
</map>
</div>

</div>
</div>
<a id="a2591de41e9c67340b83129722447923b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2591de41e9c67340b83129722447923b">&#9670;&nbsp;</a></span>saturation_temperature()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_eos::saturation_temperature </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>pressure</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: ???? </p>

</div>
</div>
<a id="a2c4ed816844055b0ed8990bbbc37f11a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c4ed816844055b0ed8990bbbc37f11a">&#9670;&nbsp;</a></span>total_mass_metal()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::total_mass_metal </td>
          <td>(</td>
          <td class="paramtype">type(state_type), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_shape_funs)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(out)&#160;</td>
          <td class="paramname"><em>metal_total_mass</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: subroutine to calculate the metal total mass (in kg). </p>
<dl class="section author"><dt>Author</dt><dd>Meissam Bahlali </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_cgraph.png" border="0" usemap="#namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_cgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_cgraph" id="namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_cgraph">
<area shape="rect" title=": subroutine to calculate the metal total mass (in kg)." alt="" coords="5,5,152,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="200,5,364,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="412,5,571,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_icgraph" id="namespacemultiphase__eos_a2c4ed816844055b0ed8990bbbc37f11a_icgraph">
<area shape="rect" title=": subroutine to calculate the metal total mass (in kg)." alt="" coords="424,5,571,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a15a1f78f9f889b58b7b9f45de20d5a48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15a1f78f9f889b58b7b9f45de20d5a48">&#9670;&nbsp;</a></span>update_velocity_absorption()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::update_velocity_absorption </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>velocity_absorption</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:&lt;INERTIA ONLY&gt;Computes velocity absorption from diamond information </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">ndim</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
    <tr><td class="paramname">velocity_absorption</td><td>Absorption term to be updated here </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a15a1f78f9f889b58b7b9f45de20d5a48_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a15a1f78f9f889b58b7b9f45de20d5a48_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a15a1f78f9f889b58b7b9f45de20d5a48_icgraph" id="namespacemultiphase__eos_a15a1f78f9f889b58b7b9f45de20d5a48_icgraph">
<area shape="rect" title=":&lt;INERTIA ONLY&gt;Computes velocity absorption from diamond information" alt="" coords="664,5,824,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="424,5,616,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a98927879ae36867eabec1a9e6a5f22d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a98927879ae36867eabec1a9e6a5f22d8">&#9670;&nbsp;</a></span>update_velocity_absorption_coriolis()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::update_velocity_absorption_coriolis </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>velocity_absorption</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:Computes velocity absorption associated to coriolis forces from diamond information </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">ndim</td><td>Number of dimensions </td></tr>
    <tr><td class="paramname">nphase</td><td>Number of phases </td></tr>
    <tr><td class="paramname">velocity_absorption</td><td>Absorption term to be updated here </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a98927879ae36867eabec1a9e6a5f22d8_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a98927879ae36867eabec1a9e6a5f22d8_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a98927879ae36867eabec1a9e6a5f22d8_icgraph" id="namespacemultiphase__eos_a98927879ae36867eabec1a9e6a5f22d8_icgraph">
<area shape="rect" title=":Computes velocity absorption associated to coriolis forces from diamond information" alt="" coords="664,5,853,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="424,5,616,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<a id="a8f7f68ee8d294089b9077c480795eb9c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f7f68ee8d294089b9077c480795eb9c">&#9670;&nbsp;</a></span>update_velocity_source()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_eos::update_velocity_source </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>states</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type ( multi_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>u_source</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:Computes velocity source from diamond information </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensionrs describing the mesh, fields, nodes, etc. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__eos_a8f7f68ee8d294089b9077c480795eb9c_icgraph.png" border="0" usemap="#namespacemultiphase__eos_a8f7f68ee8d294089b9077c480795eb9c_icgraph" alt=""/></div>
<map name="namespacemultiphase__eos_a8f7f68ee8d294089b9077c480795eb9c_icgraph" id="namespacemultiphase__eos_a8f7f68ee8d294089b9077c480795eb9c_icgraph">
<area shape="rect" title=":Computes velocity source from diamond information" alt="" coords="664,5,824,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac8c3c3c252bab49e31602e628c983f5b" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="424,5,616,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="200,5,376,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,152,47"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ae1ce91e74714b2c125d7a764aaa79ff3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ce91e74714b2c125d7a764aaa79ff3">&#9670;&nbsp;</a></span>flooding_hmin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, parameter multiphase_eos::flooding_hmin = 1e-5</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac225ca863b2915b70181fe53abe4d779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac225ca863b2915b70181fe53abe4d779">&#9670;&nbsp;</a></span>original_immobile_per_phase</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:), allocatable, save multiphase_eos::original_immobile_per_phase</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ad75fdebae56a34f58313eb37d69fae6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad75fdebae56a34f58313eb37d69fae6e">&#9670;&nbsp;</a></span>pc_table_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable, save multiphase_eos::pc_table_data</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aa82391e55c623b151745a9ef5fe09e97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa82391e55c623b151745a9ef5fe09e97">&#9670;&nbsp;</a></span>relperm_table_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable, save multiphase_eos::relperm_table_data</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aadda55c84c6fbe47425442430dc79dd4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aadda55c84c6fbe47425442430dc79dd4">&#9670;&nbsp;</a></span>relperm_table_norm_data</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real, dimension(:,:,:), allocatable, save multiphase_eos::relperm_table_norm_data</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ac9e26a6e715bbcea0e5f3d124871a8b2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9e26a6e715bbcea0e5f3d124871a8b2">&#9670;&nbsp;</a></span>tables_loaded</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, save multiphase_eos::tables_loaded = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="aede48d1965af522f9a3bfcf4148a9395"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aede48d1965af522f9a3bfcf4148a9395">&#9670;&nbsp;</a></span>tables_normalised</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical, save multiphase_eos::tables_normalised = .false.</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemultiphase__eos.html">multiphase_eos</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
