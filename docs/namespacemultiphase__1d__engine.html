<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: multiphase_1d_engine Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ICFERST<span id="projectnumber">&#160;25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacemultiphase__1d__engine.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a>  </div>
  <div class="headertitle"><div class="title">multiphase_1d_engine Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This module contain all the necessary subroutines to deal with FE-wise equations and fields. Assembling and solving of the momentum equation and associated fields such as capillary pressure, hydrostatic pressure solver, and stabilisation techniques. Also includes the assembly and solving of a Laplacian system (for zeta potential mainly)  
<a href="namespacemultiphase__1d__engine.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a8b8466b21f31e369fc0ae74a939444cd" id="r_a8b8466b21f31e369fc0ae74a939444cd"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd">intenerge_assem_solve</a> (state, packed_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, tracer, velocity, density, multi_absorp, dt, suf_sig_diagten_bc, volfra_pore, volfra_pore_total, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_gdiff, eles_with_pipe, pipes_aux, option_path, mass_ele_transp, thermal, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, icomp, saturation, permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:a8b8466b21f31e369fc0ae74a939444cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the transport of energy/temperature and to solve the transport of components.  <br /></td></tr>
<tr class="separator:a8b8466b21f31e369fc0ae74a939444cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8eddee3d8387917a7563c83c7ebbe9d" id="r_ae8eddee3d8387917a7563c83c7ebbe9d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d">force_min_max_principle</a> (mdims, entrance, tracer, nonlinear_iteration, totally_min_max)</td></tr>
<tr class="memdesc:ae8eddee3d8387917a7563c83c7ebbe9d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: To help the stability of the system,if there are no sources/sinks it is known that the temperature must fulfill the min max principle, therefore here values outside this rank are capped.  <br /></td></tr>
<tr class="separator:ae8eddee3d8387917a7563c83c7ebbe9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae08ee439502a499a77b44ecdd504846a" id="r_ae08ee439502a499a77b44ecdd504846a"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a">tracer_assemble_solve</a> (tracer_name, state, packed_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, tracer, velocity, density, multi_absorp, dt, suf_sig_diagten_bc, volfra_pore, volfra_pore_total, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_gdiff, eles_with_pipe, pipes_aux, mass_ele_transp, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, icomp, saturation, permeability_tensor_field, nonlinear_iteration)</td></tr>
<tr class="memdesc:ae08ee439502a499a77b44ecdd504846a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passive_Tracer_N Where N is an integer which is continuous starting from 1.  <br /></td></tr>
<tr class="separator:ae08ee439502a499a77b44ecdd504846a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8ed1c2e68fd75835c3794475805554c" id="r_aa8ed1c2e68fd75835c3794475805554c"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c">volumefraction_assemble_solve</a> (state, packed_state, multicomponent_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, dt, suf_sig_diagten_bc, v_source, volfra_pore, volfra_pore_total, igot_theta_flux, mass_ele_transp, nonlinear_iteration, time_step, sfpi_taken, sfpi_its, courant_number, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j)</td></tr>
<tr class="memdesc:aa8ed1c2e68fd75835c3794475805554c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded.  <br /></td></tr>
<tr class="separator:aa8ed1c2e68fd75835c3794475805554c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07a7956a7419e82fb8f059cae3ded083" id="r_a07a7956a7419e82fb8f059cae3ded083"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083">volumefraction_assemble_solve_newton</a> (state, packed_state, multicomponent_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, dt, suf_sig_diagten_bc, prev_sat, v_source, volfra_pore, igot_theta_flux, mass_ele_transp, nonlinear_iteration, time_step, sfpi_taken, sfpi_its, courant_number, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j)</td></tr>
<tr class="memdesc:a07a7956a7419e82fb8f059cae3ded083"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jacobian. Solves using Newton's method.  <br /></td></tr>
<tr class="separator:a07a7956a7419e82fb8f059cae3ded083"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1ce62fd9e2240cf8992447180a0152c" id="r_aa1ce62fd9e2240cf8992447180a0152c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c">assemb_sat_jac_and_res</a> (state, packed_state, final_phase, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, sat_field, sat_bak, velocity, density, multi_absorp, diag_scale_pres, diag_scale_pres_coup, inv_b, den_all, denold_all, cv_disopt, cv_dg_vel_int_opt, dt, cv_theta, cv_beta, suf_sig_diagten_bc, deriv, cv_p, sourct_all, absorbt_all, volfra_pore, getcv_disc, getct, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, theta_gdiff, mean_pore_cv, mass_mn_pres, thermal, got_free_surf, mass_suf, mass_ele_transp, tdiffusion, saturation, vad_parameter, phase_with_pc, courant_number, permeability_tensor_field, calculate_mass_delta, eles_with_pipe, pipes_aux, porous_heat_coef, porous_heat_coef_old, outfluxes, solving_compositional, nonlinear_iteration, assemble_collapsed_to_one_phase)</td></tr>
<tr class="memdesc:aa1ce62fd9e2240cf8992447180a0152c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of the saturation. The Jacobian is stored in MmatPETSC_ACV and the residual in MmatCV_RHS.  <br /></td></tr>
<tr class="separator:aa1ce62fd9e2240cf8992447180a0152c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad72540721ea2ef4651301189e8973481" id="r_ad72540721ea2ef4651301189e8973481"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481">compositional_assemble_solve</a> (state, packed_state, multicomponent_state, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, multi_absorp, dt, suf_sig_diagten_bc, get_theta_flux, use_theta_flux, theta_gdiff, eles_with_pipe, pipes_aux, mass_ele, sum_theta_flux, sum_one_m_theta_flux, sum_theta_flux_j, sum_one_m_theta_flux_j)</td></tr>
<tr class="memdesc:ad72540721ea2ef4651301189e8973481"><td class="mdescLeft">&#160;</td><td class="mdescRight">:In this subroutine the components are solved for all the phases. Systems for each component are assembled and solved by calling INTENERGE_ASSEM_SOLVE  <br /></td></tr>
<tr class="separator:ad72540721ea2ef4651301189e8973481"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2644f81b959a9c66d17c6ae96e452faf" id="r_a2644f81b959a9c66d17c6ae96e452faf"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf">force_bal_cty_assem_solve</a> (state, packed_state, mdims, cv_gidims, fe_gidims, cv_funs, fe_funs, mspars, ndgln, mdisopt, mmat, multi_absorp, upwnd, eles_with_pipe, pipes_aux, velocity, pressure, dt, suf_sig_diagten_bc, v_source, volfra_pore, volfra_pore_total, igot_theta_flux, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, calculate_mass_delta, outfluxes, pres_its_taken, nonlinear_its, courant_number)</td></tr>
<tr class="memdesc:a2644f81b959a9c66d17c6ae96e452faf"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix Once these matrices (and corresponding RHSs) are generated the system of equations is solved using the projection method.  <br /></td></tr>
<tr class="separator:a2644f81b959a9c66d17c6ae96e452faf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1438bf1da042b7b9b7d65fd2836aace" id="r_aa1438bf1da042b7b9b7d65fd2836aace"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#aa1438bf1da042b7b9b7d65fd2836aace">dg_visc_lin</a> (s_inv_nnx_mat12, nnx_mat, nnx_mat2, nn_mat, nn_mat2, u_snloc, u_nloc, sbufen_reversed, sdetwe, sbcvngi, snormxn_all, ndim, u_sloc2loc, u_other_loc, u_nloc_ext, on_boundary)</td></tr>
<tr class="memdesc:aa1438bf1da042b7b9b7d65fd2836aace"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter element coupling for the viscocity discretization. NNX_MAT, NNX_MAT2 contain matricies of first derivative times basis function for current element and neightbouring element. Similarly NN_MAT, NN_MAT2, contain the element-wise mass matrices. Only call this sub if element not next to the boundary...  <br /></td></tr>
<tr class="separator:aa1438bf1da042b7b9b7d65fd2836aace"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a425257d37d64d5ef1b27cd666391fc" id="r_a4a425257d37d64d5ef1b27cd666391fc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a4a425257d37d64d5ef1b27cd666391fc">viscocity_tensor_les_calc</a> (les_udiffusion, les_udiffusion_vol, dux_ele_all, ndim, nphase, u_nloc, x_nloc, totele, x_nonods, x_all, x_ndgln, mat_nonods, mat_nloc, mat_ndgln, les_disopt, les_cs, uden, cv_nonods, cv_ndgln, u_ndgln, u_nonods, u_all, deriv)</td></tr>
<tr class="memdesc:a4a425257d37d64d5ef1b27cd666391fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL  <br /></td></tr>
<tr class="separator:a4a425257d37d64d5ef1b27cd666391fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4d7e6111d2e2ffcc4a22cb168d15f34" id="r_ac4d7e6111d2e2ffcc4a22cb168d15f34"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ac4d7e6111d2e2ffcc4a22cb168d15f34">comb_vel_matrix_diag_dist</a> (diag_bigm_con, bigm_con, dgm_petsc, finele, colele, ndim, nphase, u_nloc, totele, velocity, pressure, mmat)</td></tr>
<tr class="memdesc:ac4d7e6111d2e2ffcc4a22cb168d15f34"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. For stokes also the diagonal of the matrix is introduced in the mass matrix  <br /></td></tr>
<tr class="separator:ac4d7e6111d2e2ffcc4a22cb168d15f34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a154e187ad1fef3c04332b9b757a7240d" id="r_a154e187ad1fef3c04332b9b757a7240d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a154e187ad1fef3c04332b9b757a7240d">comb_vel_matrix_diag_dist_lump</a> (diag_bigm_con, bigm_con, dgm_petsc, finele, colele, ndim, nphase, u_nloc, totele, velocity, pressure)</td></tr>
<tr class="memdesc:a154e187ad1fef3c04332b9b757a7240d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA.  <br /></td></tr>
<tr class="separator:a154e187ad1fef3c04332b9b757a7240d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19a3d87102acd36c65500df29796b9ec" id="r_a19a3d87102acd36c65500df29796b9ec"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a19a3d87102acd36c65500df29796b9ec">use_posinmat_c_store</a> (count, u_inod, p_jnod, u_nonods, findc, colc, ncolc, ido_store_ac_spar_pt, stored_ac_spar_pt, posinmat_c_store, ele, u_iloc, p_jloc, totele, u_nloc, p_nloc)</td></tr>
<tr class="memdesc:a19a3d87102acd36c65500df29796b9ec"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to assemble the C matrix in the ICFERST format.  <br /></td></tr>
<tr class="separator:a19a3d87102acd36c65500df29796b9ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f7f591c0dd6fb3817df338933c82990" id="r_a5f7f591c0dd6fb3817df338933c82990"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a5f7f591c0dd6fb3817df338933c82990">use_posinmat_c_store_suf_dg</a> (count, u_inod, p_jnod, u_nonods, findc, colc, ncolc, ido_store_ac_spar_pt, stored_ac_spar_pt, posinmat_c_store_suf_dg, ele, iface, u_siloc, p_sjloc, totele, nface, u_snloc, p_snloc)</td></tr>
<tr class="memdesc:a5f7f591c0dd6fb3817df338933c82990"><td class="mdescLeft">&#160;</td><td class="mdescRight">Used to assemble the C matrix in the ICFERST format (for DG?)  <br /></td></tr>
<tr class="separator:a5f7f591c0dd6fb3817df338933c82990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8917356adde1eb2aedccd0320529a6c5" id="r_a8917356adde1eb2aedccd0320529a6c5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5">linearise_field</a> (field_in, field_out)</td></tr>
<tr class="memdesc:a8917356adde1eb2aedccd0320529a6c5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field  <br /></td></tr>
<tr class="separator:a8917356adde1eb2aedccd0320529a6c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a69c69484b7aa3fadf3b433fb3d1c06e4" id="r_a69c69484b7aa3fadf3b433fb3d1c06e4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a69c69484b7aa3fadf3b433fb3d1c06e4">introduce_grad_rhs_field_term</a> (packed_state, mdims, mmat, rhs_field, fe_funs, devfuns, x_all, loc_u_rhs, ele, cv_ndgln, x_ndgln, ele2, iface, sdetwe, snormxn_all, u_sloc2loc, cv_sloc2loc, mat_other_loc)</td></tr>
<tr class="memdesc:a69c69484b7aa3fadf3b433fb3d1c06e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example) for the momentum equation. It has two options (hard-coded) integrations by parts (activated) or voluemtric integration, For capillary pressure: The capillary pressure is a term introduced as a RHS which affects the effective velocity  <br /></td></tr>
<tr class="separator:a69c69484b7aa3fadf3b433fb3d1c06e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de595767a445b64e2d2c03a88413f2a" id="r_a9de595767a445b64e2d2c03a88413f2a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a">getoverrelaxation_parameter</a> (state, packed_state, mdims, ndgln, overrelaxation, phase_with_pc, totally_min_max, for_transport)</td></tr>
<tr class="memdesc:a9de595767a445b64e2d2c03a88413f2a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more information read: doi.org/10.1016/j.cma.2019.07.004.  <br /></td></tr>
<tr class="separator:a9de595767a445b64e2d2c03a88413f2a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f51328ef034efd7e4104db3a9b58d4e" id="r_a5f51328ef034efd7e4104db3a9b58d4e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a5f51328ef034efd7e4104db3a9b58d4e">high_order_pressure_solve</a> (mdims, ndgln, u_rhs, state, packed_state, nphase, u_absorbin)</td></tr>
<tr class="memdesc:a5f51328ef034efd7e4104db3a9b58d4e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created and solved that accounts for the gravity effect in the system. Next, this is introduced as a RHS in the momemtum equation This allows for higher precision for the gravity effect. &gt;  <br /></td></tr>
<tr class="separator:a5f51328ef034efd7e4104db3a9b58d4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab407ee959b55313b7b395f5eeac47e0e" id="r_ab407ee959b55313b7b395f5eeac47e0e"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ab407ee959b55313b7b395f5eeac47e0e">dg_oscilat_detect</a> (sndotq_keep, sndotq2_keep, n_dot_du, n_dot_du2, sincome, mass_ele, mass_ele2)</td></tr>
<tr class="memdesc:ab407ee959b55313b7b395f5eeac47e0e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <br /></td></tr>
<tr class="separator:ab407ee959b55313b7b395f5eeac47e0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a427e8757a259e6a8828dc992c757fff9" id="r_a427e8757a259e6a8828dc992c757fff9"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a427e8757a259e6a8828dc992c757fff9">p0_dg_oscilat_detect</a> (sndotq_keep, sndotq2_keep, n_dot_du, n_dot_du2, sincome, mass_ele, mass_ele2)</td></tr>
<tr class="memdesc:a427e8757a259e6a8828dc992c757fff9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME.  <br /></td></tr>
<tr class="separator:a427e8757a259e6a8828dc992c757fff9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac23b4fbb2a0c5d2c452d01d480d46b64" id="r_ac23b4fbb2a0c5d2c452d01d480d46b64"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#ac23b4fbb2a0c5d2c452d01d480d46b64">diffus_cal_coeff_stress_or_tensor</a> (mdims, diff_coef_divdx, diff_coefold_divdx, stress_form, stress_form_stab, zero_or_two_thirds, sbufen_reversed, sbcvfen_reversed, sbcvngi, sloc_udiffusion, sloc_udiffusion_vol, sloc2_udiffusion, sloc2_udiffusion_vol, diff_gi_added, hdc, u_cv_nodj_ipha_all, u_cv_nodi_ipha_all, uold_cv_nodj_ipha_all, uold_cv_nodi_ipha_all, ele, ele2, snormxn_all, sloc_dux_ele_all, sloc2_dux_ele_all, sloc_duoldx_ele_all, sloc2_duoldx_ele_all, sele, wic_u_bc, <a class="el" href="namespacecv__advection.html#a7ceb6fac2898be0cae2d603d5226f631">wic_u_bc_dirichlet</a>, simple_diff_calc, diff_min_frac, diff_max_frac)</td></tr>
<tr class="memdesc:ac23b4fbb2a0c5d2c452d01d480d46b64"><td class="mdescLeft">&#160;</td><td class="mdescRight">: &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity.  <br /></td></tr>
<tr class="separator:ac23b4fbb2a0c5d2c452d01d480d46b64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b7967a62e580d633d9c828e05cac7ae" id="r_a0b7967a62e580d633d9c828e05cac7ae"><td class="memItemLeft" align="right" valign="top">subroutine, public&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#a0b7967a62e580d633d9c828e05cac7ae">generate_and_solve_laplacian_system</a> (mdims, state, packed_state, ndgln, mmat, mspars, cv_funs, cv_gidims, sigma_field, field_name, k_fields, f_fields, intface_val_type, solver_path)</td></tr>
<tr class="memdesc:a0b7967a62e580d633d9c828e05cac7ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. &gt;  <br /></td></tr>
<tr class="separator:a0b7967a62e580d633d9c828e05cac7ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe0c5dfb1b3480e8ae2df59b05e12348" id="r_afe0c5dfb1b3480e8ae2df59b05e12348"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__1d__engine.html#afe0c5dfb1b3480e8ae2df59b05e12348">impose_strong_bcs_wells</a> (state, pipes_aux, mdims, mmat, ndgln, cmc_petsc, pressure, rhs_p)</td></tr>
<tr class="memdesc:afe0c5dfb1b3480e8ae2df59b05e12348"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pressure boundary conditions for wells ONLY. This is required only when using P0DG-P1 If not imposing strong pressure BCs and using P0DG-P1, the formulation for weak pressure BCs leads to a 0 in the diagonal of the CMC matrix, therefore strong BCs are required.  <br /></td></tr>
<tr class="separator:afe0c5dfb1b3480e8ae2df59b05e12348"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contain all the necessary subroutines to deal with FE-wise equations and fields. Assembling and solving of the momentum equation and associated fields such as capillary pressure, hydrostatic pressure solver, and stabilisation techniques. Also includes the assembly and solving of a Laplacian system (for zeta potential mainly) </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="aa1ce62fd9e2240cf8992447180a0152c" name="aa1ce62fd9e2240cf8992447180a0152c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1ce62fd9e2240cf8992447180a0152c">&#9670;&#160;</a></span>assemb_sat_jac_and_res()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::assemb_sat_jac_and_res </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout), target&#160;</td>
          <td class="paramname"><em>sat_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:)&#160;</td>
          <td class="paramname"><em>sat_bak</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), target&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>diag_scale_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>diag_scale_pres_coup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>inv_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), target&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_disopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_dg_vel_int_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cv_theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cv_beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>sourct_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in), pointer&#160;</td>
          <td class="paramname"><em>absorbt_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>getcv_disc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>getct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_gdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mean_pore_cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_mn_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>thermal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>got_free_surf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_suf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(in), optional&#160;</td>
          <td class="paramname"><em>tdiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>vad_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout), optional&#160;</td>
          <td class="paramname"><em>phase_with_pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>courant_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional&#160;</td>
          <td class="paramname"><em>calculate_mass_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(in), optional&#160;</td>
          <td class="paramname"><em>porous_heat_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(in), optional&#160;</td>
          <td class="paramname"><em>porous_heat_coef_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>solving_compositional</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>assemble_collapsed_to_one_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of the saturation. The Jacobian is stored in MmatPETSC_ACV and the residual in MmatCV_RHS. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas </dd></dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_cgraph" id="anamespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_cgraph">
<area shape="rect" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="5,214,197,254"/>
<area shape="rect" href="namespacematrix__operations.html#ab99709a532cd3a8ace8bd896814bc37b" title=" " alt="" coords="259,6,460,61"/>
<area shape="poly" title=" " alt="" coords="113,212,165,144,202,105,244,71,254,65,257,70,247,76,206,109,169,147,118,215"/>
<area shape="rect" href="namespacemultiphase__eos.html#a8c66b15baf1f392d67a7b875514f9db7" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="245,86,473,126"/>
<area shape="poly" title=" " alt="" coords="126,211,179,173,244,135,262,128,264,133,247,140,181,177,129,215"/>
<area shape="rect" href="namespacesolvers__module.html#a6d8537381fc47d2c768d80375889a65a" title=" " alt="" coords="263,150,456,190"/>
<area shape="poly" title=" " alt="" coords="182,211,264,190,266,195,183,216"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="541,254,722,294"/>
<area shape="poly" title=" " alt="" coords="179,251,246,263,393,273,527,274,527,280,393,279,245,268,178,256"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="249,214,470,254"/>
<area shape="poly" title=" " alt="" coords="197,231,235,231,235,236,197,236"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="268,448,451,488"/>
<area shape="poly" title=" " alt="" coords="126,252,328,437,324,441,123,256"/>
<area shape="rect" href="namespacesolvers__module.html#aed9753359fd3dd4278721035ca8c0134" title="In this subroutine the matrix is multiplied by vfield A is&#45;written." alt="" coords="267,512,452,552"/>
<area shape="poly" title=" " alt="" coords="110,253,125,303,153,369,193,439,218,471,247,498,256,504,253,509,244,502,214,474,188,442,148,372,120,305,105,255"/>
<area shape="rect" href="namespacemultiphase__eos.html#a4c25264c85fc53c6e510fb601aaa3b58" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="535,102,727,142"/>
<area shape="poly" title=" " alt="" coords="474,110,522,112,521,118,474,115"/>
<area shape="rect" href="namespacemultiphase__eos.html#a19df2cd38bcac98a4dadc0a3327bc1d4" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="795,42,955,82"/>
<area shape="poly" title=" " alt="" coords="444,83,472,70,486,58,494,46,504,33,520,23,557,11,596,5,673,6,747,17,809,35,808,40,746,23,673,11,596,11,558,17,522,28,508,37,499,49,490,62,475,74,446,88"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae389bf78d79bfc3260a4b53fe2e117d8" title="In this subroutine we compute the viscosity EOS. Options for different EOS." alt="" coords="536,38,727,78"/>
<area shape="poly" title=" " alt="" coords="472,83,522,74,523,79,473,88"/>
<area shape="poly" title=" " alt="" coords="712,99,781,82,782,87,714,104"/>
<area shape="rect" href="namespacemultiphase__eos.html#a2b630dc39b8a9a21ef87319a98039974" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1008,42,1163,82"/>
<area shape="poly" title=" " alt="" coords="955,59,994,59,994,64,955,64"/>
<area shape="poly" title=" " alt="" coords="471,247,527,256,527,261,470,252"/>
<area shape="rect" href="namespacemultiphase__eos.html#a0884f603bf7bf0a4b380eb50f6de51b7" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="554,190,709,230"/>
<area shape="poly" title=" " alt="" coords="470,221,540,215,540,220,470,226"/>
<area shape="poly" title=" " alt="" coords="586,190,583,180,591,171,607,165,631,163,660,166,675,173,673,178,658,171,631,168,608,170,594,175,589,181,591,188"/>
<area shape="poly" title=" " alt="" coords="373,446,432,376,473,337,520,303,532,297,534,302,523,308,477,341,436,380,377,450"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="541,580,722,620"/>
<area shape="poly" title=" " alt="" coords="452,485,475,498,492,515,500,533,508,550,523,566,532,572,529,576,520,570,503,553,495,535,487,518,472,502,450,490"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="536,645,727,670"/>
<area shape="poly" title=" " alt="" coords="453,483,475,498,489,515,496,532,500,566,503,599,510,615,523,630,530,636,527,640,519,634,505,618,498,601,494,567,491,534,484,518,472,502,450,487"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="543,694,719,720"/>
<area shape="poly" title=" " alt="" coords="453,482,475,498,492,522,500,545,501,569,499,592,498,615,499,638,507,660,523,681,533,689,530,693,519,685,502,662,494,639,492,615,494,592,496,569,494,546,487,524,471,502,450,486"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="526,744,737,784"/>
<area shape="poly" title=" " alt="" coords="452,482,475,498,495,528,504,558,504,587,500,616,496,645,496,674,504,702,523,731,526,734,523,737,519,734,499,704,491,674,491,645,495,616,499,587,498,558,491,530,471,502,449,486"/>
<area shape="rect" href="namespacecv__advection.html#aa75b98e24eaf8dd45300f3c4b1c86fce" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="561,318,701,358"/>
<area shape="poly" title=" " alt="" coords="387,446,447,407,520,367,547,357,549,362,522,372,449,411,390,450"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="521,382,741,408"/>
<area shape="poly" title=" " alt="" coords="421,446,521,416,554,408,556,413,522,421,423,451"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="544,432,719,457"/>
<area shape="poly" title=" " alt="" coords="450,458,530,450,530,456,451,463"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="539,481,723,506"/>
<area shape="poly" title=" " alt="" coords="451,474,526,481,525,486,450,479"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="531,530,731,556"/>
<area shape="poly" title=" " alt="" coords="436,486,474,498,522,516,552,524,551,530,521,521,472,503,434,491"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aee06170a27bb4dab883f8ef10ff1cba8" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="791,392,959,432"/>
<area shape="poly" title=" " alt="" coords="719,430,776,422,777,428,719,435"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="789,481,960,506"/>
<area shape="poly" title=" " alt="" coords="724,491,775,491,775,496,724,496"/>
<area shape="poly" title=" " alt="" coords="840,482,833,473,837,463,851,456,875,454,904,458,916,467,912,471,902,463,875,460,852,462,840,466,838,472,844,479"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#af4782b913aba9aef1af79d9db7c1739a" title=" " alt="" coords="791,555,959,595"/>
<area shape="poly" title=" " alt="" coords="728,553,777,559,777,565,728,558"/>
<area shape="poly" title=" " alt="" coords="835,555,833,545,839,536,853,530,875,528,899,531,913,538,910,543,898,536,875,534,854,535,842,540,838,546,840,554"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_icgraph" id="anamespacemultiphase__1d__engine_aa1ce62fd9e2240cf8992447180a0152c_icgraph">
<area shape="rect" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="712,13,904,53"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="465,5,664,60"/>
<area shape="poly" title=" " alt="" coords="698,35,664,35,664,30,698,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="451,35,418,35,418,30,451,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="ac4d7e6111d2e2ffcc4a22cb168d15f34" name="ac4d7e6111d2e2ffcc4a22cb168d15f34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4d7e6111d2e2ffcc4a22cb168d15f34">&#9670;&#160;</a></span>comb_vel_matrix_diag_dist()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::comb_vel_matrix_diag_dist </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>diag_bigm_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>bigm_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( petsc_csr_matrix ), intent(inout)&#160;</td>
          <td class="paramname"><em>dgm_petsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(: ), intent(in)&#160;</td>
          <td class="paramname"><em>finele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>colele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. For stokes also the diagonal of the matrix is introduced in the mass matrix </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ac4d7e6111d2e2ffcc4a22cb168d15f34_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ac4d7e6111d2e2ffcc4a22cb168d15f34_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ac4d7e6111d2e2ffcc4a22cb168d15f34_icgraph" id="anamespacemultiphase__1d__engine_ac4d7e6111d2e2ffcc4a22cb168d15f34_icgraph">
<area shape="rect" title=": &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into t..." alt="" coords="723,5,932,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a154e187ad1fef3c04332b9b757a7240d" name="a154e187ad1fef3c04332b9b757a7240d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a154e187ad1fef3c04332b9b757a7240d">&#9670;&#160;</a></span>comb_vel_matrix_diag_dist_lump()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::comb_vel_matrix_diag_dist_lump </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>diag_bigm_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,:,:, :,:,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>bigm_con</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( petsc_csr_matrix ), intent(inout)&#160;</td>
          <td class="paramname"><em>dgm_petsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(: ), intent(in)&#160;</td>
          <td class="paramname"><em>finele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>colele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field )&#160;</td>
          <td class="paramname"><em>pressure</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into the matrix DGM_PHA. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a154e187ad1fef3c04332b9b757a7240d_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a154e187ad1fef3c04332b9b757a7240d_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a154e187ad1fef3c04332b9b757a7240d_icgraph" id="anamespacemultiphase__1d__engine_a154e187ad1fef3c04332b9b757a7240d_icgraph">
<area shape="rect" title=": &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into t..." alt="" coords="723,5,901,60"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,13,675,53"/>
<area shape="poly" title=" " alt="" coords="709,35,675,35,675,30,709,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,417,35,417,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="ad72540721ea2ef4651301189e8973481" name="ad72540721ea2ef4651301189e8973481"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad72540721ea2ef4651301189e8973481">&#9670;&#160;</a></span>compositional_assemble_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::compositional_assemble_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_gdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>sum_one_m_theta_flux_j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:In this subroutine the components are solved for all the phases. Systems for each component are assembled and solved by calling INTENERGE_ASSEM_SOLVE </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">multicomponent_state</td><td>Linked list containing all the fields used by compositional, just in case we are solving for components &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">DT</td><td>Time step size </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">GET_THETA_FLUX,USE_THETA_FLUX</td><td>????? </td></tr>
    <tr><td class="paramname">THETA_GDIFF</td><td>???? </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">mass_ele</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">sum_theta_flux,sum_one_m_theta_flux,sum_theta_flux_j,sum_one_m_theta_flux_j</td><td>???? </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_cgraph" id="anamespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_cgraph">
<area shape="rect" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="5,721,240,761"/>
<area shape="rect" href="namespacecompositional__terms.html#a48e5e1d75323094a1b7d6cd01ebde0a1" title="make sure the composition sums to 1.0" alt="" coords="328,593,517,633"/>
<area shape="poly" title=" " alt="" coords="151,719,212,680,287,643,314,634,315,639,289,648,214,685,154,724"/>
<area shape="rect" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="288,657,557,697"/>
<area shape="poly" title=" " alt="" coords="217,719,315,698,316,703,218,724"/>
<area shape="rect" href="namespacecv__advection.html#a6eaca115c05985fed5f9376ecce181d7" title="This subroutine counts then number of faces in the control volume space." alt="" coords="335,721,510,761"/>
<area shape="poly" title=" " alt="" coords="240,739,322,739,322,744,240,744"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="331,1015,515,1055"/>
<area shape="poly" title=" " alt="" coords="146,760,393,1003,389,1007,143,763"/>
<area shape="rect" href="namespacesolvers__module.html#a9bba1ef1495c1a4a47a7eea3f2c17719" title=":This subroutines eliminates the oscillations in the saturation that are bigger than a certain tolera..." alt="" coords="332,1079,513,1119"/>
<area shape="poly" title=" " alt="" coords="131,761,146,821,176,904,197,948,223,991,254,1031,290,1065,320,1082,318,1086,286,1069,250,1034,219,994,193,950,171,906,141,823,125,762"/>
<area shape="rect" href="namespacecompositional__terms.html#a23481f5d5ce42c14c00cbc93e4a7bfa2" title="Method to flash components." alt="" coords="654,61,813,101"/>
<area shape="poly" title=" " alt="" coords="542,655,555,644,567,626,575,603,584,544,585,474,583,398,579,322,579,250,586,189,593,164,603,144,624,122,649,105,652,110,627,126,608,147,598,166,591,190,584,251,584,322,588,398,591,474,590,545,580,604,572,628,559,647,546,659"/>
<area shape="rect" href="namespacecompositional__terms.html#ac1d9985f8ba66b85d7ac0905db70ec6a" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="943,29,1102,69"/>
<area shape="poly" title=" " alt="" coords="813,70,929,57,930,62,813,75"/>
<area shape="poly" title=" " alt="" coords="973,30,970,20,978,10,996,5,1023,3,1054,5,1070,13,1068,18,1052,11,1023,8,997,10,981,15,975,21,978,28"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="935,221,1111,261"/>
<area shape="poly" title=" " alt="" coords="509,727,534,719,556,707,592,682,623,656,670,603,704,548,732,492,760,435,794,379,841,324,872,297,908,271,921,264,924,268,911,276,875,302,845,328,798,382,765,438,737,494,709,550,674,606,626,660,595,686,559,712,536,723,511,732"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="647,1099,819,1125"/>
<area shape="poly" title=" " alt="" coords="516,1052,558,1064,606,1084,643,1094,642,1099,604,1089,556,1069,514,1057"/>
<area shape="rect" href="namespacecompositional__terms.html#a9091a40e5dcfbb5b4ebbce9242c7d0c4" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="605,157,861,197"/>
<area shape="poly" title=" " alt="" coords="434,1013,490,911,524,843,555,772,613,610,662,447,722,210,727,211,667,449,618,611,560,774,529,845,495,914,438,1016"/>
<area shape="rect" href="namespacemultiphase__eos.html#a96725046151437e274a33a1d0dd944ee" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="637,1149,829,1189"/>
<area shape="poly" title=" " alt="" coords="516,1045,559,1064,576,1082,584,1100,591,1118,607,1134,626,1145,623,1149,604,1138,587,1121,579,1102,571,1085,556,1069,514,1049"/>
<area shape="rect" href="namespacemultiphase__eos.html#af676f560af728589b6f716de6b010807" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="637,1213,829,1253"/>
<area shape="poly" title=" " alt="" coords="516,1041,539,1051,559,1065,573,1081,581,1099,584,1134,587,1168,594,1184,607,1199,626,1213,623,1217,604,1203,589,1186,582,1169,579,1134,576,1100,569,1084,556,1069,536,1055,514,1046"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="639,1050,828,1075"/>
<area shape="poly" title=" " alt="" coords="515,1040,625,1050,624,1056,515,1046"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="636,1277,831,1317"/>
<area shape="poly" title=" " alt="" coords="516,1040,539,1050,559,1065,578,1090,586,1115,587,1141,584,1166,582,1191,583,1216,590,1240,607,1263,625,1277,622,1281,603,1267,585,1242,577,1217,576,1191,579,1166,581,1141,580,1116,573,1092,555,1069,536,1054,514,1045"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="623,985,844,1025"/>
<area shape="poly" title=" " alt="" coords="514,1023,609,1014,609,1020,515,1029"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="641,921,825,961"/>
<area shape="poly" title=" " alt="" coords="479,1012,605,971,635,962,636,967,606,976,480,1017"/>
<area shape="rect" href="namespacecompositional__terms.html#a355b7b6ba8282f659fa0ecd18973e031" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="943,93,1102,133"/>
<area shape="poly" title=" " alt="" coords="824,155,929,131,930,136,825,160"/>
<area shape="rect" href="namespacecompositional__terms.html#ade3a2016f1b239160f844f3db8622b63" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="943,157,1102,197"/>
<area shape="poly" title=" " alt="" coords="862,175,929,175,929,180,862,180"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="1184,343,1395,383"/>
<area shape="poly" title=" " alt="" coords="1103,192,1137,207,1177,235,1213,268,1267,330,1263,333,1209,271,1173,239,1135,212,1101,196"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1048,859,1036,877,1008,889,973,896,930,898,883,895,774,885,657,874,540,870,431,872,382,879,338,890,301,907,272,921,259,925,263,911,275,895,303,884,340,878,382,875,431,879,539,890,657,900,774,904,883,901,931,894,974,882,1010,863,1039,848,1052,829,1061"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1048,859,1036,874,1012,884,982,890,946,892,904,889,811,880,710,872,610,869,517,872,476,879,440,891,410,907,386,926,374,951,365,1016,354,1094,350,1170,352,1170,357,1094,356,1017,359,952,370,928,379,911,390,895,412,884,441,878,477,875,517,877,610,885,710,894,811,897,904,895,946,889,983,879,1014,863,1039,848,1052,829,1061"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="925,731,1120,771"/>
<area shape="poly" title=" " alt="" coords="827,1055,845,1047,859,1035,881,1005,889,975,889,943,884,912,879,879,878,847,886,814,907,781,912,776,916,780,911,784,891,816,883,847,884,879,889,911,894,943,895,975,886,1008,863,1039,847,1051,829,1060"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="932,795,1113,835"/>
<area shape="poly" title=" " alt="" coords="827,1054,845,1046,859,1035,876,1014,884,992,886,970,884,947,884,900,891,876,907,852,921,840,924,844,911,855,896,878,889,900,890,947,891,970,889,993,881,1017,863,1039,847,1051,830,1059"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="951,909,1094,949"/>
<area shape="poly" title=" " alt="" coords="827,1050,860,1035,876,1019,883,1002,891,984,908,966,937,949,940,954,911,970,896,987,888,1005,880,1023,863,1040,830,1055"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="1197,889,1381,914"/>
<area shape="poly" title=" " alt="" coords="827,1053,860,1035,873,1019,880,1002,881,965,884,929,892,911,908,895,948,873,991,859,1037,853,1083,853,1170,864,1241,882,1239,887,1169,869,1083,858,1037,858,993,865,950,878,911,899,896,914,889,930,886,966,885,1003,878,1022,863,1039,830,1058"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="1189,957,1389,982"/>
<area shape="poly" title=" " alt="" coords="816,1047,860,1035,884,1022,908,1010,976,992,1046,980,1175,968,1176,974,1047,986,977,997,910,1014,886,1027,862,1040,817,1053"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="927,1025,1118,1050"/>
<area shape="poly" title=" " alt="" coords="828,1052,913,1044,914,1050,828,1057"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="935,1074,1111,1099"/>
<area shape="poly" title=" " alt="" coords="828,1068,921,1076,920,1081,828,1073"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="922,1124,1123,1164"/>
<area shape="poly" title=" " alt="" coords="820,1073,862,1084,887,1096,910,1108,935,1117,933,1122,908,1113,884,1101,860,1089,819,1078"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="923,1188,1122,1228"/>
<area shape="poly" title=" " alt="" coords="830,1068,863,1085,882,1107,888,1130,895,1153,911,1174,918,1179,914,1183,907,1178,890,1155,883,1131,877,1109,860,1089,827,1073"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="917,1252,1128,1292"/>
<area shape="poly" title=" " alt="" coords="829,1066,847,1073,863,1085,879,1103,887,1123,889,1162,890,1201,897,1220,911,1238,916,1242,912,1246,907,1242,892,1222,885,1202,884,1163,882,1124,874,1106,860,1089,844,1078,827,1071"/>
<area shape="rect" href="namespacecv__advection.html#a6c099f85979288a8bda06b0dbf65ce4b" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="947,1316,1099,1356"/>
<area shape="poly" title=" " alt="" coords="829,1065,847,1073,863,1085,883,1112,892,1139,893,1167,889,1194,886,1222,886,1249,893,1276,911,1302,935,1319,932,1324,907,1306,888,1278,881,1250,880,1222,884,1194,887,1167,887,1140,879,1114,859,1089,844,1077,827,1070"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="1197,1351,1382,1377"/>
<area shape="poly" title=" " alt="" coords="830,1064,847,1073,863,1085,878,1102,887,1120,895,1157,893,1194,885,1231,878,1267,876,1302,886,1335,896,1351,911,1366,949,1390,991,1405,1036,1412,1082,1412,1128,1407,1170,1399,1242,1379,1244,1384,1172,1404,1128,1413,1082,1417,1036,1417,990,1410,946,1395,908,1370,892,1354,881,1337,871,1303,872,1267,880,1230,887,1194,890,1157,882,1122,873,1105,859,1089,845,1077,827,1069"/>
<area shape="rect" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="953,1431,1093,1471"/>
<area shape="poly" title=" " alt="" coords="829,1064,847,1072,863,1085,880,1105,891,1125,901,1166,899,1207,891,1247,882,1288,879,1328,887,1369,897,1390,911,1410,925,1423,941,1432,939,1437,922,1427,907,1414,892,1392,882,1371,874,1329,877,1287,886,1246,894,1206,896,1166,886,1127,875,1108,859,1089,845,1077,827,1069"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="932,285,1113,325"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1048,859,1036,875,1011,886,979,893,940,896,897,894,799,886,693,877,587,874,488,876,443,882,404,892,370,907,342,919,331,922,334,911,346,897,372,887,405,881,444,879,488,882,587,891,693,899,799,901,897,898,941,891,980,880,1013,863,1039,848,1052,829,1061"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="909,1495,1136,1521"/>
<area shape="poly" title=" " alt="" coords="829,1064,847,1072,863,1085,883,1110,896,1134,903,1159,906,1185,901,1235,889,1285,876,1334,871,1383,874,1408,881,1432,893,1457,911,1481,916,1485,912,1489,907,1484,888,1459,876,1434,869,1409,866,1383,871,1333,884,1283,896,1234,901,1185,898,1161,891,1136,878,1112,859,1089,845,1077,827,1069"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="913,1545,1133,1570"/>
<area shape="poly" title=" " alt="" coords="829,1064,848,1072,863,1085,885,1113,899,1141,907,1169,910,1198,903,1254,889,1310,874,1366,867,1422,870,1449,877,1477,891,1504,911,1532,914,1534,910,1538,907,1535,886,1507,872,1479,864,1450,862,1422,868,1365,883,1309,898,1253,904,1197,902,1170,894,1143,880,1116,859,1089,845,1077,827,1069"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="946,1619,1099,1659"/>
<area shape="poly" title=" " alt="" coords="830,1064,848,1072,863,1085,876,1103,885,1127,894,1186,895,1255,892,1331,889,1407,889,1478,895,1538,902,1562,912,1581,926,1597,944,1610,941,1614,922,1601,907,1584,897,1564,890,1539,883,1478,884,1407,887,1331,890,1255,889,1186,880,1128,871,1106,859,1088,845,1077,827,1069"/>
<area shape="rect" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="937,1683,1109,1723"/>
<area shape="poly" title=" " alt="" coords="830,1064,848,1072,863,1085,878,1107,888,1135,897,1204,896,1288,890,1377,883,1467,882,1550,890,1620,899,1647,911,1669,926,1682,922,1686,907,1672,894,1650,885,1621,877,1551,878,1467,884,1377,890,1287,891,1205,882,1136,873,1109,859,1088,845,1077,827,1068"/>
<area shape="rect" href="namespacecv__advection.html#aeeb08147b461c9b4e619c6a4afd37a68" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="938,1747,1107,1787"/>
<area shape="poly" title=" " alt="" coords="830,1064,848,1072,863,1085,879,1109,890,1140,896,1177,899,1218,897,1310,890,1409,882,1509,880,1601,882,1642,888,1678,897,1709,911,1733,928,1747,924,1751,907,1736,892,1711,882,1680,877,1643,874,1601,877,1509,885,1409,892,1309,894,1218,891,1177,885,1142,874,1112,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespacecv__advection.html#a6ad3a63555367e6c0022730a76bb7df5" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="936,1811,1109,1837"/>
<area shape="poly" title=" " alt="" coords="829,1063,848,1072,863,1085,880,1112,892,1146,899,1186,901,1231,898,1332,889,1442,879,1552,876,1653,878,1698,885,1738,895,1771,911,1797,925,1809,922,1813,907,1800,891,1773,879,1739,873,1699,870,1653,874,1552,883,1442,893,1332,896,1231,893,1186,887,1147,876,1114,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespacecv__advection.html#a1ae53b6e2d75f63d1a426e6f3534d1d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="952,667,1093,707"/>
<area shape="poly" title=" " alt="" coords="827,1055,845,1047,859,1035,875,1016,885,997,895,959,892,920,884,880,876,840,873,799,882,758,892,737,907,717,921,705,937,696,940,701,924,709,911,720,897,740,887,760,879,799,881,839,890,879,898,919,900,959,890,999,879,1019,863,1039,847,1052,829,1060"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="948,1885,1097,1910"/>
<area shape="poly" title=" " alt="" coords="829,1063,848,1072,863,1085,882,1114,894,1150,902,1192,905,1240,903,1347,893,1464,883,1581,879,1690,881,1738,886,1781,896,1818,911,1848,928,1865,949,1877,946,1882,925,1869,907,1851,891,1820,881,1782,876,1739,874,1690,878,1580,888,1463,897,1347,900,1240,896,1193,889,1151,877,1116,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespacecv__advection.html#aca35d740c637f0177d867e8a10cec8ef" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="945,1935,1101,1975"/>
<area shape="poly" title=" " alt="" coords="829,1063,848,1072,863,1085,883,1116,896,1156,904,1203,907,1256,902,1375,890,1503,878,1631,873,1750,875,1803,882,1850,893,1890,911,1921,934,1939,930,1943,907,1924,889,1892,876,1851,870,1804,867,1750,873,1631,885,1502,897,1374,902,1256,899,1204,891,1157,878,1119,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespacemulti__tools.html#ac71c1810848e09741781728153d5f34b" title=" " alt="" coords="947,2023,1098,2049"/>
<area shape="poly" title=" " alt="" coords="829,1063,848,1072,863,1085,885,1119,899,1161,908,1211,911,1268,907,1394,895,1532,882,1669,875,1798,877,1855,883,1906,894,1950,912,1985,929,2003,951,2016,948,2020,925,2007,907,1988,889,1952,877,1907,871,1856,870,1798,876,1669,889,1531,902,1394,906,1268,902,1212,894,1163,880,1121,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="935,2073,1110,2098"/>
<area shape="poly" title=" " alt="" coords="829,1063,848,1072,863,1085,886,1122,901,1168,909,1223,912,1285,905,1424,889,1574,873,1724,865,1862,868,1924,875,1978,890,2024,911,2060,925,2071,921,2075,907,2063,885,2026,870,1979,862,1924,860,1862,867,1723,883,1573,899,1423,906,1285,904,1223,896,1169,881,1124,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="939,2123,1107,2163"/>
<area shape="poly" title=" " alt="" coords="829,1063,848,1072,863,1085,876,1110,885,1151,893,1270,893,1425,889,1597,885,1770,885,1925,893,2044,901,2085,911,2109,928,2124,924,2128,907,2112,895,2086,887,2045,880,1925,880,1770,884,1597,888,1425,888,1270,879,1152,871,1112,859,1088,845,1076,827,1068"/>
<area shape="rect" href="namespacecv__advection.html#afc50adcb66253565fe9c7a83244430a7" title="Detects whether the element has a shockfront or not." alt="" coords="945,424,1100,464"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1048,859,1036,872,1016,881,990,890,924,890,844,884,758,879,672,877,591,885,523,894,496,907,474,931,456,934,460,911,478,899,498,890,525,883,591,884,671,889,758,895,844,895,924,887,991,877,1018,863,1039,848,1052,830,1061"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="952,489,1093,514"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1048,859,1036,871,1017,880,994,888,934,888,861,883,783,879,704,878,631,886,569,895,544,907,525,921,513,938,505,940,510,924,517,911,528,900,547,891,570,883,631,884,703,888,782,893,861,893,934,885,995,876,1020,863,1039,848,1052,830,1061"/>
<area shape="rect" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="941,539,1104,579"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1047,859,1035,880,1008,894,981,902,954,905,927,899,872,885,817,871,761,864,704,866,676,873,647,887,618,907,589,927,573,931,577,911,592,891,621,878,649,871,676,869,704,876,760,890,815,904,871,910,927,907,955,899,983,885,1011,863,1039,848,1052,830,1061"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0358bf9293883d5a332167bc0558b985" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="929,603,1116,643"/>
<area shape="poly" title=" " alt="" coords="827,1056,845,1047,859,1035,878,1012,890,989,897,966,900,943,896,896,885,848,873,800,869,752,871,727,878,702,889,678,907,653,916,644,920,648,911,656,894,680,883,704,876,728,874,752,879,799,890,847,901,895,905,943,902,967,895,991,882,1015,863,1039,848,1052,829,1060"/>
<area shape="poly" title=" " alt="" coords="1094,919,1183,910,1184,915,1094,925"/>
<area shape="poly" title=" " alt="" coords="1094,937,1191,952,1190,957,1094,943"/>
<area shape="poly" title=" " alt="" coords="1099,1341,1183,1350,1183,1355,1099,1347"/>
<area shape="poly" title=" " alt="" coords="973,1619,970,1609,978,1600,996,1594,1023,1592,1054,1595,1070,1602,1068,1607,1052,1600,1023,1597,997,1599,981,1604,975,1610,978,1617"/>
<area shape="poly" title=" " alt="" coords="1092,674,1115,665,1134,653,1164,624,1190,592,1231,521,1260,451,1277,395,1283,397,1265,453,1236,523,1194,595,1168,628,1138,657,1117,670,1094,679"/>
<area shape="poly" title=" " alt="" coords="980,1886,970,1876,975,1866,993,1860,1023,1858,1061,1862,1071,1867,1075,1873,1070,1876,1068,1871,1059,1867,1023,1863,994,1865,979,1870,976,1876,983,1883"/>
<area shape="poly" title=" " alt="" coords="980,2025,970,2015,975,2005,993,1999,1023,1997,1061,2001,1071,2006,1075,2012,1070,2014,1068,2010,1059,2006,1023,2002,994,2004,979,2009,976,2014,983,2021"/>
<area shape="poly" title=" " alt="" coords="973,424,970,414,978,405,996,399,1023,397,1054,400,1070,407,1068,412,1052,405,1023,403,997,405,981,409,975,415,978,423"/>
<area shape="poly" title=" " alt="" coords="842,986,859,972,873,949,883,919,892,845,891,756,884,660,878,564,876,474,884,398,893,367,907,342,919,331,922,334,911,346,898,369,889,399,881,474,883,564,890,660,896,756,898,845,888,921,878,951,863,975,846,990"/>
<area shape="poly" title=" " alt="" coords="680,922,677,912,686,902,704,897,733,895,767,897,785,905,783,910,765,903,733,900,705,902,688,907,682,913,685,920"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_icgraph" id="anamespacemultiphase__1d__engine_ad72540721ea2ef4651301189e8973481_icgraph">
<area shape="rect" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,26,989,66"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,26,417,66"/>
<area shape="poly" title=" " alt="" coords="770,26,706,16,586,8,466,16,397,28,396,23,465,11,586,3,707,11,771,20"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,26,707,66"/>
<area shape="poly" title=" " alt="" coords="741,48,707,48,707,43,741,43"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,90,685,145"/>
<area shape="poly" title=" " alt="" coords="779,72,686,95,685,90,778,66"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,26,171,66"/>
<area shape="poly" title=" " alt="" coords="205,48,171,48,171,43,205,43"/>
<area shape="poly" title=" " alt="" coords="452,48,417,48,417,43,452,43"/>
<area shape="poly" title=" " alt="" coords="473,90,393,68,394,63,474,85"/>
</map>
</div>

</div>
</div>
<a id="ab407ee959b55313b7b395f5eeac47e0e" name="ab407ee959b55313b7b395f5eeac47e0e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab407ee959b55313b7b395f5eeac47e0e">&#9670;&#160;</a></span>dg_oscilat_detect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_1d_engine::dg_oscilat_detect </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>sndotq_keep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>sndotq2_keep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n_dot_du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n_dot_du2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>sincome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>mass_ele2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_cgraph" id="anamespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_cgraph">
<area shape="rect" title=": &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="5,29,175,69"/>
<area shape="poly" title=" " alt="" coords="52,30,50,20,56,11,69,5,90,3,114,6,127,13,124,18,112,11,90,8,71,10,59,15,55,21,57,28"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="223,37,364,62"/>
<area shape="poly" title=" " alt="" coords="175,47,209,47,209,52,175,52"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_icgraph" id="anamespacemultiphase__1d__engine_ab407ee959b55313b7b395f5eeac47e0e_icgraph">
<area shape="rect" title=": &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="723,29,892,69"/>
<area shape="poly" title=" " alt="" coords="848,18,834,11,807,8,784,10,771,15,766,21,768,28,763,30,760,20,768,10,783,5,807,3,835,6,850,13"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,29,675,69"/>
<area shape="poly" title=" " alt="" coords="709,52,675,52,675,47,709,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,29,417,69"/>
<area shape="poly" title=" " alt="" coords="452,52,417,52,417,47,452,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,29,171,69"/>
<area shape="poly" title=" " alt="" coords="205,52,171,52,171,47,205,47"/>
</map>
</div>

</div>
</div>
<a id="aa1438bf1da042b7b9b7d65fd2836aace" name="aa1438bf1da042b7b9b7d65fd2836aace"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1438bf1da042b7b9b7d65fd2836aace">&#9670;&#160;</a></span>dg_visc_lin()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::dg_visc_lin </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, u_snloc, 2*u_nloc ), intent(inout)&#160;</td>
          <td class="paramname"><em>s_inv_nnx_mat12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>nnx_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>nnx_mat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>nn_mat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( u_nloc, u_nloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>nn_mat2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi,  u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sbufen_reversed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>sdetwe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sbcvngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, sbcvngi  ), intent(in)&#160;</td>
          <td class="paramname"><em>snormxn_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>u_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>u_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc_ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_boundary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used to form the inter element coupling for the viscocity discretization. NNX_MAT, NNX_MAT2 contain matricies of first derivative times basis function for current element and neightbouring element. Similarly NN_MAT, NN_MAT2, contain the element-wise mass matrices. Only call this sub if element not next to the boundary... </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa1438bf1da042b7b9b7d65fd2836aace_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_aa1438bf1da042b7b9b7d65fd2836aace_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_aa1438bf1da042b7b9b7d65fd2836aace_icgraph" id="anamespacemultiphase__1d__engine_aa1438bf1da042b7b9b7d65fd2836aace_icgraph">
<area shape="rect" title=":&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used t..." alt="" coords="723,5,892,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="ac23b4fbb2a0c5d2c452d01d480d46b64" name="ac23b4fbb2a0c5d2c452d01d480d46b64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac23b4fbb2a0c5d2c452d01d480d46b64">&#9670;&#160;</a></span>diffus_cal_coeff_stress_or_tensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::diffus_cal_coeff_stress_or_tensor </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>diff_coef_divdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%nphase,sbcvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>diff_coefold_divdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>stress_form</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>stress_form_stab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>zero_or_two_thirds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sbufen_reversed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  sbcvngi, mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sbcvfen_reversed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sbcvngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%ndim,mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc_udiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc_udiffusion_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim,mdims%ndim,mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc2_udiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%nphase,mdims%cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc2_udiffusion_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim,mdims%ndim, mdims%nphase, sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>diff_gi_added</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>u_cv_nodj_ipha_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>u_cv_nodi_ipha_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>uold_cv_nodj_ipha_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(mdims%ndim,mdims%nphase,sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>uold_cv_nodi_ipha_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>snormxn_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc_dux_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc2_dux_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc_duoldx_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, mdims%ndim , mdims%nphase, mdims%u_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc2_duoldx_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( mdims%ndim,mdims%nphase,mdims%stotel ), intent(in)&#160;</td>
          <td class="paramname"><em>wic_u_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>wic_u_bc_dirichlet</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>simple_diff_calc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>diff_min_frac</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>diff_max_frac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ac23b4fbb2a0c5d2c452d01d480d46b64_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ac23b4fbb2a0c5d2c452d01d480d46b64_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ac23b4fbb2a0c5d2c452d01d480d46b64_icgraph" id="anamespacemultiphase__1d__engine_ac23b4fbb2a0c5d2c452d01d480d46b64_icgraph">
<area shape="rect" title=": &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,..." alt="" coords="723,5,900,60"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,13,675,53"/>
<area shape="poly" title=" " alt="" coords="709,35,675,35,675,30,709,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,417,35,417,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="a2644f81b959a9c66d17c6ae96e452faf" name="a2644f81b959a9c66d17c6ae96e452faf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2644f81b959a9c66d17c6ae96e452faf">&#9670;&#160;</a></span>force_bal_cty_assem_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::force_bal_cty_assem_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fe_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fe_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  : , :  ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  :, :  ), intent(in)&#160;</td>
          <td class="paramname"><em>v_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  :, :  ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(  :, :  ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,  :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>calculate_mass_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>pres_its_taken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>courant_number</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix Once these matrices (and corresponding RHSs) are generated the system of equations is solved using the projection method. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas, Asiri Obeysekara </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">FE_GIdims</td><td>Gauss integration numbers for FE fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">FE_funs</td><td>Shape functions for the FE mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">velocity</td><td>tensor field. Why do we pass it down instead of retrieving it from packed_state... </td></tr>
    <tr><td class="paramname">pressure</td><td>tensor fieldWhy do we pass it down instead of retrieving it from packed_state... </td></tr>
    <tr><td class="paramname">DT</td><td>Time step size </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">V_SOURCE</td><td>Source term </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">IGOT_THETA_FLUX,THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td>???? </td></tr>
    <tr><td class="paramname">calculate_mass_delta</td><td>This is to compute mass conservation </td></tr>
    <tr><td class="paramname">outfluxes</td><td>variable containing the outfluxes information </td></tr>
    <tr><td class="paramname">pres_its_taken</td><td>Integer containing the number of iterations performed by the solver to solve for pressure </td></tr>
    <tr><td class="paramname">nonlinear_its</td><td>current non-linear iteration </td></tr>
    <tr><td class="paramname">Courant_number</td><td>Global courant number and shock front courant number </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_cgraph" id="anamespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_cgraph">
<area shape="rect" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="5,1404,215,1444"/>
<area shape="rect" href="namespacemulti__data__types.html#af7028748dfa3e370ed4bfd1db524c87b" title="This subroutine performs the addition of an array and a multifield and returns the array b = b + a * ..." alt="" coords="296,5,463,45"/>
<area shape="poly" title=" " alt="" coords="110,1404,123,1140,153,710,174,488,199,290,228,139,244,87,261,56,282,39,285,43,265,59,248,89,233,140,204,291,179,488,158,711,129,1141,115,1404"/>
<area shape="rect" href="namespacematrix__operations.html#a1167c3b995711ad4c85718f072beb45e" title=" " alt="" coords="276,69,483,109"/>
<area shape="poly" title=" " alt="" coords="110,1404,124,1151,155,742,176,530,201,342,229,199,244,150,260,120,264,116,268,120,265,123,249,152,234,200,206,343,181,531,160,742,130,1152,115,1404"/>
<area shape="rect" href="namespacecopy__outof__state.html#a6bc946977b60a10ae77f86013eb499e7" title=": This function points a tensor field as a vector field type This is necessary when solving for tenso..." alt="" coords="301,133,458,173"/>
<area shape="poly" title=" " alt="" coords="110,1404,125,1162,157,773,178,573,203,395,230,259,245,212,261,184,286,164,290,169,265,187,250,214,235,260,208,396,183,573,162,774,131,1163,115,1404"/>
<area shape="rect" href="namespacematrix__operations.html#a21f0dc69d818b28b0c43412704ebd32b" title=": Performs the multiplication CDP_tensor = MmatC * deltap" alt="" coords="304,197,455,237"/>
<area shape="poly" title=" " alt="" coords="108,1404,109,1190,114,1025,124,842,142,657,170,486,187,411,208,345,233,289,261,248,274,236,290,227,292,231,277,240,265,251,237,292,213,346,193,412,175,487,148,658,130,843,119,1025,114,1190,114,1404"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="829,383,1019,409"/>
<area shape="poly" title=" " alt="" coords="110,1404,126,1192,158,858,179,687,203,536,230,423,245,385,261,362,280,349,304,340,362,329,431,326,507,329,656,346,771,361,862,378,861,383,770,367,656,351,506,335,431,331,363,334,305,345,282,354,265,366,250,387,236,424,208,537,184,688,163,858,131,1193,115,1404"/>
<area shape="rect" href="namespacecv__advection.html#ae7ba4bc947f32d4cea21ddc4cef46033" title="determine stress form of viscocity..." alt="" coords="586,667,729,707"/>
<area shape="poly" title=" " alt="" coords="110,1403,121,1264,146,1053,166,944,192,844,223,763,241,733,261,710,284,697,315,687,396,677,487,675,572,678,572,683,487,681,396,683,316,693,286,702,264,714,245,736,228,766,197,846,172,945,152,1054,126,1264,115,1404"/>
<area shape="rect" href="namespacemultiphase__eos.html#a481c8af5bd845806f46c11121270ecb9" title=": In this subroutine the capilalry pressure is computed based on the saturation and the formula used" alt="" coords="283,724,475,764"/>
<area shape="poly" title=" " alt="" coords="111,1404,125,1277,155,1088,176,989,200,899,228,825,244,796,261,774,270,766,273,770,265,778,248,799,233,827,205,901,181,991,160,1089,131,1278,116,1404"/>
<area shape="rect" href="namespacemulti__surface__tension.html#ae26cb34b2b50706fd7111f4398270e50" title=" " alt="" coords="263,376,496,416"/>
<area shape="poly" title=" " alt="" coords="109,1404,114,1219,122,1079,135,926,154,771,180,627,197,564,215,509,237,463,261,428,266,422,270,426,265,431,241,465,220,511,202,566,185,629,159,771,140,926,128,1080,120,1219,114,1404"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="819,484,1029,524"/>
<area shape="poly" title=" " alt="" coords="109,1404,115,1241,123,1121,136,989,155,858,181,739,198,687,216,642,237,606,261,579,290,559,318,548,345,544,372,546,429,560,497,579,521,590,545,600,608,613,658,619,708,615,770,600,803,587,835,570,889,531,892,535,838,574,806,592,771,605,709,620,658,624,607,618,543,605,519,594,495,584,427,565,371,551,345,549,319,553,293,564,264,583,241,609,221,645,203,689,187,740,160,859,141,990,128,1121,120,1241,114,1404"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae699fc2f76cbea255bf9387531dd3a6b" title=": This subroutine computed the gravity effect, i.e. rho * g" alt="" coords="283,788,475,828"/>
<area shape="poly" title=" " alt="" coords="111,1403,128,1287,159,1117,180,1030,204,949,231,883,245,858,261,838,270,830,273,834,265,842,250,861,236,886,209,951,185,1031,165,1119,133,1288,117,1404"/>
<area shape="rect" href="namespacemultiphase__eos.html#a9bcaed7ce8cf8559509b9cda97129227" title=": Computes the viscosity effect as a momemtum diffusion, this is zero for porous media" alt="" coords="283,852,475,892"/>
<area shape="poly" title=" " alt="" coords="108,1404,111,1313,117,1249,129,1179,147,1105,175,1031,212,962,235,931,261,902,269,895,273,899,265,906,239,934,216,965,179,1033,152,1106,134,1180,122,1250,116,1313,113,1404"/>
<area shape="rect" href="namespacematrix__operations.html#a3708de5c9d2be279bb9d9fb5e846d5c0" title=":Initialize the momentum equation (CMC) and introduces the corresponding values in it...." alt="" coords="305,261,454,301"/>
<area shape="poly" title=" " alt="" coords="109,1404,112,1202,119,1047,130,876,149,703,176,543,193,472,212,410,235,358,261,318,274,305,290,296,293,300,278,310,265,322,240,361,217,412,198,474,181,544,154,704,136,877,124,1048,117,1202,114,1404"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac4d7e6111d2e2ffcc4a22cb168d15f34" title=": &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into t..." alt="" coords="275,916,484,956"/>
<area shape="poly" title=" " alt="" coords="109,1404,116,1323,124,1268,137,1206,156,1142,182,1079,217,1019,261,967,268,961,271,965,265,971,221,1022,187,1081,161,1144,142,1207,129,1269,121,1324,114,1404"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a154e187ad1fef3c04332b9b757a7240d" title=": &lt;FOR INERTIA ONLY&gt;This subroutine combines the distributed and block diagonal for an element into t..." alt="" coords="290,981,469,1035"/>
<area shape="poly" title=" " alt="" coords="111,1403,123,1336,148,1240,168,1188,193,1137,223,1089,261,1046,276,1034,280,1038,264,1050,228,1092,197,1139,173,1190,153,1242,128,1337,116,1404"/>
<area shape="rect" href="namespacematrix__operations.html#aa1887beaf66c37ca16542840cef20301" title=":CV_RHS=CT*U" alt="" coords="305,1060,454,1100"/>
<area shape="poly" title=" " alt="" coords="113,1403,127,1345,155,1266,174,1224,198,1182,227,1144,261,1110,291,1093,293,1097,264,1114,231,1147,203,1185,179,1226,160,1268,132,1347,118,1404"/>
<area shape="rect" href="namespacematrix__operations.html#a2e2c830d293c519d8778bffb7acb69fc" title=": DP = (C)^T U_ALL" alt="" coords="305,1124,454,1164"/>
<area shape="poly" title=" " alt="" coords="115,1403,133,1356,164,1294,206,1229,232,1200,261,1174,291,1158,293,1162,264,1178,236,1203,210,1232,168,1296,138,1358,120,1405"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="285,442,474,467"/>
<area shape="poly" title=" " alt="" coords="109,1404,116,1228,125,1097,138,952,157,806,183,672,199,613,217,561,238,518,261,485,276,472,280,476,265,488,242,520,222,563,204,614,188,673,162,807,143,953,130,1097,121,1229,114,1404"/>
<area shape="rect" href="namespacemulti__tools.html#ac71c1810848e09741781728153d5f34b" title=" " alt="" coords="582,566,733,591"/>
<area shape="poly" title=" " alt="" coords="109,1404,113,1233,121,1107,133,968,152,830,178,704,195,649,214,602,236,563,261,535,304,509,351,496,402,493,453,499,502,511,548,526,622,557,620,562,547,531,501,516,452,504,402,499,352,501,306,514,264,539,240,566,219,604,200,651,184,705,157,831,138,969,126,1107,119,1233,114,1404"/>
<area shape="rect" href="namespacemulti__data__types.html#a65dde4f9748cb3dd200c328f99304c4e" title="Deallocation of a multi field type." alt="" coords="274,1188,485,1228"/>
<area shape="poly" title=" " alt="" coords="120,1403,142,1367,173,1322,214,1277,261,1238,272,1232,274,1236,264,1242,217,1281,177,1326,146,1370,124,1405"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ab407ee959b55313b7b395f5eeac47e0e" title=": &lt;INERTIA ONLY&gt;Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="295,1276,464,1316"/>
<area shape="poly" title=" " alt="" coords="136,1402,192,1363,262,1326,281,1318,283,1323,264,1330,195,1368,139,1406"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1438bf1da042b7b9b7d65fd2836aace" title=":&lt;FOR INERTIA ONLY&gt; This sub calculates S_INV_NNX_MAT12 which contains NDIM matricies that are used t..." alt="" coords="295,1340,464,1380"/>
<area shape="poly" title=" " alt="" coords="194,1401,281,1381,282,1386,196,1407"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a1a79a30e56a823153a0f05dcbdfc254c" title=" " alt="" coords="295,1404,463,1444"/>
<area shape="poly" title=" " alt="" coords="215,1421,282,1421,282,1427,215,1427"/>
<area shape="rect" href="namespacecv__advection.html#a24da0795bb0073e26720f411ded816b6" title="Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))" alt="" coords="267,1469,492,1494"/>
<area shape="poly" title=" " alt="" coords="205,1441,306,1463,305,1468,204,1447"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ac23b4fbb2a0c5d2c452d01d480d46b64" title=": &lt;INERTIA ONLY&gt; This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX,..." alt="" coords="291,1518,468,1573"/>
<area shape="poly" title=" " alt="" coords="145,1442,200,1473,264,1504,279,1510,277,1515,262,1509,198,1478,143,1446"/>
<area shape="rect" href="namespacesolvers__module.html#a9ad917af46abb89b45e944c720205d25" title="This subroutine provides a new guess based on previous updates and residuals. Use this subroutine to ..." alt="" coords="291,1597,467,1651"/>
<area shape="poly" title=" " alt="" coords="127,1443,182,1511,221,1550,264,1583,280,1592,277,1597,261,1588,217,1554,178,1515,123,1446"/>
<area shape="rect" href="namespacecopy__outof__state.html#acea2acdccf9091776be013ade24bcd97" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="292,1700,467,1740"/>
<area shape="poly" title=" " alt="" coords="122,1443,142,1487,173,1545,214,1607,264,1662,286,1678,310,1692,307,1696,283,1683,261,1666,210,1610,168,1548,137,1490,117,1445"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a5f51328ef034efd7e4104db3a9b58d4e" title=": Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created..." alt="" coords="277,1764,481,1804"/>
<area shape="poly" title=" " alt="" coords="117,1444,131,1504,157,1587,177,1631,201,1675,230,1715,264,1750,271,1755,267,1759,261,1754,226,1718,197,1677,172,1633,152,1589,125,1505,112,1445"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#afe0c5dfb1b3480e8ae2df59b05e12348" title=": In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pr..." alt="" coords="281,1828,477,1868"/>
<area shape="poly" title=" " alt="" coords="116,1444,125,1514,149,1614,169,1668,194,1722,225,1771,264,1814,271,1820,268,1824,261,1818,221,1774,189,1724,164,1670,144,1616,120,1515,110,1445"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad775c010bade229fba0416002e6928a6" title="Calculate the inf norm of the normalised field, so the field goes from 0 to 1 It requires as inputs t..." alt="" coords="285,1916,474,1956"/>
<area shape="poly" title=" " alt="" coords="115,1444,124,1522,148,1637,167,1700,192,1764,225,1824,265,1878,282,1894,303,1907,300,1912,279,1899,261,1882,220,1827,188,1766,162,1702,143,1638,119,1523,110,1445"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a69c69484b7aa3fadf3b433fb3d1c06e4" title=": This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example..." alt="" coords="295,1981,464,2035"/>
<area shape="poly" title=" " alt="" coords="113,1444,116,1537,122,1603,134,1676,152,1753,179,1830,216,1902,239,1936,265,1966,284,1982,281,1986,261,1970,235,1939,211,1905,174,1832,147,1755,128,1678,117,1604,111,1538,108,1445"/>
<area shape="rect" href="namespacecv__advection.html#abef6c88c50d350a8f4a9be0191a1f0c0" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="297,594,462,649"/>
<area shape="poly" title=" " alt="" coords="110,1404,123,1259,152,1039,172,923,197,817,226,728,243,693,261,666,282,647,286,651,265,670,247,696,231,730,202,818,177,925,157,1040,129,1260,115,1404"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8917356adde1eb2aedccd0320529a6c5" title=": &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field" alt="" coords="295,2060,464,2100"/>
<area shape="poly" title=" " alt="" coords="116,1444,132,1567,162,1749,183,1843,207,1929,234,1999,249,2026,265,2046,284,2060,280,2065,261,2050,244,2029,229,2001,201,1930,177,1844,157,1750,127,1568,111,1445"/>
<area shape="rect" href="namespacematrix__operations.html#ac5503ef651bc30022aca0f24318dd107" title=": Inversion of the mass matrix. If compacted this is much more efficient" alt="" coords="292,2124,467,2164"/>
<area shape="poly" title=" " alt="" coords="116,1444,129,1578,158,1778,178,1883,203,1979,232,2057,248,2088,265,2110,281,2123,278,2127,261,2114,243,2090,227,2060,198,1980,173,1884,153,1779,124,1578,110,1445"/>
<area shape="rect" href="namespacematrix__operations.html#a6b0b66b5d46bba8678e6e5e3e5bee13c" title=": U = Mass_matrix * Vector (tipically vector is Grad * P + RHS and this is used to obtain the velocit..." alt="" coords="298,2188,461,2228"/>
<area shape="poly" title=" " alt="" coords="115,1444,127,1589,154,1809,174,1924,199,2029,229,2116,246,2149,265,2174,287,2190,284,2195,261,2178,242,2152,224,2118,194,2031,169,1925,149,1810,122,1589,110,1445"/>
<area shape="rect" href="namespacematrix__operations.html#a1ce0b2be2d80aa729f46ed7cad39e46e" title="calculate DMATINV" alt="" coords="305,2252,454,2292"/>
<area shape="poly" title=" " alt="" coords="115,1444,125,1599,150,1839,170,1964,195,2079,227,2174,245,2211,265,2238,278,2249,293,2257,290,2262,275,2254,261,2242,240,2214,222,2176,190,2081,165,1965,145,1839,120,1599,110,1444"/>
<area shape="rect" href="namespacemulti__pipes.html#afdca65353a0cf530087859d2521f1454" title=": This sub modifies MmatC for 1D pipe modelling. Works on the momentum equation" alt="" coords="300,2316,459,2356"/>
<area shape="poly" title=" " alt="" coords="115,1444,123,1610,132,1733,147,1869,166,2004,192,2130,207,2185,224,2233,244,2272,265,2302,289,2320,285,2324,261,2306,239,2275,219,2235,202,2186,186,2131,161,2005,141,1869,127,1734,118,1610,109,1444"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a427e8757a259e6a8828dc992c757fff9" title=": &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="295,2404,464,2444"/>
<area shape="poly" title=" " alt="" coords="115,1444,124,1618,149,1894,169,2040,194,2175,226,2288,245,2332,265,2366,280,2383,299,2395,296,2400,277,2387,261,2370,240,2335,221,2290,189,2176,163,2041,144,1894,119,1619,109,1444"/>
<area shape="rect" href="namespacesolvers__module.html#a22222ae8924d0c67a163ee7b01cb00e1" title="In this subroutine the Schur complement is generated and solved using PETSc to update the pressure fi..." alt="" coords="295,2468,463,2508"/>
<area shape="poly" title=" " alt="" coords="114,1444,118,1635,126,1780,138,1939,156,2100,183,2249,200,2314,219,2372,240,2419,265,2454,284,2470,281,2474,261,2458,236,2421,214,2373,194,2316,178,2250,151,2101,132,1940,120,1780,113,1635,109,1444"/>
<area shape="rect" href="namespacesolvers__module.html#a9c699fc13a99bfd2473ee1c229452938" title="In this subroutine the matrix is re&#45;scaled based on the formula D^&#45;0.5 * A * D^&#45;0...." alt="" coords="296,2532,463,2572"/>
<area shape="poly" title=" " alt="" coords="114,1444,117,1646,123,1800,134,1970,152,2141,179,2299,196,2369,216,2430,239,2480,265,2518,285,2534,281,2538,261,2522,234,2483,211,2432,191,2370,174,2300,147,2142,129,1970,117,1800,111,1646,109,1444"/>
<area shape="rect" href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48" title=":&lt;INERTIA ONLY&gt;Computes velocity absorption from diamond information" alt="" coords="290,2596,469,2636"/>
<area shape="poly" title=" " alt="" coords="114,1444,115,1656,120,1819,130,1999,148,2181,176,2349,193,2423,214,2488,238,2542,265,2582,279,2595,276,2599,261,2586,233,2544,209,2490,188,2425,170,2350,143,2182,125,1999,115,1819,109,1656,108,1444"/>
<area shape="rect" href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8" title=":Computes velocity absorption associated to coriolis forces from diamond information" alt="" coords="274,2660,485,2700"/>
<area shape="poly" title=" " alt="" coords="115,1444,131,1683,163,2067,184,2265,208,2441,236,2574,250,2619,265,2646,268,2649,264,2653,261,2650,245,2621,230,2576,203,2442,179,2266,157,2068,125,1684,110,1445"/>
<area shape="rect" href="namespacemultiphase__eos.html#a6c6ec01c9df40b9a0d17e20e9a230998" title=":Computes velocity source from diamond information" alt="" coords="290,2724,469,2764"/>
<area shape="poly" title=" " alt="" coords="115,1444,130,1693,161,2098,182,2307,206,2493,234,2634,249,2682,265,2710,279,2723,276,2727,261,2714,244,2684,229,2636,201,2494,177,2308,155,2099,124,1694,110,1444"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a19a3d87102acd36c65500df29796b9ec" title="Used to assemble the C matrix in the ICFERST format." alt="" coords="292,2788,467,2828"/>
<area shape="poly" title=" " alt="" coords="115,1444,129,1706,159,2131,180,2350,205,2545,233,2694,249,2744,265,2774,281,2788,278,2792,261,2778,244,2746,228,2696,199,2546,175,2351,154,2131,124,1706,110,1445"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a5f7f591c0dd6fb3817df338933c82990" title="Used to assemble the C matrix in the ICFERST format (for DG?)" alt="" coords="292,2853,467,2907"/>
<area shape="poly" title=" " alt="" coords="115,1444,129,1716,159,2161,180,2391,204,2596,233,2753,249,2806,265,2838,281,2854,278,2857,261,2842,244,2808,228,2754,199,2597,174,2392,153,2161,123,1716,110,1444"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a4a425257d37d64d5ef1b27cd666391fc" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="282,2932,477,2972"/>
<area shape="poly" title=" " alt="" coords="115,1444,127,1730,155,2202,175,2446,200,2663,215,2754,230,2829,247,2885,265,2918,272,2926,268,2930,261,2922,242,2887,225,2830,210,2755,195,2664,170,2446,149,2202,121,1731,109,1445"/>
<area shape="rect" href="namespacematrix__operations.html#ad5ad0554a749a06b326c31623a4cdcc5" title=": CDP=C*DP" alt="" coords="583,197,732,237"/>
<area shape="poly" title=" " alt="" coords="455,215,568,215,568,220,455,220"/>
<area shape="rect" href="namespacemulti__surface__tension.html#abdbb49689046df472c9c0989687b8b5d" title="Calculate the surface tension force as a pressure force term: PLIKE_GRAD_SOU_COEF and PLIKE_GRAD_SOU_..." alt="" coords="544,376,771,416"/>
<area shape="poly" title=" " alt="" coords="496,393,530,393,530,399,496,399"/>
<area shape="poly" title=" " alt="" coords="771,393,815,393,815,399,771,399"/>
<area shape="poly" title=" " alt="" coords="709,414,862,476,860,481,707,419"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="565,788,749,828"/>
<area shape="poly" title=" " alt="" coords="475,805,552,805,552,811,475,811"/>
<area shape="poly" title=" " alt="" coords="608,788,605,778,613,769,630,763,657,761,688,764,705,771,703,776,687,769,657,767,631,769,616,773,610,779,613,787"/>
<area shape="poly" title=" " alt="" coords="453,262,568,235,570,240,455,267"/>
<area shape="rect" href="namespacematrix__operations.html#a7a02a088a4fedcbf140c8c428b584b66" title=": CDP=C*DP" alt="" coords="583,261,732,301"/>
<area shape="poly" title=" " alt="" coords="454,279,568,279,568,284,454,284"/>
<area shape="poly" title=" " alt="" coords="474,449,614,441,770,425,858,409,859,414,771,431,614,447,474,455"/>
<area shape="poly" title=" " alt="" coords="475,462,544,469,805,492,805,497,544,475,474,468"/>
<area shape="poly" title=" " alt="" coords="444,465,497,484,522,502,545,520,616,558,613,562,543,525,519,506,495,489,442,470"/>
<area shape="poly" title=" " alt="" coords="614,568,605,558,610,548,628,541,657,539,696,543,706,548,710,554,705,557,702,552,694,549,657,545,629,547,613,552,610,557,618,564"/>
<area shape="poly" title=" " alt="" coords="329,1276,326,1266,335,1257,352,1251,379,1249,411,1252,428,1259,425,1264,409,1257,379,1255,353,1257,337,1261,332,1267,335,1275"/>
<area shape="poly" title=" " alt="" coords="329,1700,326,1690,335,1681,352,1675,379,1673,411,1676,428,1683,425,1688,409,1681,379,1679,353,1681,337,1685,332,1691,335,1699"/>
<area shape="poly" title=" " alt="" coords="329,1916,326,1906,335,1897,352,1891,379,1889,411,1892,428,1899,425,1904,409,1897,379,1895,353,1897,337,1901,332,1907,335,1915"/>
<area shape="poly" title=" " alt="" coords="463,638,573,664,572,670,462,643"/>
<area shape="poly" title=" " alt="" coords="329,2404,326,2394,335,2385,352,2379,379,2377,411,2380,428,2387,425,2392,409,2385,379,2383,353,2385,337,2389,332,2395,335,2403"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_icgraph" id="anamespacemultiphase__1d__engine_a2644f81b959a9c66d17c6ae96e452faf_icgraph">
<area shape="rect" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="ae8eddee3d8387917a7563c83c7ebbe9d" name="ae8eddee3d8387917a7563c83c7ebbe9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8eddee3d8387917a7563c83c7ebbe9d">&#9670;&#160;</a></span>force_min_max_principle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::force_min_max_principle </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>entrance</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(2), intent(inout)&#160;</td>
          <td class="paramname"><em>totally_min_max</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: To help the stability of the system,if there are no sources/sinks it is known that the temperature must fulfill the min max principle, therefore here values outside this rank are capped. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_cgraph" id="anamespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_cgraph">
<area shape="rect" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="5,29,200,69"/>
<area shape="rect" href="namespacecopy__outof__state.html#acea2acdccf9091776be013ade24bcd97" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="248,29,423,69"/>
<area shape="poly" title=" " alt="" coords="200,47,234,47,234,52,200,52"/>
<area shape="poly" title=" " alt="" coords="292,30,289,20,296,10,312,5,335,3,362,6,377,13,375,18,361,11,335,8,313,10,300,15,295,21,297,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_icgraph" id="anamespacemultiphase__1d__engine_ae8eddee3d8387917a7563c83c7ebbe9d_icgraph">
<area shape="rect" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="1269,205,1464,245"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,176,1221,216"/>
<area shape="poly" title=" " alt="" coords="1255,214,1221,209,1222,204,1256,208"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="782,233,962,273"/>
<area shape="poly" title=" " alt="" coords="1256,234,962,250,962,245,1256,228"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,74,989,114"/>
<area shape="poly" title=" " alt="" coords="1064,173,923,117,925,112,1066,168"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,110,417,150"/>
<area shape="poly" title=" " alt="" coords="1023,201,908,201,768,198,616,189,465,171,382,153,383,148,466,166,617,183,769,193,908,196,1023,196"/>
<area shape="poly" title=" " alt="" coords="821,71,767,47,706,29,639,15,585,9,532,12,466,29,429,45,394,67,341,112,337,108,391,63,426,40,464,24,531,7,585,3,639,10,707,24,769,42,823,66"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,38,707,78"/>
<area shape="poly" title=" " alt="" coords="741,80,707,76,707,71,742,75"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,103,685,158"/>
<area shape="poly" title=" " alt="" coords="741,113,686,120,685,115,741,108"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,110,171,150"/>
<area shape="poly" title=" " alt="" coords="205,133,171,133,171,128,205,128"/>
<area shape="poly" title=" " alt="" coords="497,84,466,93,393,113,391,108,465,88,496,79"/>
<area shape="poly" title=" " alt="" coords="473,133,417,133,417,128,473,128"/>
<area shape="poly" title=" " alt="" coords="768,258,700,255,623,249,542,236,465,217,431,203,398,187,345,153,348,148,401,182,433,199,466,212,544,231,623,243,700,250,768,252"/>
</map>
</div>

</div>
</div>
<a id="a0b7967a62e580d633d9c828e05cac7ae" name="a0b7967a62e580d633d9c828e05cac7ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b7967a62e580d633d9c828e05cac7ae">&#9670;&#160;</a></span>generate_and_solve_laplacian_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::generate_and_solve_laplacian_system </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>sigma_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character( len = * ), intent(in), optional&#160;</td>
          <td class="paramname"><em>field_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>k_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>f_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>intface_val_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character(len=option_path_len), intent(in), optional&#160;</td>
          <td class="paramname"><em>solver_path</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. &gt; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">Sigma_field</td><td>Coefficient multipliying the left-hand side term </td></tr>
    <tr><td class="paramname">field_name</td><td>name of the field to be solved for </td></tr>
    <tr><td class="paramname">K_fields</td><td>Coefficients multipliying the RHS terms </td></tr>
    <tr><td class="paramname">F_fields</td><td>RHS fierlds </td></tr>
    <tr><td class="paramname">intface_val_type</td><td>0 = no interpolation; 1 Harmonic mean; !20 for SP solver, harmonic mean considering charge; negative normal mean </td></tr>
    <tr><td class="paramname">solver_path</td><td>Path to select the type of solver </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a0b7967a62e580d633d9c828e05cac7ae_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a0b7967a62e580d633d9c828e05cac7ae_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a0b7967a62e580d633d9c828e05cac7ae_icgraph" id="anamespacemultiphase__1d__engine_a0b7967a62e580d633d9c828e05cac7ae_icgraph">
<area shape="rect" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="663,5,832,60"/>
<area shape="rect" href="namespacemulti__sp.html#a0bfcd312d07ac4982048c03a3980c5e6" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="465,13,615,53"/>
<area shape="poly" title=" " alt="" coords="649,35,615,35,615,30,649,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,418,35,418,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="a9de595767a445b64e2d2c03a88413f2a" name="a9de595767a445b64e2d2c03a88413f2a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de595767a445b64e2d2c03a88413f2a">&#9670;&#160;</a></span>getoverrelaxation_parameter()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::getoverrelaxation_parameter </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>overrelaxation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>phase_with_pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), optional&#160;</td>
          <td class="paramname"><em>totally_min_max</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>for_transport</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more information read: doi.org/10.1016/j.cma.2019.07.004. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Overrelaxation</td><td>INOUT Field containing the outcome of this subroutine </td></tr>
    <tr><td class="paramname">Phase_with_Pc</td><td>Phase that will contain the Overrelaxation field </td></tr>
    <tr><td class="paramname">totally_min_max</td><td>Min max of the field (to normalise for transport) </td></tr>
    <tr><td class="paramname">for_transport</td><td>True if the field is not saturation </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_cgraph" id="anamespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_cgraph">
<area shape="rect" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="5,61,227,101"/>
<area shape="rect" href="namespacemultiphase__eos.html#a0884f603bf7bf0a4b380eb50f6de51b7" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="288,29,443,69"/>
<area shape="poly" title=" " alt="" coords="227,64,274,58,275,64,227,70"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="275,93,456,133"/>
<area shape="poly" title=" " alt="" coords="227,93,261,97,260,103,227,98"/>
<area shape="poly" title=" " alt="" coords="319,30,316,20,324,10,340,5,365,3,394,6,410,13,408,18,393,11,365,8,341,10,327,15,322,21,324,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_icgraph" id="anamespacemultiphase__1d__engine_a9de595767a445b64e2d2c03a88413f2a_icgraph">
<area shape="rect" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="1269,112,1491,152"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="776,25,968,65"/>
<area shape="poly" title=" " alt="" coords="1270,112,1221,103,968,62,968,56,1222,97,1271,107"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,10,685,65"/>
<area shape="poly" title=" " alt="" coords="1323,109,1220,68,1093,31,991,12,887,9,755,16,686,23,685,18,754,11,887,3,992,7,1094,26,1222,63,1325,104"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,112,1221,152"/>
<area shape="poly" title=" " alt="" coords="1256,135,1221,135,1221,129,1256,129"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,192,707,232"/>
<area shape="poly" title=" " alt="" coords="1274,157,1222,167,1106,183,990,195,707,211,707,206,989,189,1105,178,1221,161,1273,152"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,255,1219,295"/>
<area shape="poly" title=" " alt="" coords="1342,163,1286,200,1223,238,1183,257,1181,252,1220,234,1283,196,1338,158"/>
<area shape="poly" title=" " alt="" coords="762,45,685,43,685,37,763,40"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,135,417,175"/>
<area shape="poly" title=" " alt="" coords="500,72,466,86,360,137,357,132,464,81,498,67"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,135,171,175"/>
<area shape="poly" title=" " alt="" coords="205,157,171,157,171,152,205,152"/>
<area shape="poly" title=" " alt="" coords="1024,131,769,129,617,132,466,140,418,144,417,139,465,135,617,126,769,123,1024,126"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,140,989,180"/>
<area shape="poly" title=" " alt="" coords="1024,146,990,150,989,144,1023,141"/>
<area shape="poly" title=" " alt="" coords="810,137,650,67,652,62,812,132"/>
<area shape="poly" title=" " alt="" coords="741,161,417,158,417,153,741,156"/>
<area shape="poly" title=" " alt="" coords="749,185,697,195,696,189,748,180"/>
<area shape="poly" title=" " alt="" coords="478,192,412,177,413,172,479,186"/>
<area shape="poly" title=" " alt="" coords="1026,288,909,294,767,293,691,288,614,279,538,266,465,246,429,233,396,214,342,177,345,173,399,210,432,228,466,241,539,260,615,274,692,283,768,288,909,289,1026,283"/>
</map>
</div>

</div>
</div>
<a id="a5f51328ef034efd7e4104db3a9b58d4e" name="a5f51328ef034efd7e4104db3a9b58d4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f51328ef034efd7e4104db3a9b58d4e">&#9670;&#160;</a></span>high_order_pressure_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::high_order_pressure_solve </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>u_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_absorbin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created and solved that accounts for the gravity effect in the system. Next, this is introduced as a RHS in the momemtum equation This allows for higher precision for the gravity effect. &gt; </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">u_rhs</td><td>INOUT Field to contain the outcome of this subroutine </td></tr>
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">Number</td><td>of phases </td></tr>
    <tr><td class="paramname">u_absorbin</td><td>Absorption associated to the momentum equation/velocity </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_cgraph" id="anamespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_cgraph">
<area shape="rect" title=": Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created..." alt="" coords="5,241,209,281"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="265,145,460,185"/>
<area shape="poly" title=" " alt="" coords="151,239,256,195,278,187,280,192,258,200,153,244"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="263,209,462,249"/>
<area shape="poly" title=" " alt="" coords="209,246,249,241,250,246,210,251"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="257,273,468,313"/>
<area shape="poly" title=" " alt="" coords="210,271,244,276,244,281,209,277"/>
<area shape="rect" href="namespacemulti__tools.html#a29b23492be133b01a7eb9bce13adbdfb" title=" " alt="" coords="275,338,450,363"/>
<area shape="poly" title=" " alt="" coords="151,279,258,323,289,332,288,337,256,328,149,284"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a689cd7b7b9202b6f36f1c65e6dbc45fa" title="this subroutine generates the FE basis functions, weights and the derivatives of the shape functions ..." alt="" coords="516,69,715,109"/>
<area shape="poly" title=" " alt="" coords="446,207,466,195,482,180,490,165,499,148,514,131,542,113,545,118,518,135,503,151,495,167,486,183,470,199,448,212"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#abef213cc1ec9a2cb3cff9283a1019071" title="This subroutine calculates FINDGPTS,COLGPTS,NCOLGPTS which contains given a local node ILOC the Gauss..." alt="" coords="516,145,715,185"/>
<area shape="poly" title=" " alt="" coords="442,207,522,186,523,191,443,212"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a55f7da59b552d475085e9ae74e74f875" title="SHAPESV AND RELATED SUBRTS &amp; FUNCTIONS Shape functions associated with volume integration using both ..." alt="" coords="516,336,715,376"/>
<area shape="poly" title=" " alt="" coords="439,247,469,259,528,291,578,326,575,330,525,296,467,264,437,252"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a9c978f9224bd7a912e1ea02ced195e5d" title=": This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with ..." alt="" coords="531,209,699,249"/>
<area shape="poly" title=" " alt="" coords="462,227,517,227,517,232,462,232"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a327e5ef3b6b9241997dcf0c6f8cad2dd" title="This subroutine generates the FE basis functions, weights and the derivatives of the shape functions ..." alt="" coords="516,629,715,669"/>
<area shape="poly" title=" " alt="" coords="454,247,470,260,604,616,599,617,466,263,450,252"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a4852a3c1708fb73f5ce2ed24032a575b" title="determine CV_SLOCLIST" alt="" coords="778,69,946,109"/>
<area shape="poly" title=" " alt="" coords="715,87,764,87,764,92,715,92"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a06fcc23267a886a2b3122b3a77667801" title="Compute SBCVFEN from SCVFEN." alt="" coords="763,5,961,45"/>
<area shape="poly" title=" " alt="" coords="693,67,771,46,772,51,694,72"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a6aa37d81c26106c0d55a961df42387f0" title=": new 1 or 4 pt quadrature set on each CV of a quadratic tetrahedra ..... Compute shape functions N,..." alt="" coords="1041,799,1219,854"/>
<area shape="poly" title=" " alt="" coords="633,375,686,437,723,472,764,500,792,513,819,518,868,518,892,518,916,521,939,532,963,552,984,581,992,611,993,641,989,670,985,699,985,728,992,757,1011,786,1031,802,1027,806,1007,790,987,759,980,729,980,699,984,669,987,640,987,612,979,583,959,555,937,536,914,527,891,523,868,523,818,523,791,518,761,505,720,476,682,441,629,378"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ab0d45b5cca739d6579a00f6a5ac41de7" title=": For quadratic elements. Shape functions associated with volume integration using both CV basis func..." alt="" coords="1046,265,1214,305"/>
<area shape="poly" title=" " alt="" coords="700,333,762,321,904,302,1032,290,1033,295,904,308,763,327,701,339"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a7124edf2219f0df3e3bdbfc9148bac65" title=": For quadratic elements: Shape functions associated with volume integration using both CV (CVN) and ..." alt="" coords="778,336,946,376"/>
<area shape="poly" title=" " alt="" coords="715,353,764,353,764,359,715,359"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a62013afe2af3b6eb9358b519e41313b8" title=": Compute shape functions N, UN etc for linear trianles. Shape functions associated with volume integ..." alt="" coords="778,451,946,491"/>
<area shape="poly" title=" " alt="" coords="661,374,807,442,804,447,659,379"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ae55e4b96c1fd166b0c386e93ddf53196" title="Get the shape functions on lines (in 2D) and quadrilateral surfaces in 3D." alt="" coords="1301,872,1469,912"/>
<area shape="poly" title=" " alt="" coords="1220,847,1294,866,1292,871,1219,852"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a7da239d41bd2bc9cf80b2d50a0c00554" title="at the Gauss points. NB: We may need to define surface elements for p and (u,v,w)" alt="" coords="1739,661,1911,701"/>
<area shape="poly" title=" " alt="" coords="1469,901,1521,902,1578,898,1636,887,1689,864,1731,832,1764,792,1790,750,1808,713,1813,715,1795,752,1768,795,1734,836,1692,869,1637,892,1579,904,1522,907,1469,906"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ad903267339ffe53d619a566ab1451802" title="Quadratic variation (2D) for velocity  9 node brick element. Linear variation (2D) for pressure  4 ..." alt="" coords="1519,687,1691,727"/>
<area shape="poly" title=" " alt="" coords="1454,870,1469,858,1481,843,1487,829,1492,799,1497,768,1504,752,1517,737,1521,733,1525,737,1521,740,1509,755,1502,770,1497,800,1492,830,1485,846,1473,862,1457,874"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a08898de4c8264828159cf3ab5a812db4" title="Quadratic variation (3D) for velocity  27 node brick element. Linear variation (3D) for pressure  8..." alt="" coords="1519,815,1691,855"/>
<area shape="poly" title=" " alt="" coords="1461,869,1514,856,1515,861,1463,875"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a0e2b87ea8cbf64e6526d68831575f1d7" title="This subrt. computes the shape functions M and N and their derivatives at the Gauss points for 3D...." alt="" coords="1519,751,1691,791"/>
<area shape="poly" title=" " alt="" coords="1449,870,1469,858,1484,844,1492,830,1501,815,1517,801,1526,795,1529,799,1520,805,1506,819,1497,833,1488,847,1472,862,1452,874"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="1521,929,1689,969"/>
<area shape="poly" title=" " alt="" coords="1463,909,1515,923,1514,928,1461,915"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a982b5a9f569eae9dc2b8382a0550bc2b" title="This computes the weight and points for standard Gaussian quadrature. If (GETNDP == T) then get the p..." alt="" coords="1959,545,2131,585"/>
<area shape="poly" title=" " alt="" coords="1863,659,1992,590,1995,594,1865,663"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a80503151b92134e8bc4261178968a508" title="If WEIGHT is TRUE in function RGPTWE then return the Gauss&#45;pt weight else return the Gauss&#45;pt...." alt="" coords="2179,707,2351,747"/>
<area shape="poly" title=" " alt="" coords="2075,583,2227,696,2224,701,2071,588"/>
<area shape="poly" title=" " alt="" coords="2224,707,2221,697,2228,688,2242,682,2265,680,2290,683,2304,690,2302,695,2289,688,2265,685,2244,687,2231,692,2226,698,2229,706"/>
<area shape="poly" title=" " alt="" coords="1659,748,1690,736,1765,704,1767,709,1692,741,1661,753"/>
<area shape="poly" title=" " alt="" coords="1691,762,2165,731,2165,736,1691,768"/>
<area shape="poly" title=" " alt="" coords="1214,279,1336,281,1404,288,1471,300,1551,322,1630,350,1780,415,1909,482,2001,536,1998,540,1906,486,1778,420,1628,355,1549,327,1470,305,1404,293,1336,287,1214,284"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ae118f5b224460ba97069ff6f3247f53a" title="This return the Lagrange poly assocaited with node INOD at point LX If DIFF then send back the value ..." alt="" coords="1299,339,1471,379"/>
<area shape="poly" title=" " alt="" coords="1209,303,1251,315,1308,332,1307,337,1250,320,1207,308"/>
<area shape="poly" title=" " alt="" coords="1344,339,1341,329,1348,320,1362,314,1385,312,1410,315,1424,322,1422,327,1409,320,1385,317,1364,319,1351,324,1346,330,1349,338"/>
<area shape="poly" title=" " alt="" coords="938,333,1039,306,1041,312,939,339"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aa8a65df277c132b8c748fc53634ded22" title=": For quadatic elements  shape functions associated with volume integration using both CV basis func..." alt="" coords="1046,329,1214,369"/>
<area shape="poly" title=" " alt="" coords="946,351,1032,349,1032,354,946,357"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a01db78dad28836c230edae9db5ce2b49" title="Compute CVN (CV basis function) for triangles, tetrahedra, quadrilaterals and hexahedra." alt="" coords="1039,457,1221,497"/>
<area shape="poly" title=" " alt="" coords="946,470,1026,472,1025,477,946,475"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a18ed715c7c19cc301ca5152fe8293ef2" title="Get the x_ndgln for the nodes of triangles or tetrahedra." alt="" coords="1013,521,1247,561"/>
<area shape="poly" title=" " alt="" coords="939,488,1041,515,1039,520,938,493"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a8e1483fa07acac02ed8dcdcd5355f922" title=": Determine the volume shape functions n, nlx, nly, nlz and weights cvweigh for the cv_nloc_cells CV ..." alt="" coords="1046,656,1214,696"/>
<area shape="poly" title=" " alt="" coords="931,489,963,507,979,523,989,538,998,554,1011,572,1052,611,1093,645,1090,649,1049,615,1007,575,993,557,985,541,975,526,960,511,928,493"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a364b3f7243c9e7b46dbcd0d3bffe5f6b" title="This subrt creates the local coordinates and node points for: (a) quadratic tetrahedra of unit volume..." alt="" coords="1301,453,1469,493"/>
<area shape="poly" title=" " alt="" coords="1206,519,1250,507,1296,494,1297,500,1251,512,1207,524"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ab33172e32fe449b773531887a2da7894" title=" " alt="" coords="1301,517,1469,557"/>
<area shape="poly" title=" " alt="" coords="1247,537,1287,536,1287,542,1247,542"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a0baef8de3aad5dd6c661809fdd333369" title=" " alt="" coords="1521,524,1689,564"/>
<area shape="poly" title=" " alt="" coords="1449,491,1530,517,1528,522,1447,496"/>
<area shape="poly" title=" " alt="" coords="1564,524,1561,514,1568,505,1582,499,1605,497,1630,500,1644,508,1642,512,1629,505,1605,503,1584,505,1571,509,1566,515,1569,523"/>
<area shape="poly" title=" " alt="" coords="1215,685,1235,694,1253,707,1268,726,1275,746,1278,784,1280,821,1287,840,1301,858,1304,862,1301,866,1297,862,1282,842,1275,822,1273,784,1270,747,1263,729,1249,711,1232,699,1213,690"/>
<area shape="poly" title=" " alt="" coords="1187,653,1298,617,1506,563,1507,569,1299,623,1188,659"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a257f57afe346a4a6cf4c30b4fb20ca11" title=" " alt="" coords="1301,656,1469,696"/>
<area shape="poly" title=" " alt="" coords="1214,673,1287,673,1287,679,1214,679"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aec7c06f0cf1ffd44899b31601d1c0835" title="This subrt computes shape functions. For now, let&#39;s just define for one element type...." alt="" coords="1301,720,1469,760"/>
<area shape="poly" title=" " alt="" coords="1211,693,1292,714,1291,719,1210,699"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a3a845aa5e30651da7fb65786056f5591" title="Compute the cv_iloc^{th} shape function value at point (xgi, ygi, zgi)" alt="" coords="1301,808,1469,848"/>
<area shape="poly" title=" " alt="" coords="1215,689,1252,707,1269,722,1278,738,1287,753,1301,770,1337,798,1334,803,1297,774,1282,756,1274,740,1265,726,1249,712,1213,694"/>
<area shape="poly" title=" " alt="" coords="1344,656,1341,646,1348,637,1362,631,1385,629,1410,632,1424,640,1422,644,1409,637,1385,635,1364,637,1351,641,1346,647,1349,655"/>
<area shape="poly" title=" " alt="" coords="1444,718,1469,706,1492,688,1503,679,1518,672,1570,660,1624,656,1677,657,1725,661,1725,666,1676,662,1624,661,1571,666,1520,677,1505,684,1496,692,1472,710,1446,722"/>
<area shape="poly" title=" " alt="" coords="1468,725,1505,719,1506,724,1469,730"/>
<area shape="poly" title=" " alt="" coords="1445,758,1472,770,1520,800,1534,807,1531,812,1517,805,1469,774,1443,763"/>
<area shape="poly" title=" " alt="" coords="1469,749,1505,754,1505,759,1468,754"/>
<area shape="poly" title=" " alt="" coords="1344,808,1341,798,1348,789,1362,783,1385,781,1410,784,1424,792,1422,796,1409,789,1385,787,1364,789,1351,793,1346,799,1349,807"/>
<area shape="poly" title=" " alt="" coords="694,207,713,195,729,177,736,158,744,139,761,119,769,114,772,118,764,123,749,141,741,160,733,180,716,199,697,212"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a334b2cc04802a89c38ad64fbb302f22d" title=": Provides a number defining the type of element we are dealing with 4,5 Linear tetrahedra,..." alt="" coords="778,221,946,261"/>
<area shape="poly" title=" " alt="" coords="700,231,764,234,764,239,699,236"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a022789d186bf99daa182112973f9f436" title=" " alt="" coords="778,133,946,173"/>
<area shape="poly" title=" " alt="" coords="681,207,782,175,784,180,682,212"/>
<area shape="poly" title=" " alt="" coords="816,222,814,212,821,202,837,197,862,195,891,198,906,205,904,210,889,203,862,200,838,202,824,207,819,213,821,220"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a8a07cc64562d015677a634d18c9d4426" title="This subroutine defines a spectal element. IPOLY defines the element type and IQADRA the quadrature...." alt="" coords="1301,135,1469,175"/>
<area shape="poly" title=" " alt="" coords="946,153,1009,155,1251,155,1287,154,1287,159,1251,160,1009,160,946,159"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a0d03c9384b63870c93b0971c1718980c" title=":This subroutine defines the shape functions M and N and their derivatives at the Gauss points for qu..." alt="" coords="1046,105,1214,145"/>
<area shape="poly" title=" " alt="" coords="946,142,1032,133,1033,138,946,147"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aa7ca46dac1dcb83ef26c8e6df107fcee" title="This sub returns the weights WEIT the quadrature points QUAPOS and the node points NODPOS...." alt="" coords="1521,135,1689,175"/>
<area shape="poly" title=" " alt="" coords="1469,152,1507,152,1507,157,1469,157"/>
<area shape="poly" title=" " alt="" coords="1215,132,1287,141,1287,146,1214,138"/>
<area shape="poly" title=" " alt="" coords="621,628,638,581,667,518,708,451,733,420,761,393,778,380,781,385,764,397,737,424,712,455,672,521,643,583,626,630"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a50d87063f46932290366708ada439a22" title="this subroutine generates the FE basis functions, weights and the derivatives of the shape functions ..." alt="" coords="1031,393,1229,433"/>
<area shape="poly" title=" " alt="" coords="621,628,639,586,668,532,709,479,734,456,761,436,823,410,890,397,956,392,1017,394,1017,400,956,398,890,402,825,415,764,441,737,460,713,483,673,535,644,588,626,630"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#aed6e41ffed4552abef7cd0b0768110b9" title="this routine generates the shape functions associated with the FV&#39;s i.e. their surfaces and volume sh..." alt="" coords="763,629,961,669"/>
<area shape="poly" title=" " alt="" coords="715,647,749,647,749,652,715,652"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#ad30d6824fc7fea931c6fdff104995abe" title="this routine generates the shape functions associated with the FV&#39;s i.e. their surfaces and volume sh..." alt="" coords="763,693,961,733"/>
<area shape="poly" title=" " alt="" coords="694,667,772,687,771,692,693,672"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a229f5476a3e385f19f86a63c8aa877bb" title="this routine generates the shape functions associated with the FV&#39;s i.e. their surfaces and volume sh..." alt="" coords="763,757,961,797"/>
<area shape="poly" title=" " alt="" coords="644,667,698,705,764,743,780,750,777,755,761,748,695,710,641,672"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#aa070d703480fe04d1ee194e12481a1e8" title="this routine generates the shape functions associated with the FV&#39;s i.e. their surfaces and volume sh..." alt="" coords="763,821,961,861"/>
<area shape="poly" title=" " alt="" coords="632,668,685,736,722,774,764,807,775,813,772,818,761,812,718,778,681,740,628,671"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a26392ba54127e829f1661b9f8a2a9d53" title=": Compute shape functions N, UN etc for linear triangles. Shape functions associated with volume inte..." alt="" coords="778,885,946,925"/>
<area shape="poly" title=" " alt="" coords="627,668,645,711,675,765,715,822,738,848,764,871,772,876,769,881,761,875,735,852,711,826,670,768,641,713,622,670"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#aa15d0b0f37084e5bcfe77f7f7d95004f" title="this subroutine calculates NEILOC which is the array containing information given a local node and an..." alt="" coords="763,565,961,605"/>
<area shape="poly" title=" " alt="" coords="693,627,771,606,772,611,694,632"/>
<area shape="poly" title=" " alt="" coords="1230,415,1345,424,1471,439,1604,461,1735,488,1954,539,1953,544,1734,493,1603,466,1470,444,1345,429,1229,421"/>
<area shape="poly" title=" " alt="" coords="1223,391,1285,377,1286,383,1224,396"/>
<area shape="poly" title=" " alt="" coords="946,901,1287,892,1287,897,946,906"/>
<area shape="poly" title=" " alt="" coords="944,884,959,872,979,844,988,817,990,790,989,763,987,707,992,676,1007,643,1023,620,1042,600,1082,567,1086,571,1046,604,1027,624,1012,645,997,677,992,707,994,763,996,790,993,818,984,846,963,875,948,888"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb29324e9e7ed1c60a8ac2d2dbe93b55" title=": this subroutine calculates shape functions sn, snlx, snly, snlz, sufnlx, sufnly,..." alt="" coords="1009,721,1251,775"/>
<area shape="poly" title=" " alt="" coords="942,883,960,871,976,851,983,830,990,808,1007,786,1015,780,1018,785,1011,790,995,810,988,832,981,854,963,875,945,887"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a1539de3045b2481a16f428cb5c810afb" title=" " alt="" coords="1046,993,1214,1033"/>
<area shape="poly" title=" " alt="" coords="898,923,950,952,1010,979,1033,987,1032,992,1008,984,948,956,896,928"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a5e72ad72ccf0f5dbdc6dc733f6845a3d" title=": the surface quadrature pts in local coord are l1, l2, l3, l4, and the associated normals normx,..." alt="" coords="1024,929,1236,969"/>
<area shape="poly" title=" " alt="" coords="947,916,1011,927,1010,932,946,922"/>
<area shape="poly" title=" " alt="" coords="1232,773,1252,786,1269,804,1277,823,1285,841,1300,858,1307,863,1304,867,1297,862,1281,843,1272,825,1265,807,1249,790,1230,778"/>
<area shape="poly" title=" " alt="" coords="1227,718,1299,697,1300,702,1228,723"/>
<area shape="poly" title=" " alt="" coords="1251,742,1287,740,1287,746,1251,747"/>
<area shape="poly" title=" " alt="" coords="1219,773,1308,801,1306,806,1217,778"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_icgraph" id="anamespacemultiphase__1d__engine_a5f51328ef034efd7e4104db3a9b58d4e_icgraph">
<area shape="rect" title=": Instead of including the gravity in the RHS normally, here a system based on a Laplacian is created..." alt="" coords="723,5,927,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="afe0c5dfb1b3480e8ae2df59b05e12348" name="afe0c5dfb1b3480e8ae2df59b05e12348"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe0c5dfb1b3480e8ae2df59b05e12348">&#9670;&#160;</a></span>impose_strong_bcs_wells()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::impose_strong_bcs_wells </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(petsc_csr_matrix), intent(inout)&#160;</td>
          <td class="paramname"><em>cmc_petsc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in)&#160;</td>
          <td class="paramname"><em>pressure</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension (:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>rhs_p</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pressure boundary conditions for wells ONLY. This is required only when using P0DG-P1 If not imposing strong pressure BCs and using P0DG-P1, the formulation for weak pressure BCs leads to a 0 in the diagonal of the CMC matrix, therefore strong BCs are required. </p>
<dl class="section author"><dt>Author</dt><dd>Pablo Salinas, Geraldine Regnier </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">CMC_petsc</td><td>petsc_csr_matrix field containing the pressure matrix. Matrix to be modified here </td></tr>
    <tr><td class="paramname">rhs_p</td><td>RHS associated to the pressure matrix. </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_afe0c5dfb1b3480e8ae2df59b05e12348_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_afe0c5dfb1b3480e8ae2df59b05e12348_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_afe0c5dfb1b3480e8ae2df59b05e12348_icgraph" id="anamespacemultiphase__1d__engine_afe0c5dfb1b3480e8ae2df59b05e12348_icgraph">
<area shape="rect" title=": In this subroutine, we modify the CMC matrix and the RHS for the pressure to strongly impose the pr..." alt="" coords="723,5,919,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a8b8466b21f31e369fc0ae74a939444cd" name="a8b8466b21f31e369fc0ae74a939444cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b8466b21f31e369fc0ae74a939444cd">&#9670;&#160;</a></span>intenerge_assem_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::intenerge_assem_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_gdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">character( len = * ), intent(in), optional&#160;</td>
          <td class="paramname"><em>option_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>thermal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the transport of energy/temperature and to solve the transport of components. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">tracer</td><td>Tracer considered for the transport equation </td></tr>
    <tr><td class="paramname">density</td><td>Density of the field </td></tr>
    <tr><td class="paramname">velocity</td><td>Velocity of the field </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">IGOT_T2</td><td>!&gt;</td></tr>
    <tr><td class="paramname">IGOT_T2.</td><td>True (1) if solving for a tracer, false otherwise </td></tr>
    <tr><td class="paramname">igot_theta_flux</td><td>???? </td></tr>
    <tr><td class="paramname">GET_THETA_FLUX,USE_THETA_FLUX</td><td>????? </td></tr>
    <tr><td class="paramname">THERMAL</td><td>If true then we are solving for temperature </td></tr>
    <tr><td class="paramname">THETA_GDIFF</td><td>???? </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td>???? </td></tr>
    <tr><td class="paramname">DT</td><td>Time step size </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">option_path</td><td>Option path of the tracer to be solved for </td></tr>
    <tr><td class="paramname">mass_ele_transp</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">saturation</td><td>PhaseVolumeFraction field </td></tr>
    <tr><td class="paramname">Permeability_tensor_field</td><td>Permeability field </td></tr>
    <tr><td class="paramname">icomp</td><td>Number of components, if &gt; 0 then compositional is solved param nonlinear_iteration Current non-linear iteration </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_cgraph" id="anamespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="5,1101,189,1141"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="279,443,451,469"/>
<area shape="poly" title=" " alt="" coords="98,1100,109,974,135,787,153,690,176,601,203,529,219,501,236,479,265,461,268,466,239,483,223,504,208,531,181,603,158,691,140,788,115,975,103,1101"/>
<area shape="rect" href="namespacecompositional__terms.html#a9091a40e5dcfbb5b4ebbce9242c7d0c4" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="237,493,493,533"/>
<area shape="poly" title=" " alt="" coords="105,1100,347,545,352,547,110,1102"/>
<area shape="rect" href="namespacemultiphase__eos.html#a96725046151437e274a33a1d0dd944ee" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="269,1008,461,1048"/>
<area shape="poly" title=" " alt="" coords="138,1099,236,1057,263,1049,264,1054,238,1063,140,1104"/>
<area shape="rect" href="namespacemultiphase__eos.html#af676f560af728589b6f716de6b010807" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="269,1072,461,1112"/>
<area shape="poly" title=" " alt="" coords="189,1109,255,1101,256,1107,190,1114"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="271,1137,460,1162"/>
<area shape="poly" title=" " alt="" coords="190,1128,257,1135,256,1141,189,1134"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="268,2173,463,2213"/>
<area shape="poly" title=" " alt="" coords="101,1141,106,1328,112,1470,124,1627,141,1785,165,1932,180,1997,198,2054,217,2102,239,2138,254,2153,271,2165,268,2169,250,2157,235,2142,213,2104,193,2056,175,1998,160,1933,136,1786,118,1627,107,1470,100,1328,96,1141"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="255,2088,476,2128"/>
<area shape="poly" title=" " alt="" coords="107,1141,358,2074,352,2075,102,1142"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="273,2305,457,2345"/>
<area shape="poly" title=" " alt="" coords="102,1142,109,1340,131,1660,149,1831,172,1992,202,2127,220,2181,240,2224,255,2246,273,2265,314,2296,311,2300,270,2269,251,2249,235,2227,215,2183,197,2129,167,1993,143,1832,125,1660,104,1340,96,1142"/>
<area shape="rect" href="namespacecompositional__terms.html#a355b7b6ba8282f659fa0ecd18973e031" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="575,5,734,45"/>
<area shape="poly" title=" " alt="" coords="476,491,491,478,511,452,523,426,531,400,533,374,528,322,515,270,502,217,497,164,500,137,507,110,520,83,539,55,561,38,565,42,543,59,524,86,512,112,505,138,502,164,508,216,520,269,533,321,539,374,536,401,528,428,515,455,495,482,480,495"/>
<area shape="rect" href="namespacecompositional__terms.html#ade3a2016f1b239160f844f3db8622b63" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="575,69,734,109"/>
<area shape="poly" title=" " alt="" coords="476,491,491,478,508,456,519,434,526,412,528,390,525,346,515,302,505,257,502,212,504,189,511,166,522,143,539,119,561,103,564,107,543,123,527,145,516,168,510,190,507,212,511,256,520,301,530,345,534,390,531,413,524,436,513,459,495,482,480,495"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="816,508,1027,548"/>
<area shape="poly" title=" " alt="" coords="736,99,754,108,770,119,808,162,840,211,865,263,884,316,909,417,920,494,915,494,904,418,879,318,860,265,835,213,804,165,766,123,751,112,733,104"/>
<area shape="rect" href="namespacematrix__operations.html#a1ce0b2be2d80aa729f46ed7cad39e46e" title="calculate DMATINV" alt="" coords="847,69,996,109"/>
<area shape="poly" title=" " alt="" coords="734,87,833,87,833,92,734,92"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1134,491,1122,504,1102,513,1075,521,1007,519,925,512,837,506,748,505,667,508,631,514,599,524,572,539,551,558,539,583,530,648,519,725,516,802,517,802,522,725,521,649,525,584,535,560,544,543,555,529,575,519,600,513,631,510,667,511,748,518,836,524,925,526,1007,519,1076,509,1104,495,1126,480,1139,462,1147"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="557,565,752,605"/>
<area shape="poly" title=" " alt="" coords="459,1142,477,1134,491,1122,503,1104,512,1081,520,1021,520,950,516,872,512,794,511,721,519,660,527,635,539,616,544,610,548,614,543,619,532,638,524,661,517,722,517,794,521,872,525,950,525,1022,517,1082,508,1107,495,1126,480,1139,462,1147"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="564,629,745,669"/>
<area shape="poly" title=" " alt="" coords="459,1142,477,1134,491,1122,512,1095,526,1068,534,1041,537,1015,531,960,517,905,503,850,496,794,498,765,506,737,519,708,539,680,550,669,554,673,543,683,524,711,511,739,504,766,501,794,508,849,522,904,536,959,542,1015,539,1042,531,1070,517,1098,495,1126,480,1139,462,1147"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="583,808,726,848"/>
<area shape="poly" title=" " alt="" coords="459,1142,477,1134,491,1122,514,1091,522,1059,521,1027,516,994,510,960,509,926,517,892,539,858,553,846,569,838,572,842,556,851,543,862,522,894,514,927,516,960,521,993,527,1026,527,1060,519,1093,495,1126,479,1138,462,1146"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="829,758,1013,783"/>
<area shape="poly" title=" " alt="" coords="459,1142,477,1134,491,1122,507,1102,518,1082,524,1062,526,1042,522,1000,512,958,503,916,500,874,503,854,510,833,522,813,540,794,559,782,586,773,656,762,737,759,816,761,816,766,737,764,656,767,587,778,561,787,543,798,526,817,515,836,508,855,505,875,508,915,517,957,527,999,531,1042,529,1063,523,1084,512,1105,495,1126,479,1138,461,1147"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="821,1051,1021,1077"/>
<area shape="poly" title=" " alt="" coords="446,1159,515,1166,597,1169,683,1165,767,1149,803,1137,837,1120,892,1083,895,1087,839,1124,805,1142,769,1155,684,1170,597,1175,515,1172,445,1165"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="559,873,750,898"/>
<area shape="poly" title=" " alt="" coords="459,1141,476,1133,491,1122,510,1097,518,1071,518,1044,515,1017,511,990,512,962,520,934,539,908,546,902,549,906,543,911,525,937,517,963,517,989,520,1017,524,1044,523,1072,515,1099,495,1126,479,1138,461,1146"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="567,922,743,947"/>
<area shape="poly" title=" " alt="" coords="459,1140,476,1133,492,1122,507,1103,514,1084,515,1042,516,1000,523,979,539,958,553,948,556,952,543,962,528,981,521,1001,520,1042,519,1085,512,1106,495,1126,479,1137,461,1145"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="554,972,755,1012"/>
<area shape="poly" title=" " alt="" coords="459,1139,492,1122,503,1111,509,1099,515,1074,521,1048,528,1035,540,1022,546,1017,549,1021,543,1026,532,1038,526,1050,520,1075,514,1101,507,1114,495,1126,462,1143"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="555,1036,754,1076"/>
<area shape="poly" title=" " alt="" coords="456,1134,492,1122,506,1113,516,1104,540,1086,556,1078,558,1083,543,1090,519,1108,509,1118,494,1126,457,1139"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="549,1100,760,1140"/>
<area shape="poly" title=" " alt="" coords="460,1137,535,1129,536,1135,460,1142"/>
<area shape="rect" href="namespacecv__advection.html#a6c099f85979288a8bda06b0dbf65ce4b" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="579,1696,731,1736"/>
<area shape="poly" title=" " alt="" coords="369,1162,375,1250,383,1315,398,1389,419,1467,450,1544,491,1617,515,1650,543,1681,567,1697,564,1702,540,1685,511,1654,486,1620,445,1547,414,1469,393,1390,378,1316,370,1250,364,1163"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="829,1459,1014,1485"/>
<area shape="poly" title=" " alt="" coords="441,1159,623,1198,710,1224,744,1237,769,1251,796,1272,820,1297,861,1350,892,1403,912,1446,907,1448,887,1406,856,1353,816,1300,792,1276,767,1256,742,1242,708,1229,621,1203,440,1165"/>
<area shape="rect" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="585,1265,725,1305"/>
<area shape="poly" title=" " alt="" coords="388,1160,456,1200,542,1244,577,1258,575,1263,540,1249,453,1205,386,1165"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="564,2088,745,2128"/>
<area shape="poly" title=" " alt="" coords="370,1162,381,1327,393,1457,410,1602,433,1749,463,1885,480,1945,499,1997,520,2041,543,2073,554,2082,550,2086,539,2076,516,2043,494,1999,475,1947,458,1886,428,1750,405,1603,388,1458,376,1327,365,1162"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="541,1330,768,1355"/>
<area shape="poly" title=" " alt="" coords="378,1161,403,1192,441,1235,489,1278,543,1315,561,1323,558,1328,540,1320,485,1282,437,1238,399,1196,374,1164"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="545,1379,765,1405"/>
<area shape="poly" title=" " alt="" coords="375,1161,397,1201,434,1257,483,1315,512,1342,543,1364,557,1372,554,1377,540,1369,508,1346,479,1319,430,1260,393,1204,371,1163"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="578,1453,731,1493"/>
<area shape="poly" title=" " alt="" coords="375,1161,396,1207,433,1274,482,1347,511,1382,543,1414,565,1431,590,1445,587,1450,562,1435,540,1418,508,1386,478,1350,428,1276,391,1209,370,1163"/>
<area shape="rect" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="569,1517,741,1557"/>
<area shape="poly" title=" " alt="" coords="372,1161,386,1223,418,1315,441,1366,469,1416,503,1463,543,1503,557,1513,554,1517,540,1507,499,1466,464,1419,436,1369,413,1317,381,1224,366,1163"/>
<area shape="rect" href="namespacecv__advection.html#aeeb08147b461c9b4e619c6a4afd37a68" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="570,1581,739,1621"/>
<area shape="poly" title=" " alt="" coords="371,1162,382,1233,410,1342,433,1403,462,1463,498,1519,543,1567,559,1579,556,1583,540,1571,494,1522,457,1466,428,1405,405,1344,377,1234,365,1163"/>
<area shape="rect" href="namespacecv__advection.html#a6ad3a63555367e6c0022730a76bb7df5" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="568,1646,741,1671"/>
<area shape="poly" title=" " alt="" coords="370,1162,377,1243,386,1303,401,1370,423,1441,453,1511,493,1576,516,1605,543,1631,557,1641,554,1645,540,1635,512,1608,488,1579,448,1513,418,1443,396,1372,381,1304,371,1244,364,1162"/>
<area shape="rect" href="namespacecv__advection.html#a1ae53b6e2d75f63d1a426e6f3534d1d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="584,693,725,733"/>
<area shape="poly" title=" " alt="" coords="459,1142,477,1134,491,1122,509,1100,521,1077,528,1055,531,1033,528,987,518,941,507,895,503,848,505,823,511,799,522,775,539,750,553,737,570,727,573,732,557,741,543,754,527,777,516,801,510,824,508,848,513,894,523,940,533,986,537,1033,534,1056,526,1079,514,1103,495,1126,479,1139,461,1147"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="580,1785,729,1810"/>
<area shape="poly" title=" " alt="" coords="369,1162,374,1256,382,1328,396,1411,417,1498,448,1587,489,1671,515,1710,543,1746,564,1764,589,1777,587,1782,561,1769,539,1750,510,1713,485,1674,443,1589,412,1500,390,1412,376,1329,369,1257,364,1162"/>
<area shape="rect" href="namespacecv__advection.html#aca35d740c637f0177d867e8a10cec8ef" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="577,1835,733,1875"/>
<area shape="poly" title=" " alt="" coords="371,1162,389,1286,425,1485,449,1590,477,1687,509,1766,526,1797,543,1819,565,1835,562,1840,539,1823,521,1800,504,1769,472,1688,444,1591,420,1486,384,1287,366,1163"/>
<area shape="rect" href="namespacemulti__tools.html#ac71c1810848e09741781728153d5f34b" title=" " alt="" coords="579,1923,730,1949"/>
<area shape="poly" title=" " alt="" coords="371,1162,388,1295,424,1513,449,1628,477,1735,508,1824,526,1859,543,1885,563,1903,588,1916,585,1921,560,1907,539,1888,521,1861,504,1826,472,1737,443,1629,419,1514,383,1296,365,1162"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="567,1973,743,2013"/>
<area shape="poly" title=" " alt="" coords="370,1162,385,1309,417,1550,441,1677,469,1795,504,1893,523,1930,543,1958,556,1969,553,1973,539,1962,518,1933,499,1895,464,1797,435,1678,412,1550,379,1310,365,1163"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="567,2038,742,2063"/>
<area shape="poly" title=" " alt="" coords="370,1162,382,1320,394,1444,411,1581,434,1720,464,1848,481,1905,500,1954,521,1994,543,2023,557,2034,553,2038,539,2027,516,1997,495,1956,476,1906,458,1850,429,1721,406,1582,389,1444,376,1320,365,1162"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="571,133,739,173"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1135,491,1122,513,1088,527,1044,535,992,537,934,532,801,517,657,502,513,496,379,498,319,505,266,518,220,539,184,556,169,560,173,543,187,523,222,510,267,503,319,501,379,508,512,522,656,537,800,543,934,540,993,532,1046,517,1090,495,1126,480,1139,461,1148"/>
<area shape="rect" href="namespacecv__advection.html#afc50adcb66253565fe9c7a83244430a7" title="Detects whether the element has a shockfront or not." alt="" coords="577,221,732,261"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1135,491,1122,511,1091,524,1052,531,1005,534,952,529,831,517,701,504,570,499,449,501,394,508,346,520,305,539,272,563,253,566,257,543,275,525,307,513,347,506,395,504,449,510,570,522,700,535,831,539,952,536,1005,529,1053,515,1094,495,1126,480,1139,461,1148"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="584,286,725,311"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1135,491,1122,509,1093,522,1056,529,1012,531,961,527,848,515,725,504,602,499,487,501,436,508,391,521,353,539,322,553,310,570,302,572,307,556,315,543,326,526,355,514,392,507,437,504,487,509,601,521,724,532,847,537,961,534,1012,527,1057,514,1096,495,1126,480,1139,461,1148"/>
<area shape="rect" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="573,336,736,376"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1135,491,1122,508,1096,520,1062,526,1021,529,975,526,871,517,758,507,645,503,539,505,492,512,451,523,415,539,386,559,370,563,374,543,390,527,417,517,452,511,493,508,539,512,644,522,757,532,870,535,975,532,1022,525,1063,513,1098,495,1126,480,1139,461,1148"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0358bf9293883d5a332167bc0558b985" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="561,400,748,440"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1135,491,1122,507,1098,517,1067,524,1030,527,988,524,893,516,790,508,686,505,590,508,547,514,509,524,476,539,450,548,442,552,445,543,454,529,479,519,510,513,548,511,590,513,686,522,789,530,893,532,988,529,1031,523,1068,512,1100,495,1126,480,1139,461,1148"/>
<area shape="rect" href="namespacemulti__tools.html#ad2dc4462bad46ef99ca0057cb3c91262" title=":This function is a tolerance function for a vector which is used as a denominator...." alt="" coords="580,465,729,490"/>
<area shape="poly" title=" " alt="" coords="459,1143,477,1134,491,1122,506,1100,515,1072,521,1038,524,1000,523,913,516,818,509,724,507,636,515,561,525,531,539,508,565,488,568,492,543,511,530,534,521,563,513,636,515,723,522,818,528,912,530,1000,527,1039,521,1073,510,1103,495,1126,480,1139,461,1148"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a14dc6f577accb38a103267b20d5c20d5" title=": Work out the shape functions and their derivatives..." alt="" coords="837,872,1005,912"/>
<area shape="poly" title=" " alt="" coords="727,842,825,866,824,871,725,848"/>
<area shape="poly" title=" " alt="" coords="725,810,848,784,849,789,727,815"/>
<area shape="poly" title=" " alt="" coords="727,838,770,858,905,1039,900,1042,766,862,725,843"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#adfb350be9f5aab4de3a36c3719c8c975" title=": This sub calculates the local corrds L1, L2, L3, L4 and weights at the quadrature points...." alt="" coords="837,808,1005,848"/>
<area shape="poly" title=" " alt="" coords="726,825,823,825,823,831,726,831"/>
<area shape="poly" title=" " alt="" coords="730,1699,766,1680,814,1637,854,1587,885,1537,906,1496,911,1499,890,1539,859,1590,818,1641,770,1685,732,1704"/>
<area shape="poly" title=" " alt="" coords="605,1454,602,1444,610,1434,628,1429,655,1427,686,1429,702,1437,700,1442,684,1435,655,1432,629,1434,613,1439,607,1445,610,1452"/>
<area shape="poly" title=" " alt="" coords="725,697,767,679,805,652,841,619,895,557,899,561,845,623,809,656,769,684,727,702"/>
<area shape="poly" title=" " alt="" coords="612,1786,602,1776,607,1766,625,1760,655,1758,693,1762,703,1767,707,1773,702,1776,700,1771,691,1767,655,1763,626,1765,611,1770,608,1776,615,1783"/>
<area shape="poly" title=" " alt="" coords="612,1925,602,1915,607,1905,625,1899,655,1897,693,1901,703,1906,707,1912,702,1914,700,1910,691,1906,655,1902,626,1904,611,1909,608,1914,615,1921"/>
<area shape="poly" title=" " alt="" coords="605,222,602,212,610,202,628,197,655,195,686,197,702,205,700,210,684,203,655,200,629,202,613,207,607,213,610,220"/>
<area shape="rect" href="namespacecopy__outof__state.html#acea2acdccf9091776be013ade24bcd97" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="567,2264,742,2304"/>
<area shape="poly" title=" " alt="" coords="431,2211,577,2257,576,2262,429,2216"/>
<area shape="poly" title=" " alt="" coords="605,2264,602,2254,610,2245,628,2239,655,2237,686,2240,702,2247,700,2252,684,2245,655,2243,629,2245,613,2249,607,2255,610,2263"/>
<area shape="poly" title=" " alt="" coords="476,2105,550,2105,550,2111,476,2111"/>
<area shape="rect" href="namespacemultiphase__eos.html#a0884f603bf7bf0a4b380eb50f6de51b7" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="577,2176,732,2216"/>
<area shape="poly" title=" " alt="" coords="433,2126,576,2169,574,2174,431,2131"/>
<area shape="poly" title=" " alt="" coords="605,2176,602,2166,610,2157,628,2151,655,2149,686,2152,702,2159,700,2164,684,2157,655,2155,629,2157,613,2161,607,2167,610,2175"/>
<area shape="poly" title=" " alt="" coords="316,2306,313,2296,321,2286,338,2281,365,2279,396,2281,413,2289,411,2294,395,2287,365,2284,339,2286,324,2291,318,2297,321,2304"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="567,2328,742,2368"/>
<area shape="poly" title=" " alt="" coords="458,2330,554,2337,553,2343,457,2335"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_icgraph" id="anamespacemultiphase__1d__engine_a8b8466b21f31e369fc0ae74a939444cd_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,139,1221,179"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,70,989,110"/>
<area shape="poly" title=" " alt="" coords="1041,138,946,113,948,107,1042,133"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,70,417,110"/>
<area shape="poly" title=" " alt="" coords="1024,179,908,191,767,198,692,197,615,193,539,183,465,169,431,158,400,143,347,112,349,108,402,139,433,153,466,163,540,178,615,187,692,192,767,193,908,186,1023,173"/>
<area shape="poly" title=" " alt="" coords="821,66,767,43,706,25,639,13,586,8,533,12,466,25,405,46,353,72,351,67,403,41,465,19,532,7,586,3,640,7,707,19,769,38,823,62"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,34,707,74"/>
<area shape="poly" title=" " alt="" coords="741,76,707,72,707,67,742,71"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,99,685,153"/>
<area shape="poly" title=" " alt="" coords="741,109,686,116,685,111,741,104"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,70,171,110"/>
<area shape="poly" title=" " alt="" coords="205,93,171,93,171,87,205,87"/>
<area shape="poly" title=" " alt="" coords="452,75,418,79,417,74,451,69"/>
<area shape="poly" title=" " alt="" coords="473,114,417,106,418,101,474,108"/>
</map>
</div>

</div>
</div>
<a id="a69c69484b7aa3fadf3b433fb3d1c06e4" name="a69c69484b7aa3fadf3b433fb3d1c06e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a69c69484b7aa3fadf3b433fb3d1c06e4">&#9670;&#160;</a></span>introduce_grad_rhs_field_term()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::introduce_grad_rhs_field_term </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>rhs_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>fe_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dev__shape__funs.html">multi_dev_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>devfuns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:)&#160;</td>
          <td class="paramname"><em>x_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension ( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_u_rhs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>sdetwe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>snormxn_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>u_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>mat_other_loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example) for the momentum equation. It has two options (hard-coded) integrations by parts (activated) or voluemtric integration, For capillary pressure: The capillary pressure is a term introduced as a RHS which affects the effective velocity </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">RHS_field</td><td>The values to introduce, for capilalry pressure these are the evaluted values of CapPressureval </td></tr>
    <tr><td class="paramname">FE_funs</td><td>Shape functions for the FE mesh </td></tr>
    <tr><td class="paramname">Devfuns</td><td>Derivatives of the FE_funs </td></tr>
    <tr><td class="paramname">X_ALL</td><td>Coordinates of the nodes </td></tr>
    <tr><td class="paramname">LOC_U_RHS</td><td>RHS INOUT field with the updated field </td></tr>
    <tr><td class="paramname">ele</td><td>Current element </td></tr>
    <tr><td class="paramname">cv_ndgln</td><td>Global to local variables of the CV mesh </td></tr>
    <tr><td class="paramname">x_ndgln</td><td>Global to local variables of the nodes </td></tr>
    <tr><td class="paramname">ele2</td><td>neighbouring element </td></tr>
    <tr><td class="paramname">iface</td><td>current face being integrated </td></tr>
    <tr><td class="paramname">sdetwe</td><td>edge lenght associated to the current gauss integration point, i.e. edge lenght </td></tr>
    <tr><td class="paramname">SNORMXN_ALL</td><td>normal to the current surface </td></tr>
    <tr><td class="paramname">U_SLOC2LOC</td><td>Surface local to local for velocity nodes </td></tr>
    <tr><td class="paramname">CV_SLOC2LOC</td><td>Surface local to local for cv nodes </td></tr>
    <tr><td class="paramname">MAT_OTHER_LOC</td><td>for sub-CV the neighbouring one </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a69c69484b7aa3fadf3b433fb3d1c06e4_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a69c69484b7aa3fadf3b433fb3d1c06e4_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a69c69484b7aa3fadf3b433fb3d1c06e4_icgraph" id="anamespacemultiphase__1d__engine_a69c69484b7aa3fadf3b433fb3d1c06e4_icgraph">
<area shape="rect" title=": This subroutine performs and introduces the gradient of a RHS field (Capillary pressure for example..." alt="" coords="723,5,892,60"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,13,675,53"/>
<area shape="poly" title=" " alt="" coords="709,35,675,35,675,30,709,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,417,35,417,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="a8917356adde1eb2aedccd0320529a6c5" name="a8917356adde1eb2aedccd0320529a6c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8917356adde1eb2aedccd0320529a6c5">&#9670;&#160;</a></span>linearise_field()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::linearise_field </td>
          <td>(</td>
          <td class="paramtype">type( tensor_field ), intent(in)&#160;</td>
          <td class="paramname"><em>field_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>field_out</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_cgraph" id="anamespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_cgraph">
<area shape="rect" title=": &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field" alt="" coords="5,5,175,45"/>
<area shape="rect" href="namespacemulti__tools.html#a29b23492be133b01a7eb9bce13adbdfb" title=" " alt="" coords="223,13,397,38"/>
<area shape="poly" title=" " alt="" coords="175,23,209,23,209,28,175,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph" id="anamespacemultiphase__1d__engine_a8917356adde1eb2aedccd0320529a6c5_icgraph">
<area shape="rect" title=": &lt;FOR INERTIA ONLY&gt; This sub will linearise a p2 field" alt="" coords="723,5,892,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a427e8757a259e6a8828dc992c757fff9" name="a427e8757a259e6a8828dc992c757fff9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a427e8757a259e6a8828dc992c757fff9">&#9670;&#160;</a></span>p0_dg_oscilat_detect()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">real function multiphase_1d_engine::p0_dg_oscilat_detect </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sndotq_keep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sndotq2_keep</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>n_dot_du</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>n_dot_du2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sincome</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1.0- CENTRAL SCHEME. dg_oscilat_detect=0.0- UPWIND SCHEME. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_cgraph" id="anamespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_cgraph">
<area shape="rect" title=": &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="5,29,175,69"/>
<area shape="poly" title=" " alt="" coords="58,30,56,20,61,11,73,5,90,3,110,6,121,13,118,17,108,11,90,8,74,10,65,15,61,21,63,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_icgraph" id="anamespacemultiphase__1d__engine_a427e8757a259e6a8828dc992c757fff9_icgraph">
<area shape="rect" title=": &lt;INERTIA ONLY&gt; Determine if we have an oscillation in the normal direction... dg_oscilat_detect=1...." alt="" coords="723,29,892,69"/>
<area shape="poly" title=" " alt="" coords="848,18,834,11,807,8,784,10,771,15,766,21,768,28,763,30,760,20,768,10,783,5,807,3,835,6,850,13"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,29,675,69"/>
<area shape="poly" title=" " alt="" coords="709,52,675,52,675,47,709,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,29,417,69"/>
<area shape="poly" title=" " alt="" coords="452,52,417,52,417,47,452,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,29,171,69"/>
<area shape="poly" title=" " alt="" coords="205,52,171,52,171,47,205,47"/>
</map>
</div>

</div>
</div>
<a id="ae08ee439502a499a77b44ecdd504846a" name="ae08ee439502a499a77b44ecdd504846a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae08ee439502a499a77b44ecdd504846a">&#9670;&#160;</a></span>tracer_assemble_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::tracer_assemble_solve </td>
          <td>(</td>
          <td class="paramtype">character(len=*), intent(in)&#160;</td>
          <td class="paramname"><em>tracer_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_gdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>icomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passive_Tracer_N Where N is an integer which is continuous starting from 1. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">tracer</td><td>Tracer considered for the transport equation </td></tr>
    <tr><td class="paramname">velocity</td><td>Velocity of the field </td></tr>
    <tr><td class="paramname">density</td><td>Density of the field </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">DT</td><td>Time step size </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">IGOT_T2</td><td>!&gt;</td></tr>
    <tr><td class="paramname">IGOT_T2.</td><td>True (1) if solving for a tracer, false otherwise </td></tr>
    <tr><td class="paramname">igot_theta_flux</td><td>???? </td></tr>
    <tr><td class="paramname">GET_THETA_FLUX,USE_THETA_FLUX</td><td>????? </td></tr>
    <tr><td class="paramname">THETA_GDIFF</td><td>???? </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">mass_ele_transp</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td>???? </td></tr>
    <tr><td class="paramname">icomp</td><td>Number of components, if &gt; 0 then compositional is solved </td></tr>
    <tr><td class="paramname">saturation</td><td>PhaseVolumeFraction field </td></tr>
    <tr><td class="paramname">Permeability_tensor_field</td><td>Permeability field param nonlinear_iteration Current non-linear iteration </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_cgraph" id="anamespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_cgraph">
<area shape="rect" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="5,1271,185,1311"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="258,871,430,896"/>
<area shape="poly" title=" " alt="" coords="95,1271,102,1201,122,1103,139,1049,163,997,193,949,232,907,244,898,247,902,235,911,198,952,168,1000,144,1051,127,1104,107,1202,100,1271"/>
<area shape="rect" href="namespacemultiphase__eos.html#a96725046151437e274a33a1d0dd944ee" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="248,921,440,961"/>
<area shape="poly" title=" " alt="" coords="97,1271,108,1212,132,1131,149,1088,172,1045,199,1005,232,971,237,966,241,970,235,975,203,1009,176,1048,154,1090,137,1133,113,1213,102,1272"/>
<area shape="rect" href="namespacemultiphase__eos.html#af676f560af728589b6f716de6b010807" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="248,985,440,1025"/>
<area shape="poly" title=" " alt="" coords="99,1270,114,1222,140,1159,179,1092,204,1061,232,1035,238,1030,242,1034,235,1039,208,1065,184,1095,145,1161,119,1224,104,1272"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="249,1049,439,1075"/>
<area shape="poly" title=" " alt="" coords="117,1269,317,1082,320,1086,120,1273"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="247,1794,441,1834"/>
<area shape="poly" title=" " alt="" coords="99,1311,100,1397,105,1456,116,1523,132,1592,157,1660,191,1724,235,1780,239,1784,235,1788,231,1784,186,1727,152,1662,127,1593,111,1524,100,1457,95,1397,93,1312"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="233,1730,455,1770"/>
<area shape="poly" title=" " alt="" coords="110,1310,328,1717,323,1719,105,1313"/>
<area shape="rect" href="namespacemulti__tools.html#a81569e130900c1b6a18ff46132f94d12" title=": Returns true if the input name is a PassievTracer type." alt="" coords="239,1882,449,1922"/>
<area shape="poly" title=" " alt="" coords="99,1311,100,1404,106,1470,116,1544,133,1622,157,1701,191,1776,235,1844,252,1860,271,1873,268,1878,248,1865,231,1848,186,1779,152,1702,127,1623,111,1544,100,1470,95,1404,93,1312"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="252,1970,436,2010"/>
<area shape="poly" title=" " alt="" coords="101,1311,115,1435,143,1621,161,1717,183,1807,208,1881,235,1932,251,1948,270,1961,267,1966,248,1953,231,1936,203,1883,178,1808,156,1718,138,1621,110,1436,96,1312"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="519,234,713,274"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,469,1008,481,973,488,931,490,884,487,778,477,663,467,547,463,440,466,392,472,350,484,313,501,284,506,279,510,282,505,288,488,316,478,351,471,393,469,440,473,547,483,662,492,777,496,884,493,932,486,974,474,1010,457,1038,440,1052"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="525,298,707,338"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,468,1010,479,979,485,941,488,899,486,803,478,699,470,594,467,497,470,454,476,415,486,382,501,355,512,343,516,347,505,358,490,384,481,416,475,454,473,497,476,594,484,698,491,802,493,899,490,942,484,980,473,1013,457,1038,440,1052"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="545,413,687,453"/>
<area shape="poly" title=" " alt="" coords="437,1047,453,1035,466,1015,475,988,483,922,483,842,478,756,473,669,471,588,479,520,488,492,501,470,514,456,530,446,533,451,517,461,505,473,493,494,484,521,477,588,478,669,483,755,488,842,489,922,480,990,470,1017,457,1038,441,1052"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="791,331,975,356"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,467,1012,477,982,482,947,485,906,482,816,474,718,467,619,465,529,468,488,474,453,485,423,501,399,514,391,538,384,607,370,777,350,777,355,608,376,539,389,517,396,504,403,490,425,479,454,473,489,470,529,472,619,480,717,488,815,490,907,488,947,482,983,472,1014,457,1038,440,1052"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="783,509,983,535"/>
<area shape="poly" title=" " alt="" coords="437,1047,453,1035,464,1016,473,992,480,929,478,854,472,773,467,692,467,617,476,556,486,532,501,513,522,501,551,494,627,489,713,494,794,505,794,510,713,500,627,494,552,499,524,506,504,517,491,534,482,557,472,618,473,692,478,772,483,854,485,929,478,993,469,1018,457,1038,441,1052"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="521,528,711,553"/>
<area shape="poly" title=" " alt="" coords="437,1047,453,1035,474,1006,488,976,496,947,499,918,491,860,476,801,460,742,453,682,455,653,463,623,478,593,501,563,507,557,511,561,505,566,483,596,468,624,461,653,458,682,465,741,481,800,497,859,504,918,501,948,493,978,479,1008,457,1039,441,1051"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="528,577,704,603"/>
<area shape="poly" title=" " alt="" coords="437,1047,453,1035,472,1009,485,983,492,957,495,931,489,879,476,827,463,774,457,721,460,694,467,667,481,640,501,613,514,602,518,606,505,617,485,643,472,669,465,695,462,721,468,773,481,825,494,878,500,931,498,958,490,985,477,1012,457,1039,441,1051"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="515,627,717,667"/>
<area shape="poly" title=" " alt="" coords="437,1047,453,1035,470,1013,481,991,488,970,490,948,487,904,477,860,467,815,463,770,466,747,472,724,484,701,501,678,504,674,508,678,505,681,488,703,477,726,471,748,469,770,472,814,482,858,492,903,496,948,493,971,486,993,474,1016,457,1039,440,1051"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="517,691,715,731"/>
<area shape="poly" title=" " alt="" coords="437,1047,453,1035,477,999,485,964,484,928,477,891,470,854,468,817,477,779,501,742,504,738,508,742,505,745,482,781,473,817,475,854,482,890,489,927,491,964,481,1002,457,1038,440,1051"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="777,1142,988,1182"/>
<area shape="poly" title=" " alt="" coords="427,1047,453,1035,468,1019,475,1002,484,985,501,970,563,945,590,939,616,937,669,945,731,970,755,985,778,1003,817,1045,848,1089,869,1128,864,1131,843,1092,813,1048,774,1006,752,989,728,975,668,951,616,942,590,944,564,950,504,975,488,988,480,1004,472,1022,456,1039,430,1052"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="511,819,721,859"/>
<area shape="poly" title=" " alt="" coords="435,1047,453,1035,468,1016,475,998,477,958,479,918,486,897,501,876,515,864,518,868,505,880,491,899,484,919,482,958,480,999,472,1019,456,1039,438,1051"/>
<area shape="rect" href="namespacecv__advection.html#a6c099f85979288a8bda06b0dbf65ce4b" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="540,755,692,795"/>
<area shape="poly" title=" " alt="" coords="436,1047,453,1035,472,1007,480,980,480,952,477,923,473,894,473,865,481,835,501,805,525,788,528,792,505,809,486,837,478,865,478,894,482,922,486,951,486,981,477,1010,457,1039,440,1051"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="790,852,975,877"/>
<area shape="poly" title=" " alt="" coords="432,1047,453,1035,464,1023,470,1012,476,986,482,961,489,948,501,936,521,924,549,913,618,896,698,882,776,872,777,877,699,887,620,901,550,919,524,929,504,940,493,951,487,963,481,988,475,1014,468,1027,456,1039,435,1051"/>
<area shape="rect" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="546,985,686,1025"/>
<area shape="poly" title=" " alt="" coords="405,1047,532,1020,533,1025,406,1052"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="525,1959,707,1999"/>
<area shape="poly" title=" " alt="" coords="350,1074,428,1545,477,1818,495,1909,505,1946,515,1955,512,1959,500,1949,490,1910,472,1819,423,1546,345,1075"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="503,1049,729,1075"/>
<area shape="poly" title=" " alt="" coords="439,1059,489,1059,489,1065,439,1065"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="506,1099,726,1124"/>
<area shape="poly" title=" " alt="" coords="415,1072,532,1093,531,1099,414,1077"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="539,1173,693,1213"/>
<area shape="poly" title=" " alt="" coords="373,1072,562,1164,560,1169,370,1077"/>
<area shape="rect" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="530,1237,702,1277"/>
<area shape="poly" title=" " alt="" coords="356,1073,413,1144,455,1186,504,1222,518,1230,516,1235,501,1227,452,1190,409,1148,352,1076"/>
<area shape="rect" href="namespacecv__advection.html#aeeb08147b461c9b4e619c6a4afd37a68" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="531,1301,701,1341"/>
<area shape="poly" title=" " alt="" coords="353,1074,372,1115,404,1173,449,1234,475,1262,504,1286,520,1296,517,1300,501,1291,471,1266,444,1238,400,1176,367,1118,348,1076"/>
<area shape="rect" href="namespacecv__advection.html#a6ad3a63555367e6c0022730a76bb7df5" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="529,1365,703,1391"/>
<area shape="poly" title=" " alt="" coords="351,1074,366,1126,395,1202,415,1243,440,1282,470,1319,504,1351,518,1359,515,1364,501,1355,466,1323,436,1286,411,1245,390,1204,361,1128,346,1076"/>
<area shape="rect" href="namespacecv__advection.html#a1ae53b6e2d75f63d1a426e6f3534d1d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="545,1415,687,1455"/>
<area shape="poly" title=" " alt="" coords="350,1074,363,1133,390,1221,411,1269,436,1317,467,1361,504,1400,534,1417,531,1422,501,1404,463,1365,432,1320,406,1272,385,1223,357,1134,345,1075"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="541,1504,691,1529"/>
<area shape="poly" title=" " alt="" coords="349,1074,360,1142,386,1245,407,1303,433,1361,465,1416,505,1465,527,1483,553,1497,550,1501,524,1488,501,1469,461,1419,428,1364,402,1305,381,1247,355,1143,344,1075"/>
<area shape="rect" href="namespacecv__advection.html#aca35d740c637f0177d867e8a10cec8ef" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="538,1554,694,1594"/>
<area shape="poly" title=" " alt="" coords="348,1075,353,1154,361,1213,374,1279,394,1348,421,1417,458,1482,504,1539,527,1554,524,1559,501,1543,453,1485,416,1420,389,1350,369,1280,356,1214,348,1155,343,1075"/>
<area shape="rect" href="namespacemulti__tools.html#ac71c1810848e09741781728153d5f34b" title=" " alt="" coords="541,1643,691,1668"/>
<area shape="poly" title=" " alt="" coords="348,1075,352,1162,359,1227,372,1301,391,1381,419,1460,456,1536,479,1572,505,1604,526,1622,551,1635,548,1640,523,1627,501,1608,475,1575,451,1539,414,1462,386,1382,366,1302,354,1228,347,1162,343,1075"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="528,1693,704,1733"/>
<area shape="poly" title=" " alt="" coords="350,1074,366,1190,398,1372,420,1468,445,1556,473,1629,489,1657,505,1677,518,1688,514,1692,501,1681,484,1660,468,1631,440,1558,414,1469,393,1373,360,1191,344,1075"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="529,1757,703,1783"/>
<area shape="poly" title=" " alt="" coords="349,1075,363,1202,392,1404,414,1511,440,1609,470,1690,487,1720,505,1743,518,1753,515,1757,501,1747,482,1723,465,1692,434,1611,409,1512,387,1405,357,1202,344,1075"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="532,1807,700,1847"/>
<area shape="poly" title=" " alt="" coords="349,1075,362,1208,391,1425,412,1540,438,1646,469,1734,486,1767,505,1792,521,1805,518,1810,501,1796,482,1770,464,1736,433,1648,407,1541,386,1426,357,1209,344,1075"/>
<area shape="rect" href="namespacecv__advection.html#afc50adcb66253565fe9c7a83244430a7" title="Detects whether the element has a shockfront or not." alt="" coords="539,1895,693,1935"/>
<area shape="poly" title=" " alt="" coords="350,1075,373,1230,414,1479,462,1722,485,1810,505,1858,520,1874,540,1887,537,1891,517,1878,500,1861,480,1812,457,1723,409,1480,368,1231,345,1076"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="545,5,687,31"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,475,998,489,952,497,896,499,834,492,693,476,540,460,387,452,246,455,183,463,127,478,79,501,42,514,29,531,21,533,26,517,34,505,45,483,82,468,128,460,184,458,246,465,387,481,540,497,692,505,834,502,897,494,953,479,1001,457,1038,441,1052"/>
<area shape="rect" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="535,55,697,95"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,473,1001,487,957,495,906,497,847,492,716,478,574,463,431,457,299,459,239,466,187,480,142,501,106,520,89,524,93,505,109,485,144,472,188,464,240,462,299,469,431,483,573,497,715,503,847,500,906,492,958,478,1003,457,1038,441,1052"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0358bf9293883d5a332167bc0558b985" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="523,119,709,159"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,472,1003,485,963,492,915,495,860,490,738,477,605,465,473,459,349,462,294,469,245,481,203,501,170,509,161,513,165,505,173,486,205,474,246,467,295,465,349,470,472,483,605,495,738,500,860,497,915,490,964,477,1005,457,1038,440,1052"/>
<area shape="rect" href="namespacemulti__tools.html#ad2dc4462bad46ef99ca0057cb3c91262" title=":This function is a tolerance function for a vector which is used as a denominator...." alt="" coords="541,184,691,209"/>
<area shape="poly" title=" " alt="" coords="437,1048,453,1035,471,1005,483,967,490,922,492,870,488,755,476,629,464,504,459,388,462,336,469,290,482,251,501,220,527,202,530,206,505,224,487,254,474,292,467,337,465,388,469,504,481,629,493,754,498,870,495,922,488,968,476,1007,457,1038,440,1052"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a14dc6f577accb38a103267b20d5c20d5" title=": Work out the shape functions and their derivatives..." alt="" coords="799,445,967,485"/>
<area shape="poly" title=" " alt="" coords="688,439,785,450,784,456,687,444"/>
<area shape="poly" title=" " alt="" coords="680,410,728,392,752,379,776,366,805,357,806,362,778,371,754,383,730,396,682,415"/>
<area shape="poly" title=" " alt="" coords="682,450,730,469,754,482,778,494,806,503,805,508,776,499,752,487,728,474,680,455"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#adfb350be9f5aab4de3a36c3719c8c975" title=": This sub calculates the local corrds L1, L2, L3, L4 and weights at the quadrature points...." alt="" coords="799,381,967,421"/>
<area shape="poly" title=" " alt="" coords="687,422,784,410,785,415,688,427"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a689cd7b7b9202b6f36f1c65e6dbc45fa" title="this subroutine generates the FE basis functions, weights and the derivatives of the shape functions ..." alt="" coords="783,627,982,667"/>
<area shape="poly" title=" " alt="" coords="700,689,785,668,786,673,701,694"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#abef213cc1ec9a2cb3cff9283a1019071" title="This subroutine calculates FINDGPTS,COLGPTS,NCOLGPTS which contains given a local node ILOC the Gauss..." alt="" coords="783,691,982,731"/>
<area shape="poly" title=" " alt="" coords="716,709,769,709,769,714,716,714"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a55f7da59b552d475085e9ae74e74f875" title="SHAPESV AND RELATED SUBRTS &amp; FUNCTIONS Shape functions associated with volume integration using both ..." alt="" coords="783,755,982,795"/>
<area shape="poly" title=" " alt="" coords="701,729,786,750,785,755,700,734"/>
<area shape="poly" title=" " alt="" coords="692,793,730,805,838,844,836,849,728,810,690,798"/>
<area shape="poly" title=" " alt="" coords="567,1173,564,1163,572,1154,589,1148,616,1146,647,1149,664,1156,662,1161,646,1154,616,1151,590,1153,574,1158,569,1164,572,1171"/>
<area shape="poly" title=" " alt="" coords="686,1421,708,1412,728,1400,753,1378,777,1352,817,1296,847,1240,867,1194,872,1196,851,1243,821,1299,781,1355,757,1381,731,1404,710,1417,688,1426"/>
<area shape="poly" title=" " alt="" coords="573,1506,564,1496,568,1486,586,1479,616,1477,654,1481,665,1486,668,1492,664,1495,661,1490,653,1487,616,1483,587,1485,572,1490,569,1495,577,1502"/>
<area shape="poly" title=" " alt="" coords="573,1644,564,1634,568,1624,586,1618,616,1616,654,1620,665,1625,668,1631,664,1634,661,1629,653,1625,616,1621,587,1623,572,1628,569,1634,577,1641"/>
<area shape="poly" title=" " alt="" coords="567,1896,564,1886,572,1876,589,1871,616,1869,647,1871,664,1879,662,1884,646,1877,616,1874,590,1876,574,1881,569,1887,572,1894"/>
<area shape="rect" href="namespacecopy__outof__state.html#acea2acdccf9091776be013ade24bcd97" title=": Subroutine to check whether an option is true for any phase in diamond, if any is true it returns t..." alt="" coords="529,2135,703,2175"/>
<area shape="poly" title=" " alt="" coords="442,1832,457,1844,478,1876,488,1908,488,1939,484,1971,480,2002,479,2033,486,2065,505,2098,520,2114,539,2127,536,2131,517,2118,501,2101,481,2067,474,2033,475,2001,479,1970,483,1939,482,1909,474,1879,453,1848,439,1836"/>
<area shape="poly" title=" " alt="" coords="567,2136,564,2126,572,2116,589,2111,616,2109,647,2111,664,2119,662,2124,646,2117,616,2114,590,2116,574,2121,569,2127,572,2134"/>
<area shape="poly" title=" " alt="" coords="441,1768,457,1780,472,1801,480,1823,481,1865,483,1906,490,1926,505,1945,515,1954,511,1958,501,1949,485,1928,477,1907,476,1865,475,1824,468,1804,453,1784,438,1772"/>
<area shape="rect" href="namespacemultiphase__eos.html#a0884f603bf7bf0a4b380eb50f6de51b7" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="539,2047,693,2087"/>
<area shape="poly" title=" " alt="" coords="442,1768,457,1780,477,1809,486,1838,487,1866,484,1895,481,1923,481,1951,488,1980,505,2010,521,2026,540,2039,537,2043,517,2030,501,2013,483,1982,476,1952,476,1923,479,1894,481,1866,480,1839,472,1812,453,1784,439,1772"/>
<area shape="poly" title=" " alt="" coords="567,2048,564,2038,572,2028,589,2023,616,2021,647,2023,664,2031,662,2036,646,2029,616,2026,590,2028,574,2033,569,2039,572,2046"/>
<area shape="poly" title=" " alt="" coords="298,1882,295,1872,303,1863,319,1857,344,1855,373,1858,389,1865,386,1870,371,1863,344,1861,320,1863,306,1867,300,1873,303,1881"/>
<area shape="poly" title=" " alt="" coords="298,1970,295,1960,303,1951,319,1945,344,1943,373,1946,389,1953,386,1958,371,1951,344,1949,320,1951,306,1955,300,1961,303,1969"/>
<area shape="rect" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d" title=": Read from diamond and decide which sort of density representation do we have" alt="" coords="529,2199,703,2239"/>
<area shape="poly" title=" " alt="" coords="358,2009,380,2047,413,2094,455,2143,504,2185,517,2193,515,2197,501,2190,451,2147,409,2098,376,2050,353,2012"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_icgraph" id="anamespacemultiphase__1d__engine_ae08ee439502a499a77b44ecdd504846a_icgraph">
<area shape="rect" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="465,5,645,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,418,28,418,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a19a3d87102acd36c65500df29796b9ec" name="a19a3d87102acd36c65500df29796b9ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19a3d87102acd36c65500df29796b9ec">&#9670;&#160;</a></span>use_posinmat_c_store()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::use_posinmat_c_store </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_inod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>p_jnod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nonods + 1), intent(in)&#160;</td>
          <td class="paramname"><em>findc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( ncolc), intent(in)&#160;</td>
          <td class="paramname"><em>colc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncolc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ido_store_ac_spar_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>stored_ac_spar_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc,p_nloc, totele*ido_store_ac_spar_pt), intent(inout)&#160;</td>
          <td class="paramname"><em>posinmat_c_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_iloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>p_jloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>p_nloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to assemble the C matrix in the ICFERST format. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_cgraph" id="anamespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_cgraph">
<area shape="rect" title="Used to assemble the C matrix in the ICFERST format." alt="" coords="5,5,180,45"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="228,5,377,45"/>
<area shape="poly" title=" " alt="" coords="180,23,214,23,214,28,180,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_icgraph" id="anamespacemultiphase__1d__engine_a19a3d87102acd36c65500df29796b9ec_icgraph">
<area shape="rect" title="Used to assemble the C matrix in the ICFERST format." alt="" coords="723,5,897,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a5f7f591c0dd6fb3817df338933c82990" name="a5f7f591c0dd6fb3817df338933c82990"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f7f591c0dd6fb3817df338933c82990">&#9670;&#160;</a></span>use_posinmat_c_store_suf_dg()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::use_posinmat_c_store_suf_dg </td>
          <td>(</td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>count</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_inod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>p_jnod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nonods + 1), intent(in)&#160;</td>
          <td class="paramname"><em>findc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( ncolc), intent(in)&#160;</td>
          <td class="paramname"><em>colc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncolc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ido_store_ac_spar_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>stored_ac_spar_pt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_snloc,p_snloc,nface,totele*ido_store_ac_spar_pt ), intent(inout)&#160;</td>
          <td class="paramname"><em>posinmat_c_store_suf_dg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_siloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>p_sjloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>p_snloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to assemble the C matrix in the ICFERST format (for DG?) </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_cgraph" id="anamespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_cgraph">
<area shape="rect" title="Used to assemble the C matrix in the ICFERST format (for DG?)" alt="" coords="5,5,180,60"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="228,13,377,53"/>
<area shape="poly" title=" " alt="" coords="180,30,214,30,214,35,180,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_icgraph" id="anamespacemultiphase__1d__engine_a5f7f591c0dd6fb3817df338933c82990_icgraph">
<area shape="rect" title="Used to assemble the C matrix in the ICFERST format (for DG?)" alt="" coords="723,5,897,60"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,13,675,53"/>
<area shape="poly" title=" " alt="" coords="709,35,675,35,675,30,709,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,417,35,417,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="a4a425257d37d64d5ef1b27cd666391fc" name="a4a425257d37d64d5ef1b27cd666391fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a425257d37d64d5ef1b27cd666391fc">&#9670;&#160;</a></span>viscocity_tensor_les_calc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine multiphase_1d_engine::viscocity_tensor_les_calc </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, mat_nonods  ), intent(inout)&#160;</td>
          <td class="paramname"><em>les_udiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, mat_nonods  ), intent(inout)&#160;</td>
          <td class="paramname"><em>les_udiffusion_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, u_nloc, totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>dux_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, x_nonods  ), intent(in)&#160;</td>
          <td class="paramname"><em>x_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( x_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mat_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mat_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( mat_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>mat_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>les_disopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>les_cs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, cv_nonods ), intent(in)&#160;</td>
          <td class="paramname"><em>uden</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( mat_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( u_nloc * totele  ), intent(in)&#160;</td>
          <td class="paramname"><em>u_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, u_nonods  ), intent(in)&#160;</td>
          <td class="paramname"><em>u_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase, cv_nonods ), intent(in)&#160;</td>
          <td class="paramname"><em>deriv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION, LES_UDIFFUSION_VOL </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a4a425257d37d64d5ef1b27cd666391fc_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a4a425257d37d64d5ef1b27cd666391fc_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a4a425257d37d64d5ef1b27cd666391fc_icgraph" id="anamespacemultiphase__1d__engine_a4a425257d37d64d5ef1b27cd666391fc_icgraph">
<area shape="rect" title=": &lt;FOR INERTIA ONLY&gt; This subroutine calculates a tensor of viscocity LES_UDIFFUSION,..." alt="" coords="723,5,917,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="aa8ed1c2e68fd75835c3794475805554c" name="aa8ed1c2e68fd75835c3794475805554c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8ed1c2e68fd75835c3794475805554c">&#9670;&#160;</a></span>volumefraction_assemble_solve()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::volumefraction_assemble_solve </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type )&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>v_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>time_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>sfpi_taken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>sfpi_its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>courant_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">multicomponent_state</td><td>Linked list containing all the fields used by compositional, just in case we are solving for components &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">DT</td><td>Time step size </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">V_SOURCE</td><td>Source term </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">igot_theta_flux</td><td>???? </td></tr>
    <tr><td class="paramname">mass_ele_transp</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">nonlinear_iteration</td><td>Current non-linear iteration </td></tr>
    <tr><td class="paramname">time_step</td><td>current time-step </td></tr>
    <tr><td class="paramname">SFPI_its</td><td>Number of saturation fixed point iterations taken </td></tr>
    <tr><td class="paramname">Courant_number</td><td>Global courant number and shock front courant number </td></tr>
    <tr><td class="paramname">THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td>???? </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_cgraph" id="anamespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="5,1073,247,1113"/>
<area shape="rect" href="namespacematrix__operations.html#ab99709a532cd3a8ace8bd896814bc37b" title=" " alt="" coords="311,655,513,710"/>
<area shape="poly" title=" " alt="" coords="128,1073,143,1006,173,912,195,860,222,810,254,762,293,721,299,716,302,720,297,725,258,766,226,813,200,863,178,914,148,1007,133,1074"/>
<area shape="rect" href="namespacesolvers__module.html#a75f714580dc6fc01b865dd5533aa81c8" title=": The maximum backtracking factor is calculated based on the Courant number and physical effects ocur..." alt="" coords="331,735,493,775"/>
<area shape="poly" title=" " alt="" coords="130,1073,148,1016,180,938,201,896,228,855,258,817,293,785,317,770,319,775,296,789,262,821,232,858,206,899,184,940,153,1017,135,1074"/>
<area shape="rect" href="namespacemultiphase__eos.html#a8c66b15baf1f392d67a7b875514f9db7" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="298,799,526,839"/>
<area shape="poly" title=" " alt="" coords="145,1071,293,923,376,846,380,850,297,927,149,1075"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="295,937,529,977"/>
<area shape="poly" title=" " alt="" coords="168,1071,355,981,358,986,170,1076"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="911,973,1100,998"/>
<area shape="poly" title=" " alt="" coords="247,1076,294,1071,450,1056,571,1046,692,1035,846,1015,935,998,936,1003,847,1020,692,1041,571,1052,450,1061,295,1076,247,1081"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="1187,1908,1368,1948"/>
<area shape="poly" title=" " alt="" coords="247,1097,415,1107,601,1123,760,1143,816,1154,848,1167,896,1207,933,1249,961,1293,981,1337,995,1383,1005,1429,1015,1523,1025,1619,1033,1666,1045,1713,1063,1759,1088,1805,1122,1850,1166,1894,1176,1902,1173,1906,1162,1898,1118,1854,1084,1808,1058,1762,1040,1715,1028,1667,1019,1619,1010,1524,999,1430,990,1384,976,1339,956,1295,929,1252,892,1211,845,1172,814,1159,760,1148,601,1128,415,1113,247,1102"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="895,1067,1116,1107"/>
<area shape="poly" title=" " alt="" coords="247,1090,881,1085,881,1090,247,1095"/>
<area shape="rect" href="namespacesolvers__module.html#a9bba1ef1495c1a4a47a7eea3f2c17719" title=":This subroutines eliminates the oscillations in the saturation that are bigger than a certain tolera..." alt="" coords="621,1181,803,1221"/>
<area shape="poly" title=" " alt="" coords="168,1111,227,1137,295,1160,376,1176,459,1187,608,1198,607,1203,458,1193,375,1182,294,1165,225,1142,166,1116"/>
<area shape="rect" href="namespacesolvers__module.html#aa6838cee9b9a7eb08de040686134a9ed" title=":In this subroutine we applied some corrections and backtrack_par on the saturations obtained from th..." alt="" coords="337,1232,487,1272"/>
<area shape="poly" title=" " alt="" coords="152,1112,215,1161,255,1187,296,1211,328,1225,325,1230,293,1216,252,1192,212,1165,149,1116"/>
<area shape="rect" href="namespacesolvers__module.html#a5f0983ff761cbc960353cd6850ce0835" title=": This subroutines eliminates the oscillations in the saturation that are bigger than a certain toler..." alt="" coords="607,1267,817,1307"/>
<area shape="poly" title=" " alt="" coords="140,1113,163,1152,197,1199,242,1246,268,1266,296,1282,334,1296,373,1306,455,1316,534,1314,606,1306,606,1312,535,1320,454,1321,372,1311,332,1301,294,1286,265,1270,238,1250,193,1203,158,1154,135,1115"/>
<area shape="rect" href="namespacecopy__outof__state.html#aec4e2450672b43ae176fc5a459424126" title=": This subroutine calculates the actual Darcy velocity, but with P0DG precision only!" alt="" coords="331,1347,493,1387"/>
<area shape="poly" title=" " alt="" coords="139,1112,161,1156,195,1214,241,1274,267,1302,296,1326,320,1340,317,1344,293,1330,264,1306,237,1277,191,1217,156,1159,134,1115"/>
<area shape="rect" href="namespacemultiphase__eos.html#a4c25264c85fc53c6e510fb601aaa3b58" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="616,659,808,699"/>
<area shape="poly" title=" " alt="" coords="508,796,528,785,544,767,551,748,558,728,576,709,602,694,605,699,579,713,563,730,556,749,548,769,531,789,510,801"/>
<area shape="rect" href="namespacemultiphase__eos.html#a19df2cd38bcac98a4dadc0a3327bc1d4" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="925,631,1085,671"/>
<area shape="poly" title=" " alt="" coords="512,796,527,785,541,768,547,751,549,714,551,678,560,660,576,645,618,621,664,606,712,598,761,596,809,599,855,606,934,624,933,629,854,611,808,604,761,601,712,603,665,611,620,626,579,649,564,663,557,679,554,714,552,752,545,771,531,789,515,801"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae389bf78d79bfc3260a4b53fe2e117d8" title="In this subroutine we compute the viscosity EOS. Options for different EOS." alt="" coords="617,723,807,763"/>
<area shape="poly" title=" " alt="" coords="486,796,577,772,612,763,613,769,578,777,487,801"/>
<area shape="poly" title=" " alt="" coords="808,667,911,657,912,662,808,672"/>
<area shape="rect" href="namespacecompositional__terms.html#a48e5e1d75323094a1b7d6cd01ebde0a1" title="make sure the composition sums to 1.0" alt="" coords="617,787,807,827"/>
<area shape="poly" title=" " alt="" coords="434,935,495,885,534,859,576,836,604,826,605,831,578,841,537,863,498,890,437,939"/>
<area shape="rect" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="577,851,847,891"/>
<area shape="poly" title=" " alt="" coords="481,935,577,907,627,892,629,897,578,912,482,940"/>
<area shape="rect" href="namespacecv__advection.html#a6eaca115c05985fed5f9376ecce181d7" title="This subroutine counts then number of faces in the control volume space." alt="" coords="918,787,1093,827"/>
<area shape="poly" title=" " alt="" coords="529,953,602,948,682,939,765,923,846,900,911,869,966,833,969,837,914,874,848,905,767,928,683,944,602,954,530,959"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="620,965,804,1005"/>
<area shape="poly" title=" " alt="" coords="530,966,607,973,606,978,529,971"/>
<area shape="poly" title=" " alt="" coords="440,976,677,1170,674,1175,436,980"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="1189,5,1365,45"/>
<area shape="poly" title=" " alt="" coords="1030,785,1075,741,1097,712,1114,682,1122,655,1127,623,1131,546,1125,362,1122,269,1124,182,1136,109,1147,80,1162,56,1176,43,1179,47,1166,59,1152,82,1141,111,1130,183,1127,269,1130,362,1137,546,1133,624,1127,656,1118,684,1101,715,1079,744,1034,788"/>
<area shape="poly" title=" " alt="" coords="804,983,897,983,897,988,804,988"/>
<area shape="poly" title=" " alt="" coords="772,1003,934,1059,932,1065,770,1008"/>
<area shape="poly" title=" " alt="" coords="1019,971,1068,916,1093,879,1114,838,1123,804,1128,764,1131,667,1119,438,1114,321,1116,213,1122,165,1131,122,1144,86,1162,56,1176,43,1179,47,1166,59,1149,88,1136,124,1127,166,1122,214,1119,321,1124,437,1136,667,1133,764,1128,805,1118,840,1098,881,1072,920,1023,974"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="1180,451,1375,491"/>
<area shape="poly" title=" " alt="" coords="1018,971,1066,916,1092,879,1114,838,1128,788,1131,743,1128,701,1122,661,1118,622,1120,583,1133,543,1162,501,1167,496,1171,499,1166,504,1138,545,1125,584,1123,622,1127,661,1133,701,1136,743,1133,789,1118,840,1097,881,1070,919,1022,974"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="1187,515,1368,555"/>
<area shape="poly" title=" " alt="" coords="1018,971,1065,916,1092,878,1114,838,1126,799,1130,764,1126,699,1124,668,1128,637,1139,605,1162,572,1174,560,1178,564,1166,575,1144,608,1133,638,1130,668,1131,699,1135,764,1131,800,1118,840,1096,881,1070,919,1022,974"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="1206,629,1349,669"/>
<area shape="poly" title=" " alt="" coords="1016,971,1063,915,1090,878,1114,837,1123,815,1128,795,1131,758,1138,723,1147,705,1162,686,1192,666,1195,670,1166,690,1151,708,1143,725,1136,759,1133,796,1128,817,1118,840,1094,881,1067,918,1021,974"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="1452,609,1636,634"/>
<area shape="poly" title=" " alt="" coords="1017,971,1065,916,1091,878,1114,838,1124,805,1127,774,1124,717,1123,691,1127,665,1139,640,1162,615,1202,591,1245,576,1291,570,1338,569,1383,574,1427,582,1498,602,1497,607,1425,587,1383,579,1337,575,1291,575,1246,581,1204,596,1166,619,1143,643,1132,666,1128,691,1129,717,1133,774,1129,806,1118,840,1096,881,1069,919,1021,974"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="1444,677,1644,702"/>
<area shape="poly" title=" " alt="" coords="1016,971,1061,915,1114,837,1126,807,1132,779,1140,754,1162,730,1182,719,1209,711,1276,698,1353,691,1430,687,1430,693,1354,696,1277,703,1210,716,1184,724,1166,734,1145,757,1137,781,1131,808,1118,840,1065,918,1020,974"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="1182,745,1373,770"/>
<area shape="poly" title=" " alt="" coords="1014,971,1096,861,1162,779,1174,773,1176,778,1166,783,1101,864,1018,974"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="1189,794,1365,819"/>
<area shape="poly" title=" " alt="" coords="1014,971,1071,903,1114,863,1163,830,1181,821,1183,826,1165,834,1117,867,1075,907,1018,974"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="1177,844,1378,884"/>
<area shape="poly" title=" " alt="" coords="1024,970,1085,933,1163,894,1183,886,1185,891,1165,898,1087,938,1027,975"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="1178,908,1377,948"/>
<area shape="poly" title=" " alt="" coords="1066,970,1168,948,1169,953,1067,975"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="1439,995,1649,1035"/>
<area shape="poly" title=" " alt="" coords="1100,988,1425,1006,1425,1011,1100,993"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="1172,1087,1383,1127"/>
<area shape="poly" title=" " alt="" coords="1027,996,1087,1033,1165,1072,1185,1080,1183,1085,1163,1077,1085,1038,1024,1000"/>
<area shape="rect" href="namespacecv__advection.html#a6c099f85979288a8bda06b0dbf65ce4b" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="1201,1201,1353,1241"/>
<area shape="poly" title=" " alt="" coords="1039,996,1079,1019,1100,1035,1118,1053,1130,1071,1136,1088,1141,1120,1146,1151,1153,1165,1166,1181,1190,1198,1187,1202,1162,1185,1149,1168,1141,1152,1135,1121,1131,1089,1125,1073,1114,1056,1097,1039,1077,1023,1036,1000"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="1451,1179,1637,1205"/>
<area shape="poly" title=" " alt="" coords="1036,996,1077,1019,1118,1053,1133,1076,1140,1098,1148,1118,1166,1137,1185,1147,1212,1155,1282,1169,1361,1179,1438,1185,1438,1190,1360,1184,1281,1175,1211,1160,1183,1151,1162,1141,1143,1121,1135,1100,1129,1079,1114,1056,1074,1024,1033,1000"/>
<area shape="rect" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="1207,1265,1347,1305"/>
<area shape="poly" title=" " alt="" coords="1041,996,1082,1018,1101,1034,1118,1053,1133,1081,1140,1107,1139,1157,1138,1181,1140,1204,1148,1228,1166,1251,1179,1262,1195,1271,1193,1275,1177,1267,1162,1255,1144,1230,1135,1206,1132,1181,1134,1157,1134,1108,1128,1083,1114,1056,1098,1038,1079,1023,1039,1001"/>
<area shape="poly" title=" " alt="" coords="1045,996,1085,1018,1103,1034,1118,1053,1133,1088,1143,1131,1148,1180,1150,1234,1145,1353,1134,1481,1125,1608,1123,1725,1127,1778,1135,1824,1148,1863,1166,1894,1177,1905,1173,1909,1162,1898,1143,1865,1130,1825,1122,1778,1118,1726,1120,1608,1129,1481,1139,1353,1144,1234,1143,1180,1138,1132,1128,1090,1114,1056,1099,1038,1082,1022,1042,1001"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="1164,1330,1391,1355"/>
<area shape="poly" title=" " alt="" coords="1042,996,1082,1018,1102,1034,1118,1053,1136,1090,1143,1125,1141,1159,1137,1191,1133,1223,1134,1254,1143,1284,1166,1316,1171,1320,1167,1324,1162,1319,1139,1287,1129,1254,1128,1222,1131,1190,1136,1158,1137,1125,1131,1092,1114,1056,1098,1038,1079,1023,1039,1000"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="1167,1379,1387,1405"/>
<area shape="poly" title=" " alt="" coords="1043,996,1083,1018,1102,1034,1118,1053,1139,1097,1145,1139,1142,1179,1135,1218,1129,1255,1129,1292,1140,1329,1166,1366,1169,1369,1165,1373,1162,1370,1135,1331,1124,1293,1124,1255,1130,1217,1137,1178,1140,1139,1134,1099,1114,1056,1099,1038,1080,1023,1040,1001"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="1201,1453,1354,1493"/>
<area shape="poly" title=" " alt="" coords="1043,996,1083,1018,1102,1034,1118,1053,1142,1103,1150,1150,1147,1195,1140,1238,1133,1281,1132,1324,1141,1368,1166,1416,1181,1432,1200,1445,1197,1449,1178,1436,1162,1419,1136,1370,1126,1324,1128,1280,1135,1237,1142,1194,1144,1151,1137,1105,1114,1056,1099,1038,1080,1023,1040,1000"/>
<area shape="rect" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="1191,1517,1363,1557"/>
<area shape="poly" title=" " alt="" coords="1044,996,1084,1018,1103,1034,1118,1053,1135,1085,1146,1116,1151,1146,1153,1176,1146,1232,1134,1287,1123,1340,1119,1394,1123,1421,1132,1448,1146,1475,1166,1504,1181,1516,1177,1521,1162,1507,1141,1478,1127,1450,1118,1422,1114,1394,1117,1340,1129,1286,1141,1231,1147,1175,1146,1147,1141,1118,1130,1087,1114,1056,1099,1038,1081,1023,1041,1001"/>
<area shape="rect" href="namespacecv__advection.html#aeeb08147b461c9b4e619c6a4afd37a68" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="1193,1581,1362,1621"/>
<area shape="poly" title=" " alt="" coords="1044,996,1084,1018,1103,1034,1118,1053,1128,1075,1135,1101,1141,1164,1138,1316,1135,1393,1137,1465,1146,1525,1154,1549,1166,1568,1183,1582,1179,1586,1162,1571,1150,1551,1141,1527,1131,1466,1130,1393,1132,1316,1136,1164,1130,1102,1123,1077,1114,1056,1099,1038,1081,1023,1041,1000"/>
<area shape="rect" href="namespacecv__advection.html#a6ad3a63555367e6c0022730a76bb7df5" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="1191,1646,1364,1671"/>
<area shape="poly" title=" " alt="" coords="1044,996,1084,1018,1103,1034,1118,1053,1129,1077,1136,1107,1142,1178,1141,1261,1136,1349,1132,1437,1133,1517,1143,1584,1153,1611,1166,1632,1180,1643,1177,1647,1162,1635,1148,1613,1138,1586,1128,1518,1127,1437,1131,1349,1136,1260,1137,1178,1131,1108,1124,1079,1114,1056,1099,1038,1081,1022,1041,1000"/>
<area shape="rect" href="namespacecv__advection.html#a1ae53b6e2d75f63d1a426e6f3534d1d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="1207,1023,1348,1063"/>
<area shape="poly" title=" " alt="" coords="1067,995,1193,1022,1192,1028,1066,1001"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="1203,1719,1352,1745"/>
<area shape="poly" title=" " alt="" coords="1044,996,1084,1018,1103,1034,1118,1053,1130,1079,1138,1111,1145,1188,1144,1277,1139,1372,1135,1467,1135,1554,1144,1629,1153,1658,1166,1682,1183,1699,1204,1712,1201,1716,1180,1703,1162,1686,1148,1660,1139,1630,1130,1555,1129,1466,1134,1372,1139,1276,1140,1188,1133,1112,1125,1081,1114,1056,1099,1038,1081,1022,1041,1000"/>
<area shape="rect" href="namespacecv__advection.html#aca35d740c637f0177d867e8a10cec8ef" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="1199,1769,1355,1809"/>
<area shape="poly" title=" " alt="" coords="1044,996,1084,1018,1103,1034,1118,1053,1131,1083,1140,1118,1146,1204,1143,1304,1136,1411,1129,1517,1129,1615,1133,1658,1140,1697,1151,1730,1166,1756,1189,1773,1185,1778,1162,1759,1146,1732,1134,1698,1127,1659,1124,1615,1124,1517,1130,1411,1138,1304,1141,1204,1134,1119,1126,1084,1114,1056,1099,1038,1081,1022,1041,1000"/>
<area shape="rect" href="namespacemulti__tools.html#ac71c1810848e09741781728153d5f34b" title=" " alt="" coords="1202,1858,1353,1883"/>
<area shape="poly" title=" " alt="" coords="1045,996,1085,1018,1103,1034,1118,1053,1132,1085,1142,1124,1149,1217,1146,1325,1139,1441,1131,1556,1130,1663,1133,1711,1140,1754,1151,1790,1166,1820,1184,1837,1205,1850,1203,1855,1180,1842,1162,1823,1146,1792,1135,1755,1128,1711,1125,1663,1126,1556,1133,1440,1141,1325,1144,1217,1136,1124,1127,1087,1114,1056,1099,1038,1081,1022,1042,1001"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="1190,70,1365,95"/>
<area shape="poly" title=" " alt="" coords="1019,971,1068,916,1093,879,1114,838,1122,806,1127,768,1130,678,1119,463,1115,353,1117,253,1123,208,1131,168,1144,134,1162,106,1176,94,1180,98,1166,110,1149,136,1136,169,1128,209,1122,253,1120,353,1124,462,1135,677,1133,769,1127,807,1118,840,1098,881,1072,920,1023,974"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="1193,120,1361,160"/>
<area shape="poly" title=" " alt="" coords="1019,971,1067,916,1093,879,1114,838,1121,809,1126,775,1130,692,1122,496,1119,397,1122,305,1135,227,1146,196,1162,170,1179,155,1183,159,1166,174,1151,198,1140,229,1127,305,1124,397,1127,496,1135,692,1132,775,1127,810,1118,840,1098,881,1072,919,1023,974"/>
<area shape="rect" href="namespacecv__advection.html#afc50adcb66253565fe9c7a83244430a7" title="Detects whether the element has a shockfront or not." alt="" coords="1200,208,1355,248"/>
<area shape="poly" title=" " alt="" coords="1018,971,1067,916,1093,879,1113,838,1125,783,1129,711,1124,542,1122,455,1126,375,1138,308,1148,280,1162,258,1186,240,1189,244,1166,262,1153,283,1143,309,1131,376,1128,455,1129,541,1134,711,1130,784,1119,840,1098,881,1071,919,1022,974"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="1207,273,1348,298"/>
<area shape="poly" title=" " alt="" coords="1018,971,1067,916,1093,879,1113,838,1124,788,1128,722,1124,567,1123,488,1127,415,1139,354,1149,329,1162,309,1176,297,1192,289,1195,294,1179,301,1166,312,1153,331,1144,355,1132,415,1128,488,1129,567,1133,722,1130,788,1119,840,1098,881,1071,919,1022,974"/>
<area shape="rect" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="1196,323,1359,363"/>
<area shape="poly" title=" " alt="" coords="1018,971,1067,916,1093,879,1113,838,1124,794,1127,737,1126,600,1127,531,1131,467,1142,413,1151,391,1162,373,1182,357,1185,361,1166,376,1155,393,1147,414,1136,467,1132,531,1132,600,1133,737,1129,795,1119,840,1097,881,1071,919,1022,974"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0358bf9293883d5a332167bc0558b985" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="1184,387,1371,427"/>
<area shape="poly" title=" " alt="" coords="1018,971,1066,916,1093,879,1113,838,1123,800,1127,751,1128,633,1129,573,1134,518,1144,471,1162,437,1171,428,1174,432,1166,440,1149,473,1139,519,1135,573,1133,633,1132,751,1128,801,1119,840,1097,881,1071,920,1022,974"/>
<area shape="poly" title=" " alt="" coords="1348,639,1438,630,1438,635,1349,645"/>
<area shape="poly" title=" " alt="" coords="1349,657,1446,672,1445,677,1348,663"/>
<area shape="poly" title=" " alt="" coords="1353,1210,1437,1201,1438,1206,1354,1216"/>
<area shape="poly" title=" " alt="" coords="1228,1454,1225,1444,1233,1434,1250,1429,1277,1427,1308,1429,1325,1437,1323,1442,1307,1435,1277,1432,1251,1434,1236,1439,1230,1445,1233,1452"/>
<area shape="poly" title=" " alt="" coords="1348,1033,1425,1024,1425,1030,1348,1038"/>
<area shape="poly" title=" " alt="" coords="1234,1721,1225,1711,1230,1701,1248,1695,1277,1693,1316,1697,1326,1702,1330,1708,1325,1710,1322,1706,1314,1702,1277,1698,1249,1700,1233,1705,1230,1710,1238,1717"/>
<area shape="poly" title=" " alt="" coords="1234,1860,1225,1850,1230,1840,1248,1833,1277,1831,1316,1835,1326,1840,1330,1846,1325,1849,1322,1844,1314,1841,1277,1837,1249,1839,1233,1844,1230,1849,1238,1856"/>
<area shape="poly" title=" " alt="" coords="1228,208,1225,198,1233,189,1250,183,1277,181,1308,184,1325,191,1323,196,1307,189,1277,187,1251,189,1236,193,1230,199,1233,207"/>
<area shape="poly" title=" " alt="" coords="1097,1105,1118,1124,1135,1154,1146,1192,1152,1236,1155,1285,1151,1394,1141,1512,1131,1630,1128,1738,1131,1787,1138,1830,1149,1866,1166,1894,1177,1905,1173,1909,1162,1898,1144,1868,1133,1831,1126,1787,1123,1738,1126,1629,1136,1512,1146,1394,1149,1285,1147,1236,1141,1193,1130,1156,1114,1127,1093,1109"/>
<area shape="poly" title=" " alt="" coords="487,1237,607,1216,608,1222,488,1242"/>
<area shape="poly" title=" " alt="" coords="488,1258,593,1270,593,1276,487,1263"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_icgraph" id="anamespacemultiphase__1d__engine_aa8ed1c2e68fd75835c3794475805554c_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,5,707,45"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a07a7956a7419e82fb8f059cae3ded083" name="a07a7956a7419e82fb8f059cae3ded083"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a07a7956a7419e82fb8f059cae3ded083">&#9670;&#160;</a></span>volumefraction_assemble_solve_newton()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine, public multiphase_1d_engine::volumefraction_assemble_solve_newton </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type )&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>multicomponent_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ,: ), intent(inout)&#160;</td>
          <td class="paramname"><em>prev_sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>v_source</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>time_step</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>sfpi_taken</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>sfpi_its</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>courant_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jacobian. Solves using Newton's method. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">multicomponent_state</td><td>Linked list containing all the fields used by compositional, just in case we are solving for components &gt;</td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">DT</td><td>Time step size </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">V_SOURCE</td><td>Source term </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">igot_theta_flux</td><td>???? </td></tr>
    <tr><td class="paramname">mass_ele_transp</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">nonlinear_iteration</td><td>Current non-linear iteration </td></tr>
    <tr><td class="paramname">time_step</td><td>current time-step </td></tr>
    <tr><td class="paramname">SFPI_its</td><td>Number of saturation fixed point iterations taken </td></tr>
    <tr><td class="paramname">Courant_number</td><td>Global courant number and shock front courant number </td></tr>
    <tr><td class="paramname">THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td>???? </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_cgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_cgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_cgraph" id="anamespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_cgraph">
<area shape="rect" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="5,368,204,422"/>
<area shape="rect" href="namespacematrix__operations.html#ab99709a532cd3a8ace8bd896814bc37b" title=" " alt="" coords="879,53,1081,108"/>
<area shape="poly" title=" " alt="" coords="172,365,251,334,550,222,851,118,877,109,878,114,853,123,552,227,253,339,174,370"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="573,290,765,330"/>
<area shape="poly" title=" " alt="" coords="204,377,559,323,560,329,205,383"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="1175,194,1357,234"/>
<area shape="poly" title=" " alt="" coords="132,365,185,318,251,271,409,181,475,147,538,120,603,96,674,76,851,38,926,19,987,5,1016,3,1045,7,1076,18,1110,38,1126,54,1134,71,1137,108,1139,145,1145,163,1158,180,1166,186,1162,190,1154,183,1140,165,1133,146,1132,108,1129,73,1121,57,1106,42,1074,23,1044,12,1016,8,988,10,927,25,853,43,675,81,604,101,540,125,477,152,411,186,253,276,188,322,135,369"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a9de595767a445b64e2d2c03a88413f2a" title="Overrelaxation has to be alocate before calling this subroutine its size is cv_nonods For more inform..." alt="" coords="869,375,1091,415"/>
<area shape="poly" title=" " alt="" coords="204,392,856,392,856,398,204,398"/>
<area shape="rect" href="namespacesolvers__module.html#a75f714580dc6fc01b865dd5533aa81c8" title=": The maximum backtracking factor is calculated based on the Courant number and physical effects ocur..." alt="" coords="288,990,451,1030"/>
<area shape="poly" title=" " alt="" coords="112,422,129,539,160,704,179,787,202,864,227,927,254,969,277,987,274,991,250,973,222,929,197,866,174,789,154,705,124,540,107,423"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="252,875,487,915"/>
<area shape="poly" title=" " alt="" coords="123,421,353,861,349,864,118,424"/>
<area shape="rect" href="namespacesolvers__module.html#a9bba1ef1495c1a4a47a7eea3f2c17719" title=":This subroutines eliminates the oscillations in the saturation that are bigger than a certain tolera..." alt="" coords="579,1067,760,1107"/>
<area shape="poly" title=" " alt="" coords="112,422,130,532,160,684,180,761,202,831,227,887,254,925,282,945,310,954,337,956,365,954,394,951,424,951,456,958,488,975,506,995,513,1015,520,1035,536,1053,567,1069,565,1074,533,1057,516,1037,508,1017,501,997,485,980,454,963,424,957,395,956,366,959,337,962,309,960,280,950,250,929,222,890,197,833,175,763,155,685,125,533,107,423"/>
<area shape="poly" title=" " alt="" coords="698,287,749,248,802,197,816,176,824,156,832,137,850,118,866,108,869,112,854,122,837,140,828,158,821,178,806,201,753,252,702,292"/>
<area shape="rect" href="namespacemultiphase__eos.html#a8c66b15baf1f392d67a7b875514f9db7" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="866,196,1094,236"/>
<area shape="poly" title=" " alt="" coords="725,287,851,246,882,237,883,242,853,251,727,292"/>
<area shape="rect" href="namespacesolvers__module.html#a6d8537381fc47d2c768d80375889a65a" title=" " alt="" coords="883,132,1077,172"/>
<area shape="poly" title=" " alt="" coords="693,287,761,235,805,206,851,182,870,174,872,179,853,187,807,211,764,239,696,291"/>
<area shape="poly" title=" " alt="" coords="745,327,824,341,917,348,966,347,1015,340,1062,328,1107,310,1123,296,1131,279,1138,261,1154,243,1163,238,1166,242,1158,248,1143,264,1135,282,1127,299,1109,314,1064,333,1016,345,966,352,917,354,823,347,744,332"/>
<area shape="poly" title=" " alt="" coords="744,327,894,369,893,374,742,332"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="889,504,1071,544"/>
<area shape="poly" title=" " alt="" coords="701,328,940,494,937,498,698,332"/>
<area shape="rect" href="namespacesolvers__module.html#aed9753359fd3dd4278721035ca8c0134" title="In this subroutine the matrix is multiplied by vfield A is&#45;written." alt="" coords="887,260,1073,300"/>
<area shape="poly" title=" " alt="" coords="765,298,873,288,874,293,766,303"/>
<area shape="rect" href="namespacemultiphase__eos.html#a4c25264c85fc53c6e510fb601aaa3b58" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1170,130,1362,170"/>
<area shape="poly" title=" " alt="" coords="1066,194,1165,170,1167,175,1067,199"/>
<area shape="rect" href="namespacemultiphase__eos.html#a19df2cd38bcac98a4dadc0a3327bc1d4" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1449,102,1609,142"/>
<area shape="poly" title=" " alt="" coords="1085,194,1106,182,1121,166,1129,148,1137,130,1155,115,1190,100,1226,91,1302,82,1376,86,1441,96,1441,101,1375,91,1302,88,1227,96,1191,106,1157,120,1141,134,1134,150,1126,169,1110,186,1088,198"/>
<area shape="rect" href="namespacemultiphase__eos.html#ae389bf78d79bfc3260a4b53fe2e117d8" title="In this subroutine we compute the viscosity EOS. Options for different EOS." alt="" coords="1171,15,1361,55"/>
<area shape="poly" title=" " alt="" coords="1089,194,1106,182,1118,169,1125,157,1130,129,1135,101,1142,86,1154,72,1170,59,1173,64,1158,75,1147,89,1140,102,1135,130,1130,158,1122,173,1110,186,1092,198"/>
<area shape="poly" title=" " alt="" coords="1362,137,1435,129,1436,134,1362,142"/>
<area shape="rect" href="namespacemultiphase__eos.html#a2b630dc39b8a9a21ef87319a98039974" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1691,102,1845,142"/>
<area shape="poly" title=" " alt="" coords="1610,119,1677,119,1677,124,1610,124"/>
<area shape="poly" title=" " alt="" coords="1078,372,1106,354,1118,341,1124,328,1129,300,1135,272,1142,258,1154,244,1162,238,1165,242,1158,247,1146,261,1140,274,1135,301,1129,330,1122,344,1110,358,1081,377"/>
<area shape="rect" href="namespacemultiphase__eos.html#a0884f603bf7bf0a4b380eb50f6de51b7" title=":This functions returns the derivative of the capillary pressure with respect to the saturation" alt="" coords="1189,282,1343,322"/>
<area shape="poly" title=" " alt="" coords="1053,372,1107,354,1155,331,1176,323,1178,328,1157,336,1109,359,1054,377"/>
<area shape="poly" title=" " alt="" coords="1218,282,1215,272,1222,263,1240,257,1266,255,1296,258,1313,265,1311,270,1295,263,1266,260,1241,262,1225,267,1220,273,1223,280"/>
<area shape="poly" title=" " alt="" coords="1018,502,1064,470,1087,449,1106,425,1118,401,1124,377,1125,332,1128,289,1137,266,1154,244,1161,237,1165,241,1158,247,1141,269,1133,290,1130,333,1129,378,1123,403,1110,428,1091,452,1068,474,1021,506"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="1175,562,1357,602"/>
<area shape="poly" title=" " alt="" coords="1072,540,1162,558,1161,563,1071,545"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="1171,626,1361,652"/>
<area shape="poly" title=" " alt="" coords="1016,542,1080,577,1157,611,1186,620,1185,625,1155,616,1078,582,1014,547"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="1178,676,1354,701"/>
<area shape="poly" title=" " alt="" coords="1002,542,1067,602,1110,635,1157,662,1174,669,1172,674,1155,667,1107,639,1064,606,998,546"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="1424,1111,1635,1151"/>
<area shape="poly" title=" " alt="" coords="1071,515,1156,512,1247,514,1326,524,1356,534,1378,548,1397,578,1409,621,1414,672,1416,729,1417,841,1420,888,1427,925,1444,973,1466,1020,1510,1097,1505,1100,1462,1023,1440,975,1421,926,1415,889,1412,841,1411,729,1409,673,1403,622,1392,580,1374,551,1354,539,1324,529,1246,519,1157,517,1072,520"/>
<area shape="rect" href="namespacecv__advection.html#aa75b98e24eaf8dd45300f3c4b1c86fce" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="1196,346,1336,386"/>
<area shape="poly" title=" " alt="" coords="1004,502,1070,453,1155,402,1185,388,1188,393,1157,407,1073,458,1008,506"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="1156,725,1376,750"/>
<area shape="poly" title=" " alt="" coords="996,543,1021,580,1058,626,1104,672,1157,711,1170,717,1168,722,1155,716,1101,676,1054,629,1017,583,992,546"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="1179,774,1353,800"/>
<area shape="poly" title=" " alt="" coords="992,543,1015,589,1051,648,1098,710,1127,737,1157,761,1168,766,1165,771,1155,765,1123,741,1094,713,1046,651,1010,591,988,546"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="1437,888,1621,913"/>
<area shape="poly" title=" " alt="" coords="1026,501,1101,476,1147,465,1195,458,1244,456,1292,462,1337,477,1378,503,1397,524,1411,545,1419,566,1423,588,1420,632,1410,678,1399,723,1394,769,1395,792,1400,815,1411,838,1426,861,1449,879,1445,884,1422,865,1406,841,1395,817,1390,793,1388,769,1394,722,1405,676,1415,632,1418,588,1414,568,1406,547,1393,527,1374,508,1335,482,1291,467,1244,461,1195,463,1148,470,1103,481,1028,507"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="1429,825,1629,850"/>
<area shape="poly" title=" " alt="" coords="1011,502,1084,462,1131,442,1181,425,1234,415,1285,415,1334,426,1357,437,1378,453,1397,473,1411,494,1419,516,1422,538,1419,583,1408,629,1396,675,1391,721,1393,744,1399,766,1409,788,1426,810,1431,815,1427,819,1422,814,1405,791,1394,768,1387,744,1386,721,1391,674,1402,628,1413,582,1417,539,1413,517,1406,497,1393,477,1374,457,1354,442,1332,431,1285,420,1234,421,1183,430,1133,447,1086,467,1014,506"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aee06170a27bb4dab883f8ef10ff1cba8" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="1445,760,1613,800"/>
<area shape="poly" title=" " alt="" coords="1353,782,1431,780,1432,785,1353,787"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="1683,900,1853,925"/>
<area shape="poly" title=" " alt="" coords="1622,902,1669,905,1669,910,1621,907"/>
<area shape="poly" title=" " alt="" coords="1729,901,1721,891,1725,881,1741,875,1768,873,1801,877,1814,886,1811,890,1799,882,1768,878,1743,880,1729,885,1726,890,1733,898"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#af4782b913aba9aef1af79d9db7c1739a" title=" " alt="" coords="1684,811,1852,851"/>
<area shape="poly" title=" " alt="" coords="1629,832,1670,831,1670,836,1629,837"/>
<area shape="poly" title=" " alt="" coords="1724,811,1721,801,1728,792,1744,786,1768,784,1796,787,1811,794,1808,799,1794,792,1768,790,1745,791,1731,796,1726,802,1729,810"/>
<area shape="rect" href="namespacecompositional__terms.html#a48e5e1d75323094a1b7d6cd01ebde0a1" title="make sure the composition sums to 1.0" alt="" coords="575,811,764,851"/>
<area shape="poly" title=" " alt="" coords="463,872,561,851,563,856,464,877"/>
<area shape="rect" href="namespacecompositional__terms.html#a66bd32a7cfb204a4ceafac3c09cb188b" title="Calculate compositional model linkage between the phase expressed in COMP_ABSORB. Use values from the..." alt="" coords="535,1003,804,1043"/>
<area shape="poly" title=" " alt="" coords="452,913,488,931,504,946,513,961,521,975,536,989,548,995,545,1000,533,993,517,979,508,964,500,950,485,936,450,917"/>
<area shape="rect" href="namespacecv__advection.html#a6eaca115c05985fed5f9376ecce181d7" title="This subroutine counts then number of faces in the control volume space." alt="" coords="582,939,757,979"/>
<area shape="poly" title=" " alt="" coords="464,912,569,935,568,940,463,918"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="577,875,761,915"/>
<area shape="poly" title=" " alt="" coords="487,892,564,892,564,898,487,898"/>
<area shape="poly" title=" " alt="" coords="460,913,488,932,501,947,508,963,513,995,517,1025,524,1039,536,1053,567,1071,564,1076,533,1057,520,1042,512,1026,507,995,503,965,497,950,485,936,457,917"/>
<area shape="rect" href="namespacecompositional__terms.html#a23481f5d5ce42c14c00cbc93e4a7bfa2" title="Method to flash components." alt="" coords="901,1380,1059,1420"/>
<area shape="poly" title=" " alt="" coords="791,1041,806,1053,827,1081,837,1109,840,1136,839,1163,836,1220,841,1250,854,1282,872,1308,893,1331,938,1370,935,1374,890,1335,868,1311,850,1284,836,1251,830,1220,833,1163,835,1136,832,1110,822,1084,802,1057,788,1045"/>
<area shape="rect" href="namespacecompositional__terms.html#ac1d9985f8ba66b85d7ac0905db70ec6a" title="Width: width of the sigmoid function. The sigmoid function, varies between ( LowMag,..." alt="" coords="1187,1512,1345,1552"/>
<area shape="poly" title=" " alt="" coords="1025,1418,1211,1504,1208,1509,1023,1423"/>
<area shape="poly" title=" " alt="" coords="1218,1513,1215,1502,1222,1493,1240,1488,1266,1486,1296,1488,1313,1496,1311,1501,1295,1494,1266,1491,1241,1493,1225,1498,1220,1504,1223,1511"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="1178,1296,1354,1336"/>
<area shape="poly" title=" " alt="" coords="758,963,783,973,806,989,824,1014,832,1038,834,1063,832,1088,829,1113,830,1137,837,1161,854,1185,886,1215,923,1239,963,1259,1004,1276,1088,1298,1165,1309,1164,1315,1087,1303,1002,1281,960,1264,920,1244,883,1219,850,1189,833,1163,825,1138,824,1113,826,1088,828,1063,827,1039,819,1016,802,993,781,977,756,968"/>
<area shape="poly" title=" " alt="" coords="760,886,783,876,802,861,820,838,832,816,844,773,843,729,836,686,827,641,822,593,828,544,837,518,850,491,865,469,884,450,925,420,928,424,887,454,869,473,854,494,841,520,833,545,828,594,832,640,841,685,849,729,849,773,837,818,824,841,806,865,786,881,763,891"/>
<area shape="rect" href="namespacemulti__tools.html#ac75ade49c065a07b12ef6532bbbd7abb" title=":Copies the data from inval to outval safely. If the sizes are different outval is populated using th..." alt="" coords="894,1149,1066,1174"/>
<area shape="poly" title=" " alt="" coords="763,900,786,910,806,925,825,951,833,978,833,1005,830,1032,827,1059,828,1085,835,1110,854,1134,882,1152,879,1156,850,1138,831,1112,822,1085,822,1058,825,1032,828,1005,828,979,820,954,802,929,783,914,761,905"/>
<area shape="rect" href="namespacecompositional__terms.html#a9091a40e5dcfbb5b4ebbce9242c7d0c4" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="852,932,1108,972"/>
<area shape="poly" title=" " alt="" coords="762,909,859,927,858,932,761,914"/>
<area shape="rect" href="namespacemultiphase__eos.html#a96725046151437e274a33a1d0dd944ee" title=": Here we compute component/solute/thermal diffusion coefficient" alt="" coords="884,754,1076,794"/>
<area shape="poly" title=" " alt="" coords="761,879,803,861,817,847,826,833,835,818,850,803,870,793,873,798,854,808,839,821,830,836,822,851,805,865,763,884"/>
<area shape="rect" href="namespacemultiphase__eos.html#af676f560af728589b6f716de6b010807" title=": Dispersion for porous media For thermal, the field density needs to be passed down,..." alt="" coords="884,818,1076,858"/>
<area shape="poly" title=" " alt="" coords="761,875,870,855,871,860,762,881"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="885,882,1075,908"/>
<area shape="poly" title=" " alt="" coords="761,892,871,892,871,898,761,898"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae8eddee3d8387917a7563c83c7ebbe9d" title=": To help the stability of the system,if there are no sources/sinks it is known that the temperature ..." alt="" coords="883,996,1077,1036"/>
<area shape="poly" title=" " alt="" coords="763,906,805,925,822,939,830,954,839,969,854,982,871,991,869,996,850,986,835,972,826,957,817,942,803,929,761,911"/>
<area shape="rect" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c" title=": For boussinesq porous media we need the reference density to ensure consistency when mixing with th..." alt="" coords="888,1084,1072,1124"/>
<area shape="poly" title=" " alt="" coords="762,902,785,911,806,925,819,940,827,955,832,986,836,1016,843,1031,854,1046,874,1063,897,1076,894,1081,871,1067,850,1050,838,1034,831,1018,827,987,822,957,815,943,802,929,783,916,760,907"/>
<area shape="rect" href="namespacecompositional__terms.html#a355b7b6ba8282f659fa0ecd18973e031" title="Calculate the diffusion coefficient COMP_DIFFUSION for current composition... based on page 136 in Re..." alt="" coords="1187,1360,1345,1400"/>
<area shape="poly" title=" " alt="" coords="1096,970,1110,982,1128,1006,1139,1029,1146,1052,1149,1075,1146,1121,1136,1166,1125,1211,1122,1256,1124,1279,1130,1301,1141,1324,1158,1346,1176,1361,1173,1365,1154,1350,1137,1326,1125,1303,1119,1280,1116,1256,1120,1210,1130,1165,1140,1120,1144,1075,1141,1053,1134,1031,1123,1008,1106,986,1093,974"/>
<area shape="rect" href="namespacecompositional__terms.html#ade3a2016f1b239160f844f3db8622b63" title="Determine MAT_U from NU,NV,NW which are variables mapped to material mesh." alt="" coords="1187,1424,1345,1464"/>
<area shape="poly" title=" " alt="" coords="1097,971,1110,982,1130,1010,1144,1037,1151,1064,1154,1091,1149,1145,1136,1198,1123,1251,1117,1304,1119,1330,1126,1357,1139,1383,1158,1410,1176,1425,1173,1430,1154,1414,1134,1386,1121,1359,1114,1331,1112,1304,1117,1250,1130,1197,1143,1144,1149,1091,1146,1065,1139,1039,1126,1013,1106,986,1093,975"/>
<area shape="poly" title=" " alt="" coords="1345,1427,1374,1410,1403,1383,1428,1352,1470,1284,1499,1217,1517,1163,1522,1165,1504,1219,1474,1286,1433,1355,1407,1387,1378,1414,1347,1432"/>
<area shape="poly" title=" " alt="" coords="1074,888,1091,880,1106,868,1120,845,1130,817,1137,782,1139,743,1138,655,1131,559,1124,463,1122,374,1130,299,1140,268,1154,244,1162,235,1166,239,1158,247,1144,270,1135,300,1127,374,1129,463,1136,559,1143,655,1145,743,1142,783,1136,818,1125,848,1110,871,1094,885,1076,893"/>
<area shape="poly" title=" " alt="" coords="1074,887,1091,879,1106,868,1128,837,1136,807,1136,776,1131,744,1126,712,1125,679,1133,646,1154,613,1162,606,1165,609,1158,617,1138,648,1130,680,1131,711,1136,743,1141,775,1142,808,1133,840,1110,871,1094,884,1076,892"/>
<area shape="poly" title=" " alt="" coords="1074,887,1091,879,1106,868,1124,843,1132,819,1133,793,1130,768,1127,741,1127,715,1135,688,1154,662,1160,657,1164,661,1158,666,1140,691,1133,715,1132,741,1135,767,1138,793,1137,820,1129,846,1110,871,1094,883,1076,892"/>
<area shape="poly" title=" " alt="" coords="1074,886,1091,878,1106,868,1121,850,1128,831,1130,792,1131,751,1139,731,1154,712,1164,704,1168,708,1158,715,1143,734,1136,752,1135,792,1133,832,1126,852,1110,871,1094,883,1076,891"/>
<area shape="poly" title=" " alt="" coords="1076,899,1094,907,1110,918,1127,940,1134,963,1135,986,1134,1009,1132,1031,1133,1053,1141,1073,1158,1093,1185,1112,1215,1127,1279,1145,1346,1151,1410,1149,1410,1154,1346,1157,1278,1150,1213,1132,1182,1117,1154,1097,1136,1076,1128,1054,1127,1031,1128,1008,1130,986,1129,964,1122,943,1106,922,1091,911,1074,904"/>
<area shape="poly" title=" " alt="" coords="1074,884,1106,867,1118,855,1124,843,1130,816,1135,788,1142,774,1154,761,1163,754,1166,759,1158,765,1146,777,1140,790,1135,817,1130,845,1122,859,1110,872,1076,889"/>
<area shape="poly" title=" " alt="" coords="1074,881,1107,867,1121,856,1130,843,1139,830,1155,817,1187,802,1189,806,1157,821,1143,833,1134,846,1125,859,1109,872,1076,885"/>
<area shape="poly" title=" " alt="" coords="1076,900,1110,918,1124,935,1131,953,1133,989,1136,1024,1143,1039,1158,1053,1186,1070,1212,1081,1237,1087,1262,1088,1314,1076,1375,1052,1419,1026,1458,992,1489,955,1511,923,1515,926,1493,958,1461,995,1422,1031,1377,1057,1316,1081,1262,1093,1237,1092,1211,1086,1183,1075,1154,1057,1139,1042,1131,1025,1128,990,1126,954,1119,938,1106,922,1074,904"/>
<area shape="poly" title=" " alt="" coords="1041,880,1156,860,1290,847,1415,839,1416,845,1291,852,1156,866,1042,885"/>
<area shape="poly" title=" " alt="" coords="1076,897,1094,906,1110,918,1128,941,1140,964,1147,987,1150,1010,1147,1055,1137,1101,1126,1146,1122,1192,1124,1214,1131,1237,1141,1260,1158,1282,1168,1292,1165,1296,1154,1286,1137,1262,1126,1239,1119,1215,1117,1192,1121,1146,1131,1100,1142,1055,1145,1010,1142,988,1135,966,1124,944,1106,922,1091,910,1074,902"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="1169,939,1363,979"/>
<area shape="poly" title=" " alt="" coords="1048,905,1109,918,1174,933,1173,938,1107,923,1047,910"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="1195,875,1337,915"/>
<area shape="poly" title=" " alt="" coords="1075,892,1181,892,1181,898,1075,898"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="1165,1003,1367,1043"/>
<area shape="poly" title=" " alt="" coords="1076,903,1110,918,1127,935,1135,954,1142,972,1158,989,1165,994,1162,998,1154,993,1138,975,1130,956,1122,938,1106,922,1074,907"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="1167,1168,1365,1208"/>
<area shape="poly" title=" " alt="" coords="1076,898,1094,906,1110,918,1131,947,1140,976,1140,1004,1137,1033,1133,1062,1133,1091,1140,1119,1158,1148,1170,1159,1166,1163,1154,1151,1135,1121,1127,1091,1128,1062,1131,1033,1135,1004,1134,976,1126,949,1106,922,1091,911,1074,903"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="1161,1232,1371,1272"/>
<area shape="poly" title=" " alt="" coords="1076,898,1094,906,1110,918,1125,937,1136,956,1145,994,1143,1031,1136,1069,1129,1107,1127,1144,1135,1181,1144,1200,1158,1218,1161,1222,1157,1225,1154,1222,1140,1203,1130,1183,1121,1144,1124,1106,1131,1068,1138,1031,1140,994,1131,958,1121,940,1106,922,1091,911,1074,902"/>
<area shape="poly" title=" " alt="" coords="1338,894,1424,895,1423,901,1337,899"/>
<area shape="poly" title=" " alt="" coords="1337,877,1456,851,1457,856,1338,882"/>
<area shape="poly" title=" " alt="" coords="927,1085,924,1074,933,1065,951,1060,980,1058,1013,1060,1031,1068,1029,1073,1012,1066,980,1063,952,1065,935,1070,929,1076,932,1083"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_icgraph.png" border="0" usemap="#anamespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_icgraph" alt=""/></div>
<map name="anamespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_icgraph" id="anamespacemultiphase__1d__engine_a07a7956a7419e82fb8f059cae3ded083_icgraph">
<area shape="rect" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="465,5,664,60"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="451,35,418,35,418,30,451,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacemultiphase__1d__engine.html">multiphase_1d_engine</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
