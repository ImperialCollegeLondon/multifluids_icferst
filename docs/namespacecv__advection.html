<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: cv_advection Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ICFERST<span id="projectnumber">&#160;25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('namespacecv__advection.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Types</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">cv_advection Module Reference</div></div>
</div><!--header-->
<div class="contents">

<p>This module contains all the tools to assemble and solve the equations and fields associated with the CV mesh, i.e. transport equation, continuity equation, DCVFE gradient matrix and the Laplacian system for the zeta-potential.  
<a href="namespacecv__advection.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Types</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecv__advection_1_1dg__derivs__all.html">dg_derivs_all</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates derivatives of vector fields  <a href="interfacecv__advection_1_1dg__derivs__all.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">interface &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="interfacecv__advection_1_1pack__loc__all.html">pack_loc_all</a></td></tr>
<tr class="memdesc:"><td class="mdescLeft">&#160;</td><td class="mdescRight">Packs field together to be later on used for high order computations.  <a href="interfacecv__advection_1_1pack__loc__all.html#details">More...</a><br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a3bd456f4f3d098a36288e7ed4a6dbf6b" id="r_a3bd456f4f3d098a36288e7ed4a6dbf6b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b">cv_assemb</a> (state, packed_state, final_phase, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, tracer, velocity, density, multi_absorp, diag_scale_pres, diag_scale_pres_coup, inv_b, den_all, denold_all, cv_disopt, cv_dg_vel_int_opt, dt, cv_theta, cv_beta, suf_sig_diagten_bc, deriv, cv_p, sourct_all, absorbt_all, volfra_pore, volfra_pore_total, getcv_disc, getct, igot_t2, igot_theta_flux, get_theta_flux, use_theta_flux, theta_flux, one_m_theta_flux, theta_flux_j, one_m_theta_flux_j, theta_gdiff, mean_pore_cv, mean_pore_cv_total, mass_mn_pres, thermal, got_free_surf, mass_suf, mass_ele_transp, tdiffusion, saturation, vad_parameter, phase_with_pc, courant_number, permeability_tensor_field, calculate_mass_delta, eles_with_pipe, pipes_aux, porous_heat_coef, porous_heat_coef_old, outfluxes, solving_compositional, nonlinear_iteration, assemble_collapsed_to_one_phase)</td></tr>
<tr class="memdesc:a3bd456f4f3d098a36288e7ed4a6dbf6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutines generates the transport equation for a cv field. It also can generate the Continuity equation if GETCT = .true. and also generate the gradient matrix of the momentum equation for the DCVFE method if the option is activated.  <br /></td></tr>
<tr class="separator:a3bd456f4f3d098a36288e7ed4a6dbf6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeeb08147b461c9b4e619c6a4afd37a68" id="r_aeeb08147b461c9b4e619c6a4afd37a68"><td class="memItemLeft" align="right" valign="top">pure subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aeeb08147b461c9b4e619c6a4afd37a68">onvdlim_ano_many</a> (nfield, tdlim, tdcen, income, etdnew_pele, etdnew_peleot, xi_limit, tupwin, tupwi2, denoin, ctilin, denoou, ctilou, ftilin, ftilou)</td></tr>
<tr class="memdesc:aeeb08147b461c9b4e619c6a4afd37a68"><td class="mdescLeft">&#160;</td><td class="mdescRight">This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values TDCEN(1...SNGI) using a NVD shceme. INCOME(1...SNGI)=1 for incomming to element ELE else =0. LIBETA is the flux limiting parameter. TDMAX(PELE)=maximum of the surrounding 6 element values of element PELE. TDMIN(PELE)=minimum of the surrounding 6 element values of element PELE. PELEOT=element at other side of current face. ELEOT2=element at other side of the element ELEOTH. ELESID=element next to oposing current face. DENOIN, CTILIN, DENOOU, CTILOU, FTILIN, FTILOU =&gt; memory The elements are arranged in this order: ELEOT2,ELE, PELEOT, ELESID.  <br /></td></tr>
<tr class="separator:aeeb08147b461c9b4e619c6a4afd37a68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e0beda955985765258aade53af3d1fb" id="r_a6e0beda955985765258aade53af3d1fb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6e0beda955985765258aade53af3d1fb">is_field_constant</a> (igot_t_const, igot_t_const_value, t_all, cv_nonods)</td></tr>
<tr class="memdesc:a6e0beda955985765258aade53af3d1fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Checks whether a field is constant or not. Although I think this check is terrible, no alternatives have provided the same functionality so far.  <br /></td></tr>
<tr class="separator:a6e0beda955985765258aade53af3d1fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad3a63555367e6c0022730a76bb7df5" id="r_a6ad3a63555367e6c0022730a76bb7df5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6ad3a63555367e6c0022730a76bb7df5">pack_loc</a> (loc_f, t_all, nphase, ipt, igot_t_pack)</td></tr>
<tr class="memdesc:a6ad3a63555367e6c0022730a76bb7df5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Copies memory into the same large array to then perform a projection from CV to FE.  <br /></td></tr>
<tr class="separator:a6ad3a63555367e6c0022730a76bb7df5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e58766834b93ab43ae7a753e699a9da" id="r_a9e58766834b93ab43ae7a753e699a9da"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a9e58766834b93ab43ae7a753e699a9da">unpack_loc</a> (loc_f, t_all, nphase, ipt, igot_t_pack, igot_t_const, igot_t_const_value)</td></tr>
<tr class="memdesc:a9e58766834b93ab43ae7a753e699a9da"><td class="mdescLeft">&#160;</td><td class="mdescRight">If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage.  <br /></td></tr>
<tr class="separator:a9e58766834b93ab43ae7a753e699a9da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1ccfb76c0376157c7a4446fbe4f7362" id="r_ae1ccfb76c0376157c7a4446fbe4f7362"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ae1ccfb76c0376157c7a4446fbe4f7362">pack_or_unpack_loc</a> (loc_f, t_all, nphase, nfield, ipt, pack, store, igot_t)</td></tr>
<tr class="memdesc:ae1ccfb76c0376157c7a4446fbe4f7362"><td class="mdescLeft">&#160;</td><td class="mdescRight">If PACK then pack T_ALL into LOC_F as long at IGOT_T==1 and STORE and not already in storage.  <br /></td></tr>
<tr class="separator:ae1ccfb76c0376157c7a4446fbe4f7362"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c1d3d050b9d6e3a460a5e33481a2317" id="r_a5c1d3d050b9d6e3a460a5e33481a2317"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a5c1d3d050b9d6e3a460a5e33481a2317">pack_loc_all1</a> (loc_f, field1, oldfield1, field2, oldfield2, field3, oldfield3, igot_t_pack, use_volume_frac_t2, nfield)</td></tr>
<tr class="memdesc:a5c1d3d050b9d6e3a460a5e33481a2317"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine is for fields that have already size final_phase - 1 Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the field into LOC_F to later on apply the limiters on all the fields at once.  <br /></td></tr>
<tr class="separator:a5c1d3d050b9d6e3a460a5e33481a2317"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a683fbf63598344fcda6fd591c09f5133" id="r_a683fbf63598344fcda6fd591c09f5133"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a683fbf63598344fcda6fd591c09f5133">pack_loc_all2</a> (loc_f, field1, oldfield1, field2, oldfield2, field3, oldfield3, igot_t_pack, use_volume_frac_t2, start_phase, final_phase, nodi)</td></tr>
<tr class="memdesc:a683fbf63598344fcda6fd591c09f5133"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subrotuine is for fields that are bigger than final_phase - start_phase Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the field into LOC_F to later on apply the limiters on all the fields at once.  <br /></td></tr>
<tr class="separator:a683fbf63598344fcda6fd591c09f5133"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebdd2647306a5d499b80ba8edc89bb93" id="r_aebdd2647306a5d499b80ba8edc89bb93"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aebdd2647306a5d499b80ba8edc89bb93">pack_loc_all3</a> (loc_f, field1, oldfield1, field2, oldfield2, field3, oldfield3, igot_t_pack, use_volume_frac_t2, start_phase, final_phase, nodi)</td></tr>
<tr class="memdesc:aebdd2647306a5d499b80ba8edc89bb93"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subrotuine is for fields that are bigger than final_phase - start_phase Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the field into LOC_F to later on apply the limiters on all the fields at once. This one is for integer fields.  <br /></td></tr>
<tr class="separator:aebdd2647306a5d499b80ba8edc89bb93"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4d87f487367930256a65aba57352cba8" id="r_a4d87f487367930256a65aba57352cba8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a4d87f487367930256a65aba57352cba8">i_pack_loc</a> (loc_f, t_all, nphase, ipt, igot_t_pack)</td></tr>
<tr class="memdesc:a4d87f487367930256a65aba57352cba8"><td class="mdescLeft">&#160;</td><td class="mdescRight">If PACK then pack T_ALL into LOC_F as long at IGOT_T==1 and STORE and not already in storage.  <br /></td></tr>
<tr class="separator:a4d87f487367930256a65aba57352cba8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a203f402aedd9fec9cade1641c093c169" id="r_a203f402aedd9fec9cade1641c093c169"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169">unpack_loc_all</a> (loc_f, field1, oldfield1, field2, oldfield2, field3, oldfield3, igot_t_pack, igot_t_const, igot_t_const_value, use_volume_frac_t2, nfield)</td></tr>
<tr class="memdesc:a203f402aedd9fec9cade1641c093c169"><td class="mdescLeft">&#160;</td><td class="mdescRight">If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage. Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the LOC_F into the field or use a constant value. This is after the limiters have been applied.  <br /></td></tr>
<tr class="separator:a203f402aedd9fec9cade1641c093c169"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6eaca115c05985fed5f9376ecce181d7" id="r_a6eaca115c05985fed5f9376ecce181d7"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6eaca115c05985fed5f9376ecce181d7">cv_count_faces</a> (mdims, cv_ele_type, cv_gidims)</td></tr>
<tr class="memdesc:a6eaca115c05985fed5f9376ecce181d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine counts then number of faces in the control volume space.  <br /></td></tr>
<tr class="separator:a6eaca115c05985fed5f9376ecce181d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa75b98e24eaf8dd45300f3c4b1c86fce" id="r_aa75b98e24eaf8dd45300f3c4b1c86fce"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aa75b98e24eaf8dd45300f3c4b1c86fce">find_other_side_fast</a> (cv_other_loc, cv_nloc, integrat_at_gi, x_nloc, x_ndgln, cv_snloc, cvfem_on_face, x_share, ele, ele2, finele, colele, distcontinuous_method)</td></tr>
<tr class="memdesc:aa75b98e24eaf8dd45300f3c4b1c86fce"><td class="mdescLeft">&#160;</td><td class="mdescRight">We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,GI)=.TRUE. if CV_KLOC is on the face that GI is centred on. Look for these nodes on the other elements. ELE2=0 also when we are between elements but are trying to integrate across the middle of a CV.  <br /></td></tr>
<tr class="separator:aa75b98e24eaf8dd45300f3c4b1c86fce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72902394525a29d241353d21af94ec81" id="r_a72902394525a29d241353d21af94ec81"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81">find_other_side</a> (cv_other_loc, cv_nloc, u_other_loc, u_nloc, mat_other_loc, integrat_at_gi, x_nloc, xu_nloc, x_ndgln, xu_ndgln, cv_snloc, cvfem_on_face, x_share, ele, ele2, finele, colele, distcontinuous_method)</td></tr>
<tr class="memdesc:a72902394525a29d241353d21af94ec81"><td class="mdescLeft">&#160;</td><td class="mdescRight">We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC. CVFEM_ON_FACE(CV_KLOC,GI)=.TRUE. if CV_KLOC is on the face that GI is centred on. Look for these nodes on the other elements. ELE2=0 also when we are between elements but are trying to integrate across the middle of a CV.  <br /></td></tr>
<tr class="separator:a72902394525a29d241353d21af94ec81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ae53b6e2d75f63d1a426e6f3534d1d7" id="r_a1ae53b6e2d75f63d1a426e6f3534d1d7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a1ae53b6e2d75f63d1a426e6f3534d1d7">proj_cv_to_fem</a> (packed_state, fempsi, psi, mdims, cv_gidims, cv_funs, mspars, ndgln, igetct, x, mass_ele, mass_mn_pres, tracer, psi_ave, psi_int, activate_limiters)</td></tr>
<tr class="memdesc:a1ae53b6e2d75f63d1a426e6f3534d1d7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded Subroutine description: (1) determine FEMT (finite element wise) etc from T (control volume wise) (2) (optional) calculate psi_int (area) and psi_ave (barycentre) over each CV.  <br /></td></tr>
<tr class="separator:a1ae53b6e2d75f63d1a426e6f3534d1d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a548ad0b9f86ac7e85559962a298a834b" id="r_a548ad0b9f86ac7e85559962a298a834b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a548ad0b9f86ac7e85559962a298a834b">dg_derivs_all1</a> (femt, femtold, dtx_ele, dtoldx_ele, ndim, nphase, ncomp, totele, cv_ndgln, xcv_ndgln, x_nloc, x_ndgln, cv_ngi, cv_nloc, cvweight, n, nlx, nly, nlz, x_n, x_nlx, x_nly, x_nlz, x_nonods, x, y, z, nface, face_ele, cv_sloclist, x_sloclist, cv_snloc, x_snloc, wic_t_bc, suf_t_bc, sbcvngi, sbcvfen, sbweigh, x_sbcvfen, x_sbcvfenslx, x_sbcvfensly, get_gradu, state, p0mesh)</td></tr>
<tr class="memdesc:a548ad0b9f86ac7e85559962a298a834b"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates derivatives of vector fields  <br /></td></tr>
<tr class="separator:a548ad0b9f86ac7e85559962a298a834b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1de8526f025c7830c8e53ac5060b540e" id="r_a1de8526f025c7830c8e53ac5060b540e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a1de8526f025c7830c8e53ac5060b540e">dg_derivs_all2</a> (femt, femtold, dtx_ele, dtoldx_ele, ndim, nphase, totele, cv_ndgln, xcv_ndgln, x_nloc, x_ndgln, cv_ngi, cv_nloc, cvweight, n, nlx, nly, nlz, x_n, x_nlx, x_nly, x_nlz, x_nonods, x, y, z, nface, face_ele, cv_sloclist, x_sloclist, cv_snloc, x_snloc, wic_t_bc, suf_t_bc, sbcvngi, sbcvfen, sbweigh, x_sbcvfen, x_sbcvfenslx, x_sbcvfensly, p0mesh)</td></tr>
<tr class="memdesc:a1de8526f025c7830c8e53ac5060b540e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the derivatives of vector fields.  <br /></td></tr>
<tr class="separator:a1de8526f025c7830c8e53ac5060b540e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c099f85979288a8bda06b0dbf65ce4b" id="r_a6c099f85979288a8bda06b0dbf65ce4b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6c099f85979288a8bda06b0dbf65ce4b">diffus_cal_coeff</a> (diff_coef_divdx, diff_coefold_divdx, cv_nloc, mat_nloc, nphase, mat_ndgln, smatfen, scvfen, gi, ndim, tdiffusion, hdc, t_cv_nodj, t_cv_nodi, told_cv_nodj, told_cv_nodi, ele, ele2, cvnormx_all, loc_dtx_ele_all, loc_dtoldx_ele_all, loc2_dtx_ele_all, loc2_dtoldx_ele_all, loc_wic_t_bc, cv_other_loc, mat_other_loc, cv_snloc, cv_sloc2loc, on_domain_boundary, between_elements, has_anisotropic_diffusivity)</td></tr>
<tr class="memdesc:a6c099f85979288a8bda06b0dbf65ce4b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. It requires the derivatives of the field obtained using DG_DERIVS_ALL DG_DERIVS_ALL.  <br /></td></tr>
<tr class="separator:a6c099f85979288a8bda06b0dbf65ce4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abef6c88c50d350a8f4a9be0191a1f0c0" id="r_abef6c88c50d350a8f4a9be0191a1f0c0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#abef6c88c50d350a8f4a9be0191a1f0c0">linear_high_diffus_cal_coeff_stress_or_tensor</a> (stress_ij_ele_ext, s_inv_nnx_mat12, stress_form, stress_form_stab, zero_or_two_thirds, u_snloc, u_nloc, cv_snloc, nphase, sbufen_reversed, sbcvfen_reversed, sdetwei, sbcvngi, ndim, sloc_udiffusion, sloc_udiffusion_vol, sloc2_udiffusion, sloc2_udiffusion_vol, diff_gi_added, on_boundary, snormxn_all)</td></tr>
<tr class="memdesc:abef6c88c50d350a8f4a9be0191a1f0c0"><td class="mdescLeft">&#160;</td><td class="mdescRight">This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between element contributions. based on a high order scheme. The matrix S_INV_NNX_MAT12 is used to calculate the rows of the matrix with STRESS_IJ_ELE_EXT. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity.  <br /></td></tr>
<tr class="separator:abef6c88c50d350a8f4a9be0191a1f0c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7ba4bc947f32d4cea21ddc4cef46033" id="r_ae7ba4bc947f32d4cea21ddc4cef46033"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ae7ba4bc947f32d4cea21ddc4cef46033">calc_stress_ten</a> (stress_ij, zero_or_two_thirds, ndim, ufenx_iloc, ufenx_jloc, ten_xx, ten_vol)</td></tr>
<tr class="memdesc:ae7ba4bc947f32d4cea21ddc4cef46033"><td class="mdescLeft">&#160;</td><td class="mdescRight">determine stress form of viscocity...  <br /></td></tr>
<tr class="separator:ae7ba4bc947f32d4cea21ddc4cef46033"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84ebab4afe58323322b98d8539e18ff8" id="r_a84ebab4afe58323322b98d8539e18ff8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a84ebab4afe58323322b98d8539e18ff8">calc_stress_ten_reduce</a> (stress_ij, zero_or_two_thirds, ndim, fen_ten_xx, fen_ten_vol, ufenx_jloc)</td></tr>
<tr class="memdesc:a84ebab4afe58323322b98d8539e18ff8"><td class="mdescLeft">&#160;</td><td class="mdescRight">determine stress form of viscocity...  <br /></td></tr>
<tr class="separator:a84ebab4afe58323322b98d8539e18ff8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7413ef4bcb969bf21f6beb7aba061e8e" id="r_a7413ef4bcb969bf21f6beb7aba061e8e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a7413ef4bcb969bf21f6beb7aba061e8e">cal_lim_vol_adjust</a> (tmin_store, tmin, t, tmin_nod, reset_store, mass_cv, cv_nodi_ipha, cv_nodj_ipha, iphase, cv_nonods, income)</td></tr>
<tr class="memdesc:a7413ef4bcb969bf21f6beb7aba061e8e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Adjust TMIN to take into account different sized CV's. if RESET_STORE then reset TMIN to orginal values.  <br /></td></tr>
<tr class="separator:a7413ef4bcb969bf21f6beb7aba061e8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a24da0795bb0073e26720f411ded816b6" id="r_a24da0795bb0073e26720f411ded816b6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a24da0795bb0073e26720f411ded816b6">dgsimplnorm_all</a> (nloc, snloc, ndim, xl_all, xsl_all, normx_all)</td></tr>
<tr class="memdesc:a24da0795bb0073e26720f411ded816b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))  <br /></td></tr>
<tr class="separator:a24da0795bb0073e26720f411ded816b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf4f6cf3db5049a9a7f73a113bea3921" id="r_adf4f6cf3db5049a9a7f73a113bea3921"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#adf4f6cf3db5049a9a7f73a113bea3921">dgsimplnorm</a> (ele, siloc2iloc, nloc, snloc, xondgl, x, y, z, normx, normy, normz)</td></tr>
<tr class="memdesc:adf4f6cf3db5049a9a7f73a113bea3921"><td class="mdescLeft">&#160;</td><td class="mdescRight">Form approximate surface normal (NORMX,NORMY,NORMZ)  <br /></td></tr>
<tr class="separator:adf4f6cf3db5049a9a7f73a113bea3921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3af4784ad37e42f3ede076507c5704bb" id="r_a3af4784ad37e42f3ede076507c5704bb"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb">isotropic_limiter_all</a> (t_all, told_all, t2_all, t2old_all, den_all, denold_all, igot_t2, nphase, cv_nonods, nsmall_colm, small_centrm, small_findrm, small_colm, stotel, cv_snloc, cv_sndgln, suf_t_bc_all, suf_t2_bc_all, suf_d_bc_all, wic_t_bc_all, wic_t2_bc_all, wic_d_bc_all, mass_cv, toldupwind_mat_all, denoldupwind_mat_all, t2oldupwind_mat_all, tupwind_mat_all, denupwind_mat_all, t2upwind_mat_all)</td></tr>
<tr class="memdesc:a3af4784ad37e42f3ede076507c5704bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the limited values at the interface, not as generic as the anisotropic one and never used actually...  <br /></td></tr>
<tr class="separator:a3af4784ad37e42f3ede076507c5704bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8eb89cd41fa936c21d77e9277c24ff38" id="r_a8eb89cd41fa936c21d77e9277c24ff38"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38">calc_sele</a> (ele, ele3, sele, cv_siloc, cv_iloc, u_sloc2loc, cv_sloc2loc, face_ele, gi, cv_funs, mdims, cv_gidims, cv_ndgln, u_ndgln, cv_sndgln, u_sndgln)</td></tr>
<tr class="memdesc:a8eb89cd41fa936c21d77e9277c24ff38"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face on the boundary of the domain.  <br /></td></tr>
<tr class="separator:a8eb89cd41fa936c21d77e9277c24ff38"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca35d740c637f0177d867e8a10cec8ef" id="r_aca35d740c637f0177d867e8a10cec8ef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aca35d740c637f0177d867e8a10cec8ef">put_in_ct_rhs</a> (get_c_in_cv_advdif_and_calc_c_cv, ct_rhs_phase_cv_nodi, ct_rhs_phase_cv_nodj, final_phase, mdims, cv_funs, ndgln, mmat, gi, between_elements, on_domain_boundary, ele, ele2, sele, hdc, mass_ele, jcount_kloc, jcount_kloc2, icount_kloc, icount_kloc2, c_jcount_kloc, c_jcount_kloc2, c_icount_kloc, c_icount_kloc2, u_other_loc, u_sloc2loc, cv_sloc2loc, scvdetwei, cvnormx_all, den_all, cv_nodi, cv_nodj, wic_u_bc_all, wic_p_bc_all, suf_p_bc_all, ugi_coef_ele_all, ugi_coef_ele2_all, ndotq, ndotqold, limt, limdt, limdtold, limt_hat, ndotq_hat, ftheta_t2, one_m_ftheta_t2old, ftheta_t2_j, one_m_ftheta_t2old_j, integrate_other_side_and_not_boundary, loc_u, theta_vel, udgi_imp_all, rcon, rcon_j, ndotq_imp, x_all, suf_d_bc_all, gravty)</td></tr>
<tr class="memdesc:aca35d740c637f0177d867e8a10cec8ef"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT, MmatCT_RHS It also computes the gradient matrix using the DCVFE method.  <br /></td></tr>
<tr class="separator:aca35d740c637f0177d867e8a10cec8ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b9fcfd8bbef480150a7ebc72fccacff" id="r_a9b9fcfd8bbef480150a7ebc72fccacff"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff">calc_anisotrop_lim</a> (mmat, t_all, told_all, den_all, denold_all, t2_all, t2old_all, femt_all, femtold_all, femden_all, femdenold_all, femt2_all, femt2old_all, use_femt, tupwind_mat_all, toldupwind_mat_all, denupwind_mat_all, denoldupwind_mat_all, t2upwind_mat_all, t2oldupwind_mat_all, igot_t2, nphase, cv_nonods, cv_nloc, totele, cv_ndgln, small_findrm, small_centrm, small_colm, nsmall_colm, x_ndgln, x_nonods, ndim, x_all, xc_cv_all, use_reflect)</td></tr>
<tr class="memdesc:a9b9fcfd8bbef480150a7ebc72fccacff"><td class="mdescLeft">&#160;</td><td class="mdescRight">For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine FINPTS or IFINPTS; the upwind value for each node pair is stored in the matrices TUPWIND AND.  <br /></td></tr>
<tr class="separator:a9b9fcfd8bbef480150a7ebc72fccacff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a796bc5ddad90b88fcb185a3fc5da03ba" id="r_a796bc5ddad90b88fcb185a3fc5da03ba"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba">triloccords</a> (xp, yp, zp, n1, n2, n3, n4, x1, y1, z1, x2, y2, z2, x3, y3, z3, x4, y4, z4)</td></tr>
<tr class="separator:a796bc5ddad90b88fcb185a3fc5da03ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19bc7cfcb7c297d93ce7edd0658eeb22" id="r_a19bc7cfcb7c297d93ce7edd0658eeb22"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22">triloccords2d</a> (xp, yp, n1, n2, n3, x1, y1, x2, y2, x3, y3)</td></tr>
<tr class="separator:a19bc7cfcb7c297d93ce7edd0658eeb22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afc50adcb66253565fe9c7a83244430a7" id="r_afc50adcb66253565fe9c7a83244430a7"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#afc50adcb66253565fe9c7a83244430a7">shock_front_in_ele</a> (ele, mdims, sat, ndgln, imble_frac)</td></tr>
<tr class="memdesc:afc50adcb66253565fe9c7a83244430a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects whether the element has a shockfront or not.  <br /></td></tr>
<tr class="separator:afc50adcb66253565fe9c7a83244430a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e92f04a2ef0257a47a96daebf15cbb5" id="r_a8e92f04a2ef0257a47a96daebf15cbb5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a8e92f04a2ef0257a47a96daebf15cbb5">generate_laplacian_system</a> (mdims, packed_state, ndgln, mmat, mspars, cv_funs, cv_gidims, sigma_field, solution, k_fields, f_fields, intface_val_type)</td></tr>
<tr class="memdesc:a8e92f04a2ef0257a47a96daebf15cbb5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error.  <br /></td></tr>
<tr class="separator:a8e92f04a2ef0257a47a96daebf15cbb5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa543dc448a797694ce8751b3a8cfdde3" id="r_aa543dc448a797694ce8751b3a8cfdde3"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3">scvdetnx</a> (mdims, ndgln, x_all, cv_funs, cv_gidims, on_domain_boundary, between_elements, ele, gi, scvdetwei, cvnormx_all, xc_all, x_nod, x_nodj)</td></tr>
<tr class="separator:aa543dc448a797694ce8751b3a8cfdde3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7335aa20cf26620a8e0fefcb9be90fac" id="r_a7335aa20cf26620a8e0fefcb9be90fac"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac">saturation_assemb</a> (state, packed_state, final_phase, mdims, cv_gidims, cv_funs, mspars, ndgln, mdisopt, mmat, upwnd, saturation, sat_prev, velocity, density, den_all, denold_all, dt, suf_sig_diagten_bc, cv_p, sourct_all, volfra_pore, vad_parameter, phase_with_pc, eles_with_pipe, pipes_aux, nonlinear_iteration, assemble_collapsed_to_one_phase, getresidual)</td></tr>
<tr class="separator:a7335aa20cf26620a8e0fefcb9be90fac"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a939c43361c098c807280c739e30b5370" id="r_a939c43361c098c807280c739e30b5370"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a939c43361c098c807280c739e30b5370">wic_t_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:a939c43361c098c807280c739e30b5370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f50cabe5b0bcd1018205e2d6f15f3ff" id="r_a8f50cabe5b0bcd1018205e2d6f15f3ff"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a8f50cabe5b0bcd1018205e2d6f15f3ff">wic_t_bc_robin</a> = 2</td></tr>
<tr class="separator:a8f50cabe5b0bcd1018205e2d6f15f3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29adecab6c33872a56cf4775b4e1c3e3" id="r_a29adecab6c33872a56cf4775b4e1c3e3"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a29adecab6c33872a56cf4775b4e1c3e3">wic_t_bc_diri_adv_and_robin</a> = 3</td></tr>
<tr class="separator:a29adecab6c33872a56cf4775b4e1c3e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa646dbddd6308ea78c1c05d5b51c4d22" id="r_aa646dbddd6308ea78c1c05d5b51c4d22"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aa646dbddd6308ea78c1c05d5b51c4d22">wic_d_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:aa646dbddd6308ea78c1c05d5b51c4d22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ceb6fac2898be0cae2d603d5226f631" id="r_a7ceb6fac2898be0cae2d603d5226f631"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a7ceb6fac2898be0cae2d603d5226f631">wic_u_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:a7ceb6fac2898be0cae2d603d5226f631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6309cc2d2e0e51146784619230b6e70a" id="r_a6309cc2d2e0e51146784619230b6e70a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6309cc2d2e0e51146784619230b6e70a">wic_u_bc_robin</a> = 2</td></tr>
<tr class="separator:a6309cc2d2e0e51146784619230b6e70a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87709ec60fd78f0870ce18b9bbf7eb8" id="r_ab87709ec60fd78f0870ce18b9bbf7eb8"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ab87709ec60fd78f0870ce18b9bbf7eb8">wic_u_bc_diri_adv_and_robin</a> = 3</td></tr>
<tr class="separator:ab87709ec60fd78f0870ce18b9bbf7eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03129ee41533b2c78d1ec116019892fa" id="r_a03129ee41533b2c78d1ec116019892fa"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a03129ee41533b2c78d1ec116019892fa">wic_u_bc_dirichlet_inout</a> = 2</td></tr>
<tr class="separator:a03129ee41533b2c78d1ec116019892fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03647ce996f35f7512f2206c2a4bc8d4" id="r_a03647ce996f35f7512f2206c2a4bc8d4"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a03647ce996f35f7512f2206c2a4bc8d4">wic_p_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:a03647ce996f35f7512f2206c2a4bc8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d139b0bd7722182c16855e683657878" id="r_a6d139b0bd7722182c16855e683657878"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6d139b0bd7722182c16855e683657878">wic_p_bc_free</a> = 2</td></tr>
<tr class="separator:a6d139b0bd7722182c16855e683657878"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains all the tools to assemble and solve the equations and fields associated with the CV mesh, i.e. transport equation, continuity equation, DCVFE gradient matrix and the Laplacian system for the zeta-potential. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a7413ef4bcb969bf21f6beb7aba061e8e" name="a7413ef4bcb969bf21f6beb7aba061e8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7413ef4bcb969bf21f6beb7aba061e8e">&#9670;&#160;</a></span>cal_lim_vol_adjust()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::cal_lim_vol_adjust </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>tmin_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>tmin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>t</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>tmin_nod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>reset_store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mass_cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nodi_ipha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nodj_ipha</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>income</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Adjust TMIN to take into account different sized CV's. if RESET_STORE then reset TMIN to orginal values. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a7413ef4bcb969bf21f6beb7aba061e8e_icgraph.png" border="0" usemap="#anamespacecv__advection_a7413ef4bcb969bf21f6beb7aba061e8e_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a7413ef4bcb969bf21f6beb7aba061e8e_icgraph" id="anamespacecv__advection_a7413ef4bcb969bf21f6beb7aba061e8e_icgraph">
<area shape="rect" title="Adjust TMIN to take into account different sized CV&#39;s. if RESET_STORE then reset TMIN to orginal valu..." alt="" coords="1727,208,1889,248"/>
<area shape="rect" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="1507,208,1679,248"/>
<area shape="poly" title=" " alt="" coords="1713,231,1679,231,1679,225,1713,225"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a9b9fcfd8bbef480150a7ebc72fccacff" name="a9b9fcfd8bbef480150a7ebc72fccacff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b9fcfd8bbef480150a7ebc72fccacff">&#9670;&#160;</a></span>calc_anisotrop_lim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::calc_anisotrop_lim </td>
          <td>(</td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>told_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>denold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,:), intent(in), pointer&#160;</td>
          <td class="paramname"><em>t2_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,:), intent(in), pointer&#160;</td>
          <td class="paramname"><em>t2old_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(in)&#160;</td>
          <td class="paramname"><em>femt_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(in)&#160;</td>
          <td class="paramname"><em>femtold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(in)&#160;</td>
          <td class="paramname"><em>femden_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(in)&#160;</td>
          <td class="paramname"><em>femdenold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(in)&#160;</td>
          <td class="paramname"><em>femt2_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :), intent(in)&#160;</td>
          <td class="paramname"><em>femt2old_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_femt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>tupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>toldupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denoldupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>t2upwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>t2oldupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>small_findrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>small_centrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>small_colm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsmall_colm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(: ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(in)&#160;</td>
          <td class="paramname"><em>x_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, cv_nonods), intent(in)&#160;</td>
          <td class="paramname"><em>xc_cv_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_reflect</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine FINPTS or IFINPTS; the upwind value for each node pair is stored in the matrices TUPWIND AND. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_cgraph.png" border="0" usemap="#anamespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_cgraph" id="anamespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_cgraph">
<area shape="rect" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="5,112,148,152"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a14dc6f577accb38a103267b20d5c20d5" title=": Work out the shape functions and their derivatives..." alt="" coords="212,17,380,57"/>
<area shape="poly" title=" " alt="" coords="123,109,235,60,237,65,125,114"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="204,94,388,119"/>
<area shape="poly" title=" " alt="" coords="148,121,190,116,191,122,149,126"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="196,143,396,169"/>
<area shape="poly" title=" " alt="" coords="149,137,183,141,182,146,148,142"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#adfb350be9f5aab4de3a36c3719c8c975" title=": This sub calculates the local corrds L1, L2, L3, L4 and weights at the quadrature points...." alt="" coords="212,193,380,233"/>
<area shape="poly" title=" " alt="" coords="125,150,197,179,218,186,216,191,195,184,123,155"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a20883fea5c4c41ce4742fa1aee305ed6" title=": Work out the shape functions and their derivatives..." alt="" coords="445,5,613,45"/>
<area shape="poly" title=" " alt="" coords="380,30,432,28,432,33,381,36"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ac67c2ff971dd5f7bbfd22a1c1d22eacc" title="Generates the shape functions of a cubic triangle." alt="" coords="663,5,831,45"/>
<area shape="poly" title=" " alt="" coords="614,23,649,23,649,28,614,28"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="444,94,615,119"/>
<area shape="poly" title=" " alt="" coords="388,104,430,104,430,109,388,109"/>
<area shape="poly" title=" " alt="" coords="494,96,486,86,490,76,505,70,529,67,559,71,571,80,568,84,557,76,529,73,506,75,494,80,492,85,498,92"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#af4782b913aba9aef1af79d9db7c1739a" title=" " alt="" coords="445,168,613,208"/>
<area shape="poly" title=" " alt="" coords="390,166,432,172,431,177,389,171"/>
<area shape="poly" title=" " alt="" coords="489,168,486,158,493,149,507,143,529,141,555,144,568,152,566,156,553,149,529,147,509,149,496,153,492,159,494,167"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_icgraph.png" border="0" usemap="#anamespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_icgraph" id="anamespacecv__advection_a9b9fcfd8bbef480150a7ebc72fccacff_icgraph">
<area shape="rect" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="1507,208,1649,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a8eb89cd41fa936c21d77e9277c24ff38" name="a8eb89cd41fa936c21d77e9277c24ff38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8eb89cd41fa936c21d77e9277c24ff38">&#9670;&#160;</a></span>calc_sele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::calc_sele </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ele3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>sele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>cv_siloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_iloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>u_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>face_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_sndgln</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face on the boundary of the domain. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a8eb89cd41fa936c21d77e9277c24ff38_icgraph.png" border="0" usemap="#anamespacecv__advection_a8eb89cd41fa936c21d77e9277c24ff38_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a8eb89cd41fa936c21d77e9277c24ff38_icgraph" id="anamespacecv__advection_a8eb89cd41fa936c21d77e9277c24ff38_icgraph">
<area shape="rect" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="1507,225,1683,250"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,125,1459,150"/>
<area shape="poly" title=" " alt="" coords="1550,221,1393,153,1396,148,1552,216"/>
<area shape="rect" href="namespacecv__advection.html#a8e92f04a2ef0257a47a96daebf15cbb5" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1277,281,1451,321"/>
<area shape="poly" title=" " alt="" coords="1535,256,1438,284,1436,279,1534,251"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="1273,217,1455,257"/>
<area shape="poly" title=" " alt="" coords="1493,240,1455,240,1455,235,1493,235"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,60,977,100"/>
<area shape="poly" title=" " alt="" coords="1255,126,1221,121,977,94,977,88,1222,116,1256,120"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,175,1221,215"/>
<area shape="poly" title=" " alt="" coords="1299,156,1212,177,1211,172,1297,151"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,117,707,157"/>
<area shape="poly" title=" " alt="" coords="1256,140,707,140,707,135,1256,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,5,1219,45"/>
<area shape="poly" title=" " alt="" coords="1325,120,1220,68,1176,48,1179,43,1222,63,1327,116"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,80,615,86,540,94,466,108,409,126,358,149,356,144,407,122,465,103,539,89,615,80,754,74"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1043,220,990,229,911,235,830,237,671,228,527,210,411,189,412,184,528,204,672,222,830,231,911,230,989,224,1042,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,175,989,215"/>
<area shape="poly" title=" " alt="" coords="1024,197,990,197,990,192,1024,192"/>
<area shape="poly" title=" " alt="" coords="741,191,417,174,418,169,741,185"/>
<area shape="poly" title=" " alt="" coords="758,175,686,160,687,155,759,169"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,286,685,341"/>
<area shape="poly" title=" " alt="" coords="811,223,654,288,652,284,809,218"/>
<area shape="poly" title=" " alt="" coords="452,155,418,158,417,153,451,149"/>
<area shape="poly" title=" " alt="" coords="493,283,464,269,398,228,344,189,347,185,401,224,467,264,496,278"/>
<area shape="poly" title=" " alt="" coords="1025,19,909,16,767,20,691,27,615,38,539,53,466,75,431,90,397,109,344,149,341,144,395,105,428,85,464,69,538,48,614,32,691,21,767,14,909,10,1026,14"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="776,289,968,329"/>
<area shape="poly" title=" " alt="" coords="1259,255,969,298,968,293,1258,250"/>
<area shape="poly" title=" " alt="" coords="762,314,685,315,685,309,762,308"/>
</map>
</div>

</div>
</div>
<a id="ae7ba4bc947f32d4cea21ddc4cef46033" name="ae7ba4bc947f32d4cea21ddc4cef46033"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7ba4bc947f32d4cea21ddc4cef46033">&#9670;&#160;</a></span>calc_stress_ten()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::calc_stress_ten </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :, :  ), intent(inout)&#160;</td>
          <td class="paramname"><em>stress_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>zero_or_two_thirds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ufenx_iloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ufenx_jloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :,: ), intent(in)&#160;</td>
          <td class="paramname"><em>ten_xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ten_vol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determine stress form of viscocity... </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_ae7ba4bc947f32d4cea21ddc4cef46033_icgraph.png" border="0" usemap="#anamespacecv__advection_ae7ba4bc947f32d4cea21ddc4cef46033_icgraph" alt=""/></div>
<map name="anamespacecv__advection_ae7ba4bc947f32d4cea21ddc4cef46033_icgraph" id="anamespacecv__advection_ae7ba4bc947f32d4cea21ddc4cef46033_icgraph">
<area shape="rect" title="determine stress form of viscocity..." alt="" coords="936,5,1079,45"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="922,22,888,20,723,20,675,22,675,16,723,15,888,15,922,16"/>
<area shape="rect" href="namespacecv__advection.html#abef6c88c50d350a8f4a9be0191a1f0c0" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="723,30,888,85"/>
<area shape="poly" title=" " alt="" coords="923,41,889,47,888,42,922,36"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
<area shape="poly" title=" " alt="" coords="709,47,674,42,675,37,710,42"/>
</map>
</div>

</div>
</div>
<a id="a84ebab4afe58323322b98d8539e18ff8" name="a84ebab4afe58323322b98d8539e18ff8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84ebab4afe58323322b98d8539e18ff8">&#9670;&#160;</a></span>calc_stress_ten_reduce()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::calc_stress_ten_reduce </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, ndim  ), intent(inout)&#160;</td>
          <td class="paramname"><em>stress_ij</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>zero_or_two_thirds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, ndim ), intent(in)&#160;</td>
          <td class="paramname"><em>fen_ten_xx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim ), intent(in)&#160;</td>
          <td class="paramname"><em>fen_ten_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim ), intent(in)&#160;</td>
          <td class="paramname"><em>ufenx_jloc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>determine stress form of viscocity... </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a84ebab4afe58323322b98d8539e18ff8_icgraph.png" border="0" usemap="#anamespacecv__advection_a84ebab4afe58323322b98d8539e18ff8_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a84ebab4afe58323322b98d8539e18ff8_icgraph" id="anamespacecv__advection_a84ebab4afe58323322b98d8539e18ff8_icgraph">
<area shape="rect" title="determine stress form of viscocity..." alt="" coords="936,13,1083,53"/>
<area shape="rect" href="namespacecv__advection.html#abef6c88c50d350a8f4a9be0191a1f0c0" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="723,5,888,60"/>
<area shape="poly" title=" " alt="" coords="922,35,888,35,888,30,922,30"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,13,675,53"/>
<area shape="poly" title=" " alt="" coords="709,35,675,35,675,30,709,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,417,35,417,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="a3bd456f4f3d098a36288e7ed4a6dbf6b" name="a3bd456f4f3d098a36288e7ed4a6dbf6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bd456f4f3d098a36288e7ed4a6dbf6b">&#9670;&#160;</a></span>cv_assemb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::cv_assemb </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout), target&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), target&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>diag_scale_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>diag_scale_pres_coup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>inv_b</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), target&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_disopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_dg_vel_int_opt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cv_theta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>cv_beta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>deriv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>sourct_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in), pointer&#160;</td>
          <td class="paramname"><em>absorbt_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>getcv_disc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>getct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>one_m_theta_flux_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>theta_gdiff</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mean_pore_cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mean_pore_cv_total</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_mn_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>thermal</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>got_free_surf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_suf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>mass_ele_transp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(in), optional&#160;</td>
          <td class="paramname"><em>tdiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>vad_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>phase_with_pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>courant_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional&#160;</td>
          <td class="paramname"><em>calculate_mass_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(in), optional&#160;</td>
          <td class="paramname"><em>porous_heat_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(in), optional&#160;</td>
          <td class="paramname"><em>porous_heat_coef_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>solving_compositional</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>assemble_collapsed_to_one_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutines generates the transport equation for a cv field. It also can generate the Continuity equation if GETCT = .true. and also generate the gradient matrix of the momentum equation for the DCVFE method if the option is activated. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">final_phase</td><td>This is the final phase to be assembled, in this way we can assemble from phase 1 to final_phase not necessarily being for all the phases </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">FE_GIdims</td><td>Gauss integration numbers for FE fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">FE_funs</td><td>Shape functions for the FE mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">tracer</td><td>Tracer considered for the transport equation </td></tr>
    <tr><td class="paramname">density</td><td>Density of the field </td></tr>
    <tr><td class="paramname">velocity</td><td>Velocity of the field </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">CV_DISOPT,CV_DG_VEL_INT_OPT,IGOT_THETA_FLUX.</td><td>More Discretisation options </td></tr>
    <tr><td class="paramname">IGOT_T2.</td><td>True (1) if solving for a tracer, false otherwise </td></tr>
    <tr><td class="paramname">DIAG_SCALE_PRES</td><td>Diagonal scaling of (distributed) pressure matrix (used to treat pressure implicitly) </td></tr>
    <tr><td class="paramname">DIAG_SCALE_PRES_COUP</td><td>Diagonal scaling of (distributed) pressure matrix (for wells) </td></tr>
    <tr><td class="paramname">INV_B</td><td>Coupling term of the wells </td></tr>
    <tr><td class="paramname">MASS_MN_PRES</td><td>?? </td></tr>
    <tr><td class="paramname">MASS_SUF</td><td>?? </td></tr>
    <tr><td class="paramname">DEN_ALL</td><td>Density of the field, different memory to the input field density, used to apply the Boussinesq approximation </td></tr>
    <tr><td class="paramname">DENOLD_ALL</td><td>Density of the field, different memory to the input field density, used to apply the Boussinesq approximation </td></tr>
    <tr><td class="paramname">THETA_GDIFF</td><td>! (nphase,Mdimscv_nonods) </td></tr>
    <tr><td class="paramname">THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td></td></tr>
    <tr><td class="paramname">DT,CV_THETA,CV_BETA</td><td>Time step size and discretisation options </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC.</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">DERIV</td><td>Derivative of the density against the pressure (nphase,Mdimscv_nonods) </td></tr>
    <tr><td class="paramname">CV_P</td><td>! Control volume pressure, useless for the DCVFEM (1,Mdimsnpres,Mdimscv_nonods) </td></tr>
    <tr><td class="paramname">SOURCT_ALL</td><td>Source term of the tracer equation </td></tr>
    <tr><td class="paramname">ABSORBT_ALL</td><td>Absorption to be used here </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">GETCV_DISC</td><td>obtain the transport equation </td></tr>
    <tr><td class="paramname">GETCT</td><td>obtain the continuity equation </td></tr>
    <tr><td class="paramname">GET_THETA_FLUX,USE_THETA_FLUX,got_free_surf???</td><td></td></tr>
    <tr><td class="paramname">THERMAL</td><td>true if solving for heat transport </td></tr>
    <tr><td class="paramname">MEAN_PORE_CV</td><td>Porosity defined control volume wise </td></tr>
    <tr><td class="paramname">MASS_ELE_TRANSP</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">saturation</td><td>PhaseVolumeFraction field </td></tr>
    <tr><td class="paramname">TDIFFUSION</td><td>Diffusion associated with the tracer field </td></tr>
    <tr><td class="paramname">Phase_with_Pc</td><td>Field that defines the capillary pressure, i.e. non-wetting phase </td></tr>
    <tr><td class="paramname">VAD_parameter</td><td>Vanishing artificial diffusion parameter </td></tr>
    <tr><td class="paramname">Courant_number</td><td>Obvious ins't it? </td></tr>
    <tr><td class="paramname">Permeability_tensor_field</td><td>Permeability field </td></tr>
    <tr><td class="paramname">calculate_mass_delta</td><td>Variable used to control the mass conservation of the system </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">porous_heat_coef,porous_heat_coef_old</td><td>includes an average of porous and fluid heat coefficients </td></tr>
    <tr><td class="paramname">solving_compositional</td><td>Solving for composition if true </td></tr>
    <tr><td class="paramname">assemble_collapsed_to_one_phase</td><td>Collapses phases and solves for one single temperature. When there is thermal equilibrium </td></tr>
    <tr><td class="paramname">outfluxes</td><td>Contains all the fields required to compute the outfluxes of the model and create the outfluxes.csv file. Computed when assembling the continuity equation </td></tr>
    <tr><td class="paramname">nonlinear_iteration</td><td>Current non-linear iteration </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_cgraph.png" border="0" usemap="#anamespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_cgraph" id="anamespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_cgraph">
<area shape="rect" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="5,957,195,982"/>
<area shape="rect" href="namespacemulti__data__types.html#afc114cd60fe43e349a9b7c9c8d30bba7" title="This subroutine allocates and initialises to zero all the arrays in a multi_shape_funs data type It u..." alt="" coords="259,20,453,60"/>
<area shape="poly" title=" " alt="" coords="99,956,104,795,112,669,124,529,142,386,166,254,181,196,199,145,218,102,241,70,246,65,250,69,245,74,223,105,204,147,187,198,171,255,147,387,129,529,117,670,110,796,104,956"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="265,84,447,124"/>
<area shape="poly" title=" " alt="" coords="99,956,107,807,129,562,148,432,172,311,202,210,221,171,241,141,253,130,256,134,245,144,225,174,207,212,177,312,153,433,135,563,112,807,104,956"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="285,199,427,239"/>
<area shape="poly" title=" " alt="" coords="100,956,110,826,136,615,155,504,178,400,207,315,223,281,241,256,255,243,271,233,274,238,258,247,245,259,228,284,212,317,183,402,160,505,141,616,116,826,105,957"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="535,263,719,289"/>
<area shape="poly" title=" " alt="" coords="99,956,109,831,133,633,151,528,175,432,205,355,222,325,241,303,261,291,288,282,359,271,441,267,521,268,521,273,441,272,360,276,290,287,263,296,244,307,226,328,210,357,180,434,157,529,138,633,114,832,105,957"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="527,313,727,338"/>
<area shape="poly" title=" " alt="" coords="100,956,111,839,136,654,155,557,178,469,207,397,223,370,241,350,278,325,318,308,362,298,406,293,492,295,565,307,565,312,492,301,406,298,363,303,320,313,280,330,244,354,227,373,211,400,183,471,160,559,141,655,116,839,105,957"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="261,365,451,390"/>
<area shape="poly" title=" " alt="" coords="100,956,114,848,142,680,161,592,184,511,210,444,225,419,241,399,247,394,251,398,245,403,229,422,215,447,189,513,166,593,147,681,119,849,105,957"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="268,414,444,439"/>
<area shape="poly" title=" " alt="" coords="100,956,116,857,145,704,165,624,187,551,213,491,241,450,254,440,257,444,245,454,217,493,192,553,170,625,150,705,121,857,106,957"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab14ee9b4425c63a84854359e22ea1007" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="255,464,457,504"/>
<area shape="poly" title=" " alt="" coords="99,956,102,880,108,824,120,762,137,696,162,630,196,568,241,514,245,510,249,514,245,518,201,571,167,632,142,697,125,763,114,825,107,881,104,956"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#af946f7e305f170666101ab84d86eed5e" title="This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with vo..." alt="" coords="257,528,455,568"/>
<area shape="poly" title=" " alt="" coords="100,956,108,891,129,792,148,737,172,682,202,630,241,585,256,573,259,577,245,589,207,633,176,684,153,739,135,793,113,892,105,957"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="521,683,732,723"/>
<area shape="poly" title=" " alt="" coords="99,956,106,894,127,803,145,753,169,706,201,663,241,628,271,611,299,600,326,594,352,594,406,606,470,628,486,637,496,648,505,658,519,668,533,675,531,680,516,673,501,662,492,651,483,641,468,633,405,611,352,600,327,600,301,605,274,616,244,633,205,667,174,709,150,755,132,804,112,895,105,957"/>
<area shape="rect" href="namespacemulti__data__types.html#ab256dfeac442756797e748a252de6ea0" title="This subroutine deallocates and nullifies all the fields inside multi_shape_funs." alt="" coords="251,707,461,747"/>
<area shape="poly" title=" " alt="" coords="104,955,122,918,152,866,191,811,215,786,241,763,262,750,265,755,244,767,219,790,196,815,156,869,127,920,109,957"/>
<area shape="rect" href="namespacecv__advection.html#a6c099f85979288a8bda06b0dbf65ce4b" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="280,821,432,861"/>
<area shape="poly" title=" " alt="" coords="115,955,169,914,241,871,266,861,268,866,244,876,172,918,118,959"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="534,821,719,846"/>
<area shape="poly" title=" " alt="" coords="105,955,124,923,153,881,193,839,216,821,242,807,285,792,331,783,378,781,424,783,510,796,578,814,577,819,509,801,423,788,378,786,332,789,287,797,244,812,219,826,197,843,158,884,128,926,110,958"/>
<area shape="rect" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="286,885,426,925"/>
<area shape="poly" title=" " alt="" coords="151,954,272,923,273,929,153,959"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="265,949,447,989"/>
<area shape="poly" title=" " alt="" coords="195,967,252,967,252,972,195,972"/>
<area shape="rect" href="namespacecopy__outof__state.html#ac1305d6f3dc1c1ec92a4135ea55947b9" title=": For a given field, retrieve the associated finite element field name" alt="" coords="243,1014,469,1039"/>
<area shape="poly" title=" " alt="" coords="158,979,243,999,286,1008,284,1014,242,1004,157,985"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="246,1063,466,1089"/>
<area shape="poly" title=" " alt="" coords="121,980,175,1014,244,1048,271,1057,269,1062,242,1053,172,1019,118,985"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab7c981b328d9950b1c375aaacaa3cda0" title=": Checks whether a field is constant or not" alt="" coords="279,1137,433,1177"/>
<area shape="poly" title=" " alt="" coords="115,980,168,1035,205,1067,244,1098,298,1129,295,1134,241,1102,201,1071,165,1038,111,984"/>
<area shape="rect" href="namespacecv__advection.html#a3af4784ad37e42f3ede076507c5704bb" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="270,1201,442,1241"/>
<area shape="poly" title=" " alt="" coords="108,981,125,1021,153,1077,193,1137,217,1164,244,1187,259,1196,256,1201,241,1191,213,1167,189,1140,148,1080,120,1023,103,983"/>
<area shape="rect" href="namespacecv__advection.html#aeeb08147b461c9b4e619c6a4afd37a68" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="271,1265,441,1305"/>
<area shape="poly" title=" " alt="" coords="106,982,119,1032,145,1105,163,1145,186,1184,213,1220,244,1251,260,1262,257,1266,241,1255,209,1223,182,1187,159,1147,140,1107,114,1034,101,983"/>
<area shape="rect" href="namespacecv__advection.html#a6ad3a63555367e6c0022730a76bb7df5" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="269,1330,443,1355"/>
<area shape="poly" title=" " alt="" coords="105,982,114,1043,136,1133,154,1183,178,1232,207,1277,244,1315,258,1325,255,1329,241,1319,203,1280,173,1234,149,1185,131,1135,108,1044,100,983"/>
<area shape="rect" href="namespacecv__advection.html#a1ae53b6e2d75f63d1a426e6f3534d1d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="285,643,427,683"/>
<area shape="poly" title=" " alt="" coords="102,955,115,906,141,835,160,797,183,759,210,723,241,693,271,675,274,680,244,697,214,727,187,762,165,799,146,837,120,908,107,957"/>
<area shape="rect" href="namespacemulti__tools.html#a00bc5585e5ce49ad92386eb4acca54ff" title=":This function is a tolerance function for strictly positive values used as a denominator...." alt="" coords="281,1403,431,1429"/>
<area shape="poly" title=" " alt="" coords="105,982,113,1048,135,1149,153,1206,177,1263,207,1317,245,1365,267,1383,292,1396,290,1401,264,1387,241,1369,203,1320,172,1265,148,1208,130,1151,108,1049,100,983"/>
<area shape="rect" href="namespacecv__advection.html#aca35d740c637f0177d867e8a10cec8ef" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="278,1453,434,1493"/>
<area shape="poly" title=" " alt="" coords="104,982,107,1060,112,1118,123,1183,141,1251,166,1319,200,1382,244,1438,267,1454,264,1458,241,1442,195,1385,161,1321,135,1253,118,1184,107,1119,101,1061,98,982"/>
<area shape="rect" href="namespacemulti__tools.html#ac71c1810848e09741781728153d5f34b" title=" " alt="" coords="281,1542,431,1567"/>
<area shape="poly" title=" " alt="" coords="104,982,105,1067,110,1132,121,1205,138,1283,163,1362,198,1437,220,1471,245,1504,265,1521,290,1535,287,1539,262,1526,241,1507,215,1474,193,1439,158,1363,132,1284,115,1206,105,1132,100,1068,98,982"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="268,1592,444,1632"/>
<area shape="poly" title=" " alt="" coords="105,982,118,1096,146,1276,165,1370,188,1457,215,1529,229,1556,245,1577,258,1588,254,1592,241,1581,225,1559,210,1531,183,1459,160,1372,141,1277,113,1097,100,983"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="269,1657,443,1682"/>
<area shape="poly" title=" " alt="" coords="105,982,115,1107,141,1307,159,1413,183,1510,211,1589,227,1620,245,1642,258,1653,255,1657,241,1646,223,1623,206,1592,178,1511,154,1414,135,1308,110,1108,100,983"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#abb4ec02f375fe02820f1bf733d8fb031" title="get the shape functions for a triangle/tetrahedron" alt="" coords="543,71,711,111"/>
<area shape="poly" title=" " alt="" coords="99,956,107,813,129,580,147,456,171,342,202,248,220,212,241,185,267,162,293,148,319,142,345,140,402,142,434,140,469,133,544,112,546,117,470,139,434,145,402,147,345,146,320,147,295,153,270,166,245,188,225,215,207,250,176,344,152,457,134,581,112,813,104,956"/>
<area shape="rect" href="namespacecv__advection.html#afc50adcb66253565fe9c7a83244430a7" title="Detects whether the element has a shockfront or not." alt="" coords="279,1731,433,1771"/>
<area shape="poly" title=" " alt="" coords="105,982,117,1114,144,1326,163,1440,186,1545,213,1632,229,1667,245,1693,260,1709,280,1722,277,1726,257,1713,241,1696,224,1669,208,1634,181,1546,158,1441,138,1327,112,1114,100,983"/>
<area shape="rect" href="namespacemulti__tools.html#a9bc979224e98f447e412133da3464728" title=":This function is a tolerance function for a value which is used as a denominator...." alt="" coords="285,1795,427,1821"/>
<area shape="poly" title=" " alt="" coords="104,982,111,1130,132,1372,150,1500,175,1619,206,1716,224,1753,245,1781,258,1791,273,1799,271,1803,255,1796,241,1785,220,1756,201,1718,170,1620,145,1501,127,1373,106,1130,99,983"/>
<area shape="rect" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="275,1845,437,1885"/>
<area shape="poly" title=" " alt="" coords="104,982,111,1138,119,1259,131,1394,149,1531,173,1657,188,1713,205,1761,224,1801,245,1832,263,1846,260,1851,241,1835,219,1804,200,1763,183,1714,168,1658,144,1532,126,1395,113,1260,105,1138,99,983"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0358bf9293883d5a332167bc0558b985" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="263,1909,449,1949"/>
<area shape="poly" title=" " alt="" coords="104,982,109,1147,116,1278,127,1423,145,1570,170,1707,185,1767,203,1820,222,1863,245,1896,253,1904,249,1907,241,1899,218,1866,198,1822,180,1769,164,1708,140,1571,122,1424,110,1278,103,1148,99,982"/>
<area shape="rect" href="namespacemulti__tools.html#ad2dc4462bad46ef99ca0057cb3c91262" title=":This function is a tolerance function for a vector which is used as a denominator...." alt="" coords="281,1974,431,1999"/>
<area shape="poly" title=" " alt="" coords="104,982,106,1159,112,1299,122,1455,139,1613,164,1759,180,1823,199,1879,220,1925,245,1959,270,1977,267,1981,241,1963,216,1928,194,1881,175,1825,159,1760,134,1613,117,1455,106,1299,101,1159,99,982"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a14dc6f577accb38a103267b20d5c20d5" title=": Work out the shape functions and their derivatives..." alt="" coords="543,199,711,239"/>
<area shape="poly" title=" " alt="" coords="427,216,529,216,529,221,427,221"/>
<area shape="poly" title=" " alt="" coords="428,231,553,258,552,263,427,236"/>
<area shape="poly" title=" " alt="" coords="392,237,450,268,518,298,547,307,546,312,516,302,448,272,390,241"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#adfb350be9f5aab4de3a36c3719c8c975" title=": This sub calculates the local corrds L1, L2, L3, L4 and weights at the quadrature points...." alt="" coords="543,135,711,175"/>
<area shape="poly" title=" " alt="" coords="427,199,529,175,530,180,428,205"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a20883fea5c4c41ce4742fa1aee305ed6" title=": Work out the shape functions and their derivatives..." alt="" coords="785,184,953,224"/>
<area shape="poly" title=" " alt="" coords="711,211,771,207,772,213,711,216"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#ac67c2ff971dd5f7bbfd22a1c1d22eacc" title="Generates the shape functions of a cubic triangle." alt="" coords="1003,124,1171,164"/>
<area shape="poly" title=" " alt="" coords="942,181,1000,165,1001,170,943,186"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="784,273,955,298"/>
<area shape="poly" title=" " alt="" coords="719,277,770,279,770,284,719,282"/>
<area shape="poly" title=" " alt="" coords="834,274,826,264,830,254,845,248,869,246,899,250,911,259,908,263,897,255,869,251,846,253,834,258,832,264,838,271"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a689cd7b7b9202b6f36f1c65e6dbc45fa" title="this subroutine generates the FE basis functions, weights and the derivatives of the shape functions ..." alt="" coords="527,555,726,595"/>
<area shape="poly" title=" " alt="" coords="456,555,514,561,513,566,455,560"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#abef213cc1ec9a2cb3cff9283a1019071" title="This subroutine calculates FINDGPTS,COLGPTS,NCOLGPTS which contains given a local node ILOC the Gauss..." alt="" coords="527,619,726,659"/>
<area shape="poly" title=" " alt="" coords="419,566,470,584,518,604,541,612,540,617,516,609,468,589,417,571"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a55f7da59b552d475085e9ae74e74f875" title="SHAPESV AND RELATED SUBRTS &amp; FUNCTIONS Shape functions associated with volume integration using both ..." alt="" coords="527,363,726,403"/>
<area shape="poly" title=" " alt="" coords="450,526,468,514,479,502,485,490,491,465,497,439,504,425,516,413,522,408,525,412,519,417,508,429,502,441,496,466,490,492,483,505,471,518,453,530"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a9c978f9224bd7a912e1ea02ced195e5d" title=": This subrt defines the sub&#45;control volume and FEM shape functions. Shape functions associated with ..." alt="" coords="543,427,711,467"/>
<area shape="poly" title=" " alt="" coords="440,525,468,514,492,495,516,476,531,469,533,474,519,481,495,499,471,518,442,530"/>
<area shape="rect" href="namespaceshape__functions__prototype.html#a327e5ef3b6b9241997dcf0c6f8cad2dd" title="This subroutine generates the FE basis functions, weights and the derivatives of the shape functions ..." alt="" coords="527,491,726,531"/>
<area shape="poly" title=" " alt="" coords="455,532,513,524,514,529,456,537"/>
<area shape="poly" title=" " alt="" coords="432,836,520,834,520,839,432,842"/>
<area shape="poly" title=" " alt="" coords="308,1138,306,1128,313,1118,330,1113,356,1111,386,1114,402,1121,400,1126,384,1119,356,1116,331,1118,316,1123,311,1129,314,1136"/>
<area shape="rect" href="namespacecv__advection.html#a7413ef4bcb969bf21f6beb7aba061e8e" title="Adjust TMIN to take into account different sized CV&#39;s. if RESET_STORE then reset TMIN to orginal valu..." alt="" coords="545,1201,708,1241"/>
<area shape="poly" title=" " alt="" coords="442,1219,532,1219,532,1224,442,1224"/>
<area shape="rect" href="namespacemulti__tools.html#a36357858a282e77361c8cf51e468dd8e" title=": The function computes NVDFUNNEW, the normalised value of the advected variable on the face of the c..." alt="" coords="517,1273,736,1298"/>
<area shape="poly" title=" " alt="" coords="441,1283,503,1283,503,1288,441,1288"/>
<area shape="poly" title=" " alt="" coords="427,670,508,682,507,688,426,676"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="552,747,701,787"/>
<area shape="poly" title=" " alt="" coords="428,675,471,692,485,703,495,713,505,723,519,732,540,742,538,747,516,737,501,727,491,716,482,707,468,697,426,680"/>
<area shape="poly" title=" " alt="" coords="315,1405,306,1395,310,1385,327,1379,356,1377,392,1381,402,1385,406,1391,402,1394,399,1389,391,1386,356,1382,328,1384,314,1389,311,1394,318,1401"/>
<area shape="poly" title=" " alt="" coords="315,1544,306,1534,310,1524,327,1517,356,1515,392,1519,402,1524,406,1530,402,1533,399,1528,391,1524,356,1521,328,1523,314,1528,311,1533,318,1540"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aee06170a27bb4dab883f8ef10ff1cba8" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="543,1649,711,1689"/>
<area shape="poly" title=" " alt="" coords="444,1667,529,1667,529,1672,444,1672"/>
<area shape="poly" title=" " alt="" coords="712,108,737,120,753,133,762,145,771,158,786,170,795,176,793,180,782,174,767,161,758,149,749,137,735,125,710,113"/>
<area shape="poly" title=" " alt="" coords="711,87,827,92,955,105,1010,118,1009,123,954,111,827,97,711,93"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a37c95193cd7ac8186d5e2a9359793013" title="order so that the 1st nodes are on the base of tet for a quadratic tet..." alt="" coords="785,5,953,45"/>
<area shape="poly" title=" " alt="" coords="701,68,781,46,782,52,703,73"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a91a5940ae1f635a9dbf21cc341de9d56" title="order so that the 1st nodes are on the base for a quadratic triangle..." alt="" coords="785,120,953,160"/>
<area shape="poly" title=" " alt="" coords="711,105,772,118,771,123,710,110"/>
<area shape="poly" title=" " alt="" coords="308,1731,306,1721,313,1712,330,1706,356,1704,386,1707,402,1714,400,1719,384,1712,356,1709,331,1711,316,1716,311,1722,314,1729"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_icgraph.png" border="0" usemap="#anamespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_icgraph" id="anamespacecv__advection_a3bd456f4f3d098a36288e7ed4a6dbf6b_icgraph">
<area shape="rect" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a6eaca115c05985fed5f9376ecce181d7" name="a6eaca115c05985fed5f9376ecce181d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6eaca115c05985fed5f9376ecce181d7">&#9670;&#160;</a></span>cv_count_faces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function cv_advection::cv_count_faces </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_ele_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( <a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a> ), intent(in), optional&#160;</td>
          <td class="paramname"><em>cv_gidims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine counts then number of faces in the control volume space. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_cgraph.png" border="0" usemap="#anamespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_cgraph" id="anamespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_cgraph">
<area shape="rect" title="This subroutine counts then number of faces in the control volume space." alt="" coords="5,5,180,45"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#ab67f9e4cfb5bde91ca11304d200aa5d2" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="228,5,404,45"/>
<area shape="poly" title=" " alt="" coords="181,23,214,23,214,28,181,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_icgraph.png" border="0" usemap="#anamespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_icgraph" id="anamespacecv__advection_a6eaca115c05985fed5f9376ecce181d7_icgraph">
<area shape="rect" title="This subroutine counts then number of faces in the control volume space." alt="" coords="1037,139,1212,179"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,70,989,110"/>
<area shape="poly" title=" " alt="" coords="1037,138,945,113,946,107,1039,133"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,70,417,110"/>
<area shape="poly" title=" " alt="" coords="1024,178,909,191,768,198,692,197,615,193,539,183,465,169,431,158,400,143,347,112,349,108,402,139,433,153,466,163,540,178,616,187,693,192,768,192,908,185,1023,173"/>
<area shape="poly" title=" " alt="" coords="821,66,767,43,706,25,639,13,586,8,533,12,466,25,405,46,353,72,351,67,403,41,465,19,532,7,586,3,640,7,707,19,769,38,823,62"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,34,707,74"/>
<area shape="poly" title=" " alt="" coords="741,76,707,72,707,67,742,71"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,99,685,153"/>
<area shape="poly" title=" " alt="" coords="741,109,686,116,685,111,741,104"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,70,171,110"/>
<area shape="poly" title=" " alt="" coords="205,93,171,93,171,87,205,87"/>
<area shape="poly" title=" " alt="" coords="452,75,418,79,417,74,451,69"/>
<area shape="poly" title=" " alt="" coords="473,114,417,106,418,101,474,108"/>
</map>
</div>

</div>
</div>
<a id="a548ad0b9f86ac7e85559962a298a834b" name="a548ad0b9f86ac7e85559962a298a834b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a548ad0b9f86ac7e85559962a298a834b">&#9670;&#160;</a></span>dg_derivs_all1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dg_derivs_all1 </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>femt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>femtold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>dtx_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>dtoldx_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ncomp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>xcv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_ngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cvweight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>nlx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>nly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>nlz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_nlx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_nly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_nlz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>face_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sloclist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sloclist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>wic_t_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_t_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sbcvngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>sbcvfen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>sbweigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sbcvfen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sbcvfenslx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sbcvfensly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_gradu</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>p0mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates derivatives of vector fields </p>

</div>
</div>
<a id="a1de8526f025c7830c8e53ac5060b540e" name="a1de8526f025c7830c8e53ac5060b540e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1de8526f025c7830c8e53ac5060b540e">&#9670;&#160;</a></span>dg_derivs_all2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dg_derivs_all2 </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>femt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>femtold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>dtx_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>dtoldx_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>totele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>xcv_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_ngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cvweight</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>nlx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>nly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>nlz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_nlx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_nly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_nlz</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>face_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sloclist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sloclist</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :,  :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>wic_t_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_t_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sbcvngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>sbcvfen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>sbweigh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sbcvfen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sbcvfenslx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_sbcvfensly</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>p0mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the derivatives of vector fields. </p>

</div>
</div>
<a id="adf4f6cf3db5049a9a7f73a113bea3921" name="adf4f6cf3db5049a9a7f73a113bea3921"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf4f6cf3db5049a9a7f73a113bea3921">&#9670;&#160;</a></span>dgsimplnorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dgsimplnorm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>siloc2iloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>xondgl</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>normx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>normy</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>normz</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Form approximate surface normal (NORMX,NORMY,NORMZ) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_adf4f6cf3db5049a9a7f73a113bea3921_icgraph.png" border="0" usemap="#anamespacecv__advection_adf4f6cf3db5049a9a7f73a113bea3921_icgraph" alt=""/></div>
<map name="anamespacecv__advection_adf4f6cf3db5049a9a7f73a113bea3921_icgraph" id="anamespacecv__advection_adf4f6cf3db5049a9a7f73a113bea3921_icgraph">
<area shape="rect" title="Form approximate surface normal (NORMX,NORMY,NORMZ)" alt="" coords="1279,77,1481,102"/>
<area shape="rect" href="interfacecv__advection_1_1dg__derivs__all.html#aa7c392cd9e1166c4ae9f67ef3ee4686b" title="calculates derivatives of vector fields" alt="" coords="1028,5,1207,45"/>
<area shape="poly" title=" " alt="" coords="1313,76,1200,48,1201,43,1314,71"/>
<area shape="rect" href="interfacecv__advection_1_1dg__derivs__all.html#ab3f5ebeda39122ba30a098212e228490" title="Computes the derivatives of vector fields." alt="" coords="1028,69,1207,109"/>
<area shape="poly" title=" " alt="" coords="1265,92,1207,92,1207,87,1265,87"/>
<area shape="rect" href="namespacemulti__surface__tension.html#abdbb49689046df472c9c0989687b8b5d" title="Calculate the surface tension force as a pressure force term: PLIKE_GRAD_SOU_COEF and PLIKE_GRAD_SOU_..." alt="" coords="1004,133,1231,173"/>
<area shape="poly" title=" " alt="" coords="1314,108,1201,136,1200,131,1313,103"/>
<area shape="rect" href="namespacemulti__surface__tension.html#ae26cb34b2b50706fd7111f4398270e50" title=" " alt="" coords="723,133,956,173"/>
<area shape="poly" title=" " alt="" coords="990,156,956,156,956,151,990,151"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,133,675,173"/>
<area shape="poly" title=" " alt="" coords="709,156,675,156,675,151,709,151"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,133,417,173"/>
<area shape="poly" title=" " alt="" coords="452,156,417,156,417,151,452,151"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,133,171,173"/>
<area shape="poly" title=" " alt="" coords="205,156,171,156,171,151,205,151"/>
</map>
</div>

</div>
</div>
<a id="a24da0795bb0073e26720f411ded816b6" name="a24da0795bb0073e26720f411ded816b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a24da0795bb0073e26720f411ded816b6">&#9670;&#160;</a></span>dgsimplnorm_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dgsimplnorm_all </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>xl_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>xsl_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim ), intent(inout)&#160;</td>
          <td class="paramname"><em>normx_all</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3)) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a24da0795bb0073e26720f411ded816b6_icgraph.png" border="0" usemap="#anamespacecv__advection_a24da0795bb0073e26720f411ded816b6_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a24da0795bb0073e26720f411ded816b6_icgraph" id="anamespacecv__advection_a24da0795bb0073e26720f411ded816b6_icgraph">
<area shape="rect" title="Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))" alt="" coords="723,13,948,38"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,5,675,45"/>
<area shape="poly" title=" " alt="" coords="709,28,675,28,675,23,709,23"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,417,45"/>
<area shape="poly" title=" " alt="" coords="452,28,417,28,417,23,452,23"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,45"/>
<area shape="poly" title=" " alt="" coords="205,28,171,28,171,23,205,23"/>
</map>
</div>

</div>
</div>
<a id="a6c099f85979288a8bda06b0dbf65ce4b" name="a6c099f85979288a8bda06b0dbf65ce4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6c099f85979288a8bda06b0dbf65ce4b">&#9670;&#160;</a></span>diffus_cal_coeff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::diffus_cal_coeff </td>
          <td>(</td>
          <td class="paramtype">real, dimension( nphase ), intent(inout)&#160;</td>
          <td class="paramname"><em>diff_coef_divdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(inout)&#160;</td>
          <td class="paramname"><em>diff_coefold_divdx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>mat_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mat_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>smatfen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>scvfen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>tdiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>t_cv_nodj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>t_cv_nodi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>told_cv_nodj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>told_cv_nodi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cvnormx_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, cv_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>loc_dtx_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, cv_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>loc_dtoldx_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, cv_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>loc2_dtx_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, cv_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>loc2_dtoldx_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>loc_wic_t_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mat_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_domain_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>between_elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>has_anisotropic_diffusivity</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on a non-linear method and a non-oscillating scheme. It requires the derivatives of the field obtained using DG_DERIVS_ALL DG_DERIVS_ALL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_cgraph.png" border="0" usemap="#anamespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_cgraph" id="anamespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_cgraph">
<area shape="rect" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="5,5,157,45"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="205,13,391,38"/>
<area shape="poly" title=" " alt="" coords="158,23,192,23,192,28,158,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_icgraph.png" border="0" usemap="#anamespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_icgraph" id="anamespacecv__advection_a6c099f85979288a8bda06b0dbf65ce4b_icgraph">
<area shape="rect" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX based on..." alt="" coords="1507,208,1659,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a72902394525a29d241353d21af94ec81" name="a72902394525a29d241353d21af94ec81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72902394525a29d241353d21af94ec81">&#9670;&#160;</a></span>find_other_side()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::find_other_side </td>
          <td>(</td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>u_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>mat_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>integrat_at_gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>xu_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>xu_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cvfem_on_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>x_share</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>finele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>colele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>distcontinuous_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC. CVFEM_ON_FACE(CV_KLOC,GI)=.TRUE. if CV_KLOC is on the face that GI is centred on. Look for these nodes on the other elements. ELE2=0 also when we are between elements but are trying to integrate across the middle of a CV. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a72902394525a29d241353d21af94ec81_icgraph.png" border="0" usemap="#anamespacecv__advection_a72902394525a29d241353d21af94ec81_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a72902394525a29d241353d21af94ec81_icgraph" id="anamespacecv__advection_a72902394525a29d241353d21af94ec81_icgraph">
<area shape="rect" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="1507,241,1647,281"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,219,1459,245"/>
<area shape="poly" title=" " alt="" coords="1493,252,1456,247,1456,242,1493,247"/>
<area shape="rect" href="namespacecv__advection.html#a8e92f04a2ef0257a47a96daebf15cbb5" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1277,269,1451,309"/>
<area shape="poly" title=" " alt="" coords="1493,275,1452,280,1451,275,1493,270"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1323,216,1178,147,988,66,937,48,938,43,990,62,1180,142,1326,211"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1260,220,1221,214,1222,209,1261,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,240,707,267,707,262,1255,235"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1295,251,1270,260,1223,285,1181,304,1179,299,1220,280,1268,255,1294,246"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="aa75b98e24eaf8dd45300f3c4b1c86fce" name="aa75b98e24eaf8dd45300f3c4b1c86fce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa75b98e24eaf8dd45300f3c4b1c86fce">&#9670;&#160;</a></span>find_other_side_fast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::find_other_side_fast </td>
          <td>(</td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>integrat_at_gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>x_ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cvfem_on_face</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>x_share</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>finele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>colele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>distcontinuous_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,GI)=.TRUE. if CV_KLOC is on the face that GI is centred on. Look for these nodes on the other elements. ELE2=0 also when we are between elements but are trying to integrate across the middle of a CV. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aa75b98e24eaf8dd45300f3c4b1c86fce_icgraph.png" border="0" usemap="#anamespacecv__advection_aa75b98e24eaf8dd45300f3c4b1c86fce_icgraph" alt=""/></div>
<map name="anamespacecv__advection_aa75b98e24eaf8dd45300f3c4b1c86fce_icgraph" id="anamespacecv__advection_aa75b98e24eaf8dd45300f3c4b1c86fce_icgraph">
<area shape="rect" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="1183,13,1323,53"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="952,13,1135,53"/>
<area shape="poly" title=" " alt="" coords="1169,35,1135,35,1135,30,1169,30"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="712,13,904,53"/>
<area shape="poly" title=" " alt="" coords="938,35,904,35,904,30,938,30"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="465,5,664,60"/>
<area shape="poly" title=" " alt="" coords="698,35,664,35,664,30,698,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="451,35,418,35,418,30,451,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="a8e92f04a2ef0257a47a96daebf15cbb5" name="a8e92f04a2ef0257a47a96daebf15cbb5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e92f04a2ef0257a47a96daebf15cbb5">&#9670;&#160;</a></span>generate_laplacian_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::generate_laplacian_system </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>sigma_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( scalar_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>k_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>f_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>intface_val_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">Sigma_field</td><td>Coefficient multipliying the left-hand side term </td></tr>
    <tr><td class="paramname">Solution</td><td>Solution field of type scalar_field, required to ensure consistency </td></tr>
    <tr><td class="paramname">K_fields</td><td>Coefficients multipliying the RHS terms </td></tr>
    <tr><td class="paramname">F_fields</td><td>RHS fierlds </td></tr>
    <tr><td class="paramname">intface_val_type</td><td>0 = no interpolation; 1 Harmonic mean; !20 for SP solver, harmonic mean considering charge; negative normal mean </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a8e92f04a2ef0257a47a96daebf15cbb5_cgraph.png" border="0" usemap="#anamespacecv__advection_a8e92f04a2ef0257a47a96daebf15cbb5_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a8e92f04a2ef0257a47a96daebf15cbb5_cgraph" id="anamespacecv__advection_a8e92f04a2ef0257a47a96daebf15cbb5_cgraph">
<area shape="rect" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="5,105,180,145"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="238,5,429,31"/>
<area shape="poly" title=" " alt="" coords="119,102,168,70,227,40,248,32,250,37,229,44,171,75,122,107"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="245,55,421,80"/>
<area shape="poly" title=" " alt="" coords="177,102,266,81,267,86,178,107"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="228,105,439,145"/>
<area shape="poly" title=" " alt="" coords="180,122,214,122,214,127,180,127"/>
<area shape="rect" href="namespacecv__advection.html#a72902394525a29d241353d21af94ec81" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC, U_OTHER_LOC...." alt="" coords="263,169,403,209"/>
<area shape="poly" title=" " alt="" coords="169,142,251,164,249,169,168,147"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="246,233,421,259"/>
<area shape="poly" title=" " alt="" coords="118,143,167,181,229,218,251,227,250,232,227,223,164,186,115,147"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aee06170a27bb4dab883f8ef10ff1cba8" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="487,226,655,266"/>
<area shape="poly" title=" " alt="" coords="421,243,473,243,473,249,421,249"/>
</map>
</div>

</div>
</div>
<a id="a4d87f487367930256a65aba57352cba8" name="a4d87f487367930256a65aba57352cba8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4d87f487367930256a65aba57352cba8">&#9670;&#160;</a></span>i_pack_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::i_pack_loc </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(nphase), intent(in)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ipt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(nphase), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If PACK then pack T_ALL into LOC_F as long at IGOT_T==1 and STORE and not already in storage. </p>

</div>
</div>
<a id="a6e0beda955985765258aade53af3d1fb" name="a6e0beda955985765258aade53af3d1fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e0beda955985765258aade53af3d1fb">&#9670;&#160;</a></span>is_field_constant()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::is_field_constant </td>
          <td>(</td>
          <td class="paramtype">logical&#160;</td>
          <td class="paramname"><em>igot_t_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>igot_t_const_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(cv_nonods)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>cv_nonods</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Checks whether a field is constant or not. Although I think this check is terrible, no alternatives have provided the same functionality so far. </p>

</div>
</div>
<a id="a3af4784ad37e42f3ede076507c5704bb" name="a3af4784ad37e42f3ede076507c5704bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3af4784ad37e42f3ede076507c5704bb">&#9670;&#160;</a></span>isotropic_limiter_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::isotropic_limiter_all </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>told_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>t2_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>t2old_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>denold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nonods</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nsmall_colm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>small_centrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>small_findrm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>small_colm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>stotel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in), pointer&#160;</td>
          <td class="paramname"><em>suf_t_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in), pointer&#160;</td>
          <td class="paramname"><em>suf_t2_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in), pointer&#160;</td>
          <td class="paramname"><em>suf_d_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>wic_t_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>wic_t2_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :,:, : ), intent(in)&#160;</td>
          <td class="paramname"><em>wic_d_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mass_cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>toldupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denoldupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>t2oldupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>tupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denupwind_mat_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>t2upwind_mat_all</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Computes the limited values at the interface, not as generic as the anisotropic one and never used actually... </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_cgraph.png" border="0" usemap="#anamespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_cgraph" id="anamespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_cgraph">
<area shape="rect" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="5,5,177,45"/>
<area shape="rect" href="namespacecv__advection.html#a7413ef4bcb969bf21f6beb7aba061e8e" title="Adjust TMIN to take into account different sized CV&#39;s. if RESET_STORE then reset TMIN to orginal valu..." alt="" coords="225,5,388,45"/>
<area shape="poly" title=" " alt="" coords="178,23,212,23,212,28,178,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_icgraph.png" border="0" usemap="#anamespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_icgraph" id="anamespacecv__advection_a3af4784ad37e42f3ede076507c5704bb_icgraph">
<area shape="rect" title="Computes the limited values at the interface, not as generic as the anisotropic one and never used ac..." alt="" coords="1507,208,1679,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="abef6c88c50d350a8f4a9be0191a1f0c0" name="abef6c88c50d350a8f4a9be0191a1f0c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abef6c88c50d350a8f4a9be0191a1f0c0">&#9670;&#160;</a></span>linear_high_diffus_cal_coeff_stress_or_tensor()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::linear_high_diffus_cal_coeff_stress_or_tensor </td>
          <td>(</td>
          <td class="paramtype">real, dimension( ndim, ndim, nphase, u_snloc, 2*u_nloc ), intent(inout)&#160;</td>
          <td class="paramname"><em>stress_ij_ele_ext</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, u_snloc, 2*u_nloc ), intent(inout)&#160;</td>
          <td class="paramname"><em>s_inv_nnx_mat12</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>stress_form</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>stress_form_stab</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>zero_or_two_thirds</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>u_nloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_snloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi, u_snloc  ), intent(in)&#160;</td>
          <td class="paramname"><em>sbufen_reversed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi, cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sbcvfen_reversed</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>sdetwei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sbcvngi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ndim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim,ndim,nphase,cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc_udiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase,cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc_udiffusion_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim,ndim,nphase,cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc2_udiffusion</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase,cv_snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>sloc2_udiffusion_vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, ndim,ndim, nphase, sbcvngi), intent(in)&#160;</td>
          <td class="paramname"><em>diff_gi_added</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, sbcvngi ), intent(in)&#160;</td>
          <td class="paramname"><em>snormxn_all</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between element contributions. based on a high order scheme. The matrix S_INV_NNX_MAT12 is used to calculate the rows of the matrix with STRESS_IJ_ELE_EXT. This implements the stress and tensor form of diffusion and calculates a jump conidition. which is in DIFF_COEF_DIVDX, DIFF_COEFOLD_DIVDX The coefficient are in N_DOT_DKDU, N_DOT_DKDUOLD. look at the manual DG treatment of viscocity. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_cgraph.png" border="0" usemap="#anamespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_cgraph" alt=""/></div>
<map name="anamespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_cgraph" id="anamespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_cgraph">
<area shape="rect" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="5,30,171,85"/>
<area shape="rect" href="namespacecv__advection.html#ae7ba4bc947f32d4cea21ddc4cef46033" title="determine stress form of viscocity..." alt="" coords="221,5,363,45"/>
<area shape="poly" title=" " alt="" coords="171,42,207,36,208,41,172,47"/>
<area shape="rect" href="namespacecv__advection.html#a84ebab4afe58323322b98d8539e18ff8" title="determine stress form of viscocity..." alt="" coords="219,69,365,109"/>
<area shape="poly" title=" " alt="" coords="172,68,205,73,205,78,171,73"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_icgraph.png" border="0" usemap="#anamespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_icgraph" alt=""/></div>
<map name="anamespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_icgraph" id="anamespacecv__advection_abef6c88c50d350a8f4a9be0191a1f0c0_icgraph">
<area shape="rect" title="This sub calculates the effective diffusion coefficientd STRESS_IJ_ELE_EXT it only works for between ..." alt="" coords="723,5,888,60"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="465,13,675,53"/>
<area shape="poly" title=" " alt="" coords="709,35,675,35,675,30,709,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="452,35,417,35,417,30,452,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="aeeb08147b461c9b4e619c6a4afd37a68" name="aeeb08147b461c9b4e619c6a4afd37a68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeeb08147b461c9b4e619c6a4afd37a68">&#9670;&#160;</a></span>onvdlim_ano_many()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure subroutine cv_advection::onvdlim_ano_many </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>tdlim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>tdcen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>income</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>etdnew_pele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>etdnew_peleot</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>xi_limit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>tupwin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(in)&#160;</td>
          <td class="paramname"><em>tupwi2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>denoin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>ctilin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>denoou</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>ctilou</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>ftilin</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nfield ), intent(inout)&#160;</td>
          <td class="paramname"><em>ftilou</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values TDCEN(1...SNGI) using a NVD shceme. INCOME(1...SNGI)=1 for incomming to element ELE else =0. LIBETA is the flux limiting parameter. TDMAX(PELE)=maximum of the surrounding 6 element values of element PELE. TDMIN(PELE)=minimum of the surrounding 6 element values of element PELE. PELEOT=element at other side of current face. ELEOT2=element at other side of the element ELEOTH. ELESID=element next to oposing current face. DENOIN, CTILIN, DENOOU, CTILOU, FTILIN, FTILOU =&gt; memory The elements are arranged in this order: ELEOT2,ELE, PELEOT, ELESID. </p>
<h2><a class="anchor" id="autotoc_md0"></a>
This sub finds the neighbouring elements. Suppose that this is the face IFACE.</h2>
<h2><a class="anchor" id="autotoc_md1"></a>
|   ELEOT2   |   ELEOTH   |   ELE     |   ELESID   |</h2>
<h2><a class="anchor" id="autotoc_md2"></a>
TAIN         THALF       TAOUT</h2>
<p>TEXTIN TEXOUT </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_cgraph.png" border="0" usemap="#anamespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_cgraph" alt=""/></div>
<map name="anamespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_cgraph" id="anamespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_cgraph">
<area shape="rect" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="5,5,175,45"/>
<area shape="rect" href="namespacemulti__tools.html#a36357858a282e77361c8cf51e468dd8e" title=": The function computes NVDFUNNEW, the normalised value of the advected variable on the face of the c..." alt="" coords="223,13,441,38"/>
<area shape="poly" title=" " alt="" coords="175,23,209,23,209,28,175,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_icgraph.png" border="0" usemap="#anamespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_icgraph" alt=""/></div>
<map name="anamespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_icgraph" id="anamespacecv__advection_aeeb08147b461c9b4e619c6a4afd37a68_icgraph">
<area shape="rect" title="This sub calculates the limited face values TDADJ(1...SNGI) from the central difference face values T..." alt="" coords="1507,208,1676,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a6ad3a63555367e6c0022730a76bb7df5" name="a6ad3a63555367e6c0022730a76bb7df5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ad3a63555367e6c0022730a76bb7df5">&#9670;&#160;</a></span>pack_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::pack_loc </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ipt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Copies memory into the same large array to then perform a projection from CV to FE. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a6ad3a63555367e6c0022730a76bb7df5_icgraph.png" border="0" usemap="#anamespacecv__advection_a6ad3a63555367e6c0022730a76bb7df5_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a6ad3a63555367e6c0022730a76bb7df5_icgraph" id="anamespacecv__advection_a6ad3a63555367e6c0022730a76bb7df5_icgraph">
<area shape="rect" title="Copies memory into the same large array to then perform a projection from CV to FE." alt="" coords="1507,277,1680,302"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,219,1459,245"/>
<area shape="poly" title=" " alt="" coords="1528,276,1415,247,1416,242,1529,271"/>
<area shape="rect" href="interfacecv__advection_1_1pack__loc__all.html#a5fe1f6774c7171c5ab9f5d26b33e7e6b" title="This subroutine is for fields that have already size final_phase &#45; 1 Checks if the fields are constan..." alt="" coords="1281,269,1447,309"/>
<area shape="poly" title=" " alt="" coords="1493,292,1447,292,1447,287,1493,287"/>
<area shape="rect" href="interfacecv__advection_1_1pack__loc__all.html#a3ee66894f72b8b7bc883493023f7c440" title="This subrotuine is for fields that are bigger than final_phase &#45; start_phase Checks if the fields are..." alt="" coords="1281,333,1447,373"/>
<area shape="poly" title=" " alt="" coords="1534,308,1437,336,1436,331,1533,303"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1323,216,1178,147,988,66,937,48,938,43,990,62,1180,142,1326,211"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1260,220,1221,214,1222,209,1261,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,240,707,267,707,262,1255,235"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1295,251,1270,260,1223,285,1181,304,1179,299,1220,280,1268,255,1294,246"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a5c1d3d050b9d6e3a460a5e33481a2317" name="a5c1d3d050b9d6e3a460a5e33481a2317"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c1d3d050b9d6e3a460a5e33481a2317">&#9670;&#160;</a></span>pack_loc_all1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::pack_loc_all1 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>field1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>field2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>field3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_volume_frac_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfield</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine is for fields that have already size final_phase - 1 Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the field into LOC_F to later on apply the limiters on all the fields at once. </p>

</div>
</div>
<a id="a683fbf63598344fcda6fd591c09f5133" name="a683fbf63598344fcda6fd591c09f5133"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a683fbf63598344fcda6fd591c09f5133">&#9670;&#160;</a></span>pack_loc_all2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::pack_loc_all2 </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_volume_frac_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subrotuine is for fields that are bigger than final_phase - start_phase Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the field into LOC_F to later on apply the limiters on all the fields at once. </p>

</div>
</div>
<a id="aebdd2647306a5d499b80ba8edc89bb93" name="aebdd2647306a5d499b80ba8edc89bb93"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebdd2647306a5d499b80ba8edc89bb93">&#9670;&#160;</a></span>pack_loc_all3()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::pack_loc_all3 </td>
          <td>(</td>
          <td class="paramtype">integer, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>field3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>oldfield3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_volume_frac_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>start_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nodi</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subrotuine is for fields that are bigger than final_phase - start_phase Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the field into LOC_F to later on apply the limiters on all the fields at once. This one is for integer fields. </p>

</div>
</div>
<a id="ae1ccfb76c0376157c7a4446fbe4f7362" name="ae1ccfb76c0376157c7a4446fbe4f7362"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1ccfb76c0376157c7a4446fbe4f7362">&#9670;&#160;</a></span>pack_or_unpack_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::pack_or_unpack_loc </td>
          <td>(</td>
          <td class="paramtype">real, dimension(nfield), intent(inout)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nphase), intent(inout)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfield</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ipt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>pack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>store</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igot_t</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If PACK then pack T_ALL into LOC_F as long at IGOT_T==1 and STORE and not already in storage. </p>

</div>
</div>
<a id="a1ae53b6e2d75f63d1a426e6f3534d1d7" name="a1ae53b6e2d75f63d1a426e6f3534d1d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ae53b6e2d75f63d1a426e6f3534d1d7">&#9670;&#160;</a></span>proj_cv_to_fem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::proj_cv_to_fem </td>
          <td>(</td>
          <td class="paramtype">type(state_type)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>fempsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igetct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_mn_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(vector_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_ave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(vector_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_int</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>activate_limiters</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded Subroutine description: (1) determine FEMT (finite element wise) etc from T (control volume wise) (2) (optional) calculate psi_int (area) and psi_ave (barycentre) over each CV. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packed_state</td><td>! local state data </td></tr>
    <tr><td class="paramname">fempsi</td><td>! finite element field data </td></tr>
    <tr><td class="paramname">psi</td><td>! finite volume field data </td></tr>
    <tr><td class="paramname">Mdims</td><td>! dimension data </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>! gauss integer dimension data </td></tr>
    <tr><td class="paramname">CV_funs</td><td>! control volume shape function data </td></tr>
    <tr><td class="paramname">Mspars</td><td>! sparsity data </td></tr>
    <tr><td class="paramname">ndgln</td><td>! global numbering data </td></tr>
    <tr><td class="paramname">igetct</td><td>! whether to get CT matrix </td></tr>
    <tr><td class="paramname">X</td><td>! coordinates of the elements </td></tr>
    <tr><td class="paramname">mass_ele</td><td>! finite element mass </td></tr>
    <tr><td class="paramname">mass_mn_pres</td><td>! ?? </td></tr>
    <tr><td class="paramname">tracer</td><td>field to be projected </td></tr>
    <tr><td class="paramname">activate_limiters</td><td>are the limiters on? </td></tr>
    <tr><td class="paramname">psi_int</td><td>! control volume area </td></tr>
    <tr><td class="paramname">psi_ave</td><td>! control volume barycentre </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_cgraph.png" border="0" usemap="#anamespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_cgraph" id="anamespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="5,37,147,77"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="195,5,405,45"/>
<area shape="poly" title=" " alt="" coords="146,45,181,40,182,45,147,50"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="225,69,375,109"/>
<area shape="poly" title=" " alt="" coords="147,65,212,74,212,79,146,70"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_icgraph.png" border="0" usemap="#anamespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_icgraph" id="anamespacecv__advection_a1ae53b6e2d75f63d1a426e6f3534d1d7_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="1507,208,1648,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="aca35d740c637f0177d867e8a10cec8ef" name="aca35d740c637f0177d867e8a10cec8ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aca35d740c637f0177d867e8a10cec8ef">&#9670;&#160;</a></span>put_in_ct_rhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::put_in_ct_rhs </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>get_c_in_cv_advdif_and_calc_c_cv</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>ct_rhs_phase_cv_nodi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>ct_rhs_phase_cv_nodj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>between_elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_domain_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>sele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>hdc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>jcount_kloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>jcount_kloc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>icount_kloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>icount_kloc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>c_jcount_kloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>c_jcount_kloc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>c_icount_kloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>c_icount_kloc2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_other_loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>u_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_sloc2loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>scvdetwei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>cvnormx_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nodi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>cv_nodj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:,:)&#160;</td>
          <td class="paramname"><em>wic_u_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:,:)&#160;</td>
          <td class="paramname"><em>wic_p_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>suf_p_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>ugi_coef_ele_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>ugi_coef_ele2_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ndotq</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ndotqold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>limt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>limdt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>limdtold</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>limt_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>ndotq_hat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ftheta_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>one_m_ftheta_t2old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ftheta_t2_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>one_m_ftheta_t2old_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>integrate_other_side_and_not_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>loc_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>theta_vel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>udgi_imp_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>rcon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>rcon_j</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>ndotq_imp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), pointer&#160;</td>
          <td class="paramname"><em>x_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,: ), pointer&#160;</td>
          <td class="paramname"><em>suf_d_bc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>gravty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT, MmatCT_RHS It also computes the gradient matrix using the DCVFE method. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aca35d740c637f0177d867e8a10cec8ef_icgraph.png" border="0" usemap="#anamespacecv__advection_aca35d740c637f0177d867e8a10cec8ef_icgraph" alt=""/></div>
<map name="anamespacecv__advection_aca35d740c637f0177d867e8a10cec8ef_icgraph" id="anamespacecv__advection_aca35d740c637f0177d867e8a10cec8ef_icgraph">
<area shape="rect" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="1507,208,1663,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a7335aa20cf26620a8e0fefcb9be90fac" name="a7335aa20cf26620a8e0fefcb9be90fac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7335aa20cf26620a8e0fefcb9be90fac">&#9670;&#160;</a></span>saturation_assemb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::saturation_assemb </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout), target&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:)&#160;</td>
          <td class="paramname"><em>sat_prev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), target&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), target&#160;</td>
          <td class="paramname"><em>den_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>denold_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>cv_p</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>sourct_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>volfra_pore</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>vad_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>phase_with_pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>assemble_collapsed_to_one_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>getresidual</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_cgraph.png" border="0" usemap="#anamespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_cgraph" id="anamespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_cgraph">
<area shape="rect" title=" " alt="" coords="5,265,188,305"/>
<area shape="rect" href="namespacemulti__pipes.html#a85e1eb35eb19824df0251f27aee52634" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="255,5,437,45"/>
<area shape="poly" title=" " alt="" coords="102,264,119,221,146,164,185,106,208,79,234,55,242,50,245,54,238,59,212,82,189,109,151,167,124,223,107,266"/>
<area shape="rect" href="namespacemulti__tools.html#a5864d312b84bca3ea3982ed34d05c3f4" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="251,70,441,95"/>
<area shape="poly" title=" " alt="" coords="105,264,124,229,153,185,190,141,234,104,246,98,248,103,238,109,194,145,157,188,129,231,110,266"/>
<area shape="rect" href="namespacecv__advection.html#a8eb89cd41fa936c21d77e9277c24ff38" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="258,119,434,145"/>
<area shape="poly" title=" " alt="" coords="112,263,163,209,197,180,235,155,254,147,256,151,237,160,200,184,166,213,116,267"/>
<area shape="rect" href="namespacemulti__data__types.html#a0513ed33b7e9d6cb5ef161c23ac838c4" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="241,169,451,209"/>
<area shape="poly" title=" " alt="" coords="136,263,235,219,257,211,259,216,237,224,138,268"/>
<area shape="rect" href="namespacecv__advection.html#aa75b98e24eaf8dd45300f3c4b1c86fce" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="276,233,416,273"/>
<area shape="poly" title=" " alt="" coords="188,271,262,261,262,267,188,276"/>
<area shape="rect" href="namespacecopy__outof__state.html#ad4e108d42b18611e2908d988a6155b70" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="255,297,437,337"/>
<area shape="poly" title=" " alt="" coords="188,294,242,301,241,307,188,300"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="236,362,456,387"/>
<area shape="poly" title=" " alt="" coords="137,303,184,326,237,347,268,356,266,361,235,352,182,331,135,308"/>
<area shape="rect" href="namespacecv__advection.html#aa543dc448a797694ce8751b3a8cfdde3" title=" " alt="" coords="259,411,433,437"/>
<area shape="poly" title=" " alt="" coords="118,303,169,351,202,375,237,396,258,405,256,410,235,401,199,380,166,355,115,307"/>
<area shape="rect" href="namespacecv__advection.html#a796bc5ddad90b88fcb185a3fc5da03ba" title=" " alt="" coords="254,461,438,486"/>
<area shape="poly" title=" " alt="" coords="111,304,131,336,160,374,196,413,237,446,252,453,249,458,235,450,192,417,156,378,127,339,107,307"/>
<area shape="rect" href="namespacecv__advection.html#a19bc7cfcb7c297d93ce7edd0658eeb22" title=" " alt="" coords="246,526,446,551"/>
<area shape="poly" title=" " alt="" coords="109,305,127,345,155,396,192,449,238,495,258,508,280,519,278,524,255,513,234,499,188,452,150,398,122,347,104,307"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aee06170a27bb4dab883f8ef10ff1cba8" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="505,372,673,412"/>
<area shape="poly" title=" " alt="" coords="433,410,491,402,492,407,434,415"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="504,461,675,486"/>
<area shape="poly" title=" " alt="" coords="438,471,490,471,490,476,438,476"/>
<area shape="poly" title=" " alt="" coords="550,462,541,452,546,442,562,436,589,434,624,438,633,443,637,448,633,451,630,447,622,443,589,439,563,441,549,446,547,452,554,459"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#af4782b913aba9aef1af79d9db7c1739a" title=" " alt="" coords="505,535,673,575"/>
<area shape="poly" title=" " alt="" coords="446,543,492,546,491,551,446,548"/>
<area shape="poly" title=" " alt="" coords="544,535,541,525,549,516,565,510,589,508,618,511,633,518,631,523,616,516,589,513,566,515,552,520,547,526,549,534"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_icgraph.png" border="0" usemap="#anamespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_icgraph" id="anamespacecv__advection_a7335aa20cf26620a8e0fefcb9be90fac_icgraph">
<area shape="rect" title=" " alt="" coords="952,13,1135,53"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="712,13,904,53"/>
<area shape="poly" title=" " alt="" coords="938,35,904,35,904,30,938,30"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="465,5,664,60"/>
<area shape="poly" title=" " alt="" coords="698,35,664,35,664,30,698,30"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,13,417,53"/>
<area shape="poly" title=" " alt="" coords="451,35,418,35,418,30,451,30"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,13,171,53"/>
<area shape="poly" title=" " alt="" coords="205,35,171,35,171,30,205,30"/>
</map>
</div>

</div>
</div>
<a id="aa543dc448a797694ce8751b3a8cfdde3" name="aa543dc448a797694ce8751b3a8cfdde3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa543dc448a797694ce8751b3a8cfdde3">&#9670;&#160;</a></span>scvdetnx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::scvdetnx </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:)&#160;</td>
          <td class="paramname"><em>x_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>cv_gidims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_domain_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>between_elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>scvdetwei</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, cv_gidims%scvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>cvnormx_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim ), intent(in)&#160;</td>
          <td class="paramname"><em>xc_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nod</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>x_nodj</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<hr  />
<ul>
<li>this subroutine computed the surface area at the Gi point (SCVDETWEI)</li>
<li>this subroutine calculates the control volume (CV)</li>
<li>CVNORMX, CVNORMY, CVNORMZ normals at the Gaussian</li>
<li>integration points GI. NODI = the current global</li>
<li>node number for the co-ordinates.</li>
<li>(XC,YC,ZC) is the centre of CV NODI</li>
</ul>
<hr  />
 <h2><a class="anchor" id="autotoc_md6"></a>
- date last modified : 25/08/2020</h2>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_cgraph.png" border="0" usemap="#anamespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_cgraph" alt=""/></div>
<map name="anamespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_cgraph" id="anamespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,180,38"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#aee06170a27bb4dab883f8ef10ff1cba8" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="228,5,396,45"/>
<area shape="poly" title=" " alt="" coords="180,23,214,23,214,28,180,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_icgraph.png" border="0" usemap="#anamespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_icgraph" alt=""/></div>
<map name="anamespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_icgraph" id="anamespacecv__advection_aa543dc448a797694ce8751b3a8cfdde3_icgraph">
<area shape="rect" title=" " alt="" coords="1507,225,1681,250"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,125,1459,150"/>
<area shape="poly" title=" " alt="" coords="1550,221,1393,153,1396,148,1552,216"/>
<area shape="rect" href="namespacecv__advection.html#a8e92f04a2ef0257a47a96daebf15cbb5" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1277,281,1451,321"/>
<area shape="poly" title=" " alt="" coords="1535,256,1437,284,1436,279,1533,251"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="1273,217,1455,257"/>
<area shape="poly" title=" " alt="" coords="1493,240,1455,240,1455,235,1493,235"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,60,977,100"/>
<area shape="poly" title=" " alt="" coords="1255,126,1221,121,977,94,977,88,1222,116,1256,120"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,175,1221,215"/>
<area shape="poly" title=" " alt="" coords="1299,156,1212,177,1211,172,1297,151"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,117,707,157"/>
<area shape="poly" title=" " alt="" coords="1256,140,707,140,707,135,1256,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,5,1219,45"/>
<area shape="poly" title=" " alt="" coords="1325,120,1220,68,1176,48,1179,43,1222,63,1327,116"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,80,615,86,540,94,466,108,409,126,358,149,356,144,407,122,465,103,539,89,615,80,754,74"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1043,220,990,229,911,235,830,237,671,228,527,210,411,189,412,184,528,204,672,222,830,231,911,230,989,224,1042,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,175,989,215"/>
<area shape="poly" title=" " alt="" coords="1024,197,990,197,990,192,1024,192"/>
<area shape="poly" title=" " alt="" coords="741,191,417,174,418,169,741,185"/>
<area shape="poly" title=" " alt="" coords="758,175,686,160,687,155,759,169"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,286,685,341"/>
<area shape="poly" title=" " alt="" coords="811,223,654,288,652,284,809,218"/>
<area shape="poly" title=" " alt="" coords="452,155,418,158,417,153,451,149"/>
<area shape="poly" title=" " alt="" coords="493,283,464,269,398,228,344,189,347,185,401,224,467,264,496,278"/>
<area shape="poly" title=" " alt="" coords="1025,19,909,16,767,20,691,27,615,38,539,53,466,75,431,90,397,109,344,149,341,144,395,105,428,85,464,69,538,48,614,32,691,21,767,14,909,10,1026,14"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="776,289,968,329"/>
<area shape="poly" title=" " alt="" coords="1259,255,969,298,968,293,1258,250"/>
<area shape="poly" title=" " alt="" coords="762,314,685,315,685,309,762,308"/>
</map>
</div>

</div>
</div>
<a id="afc50adcb66253565fe9c7a83244430a7" name="afc50adcb66253565fe9c7a83244430a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afc50adcb66253565fe9c7a83244430a7">&#9670;&#160;</a></span>shock_front_in_ele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function cv_advection::shock_front_in_ele </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>imble_frac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects whether the element has a shockfront or not. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_afc50adcb66253565fe9c7a83244430a7_cgraph.png" border="0" usemap="#anamespacecv__advection_afc50adcb66253565fe9c7a83244430a7_cgraph" alt=""/></div>
<map name="anamespacecv__advection_afc50adcb66253565fe9c7a83244430a7_cgraph" id="anamespacecv__advection_afc50adcb66253565fe9c7a83244430a7_cgraph">
<area shape="rect" title="Detects whether the element has a shockfront or not." alt="" coords="5,29,160,69"/>
<area shape="poly" title=" " alt="" coords="53,29,52,20,56,11,67,5,83,3,101,6,111,13,108,17,99,11,83,8,68,10,60,14,57,21,59,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_afc50adcb66253565fe9c7a83244430a7_icgraph.png" border="0" usemap="#anamespacecv__advection_afc50adcb66253565fe9c7a83244430a7_icgraph" alt=""/></div>
<map name="anamespacecv__advection_afc50adcb66253565fe9c7a83244430a7_icgraph" id="anamespacecv__advection_afc50adcb66253565fe9c7a83244430a7_icgraph">
<area shape="rect" title="Detects whether the element has a shockfront or not." alt="" coords="1507,208,1661,248"/>
<area shape="poly" title=" " alt="" coords="1621,196,1608,189,1584,187,1563,189,1550,193,1546,199,1548,207,1543,208,1541,198,1547,189,1562,183,1584,181,1610,184,1624,192"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a796bc5ddad90b88fcb185a3fc5da03ba" name="a796bc5ddad90b88fcb185a3fc5da03ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a796bc5ddad90b88fcb185a3fc5da03ba">&#9670;&#160;</a></span>triloccords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::triloccords </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>z2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>z3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>z4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_cgraph.png" border="0" usemap="#anamespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_cgraph" id="anamespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_cgraph">
<area shape="rect" title=" " alt="" coords="5,29,189,55"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="237,29,408,55"/>
<area shape="poly" title=" " alt="" coords="190,39,224,39,224,45,190,45"/>
<area shape="poly" title=" " alt="" coords="286,31,278,21,282,11,298,5,323,3,354,7,366,16,363,20,352,11,323,8,299,10,286,15,283,20,290,27"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_icgraph.png" border="0" usemap="#anamespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_icgraph" id="anamespacecv__advection_a796bc5ddad90b88fcb185a3fc5da03ba_icgraph">
<area shape="rect" title=" " alt="" coords="1737,182,1921,207"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="1527,175,1669,215"/>
<area shape="poly" title=" " alt="" coords="1723,197,1670,197,1670,192,1723,192"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,125,1459,150"/>
<area shape="poly" title=" " alt="" coords="1767,181,1689,165,1569,151,1459,144,1459,138,1570,146,1690,160,1768,176"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="1507,251,1689,291"/>
<area shape="poly" title=" " alt="" coords="1778,214,1661,253,1659,248,1776,209"/>
<area shape="poly" title=" " alt="" coords="1513,177,1416,153,1417,147,1514,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,60,977,100"/>
<area shape="poly" title=" " alt="" coords="1255,126,1221,121,977,94,977,88,1222,116,1256,120"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,175,1221,215"/>
<area shape="poly" title=" " alt="" coords="1299,156,1212,177,1211,172,1297,151"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,117,707,157"/>
<area shape="poly" title=" " alt="" coords="1256,140,707,140,707,135,1256,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,5,1219,45"/>
<area shape="poly" title=" " alt="" coords="1325,120,1220,68,1176,48,1179,43,1222,63,1327,116"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,80,615,86,540,94,466,108,409,126,358,149,356,144,407,122,465,103,539,89,615,80,754,74"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1043,220,990,229,911,235,830,237,671,228,527,210,411,189,412,184,528,204,672,222,830,231,911,230,989,224,1042,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,175,989,215"/>
<area shape="poly" title=" " alt="" coords="1024,197,990,197,990,192,1024,192"/>
<area shape="poly" title=" " alt="" coords="741,191,417,174,418,169,741,185"/>
<area shape="poly" title=" " alt="" coords="758,175,686,160,687,155,759,169"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,286,685,341"/>
<area shape="poly" title=" " alt="" coords="811,223,654,288,652,284,809,218"/>
<area shape="poly" title=" " alt="" coords="452,155,418,158,417,153,451,149"/>
<area shape="poly" title=" " alt="" coords="493,283,464,269,398,228,344,189,347,185,401,224,467,264,496,278"/>
<area shape="poly" title=" " alt="" coords="1025,19,909,16,767,20,691,27,615,38,539,53,466,75,431,90,397,109,344,149,341,144,395,105,428,85,464,69,538,48,614,32,691,21,767,14,909,10,1026,14"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="776,289,968,329"/>
<area shape="poly" title=" " alt="" coords="1493,279,968,307,968,302,1493,274"/>
<area shape="poly" title=" " alt="" coords="762,314,685,315,685,309,762,308"/>
</map>
</div>

</div>
</div>
<a id="a19bc7cfcb7c297d93ce7edd0658eeb22" name="a19bc7cfcb7c297d93ce7edd0658eeb22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19bc7cfcb7c297d93ce7edd0658eeb22">&#9670;&#160;</a></span>triloccords2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::triloccords2d </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>n3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>x3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>y3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_cgraph.png" border="0" usemap="#anamespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_cgraph" id="anamespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,205,62"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#af4782b913aba9aef1af79d9db7c1739a" title=" " alt="" coords="253,29,421,69"/>
<area shape="poly" title=" " alt="" coords="206,47,240,47,240,52,206,52"/>
<area shape="poly" title=" " alt="" coords="294,30,291,20,298,10,314,5,337,3,364,6,379,13,377,18,363,11,337,8,315,10,302,15,297,21,299,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_icgraph.png" border="0" usemap="#anamespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_icgraph" id="anamespacecv__advection_a19bc7cfcb7c297d93ce7edd0658eeb22_icgraph">
<area shape="rect" title=" " alt="" coords="1737,182,1937,207"/>
<area shape="rect" href="namespacecv__advection.html#a9b9fcfd8bbef480150a7ebc72fccacff" title="For the anisotropic limiting scheme we find the upwind values by interpolation using the subroutine F..." alt="" coords="1527,175,1669,215"/>
<area shape="poly" title=" " alt="" coords="1724,197,1670,197,1670,192,1724,192"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,125,1459,150"/>
<area shape="poly" title=" " alt="" coords="1773,182,1689,165,1569,152,1459,144,1459,139,1570,146,1690,160,1774,176"/>
<area shape="rect" href="namespacecv__advection.html#a7335aa20cf26620a8e0fefcb9be90fac" title=" " alt="" coords="1507,251,1689,291"/>
<area shape="poly" title=" " alt="" coords="1784,214,1663,253,1661,248,1782,209"/>
<area shape="poly" title=" " alt="" coords="1513,177,1416,153,1417,147,1514,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,60,977,100"/>
<area shape="poly" title=" " alt="" coords="1255,126,1221,121,977,94,977,88,1222,116,1256,120"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,175,1221,215"/>
<area shape="poly" title=" " alt="" coords="1299,156,1212,177,1211,172,1297,151"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,117,707,157"/>
<area shape="poly" title=" " alt="" coords="1256,140,707,140,707,135,1256,135"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,5,1219,45"/>
<area shape="poly" title=" " alt="" coords="1325,120,1220,68,1176,48,1179,43,1222,63,1327,116"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,80,615,86,540,94,466,108,409,126,358,149,356,144,407,122,465,103,539,89,615,80,754,74"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1043,220,990,229,911,235,830,237,671,228,527,210,411,189,412,184,528,204,672,222,830,231,911,230,989,224,1042,215"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,175,989,215"/>
<area shape="poly" title=" " alt="" coords="1024,197,990,197,990,192,1024,192"/>
<area shape="poly" title=" " alt="" coords="741,191,417,174,418,169,741,185"/>
<area shape="poly" title=" " alt="" coords="758,175,686,160,687,155,759,169"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,286,685,341"/>
<area shape="poly" title=" " alt="" coords="811,223,654,288,652,284,809,218"/>
<area shape="poly" title=" " alt="" coords="452,155,418,158,417,153,451,149"/>
<area shape="poly" title=" " alt="" coords="493,283,464,269,398,228,344,189,347,185,401,224,467,264,496,278"/>
<area shape="poly" title=" " alt="" coords="1025,19,909,16,767,20,691,27,615,38,539,53,466,75,431,90,397,109,344,149,341,144,395,105,428,85,464,69,538,48,614,32,691,21,767,14,909,10,1026,14"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa1ce62fd9e2240cf8992447180a0152c" title="This subroutines generates calls CV_ASSEMB twice to generate a numerical jacobian for the solution of..." alt="" coords="776,289,968,329"/>
<area shape="poly" title=" " alt="" coords="1493,279,968,307,968,302,1493,274"/>
<area shape="poly" title=" " alt="" coords="762,314,685,315,685,309,762,308"/>
</map>
</div>

</div>
</div>
<a id="a9e58766834b93ab43ae7a753e699a9da" name="a9e58766834b93ab43ae7a753e699a9da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e58766834b93ab43ae7a753e699a9da">&#9670;&#160;</a></span>unpack_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::unpack_loc </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nphase), intent(inout)&#160;</td>
          <td class="paramname"><em>t_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ipt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(nphase), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(nphase), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(nphase), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_const_value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a9e58766834b93ab43ae7a753e699a9da_icgraph.png" border="0" usemap="#anamespacecv__advection_a9e58766834b93ab43ae7a753e699a9da_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a9e58766834b93ab43ae7a753e699a9da_icgraph" id="anamespacecv__advection_a9e58766834b93ab43ae7a753e699a9da_icgraph">
<area shape="rect" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage." alt="" coords="1717,215,1907,241"/>
<area shape="rect" href="namespacecv__advection.html#a203f402aedd9fec9cade1641c093c169" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="1507,208,1669,248"/>
<area shape="poly" title=" " alt="" coords="1703,231,1669,231,1669,225,1703,225"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<a id="a203f402aedd9fec9cade1641c093c169" name="a203f402aedd9fec9cade1641c093c169"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a203f402aedd9fec9cade1641c093c169">&#9670;&#160;</a></span>unpack_loc_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::unpack_loc_all </td>
          <td>(</td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>loc_f</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>field1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>oldfield1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>field2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>oldfield2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>field3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>oldfield3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_pack</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_const</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>igot_t_const_value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>use_volume_frac_t2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nfield</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage. Checks if the fields are constant or not, stored in IGOT_T_PACK, based on that introduces the LOC_F into the field or use a constant value. This is after the limiters have been applied. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a203f402aedd9fec9cade1641c093c169_cgraph.png" border="0" usemap="#anamespacecv__advection_a203f402aedd9fec9cade1641c093c169_cgraph" alt=""/></div>
<map name="anamespacecv__advection_a203f402aedd9fec9cade1641c093c169_cgraph" id="anamespacecv__advection_a203f402aedd9fec9cade1641c093c169_cgraph">
<area shape="rect" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="5,5,168,45"/>
<area shape="rect" href="namespacecv__advection.html#a9e58766834b93ab43ae7a753e699a9da" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage." alt="" coords="216,13,405,38"/>
<area shape="poly" title=" " alt="" coords="169,23,202,23,202,28,169,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a203f402aedd9fec9cade1641c093c169_icgraph.png" border="0" usemap="#anamespacecv__advection_a203f402aedd9fec9cade1641c093c169_icgraph" alt=""/></div>
<map name="anamespacecv__advection_a203f402aedd9fec9cade1641c093c169_icgraph" id="anamespacecv__advection_a203f402aedd9fec9cade1641c093c169_icgraph">
<area shape="rect" title="If PACK then UNpack loc_f into T_ALL as long at IGOT_T==1 and STORE and not already in storage...." alt="" coords="1507,208,1669,248"/>
<area shape="rect" href="namespacecv__advection.html#a3bd456f4f3d098a36288e7ed4a6dbf6b" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1269,215,1459,241"/>
<area shape="poly" title=" " alt="" coords="1493,231,1459,231,1459,225,1493,225"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a2644f81b959a9c66d17c6ae96e452faf" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="767,5,977,45"/>
<area shape="poly" title=" " alt="" coords="1322,212,1176,145,988,66,936,48,938,43,990,62,1179,140,1324,207"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a8b8466b21f31e369fc0ae74a939444cd" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="1037,179,1221,219"/>
<area shape="poly" title=" " alt="" coords="1256,217,1221,213,1222,208,1256,212"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa8ed1c2e68fd75835c3794475805554c" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="465,251,707,291"/>
<area shape="poly" title=" " alt="" coords="1256,237,707,267,707,261,1255,231"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae08ee439502a499a77b44ecdd504846a" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="1039,301,1219,341"/>
<area shape="poly" title=" " alt="" coords="1319,248,1182,304,1180,299,1317,243"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,147,417,187"/>
<area shape="poly" title=" " alt="" coords="754,23,687,26,613,32,538,45,466,66,430,84,396,105,342,148,339,144,393,101,427,79,464,62,537,40,613,27,686,20,753,18"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,147,171,187"/>
<area shape="poly" title=" " alt="" coords="205,169,171,169,171,164,205,164"/>
<area shape="poly" title=" " alt="" coords="1035,178,989,169,843,145,728,132,613,129,466,140,405,149,404,144,465,135,613,124,728,126,843,140,990,164,1036,173"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad72540721ea2ef4651301189e8973481" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="755,179,989,219"/>
<area shape="poly" title=" " alt="" coords="1024,201,990,201,990,196,1024,196"/>
<area shape="poly" title=" " alt="" coords="791,178,706,161,631,155,555,154,418,160,417,154,555,149,631,150,707,156,792,173"/>
<area shape="poly" title=" " alt="" coords="779,225,667,253,666,248,778,219"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a07a7956a7419e82fb8f059cae3ded083" title="Calls to generate the residual of the transport of saturation onlyequation for the saturation and Jac..." alt="" coords="487,171,685,226"/>
<area shape="poly" title=" " alt="" coords="741,201,686,201,686,196,741,196"/>
<area shape="poly" title=" " alt="" coords="491,249,464,240,406,215,355,189,358,184,409,210,466,235,493,244"/>
<area shape="poly" title=" " alt="" coords="473,188,417,181,418,176,474,183"/>
<area shape="poly" title=" " alt="" coords="1026,343,908,356,765,360,689,356,612,346,537,330,464,305,422,281,384,250,354,217,331,189,336,185,358,213,388,246,425,277,466,300,538,324,613,341,689,351,765,355,908,351,1025,337"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa646dbddd6308ea78c1c05d5b51c4d22" name="aa646dbddd6308ea78c1c05d5b51c4d22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa646dbddd6308ea78c1c05d5b51c4d22">&#9670;&#160;</a></span>wic_d_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_d_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03647ce996f35f7512f2206c2a4bc8d4" name="a03647ce996f35f7512f2206c2a4bc8d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03647ce996f35f7512f2206c2a4bc8d4">&#9670;&#160;</a></span>wic_p_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_p_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d139b0bd7722182c16855e683657878" name="a6d139b0bd7722182c16855e683657878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d139b0bd7722182c16855e683657878">&#9670;&#160;</a></span>wic_p_bc_free</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_p_bc_free = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29adecab6c33872a56cf4775b4e1c3e3" name="a29adecab6c33872a56cf4775b4e1c3e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29adecab6c33872a56cf4775b4e1c3e3">&#9670;&#160;</a></span>wic_t_bc_diri_adv_and_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_t_bc_diri_adv_and_robin = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a939c43361c098c807280c739e30b5370" name="a939c43361c098c807280c739e30b5370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939c43361c098c807280c739e30b5370">&#9670;&#160;</a></span>wic_t_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_t_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f50cabe5b0bcd1018205e2d6f15f3ff" name="a8f50cabe5b0bcd1018205e2d6f15f3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f50cabe5b0bcd1018205e2d6f15f3ff">&#9670;&#160;</a></span>wic_t_bc_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_t_bc_robin = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab87709ec60fd78f0870ce18b9bbf7eb8" name="ab87709ec60fd78f0870ce18b9bbf7eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87709ec60fd78f0870ce18b9bbf7eb8">&#9670;&#160;</a></span>wic_u_bc_diri_adv_and_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_diri_adv_and_robin = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7ceb6fac2898be0cae2d603d5226f631" name="a7ceb6fac2898be0cae2d603d5226f631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ceb6fac2898be0cae2d603d5226f631">&#9670;&#160;</a></span>wic_u_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03129ee41533b2c78d1ec116019892fa" name="a03129ee41533b2c78d1ec116019892fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03129ee41533b2c78d1ec116019892fa">&#9670;&#160;</a></span>wic_u_bc_dirichlet_inout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_dirichlet_inout = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6309cc2d2e0e51146784619230b6e70a" name="a6309cc2d2e0e51146784619230b6e70a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6309cc2d2e0e51146784619230b6e70a">&#9670;&#160;</a></span>wic_u_bc_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_robin = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecv__advection.html">cv_advection</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
