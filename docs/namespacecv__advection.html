<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: cv_advection Module Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICFERST
   &#160;<span id="projectnumber">22-07</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('namespacecv__advection.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">cv_advection Module Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>This module contains all the tools to assemble and solve the equations and fields associated with the CV mesh, i.e. transport equation, continuity equation, DCVFE gradient matrix and the Laplacian system for the zeta-potential.  
<a href="namespacecv__advection.html#details">More...</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:a904baa4815053bc8025c3ae2b8f69037"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037">cv_assemb</a> (state, packed_state, final_phase, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, Mdisopt, Mmat, upwnd, tracer, velocity, density, multi_absorp, DIAG_SCALE_PRES, DIAG_SCALE_PRES_COUP, INV_B, DEN_ALL, DENOLD_ALL, CV_DISOPT, CV_DG_VEL_INT_OPT, DT, CV_BETA, SUF_SIG_DIAGTEN_BC, DERIV, CV_P, SOURCT_ALL, ABSORBT_ALL, VOLFRA_PORE, GETCV_DISC, GETCT, IGOT_T2, IGOT_THETA_FLUX, GET_THETA_FLUX, USE_THETA_FLUX, THETA_FLUX, ONE_M_THETA_FLUX, THETA_FLUX_J, ONE_M_THETA_FLUX_J, THETA_GDIFF, MEAN_PORE_CV, MASS_MN_PRES, THERMAL, MASS_SUF, MASS_ELE_TRANSP, TDIFFUSION, saturation, VAD_parameter, Phase_with_Pc, Courant_number, Permeability_tensor_field, calculate_mass_delta, eles_with_pipe, pipes_aux, porous_heat_coef, porous_heat_coef_old, outfluxes, solving_compositional, nonlinear_iteration, assemble_collapsed_to_one_phase)</td></tr>
<tr class="memdesc:a904baa4815053bc8025c3ae2b8f69037"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutines generates the transport equation for a cv field. It also can generate the Continuity equation if GETCT = .true. and also generate the gradient matrix of the momentum equation for the DCVFE method if the option is activated.  <a href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037">More...</a><br /></td></tr>
<tr class="separator:a904baa4815053bc8025c3ae2b8f69037"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae1eba9d13ff146b1bf390a5de461d421"><td class="memItemLeft" align="right" valign="top">integer function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ae1eba9d13ff146b1bf390a5de461d421">cv_count_faces</a> (Mdims, CV_ELE_TYPE, CV_GIdims)</td></tr>
<tr class="memdesc:ae1eba9d13ff146b1bf390a5de461d421"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine counts then number of faces in the control volume space.  <a href="namespacecv__advection.html#ae1eba9d13ff146b1bf390a5de461d421">More...</a><br /></td></tr>
<tr class="separator:ae1eba9d13ff146b1bf390a5de461d421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6eacfe287bc5562008363c3a93b772c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ad6eacfe287bc5562008363c3a93b772c">find_other_side</a> (CV_OTHER_LOC, CV_NLOC, INTEGRAT_AT_GI, X_NLOC, X_NDGLN, CV_SNLOC, CVFEM_ON_FACE, X_SHARE, ELE, ELE2, FINELE, COLELE, DISTCONTINUOUS_METHOD)</td></tr>
<tr class="memdesc:ad6eacfe287bc5562008363c3a93b772c"><td class="mdescLeft">&#160;</td><td class="mdescRight">We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,GI)=.TRUE. if CV_KLOC is on the face that GI is centred on. Look for these nodes on the other elements. ELE2=0 also when we are between elements but are trying to integrate across the middle of a CV.  <a href="namespacecv__advection.html#ad6eacfe287bc5562008363c3a93b772c">More...</a><br /></td></tr>
<tr class="separator:ad6eacfe287bc5562008363c3a93b772c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe9ea10242e33e1921ac5526e6827999"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#afe9ea10242e33e1921ac5526e6827999">proj_cv_to_fem</a> (packed_state, fempsi, psi, Mdims, CV_GIdims, CV_funs, Mspars, ndgln, igetct, X, mass_ele, mass_mn_pres, tracer, psi_ave, psi_int)</td></tr>
<tr class="memdesc:afe9ea10242e33e1921ac5526e6827999"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded Subroutine description: (1) determine FEMT (finite element wise) etc from T (control volume wise) (2) (optional) calculate psi_int (area) and psi_ave (barycentre) over each CV.  <a href="namespacecv__advection.html#afe9ea10242e33e1921ac5526e6827999">More...</a><br /></td></tr>
<tr class="separator:afe9ea10242e33e1921ac5526e6827999"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a288564175dbabfb30d9991a26e83881d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a288564175dbabfb30d9991a26e83881d">dg_derivs_all</a> (T_ALL, DTX_ELE, Mdims, final_phase, ndgln, CV_GIdims, CV_funs, X_ALL, Mmat, WIC_T_BC_ALL, SUF_T_BC_ALL, P0Mesh)</td></tr>
<tr class="memdesc:a288564175dbabfb30d9991a26e83881d"><td class="mdescLeft">&#160;</td><td class="mdescRight">calculates derivatives of vector fields  <a href="namespacecv__advection.html#a288564175dbabfb30d9991a26e83881d">More...</a><br /></td></tr>
<tr class="separator:a288564175dbabfb30d9991a26e83881d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84815d228aeaaff7ff8f8926cd481260"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a84815d228aeaaff7ff8f8926cd481260">diffus_cal_coeff</a> (DIFF_COEF_DIVDX, CV_NLOC, MAT_NLOC, NPHASE, MAT_NDGLN, SMATFEN, SCVFEN, GI, NDIM, TDIFFUSION, HDC, T_CV_NODJ, T_CV_NODI, ELE, ELE2, CVNORMX_ALL, LOC_DTX_ELE_ALL, LOC2_DTX_ELE_ALL, LOC_WIC_T_BC, CV_OTHER_LOC, MAT_OTHER_LOC, CV_SNLOC, CV_SLOC2LOC, on_domain_boundary, between_elements)</td></tr>
<tr class="memdesc:a84815d228aeaaff7ff8f8926cd481260"><td class="mdescLeft">&#160;</td><td class="mdescRight">This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX based on a non-linear method and a non-oscillating scheme. It requires the derivatives of the field obtained using DG_DERIVS_ALL DG_DERIVS_ALL.  <a href="namespacecv__advection.html#a84815d228aeaaff7ff8f8926cd481260">More...</a><br /></td></tr>
<tr class="separator:a84815d228aeaaff7ff8f8926cd481260"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba06a5f3680d58e1db30e740119dd5dc"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aba06a5f3680d58e1db30e740119dd5dc">dgsimplnorm_all</a> (NLOC, SNLOC, NDIM, XL_ALL, XSL_ALL, NORMX_ALL)</td></tr>
<tr class="memdesc:aba06a5f3680d58e1db30e740119dd5dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))  <a href="namespacecv__advection.html#aba06a5f3680d58e1db30e740119dd5dc">More...</a><br /></td></tr>
<tr class="separator:aba06a5f3680d58e1db30e740119dd5dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59bf765f03106e474053c6af073fb1ae"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a59bf765f03106e474053c6af073fb1ae">dgsimplnorm</a> (ELE, SILOC2ILOC, NLOC, SNLOC, XONDGL, X, Y, Z, NORMX, NORMY, NORMZ)</td></tr>
<tr class="memdesc:a59bf765f03106e474053c6af073fb1ae"><td class="mdescLeft">&#160;</td><td class="mdescRight">Form approximate surface normal (NORMX,NORMY,NORMZ)  <a href="namespacecv__advection.html#a59bf765f03106e474053c6af073fb1ae">More...</a><br /></td></tr>
<tr class="separator:a59bf765f03106e474053c6af073fb1ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a0d23f536863720989376a298e7bfca"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca">calc_sele</a> (ELE, ELE3, SELE, CV_SILOC, CV_ILOC, U_SLOC2LOC, CV_SLOC2LOC, FACE_ELE, gi, CV_funs, Mdims, CV_GIdims, CV_NDGLN, U_NDGLN, CV_SNDGLN, U_SNDGLN)</td></tr>
<tr class="memdesc:a9a0d23f536863720989376a298e7bfca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face on the boundary of the domain.  <a href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca">More...</a><br /></td></tr>
<tr class="separator:a9a0d23f536863720989376a298e7bfca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e1eb601b6c5bee7ee10ce9598fb73db"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a4e1eb601b6c5bee7ee10ce9598fb73db">put_in_ct_rhs</a> (GET_C_IN_CV_ADVDIF_AND_CALC_C_CV, ct_rhs_phase_cv_nodi, ct_rhs_phase_cv_nodj, final_phase, Mdims, CV_funs, ndgln, Mmat, GI, between_elements, on_domain_boundary, ELE, ELE2, SELE, HDC, MASS_ELE, JCOUNT_KLOC, ICOUNT_KLOC, C_JCOUNT_KLOC, C_ICOUNT_KLOC, U_SLOC2LOC, CV_SLOC2LOC, SCVDETWEI, CVNORMX_ALL, DEN_ALL, CV_NODI, CV_NODJ, WIC_U_BC_ALL, WIC_P_BC_ALL, SUF_P_BC_ALL, UGI_COEF_ELE_ALL, NDOTQ, LIMT, LIMDT, LIMT_HAT, LIMT2, NDOTQ_HAT, integrate_other_side_and_not_boundary, loc_u, THETA_VEL, UDGI_IMP_ALL, RCON, RCON_J, NDOTQ_IMP, X_ALL, SUF_D_BC_ALL, gravty)</td></tr>
<tr class="memdesc:a4e1eb601b6c5bee7ee10ce9598fb73db"><td class="mdescLeft">&#160;</td><td class="mdescRight">This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT, MmatCT_RHS It also computes the gradient matrix using the DCVFE method.  <a href="namespacecv__advection.html#a4e1eb601b6c5bee7ee10ce9598fb73db">More...</a><br /></td></tr>
<tr class="separator:a4e1eb601b6c5bee7ee10ce9598fb73db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb4c2b2bcca484786a8d6f3d1410c689"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aeb4c2b2bcca484786a8d6f3d1410c689">triloccords</a> (Xp, Yp, Zp, N1, N2, N3, N4, X1, Y1, Z1, X2, Y2, Z2, X3, Y3, Z3, X4, Y4, Z4)</td></tr>
<tr class="separator:aeb4c2b2bcca484786a8d6f3d1410c689"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a0899f179933a6d3cbc48431237aff7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a1a0899f179933a6d3cbc48431237aff7">triloccords2d</a> (Xp, Yp, N1, N2, N3, X1, Y1, X2, Y2, X3, Y3)</td></tr>
<tr class="separator:a1a0899f179933a6d3cbc48431237aff7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae140305e60c328f17beabcae47d8aa6f"><td class="memItemLeft" align="right" valign="top">logical function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f">shock_front_in_ele</a> (ele, Mdims, sat, ndgln, Imble_frac)</td></tr>
<tr class="memdesc:ae140305e60c328f17beabcae47d8aa6f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Detects whether the element has a shockfront or not.  <a href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f">More...</a><br /></td></tr>
<tr class="separator:ae140305e60c328f17beabcae47d8aa6f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a133a322640c972e4b8577bb3a2439357"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a133a322640c972e4b8577bb3a2439357">generate_laplacian_system</a> (Mdims, packed_state, ndgln, Mmat, Mspars, CV_funs, CV_GIdims, Sigma_field, Solution, K_fields, F_fields, intface_val_type)</td></tr>
<tr class="memdesc:a133a322640c972e4b8577bb3a2439357"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error.  <a href="namespacecv__advection.html#a133a322640c972e4b8577bb3a2439357">More...</a><br /></td></tr>
<tr class="separator:a133a322640c972e4b8577bb3a2439357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a504d3dce7eef9e4be29410c9eea88e17"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a504d3dce7eef9e4be29410c9eea88e17">scvdetnx</a> (Mdims, ndgln, X_ALL, CV_funs, CV_GIdims, on_domain_boundary, ELE, GI, SCVDETWEI, CVNORMX_ALL, XC_ALL, X_NOD, X_NODJ)</td></tr>
<tr class="separator:a504d3dce7eef9e4be29410c9eea88e17"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a939c43361c098c807280c739e30b5370"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a939c43361c098c807280c739e30b5370">wic_t_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:a939c43361c098c807280c739e30b5370"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f50cabe5b0bcd1018205e2d6f15f3ff"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a8f50cabe5b0bcd1018205e2d6f15f3ff">wic_t_bc_robin</a> = 2</td></tr>
<tr class="separator:a8f50cabe5b0bcd1018205e2d6f15f3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29adecab6c33872a56cf4775b4e1c3e3"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a29adecab6c33872a56cf4775b4e1c3e3">wic_t_bc_diri_adv_and_robin</a> = 3</td></tr>
<tr class="separator:a29adecab6c33872a56cf4775b4e1c3e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa646dbddd6308ea78c1c05d5b51c4d22"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#aa646dbddd6308ea78c1c05d5b51c4d22">wic_d_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:aa646dbddd6308ea78c1c05d5b51c4d22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ceb6fac2898be0cae2d603d5226f631"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a7ceb6fac2898be0cae2d603d5226f631">wic_u_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:a7ceb6fac2898be0cae2d603d5226f631"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6309cc2d2e0e51146784619230b6e70a"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6309cc2d2e0e51146784619230b6e70a">wic_u_bc_robin</a> = 2</td></tr>
<tr class="separator:a6309cc2d2e0e51146784619230b6e70a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab87709ec60fd78f0870ce18b9bbf7eb8"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#ab87709ec60fd78f0870ce18b9bbf7eb8">wic_u_bc_diri_adv_and_robin</a> = 3</td></tr>
<tr class="separator:ab87709ec60fd78f0870ce18b9bbf7eb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03129ee41533b2c78d1ec116019892fa"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a03129ee41533b2c78d1ec116019892fa">wic_u_bc_dirichlet_inout</a> = 2</td></tr>
<tr class="separator:a03129ee41533b2c78d1ec116019892fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03647ce996f35f7512f2206c2a4bc8d4"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a03647ce996f35f7512f2206c2a4bc8d4">wic_p_bc_dirichlet</a> = 1</td></tr>
<tr class="separator:a03647ce996f35f7512f2206c2a4bc8d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d139b0bd7722182c16855e683657878"><td class="memItemLeft" align="right" valign="top">integer, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacecv__advection.html#a6d139b0bd7722182c16855e683657878">wic_p_bc_free</a> = 2</td></tr>
<tr class="separator:a6d139b0bd7722182c16855e683657878"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This module contains all the tools to assemble and solve the equations and fields associated with the CV mesh, i.e. transport equation, continuity equation, DCVFE gradient matrix and the Laplacian system for the zeta-potential. </p>
</div><h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a9a0d23f536863720989376a298e7bfca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a0d23f536863720989376a298e7bfca">&#9670;&nbsp;</a></span>calc_sele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::calc_sele </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ELE3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>SELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>CV_SILOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_ILOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>U_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>FACE_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>gi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>U_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_SNDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>U_SNDGLN</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face on the boundary of the domain. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a9a0d23f536863720989376a298e7bfca_icgraph.png" border="0" usemap="#namespacecv__advection_a9a0d23f536863720989376a298e7bfca_icgraph" alt=""/></div>
<map name="namespacecv__advection_a9a0d23f536863720989376a298e7bfca_icgraph" id="namespacecv__advection_a9a0d23f536863720989376a298e7bfca_icgraph">
<area shape="rect" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="1452,199,1628,226"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,137,1181,163"/>
<area shape="rect" href="namespacecv__advection.html#a133a322640c972e4b8577bb3a2439357" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1229,221,1404,263"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,161,419,203"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,161,171,203"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1002,217,1171,273"/>
<area shape="rect" href="namespacemulti__sp.html#a3761caa03a0d114b25c395685b965a73" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="775,253,925,295"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#aa42a6f5cdc900bd4a54bb2b7be3975be" title="In this internal subrotuine the generation of output vts and checkpoint are performed." alt="" coords="504,312,671,353"/>
</map>
</div>

</div>
</div>
<a id="a904baa4815053bc8025c3ae2b8f69037"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a904baa4815053bc8025c3ae2b8f69037">&#9670;&nbsp;</a></span>cv_assemb()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::cv_assemb </td>
          <td>(</td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__discretization__opts.html">multi_discretization_opts</a>)&#160;</td>
          <td class="paramname"><em>Mdisopt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1porous__adv__coefs.html">porous_adv_coefs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(inout), target&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>velocity</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), target&#160;</td>
          <td class="paramname"><em>density</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__absorption.html">multi_absorption</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>multi_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>DIAG_SCALE_PRES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>DIAG_SCALE_PRES_COUP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout), allocatable&#160;</td>
          <td class="paramname"><em>INV_B</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), target&#160;</td>
          <td class="paramname"><em>DEN_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>DENOLD_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_DISOPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_DG_VEL_INT_OPT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>DT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>CV_BETA</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_SIG_DIAGTEN_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>DERIV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_P</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SOURCT_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in), pointer&#160;</td>
          <td class="paramname"><em>ABSORBT_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>VOLFRA_PORE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GETCV_DISC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GETCT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IGOT_T2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>IGOT_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GET_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>USE_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>ONE_M_THETA_FLUX_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>THETA_GDIFF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>MEAN_PORE_CV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>MASS_MN_PRES</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>THERMAL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>MASS_SUF</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout), optional&#160;</td>
          <td class="paramname"><em>MASS_ELE_TRANSP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(in), optional&#160;</td>
          <td class="paramname"><em>TDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in), optional, target&#160;</td>
          <td class="paramname"><em>saturation</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>VAD_parameter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>Phase_with_Pc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout), optional&#160;</td>
          <td class="paramname"><em>Courant_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( tensor_field ), intent(in), optional, pointer&#160;</td>
          <td class="paramname"><em>Permeability_tensor_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), optional&#160;</td>
          <td class="paramname"><em>calculate_mass_delta</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1pipe__coords.html">pipe_coords</a>), dimension(:), intent(in), optional&#160;</td>
          <td class="paramname"><em>eles_with_pipe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__pipe__package.html">multi_pipe_package</a>), intent(in)&#160;</td>
          <td class="paramname"><em>pipes_aux</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(in), optional&#160;</td>
          <td class="paramname"><em>porous_heat_coef</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :), intent(in), optional&#160;</td>
          <td class="paramname"><em>porous_heat_coef_old</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__outfluxes.html">multi_outfluxes</a>), intent(inout), optional&#160;</td>
          <td class="paramname"><em>outfluxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>solving_compositional</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in), optional&#160;</td>
          <td class="paramname"><em>nonlinear_iteration</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in), optional&#160;</td>
          <td class="paramname"><em>assemble_collapsed_to_one_phase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutines generates the transport equation for a cv field. It also can generate the Continuity equation if GETCT = .true. and also generate the gradient matrix of the momentum equation for the DCVFE method if the option is activated. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">state</td><td>Linked list containing all the fields defined in diamond and considered by Fluidity </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">final_phase</td><td>This is the final phase to be assembled, in this way we can assemble from phase 1 to final_phase not necessarily being for all the phases </td></tr>
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">FE_GIdims</td><td>Gauss integration numbers for FE fields </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">FE_funs</td><td>Shape functions for the FE mesh </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mdisopt</td><td>Discretisation options </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">upwnd</td><td>Sigmas to compute the fluxes at the interphase for porous media </td></tr>
    <tr><td class="paramname">tracer</td><td>Tracer considered for the transport equation </td></tr>
    <tr><td class="paramname">density</td><td>Density of the field </td></tr>
    <tr><td class="paramname">velocity</td><td>Velocity of the field </td></tr>
    <tr><td class="paramname">multi_absorp</td><td>Absoprtion of associated with the transport field </td></tr>
    <tr><td class="paramname">CV_DISOPT,CV_DG_VEL_INT_OPT,IGOT_THETA_FLUX.</td><td>More Discretisation options </td></tr>
    <tr><td class="paramname">IGOT_T2.</td><td>True (1) if solving for a tracer, false otherwise </td></tr>
    <tr><td class="paramname">DIAG_SCALE_PRES</td><td>Diagonal scaling of (distributed) pressure matrix (used to treat pressure implicitly) </td></tr>
    <tr><td class="paramname">DIAG_SCALE_PRES_COUP</td><td>Diagonal scaling of (distributed) pressure matrix (for wells) </td></tr>
    <tr><td class="paramname">INV_B</td><td>Coupling term of the wells </td></tr>
    <tr><td class="paramname">MASS_MN_PRES</td><td>?? </td></tr>
    <tr><td class="paramname">MASS_SUF</td><td>?? </td></tr>
    <tr><td class="paramname">DEN_ALL</td><td>Density of the field, different memory to the input field density, used to apply the Boussinesq approximation </td></tr>
    <tr><td class="paramname">DENOLD_ALL</td><td>Density of the field, different memory to the input field density, used to apply the Boussinesq approximation </td></tr>
    <tr><td class="paramname">THETA_GDIFF</td><td>! (nphase,Mdimscv_nonods) </td></tr>
    <tr><td class="paramname">THETA_FLUX,ONE_M_THETA_FLUX,THETA_FLUX_J,ONE_M_THETA_FLUX_J</td><td></td></tr>
    <tr><td class="paramname">DT,CV_BETA</td><td>Time step size and discretisation options </td></tr>
    <tr><td class="paramname">SUF_SIG_DIAGTEN_BC.</td><td>Like upwnd but for the boundary </td></tr>
    <tr><td class="paramname">DERIV</td><td>Derivative of the density against the pressure (nphase,Mdimscv_nonods) </td></tr>
    <tr><td class="paramname">CV_P</td><td>! Control volume pressure, useless for the DCVFEM (1,Mdimsnpres,Mdimscv_nonods) </td></tr>
    <tr><td class="paramname">SOURCT_ALL</td><td>Source term of the tracer equation </td></tr>
    <tr><td class="paramname">ABSORBT_ALL</td><td>Absorption to be used here </td></tr>
    <tr><td class="paramname">VOLFRA_PORE</td><td>Porosity field (Mdimsnpres,Mdimstotele) </td></tr>
    <tr><td class="paramname">GETCV_DISC</td><td>obtain the transport equation </td></tr>
    <tr><td class="paramname">GETCT</td><td>obtain the continuity equation </td></tr>
    <tr><td class="paramname">GET_THETA_FLUX,USE_THETA_FLUX</td><td></td></tr>
    <tr><td class="paramname">THERMAL</td><td>true if solving for heat transport </td></tr>
    <tr><td class="paramname">MEAN_PORE_CV</td><td>Porosity defined control volume wise </td></tr>
    <tr><td class="paramname">MASS_ELE_TRANSP</td><td>Mass of the elements </td></tr>
    <tr><td class="paramname">saturation</td><td>PhaseVolumeFraction field </td></tr>
    <tr><td class="paramname">TDIFFUSION</td><td>Diffusion associated with the tracer field </td></tr>
    <tr><td class="paramname">Phase_with_Pc</td><td>Field that defines the capillary pressure, i.e. non-wetting phase </td></tr>
    <tr><td class="paramname">VAD_parameter</td><td>Vanishing artificial diffusion parameter </td></tr>
    <tr><td class="paramname">Courant_number</td><td>Obvious ins't it? </td></tr>
    <tr><td class="paramname">Permeability_tensor_field</td><td>Permeability field </td></tr>
    <tr><td class="paramname">calculate_mass_delta</td><td>Variable used to control the mass conservation of the system </td></tr>
    <tr><td class="paramname">eles_with_pipe</td><td>Elements that have a pipe </td></tr>
    <tr><td class="paramname">pipes_aux</td><td>Information required to define wells </td></tr>
    <tr><td class="paramname">porous_heat_coef,porous_heat_coef_old</td><td>includes an average of porous and fluid heat coefficients </td></tr>
    <tr><td class="paramname">solving_compositional</td><td>Solving for composition if true </td></tr>
    <tr><td class="paramname">assemble_collapsed_to_one_phase</td><td>Collapses phases and solves for one single temperature. When there is thermal equilibrium </td></tr>
    <tr><td class="paramname">outfluxes</td><td>Contains all the fields required to compute the outfluxes of the model and create the outfluxes.csv file. Computed when assembling the continuity equation </td></tr>
    <tr><td class="paramname">nonlinear_iteration</td><td>Current non-linear iteration </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_cgraph.png" border="0" usemap="#namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_cgraph" alt=""/></div>
<map name="namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_cgraph" id="namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_cgraph">
<area shape="rect" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="5,517,195,543"/>
<area shape="rect" href="namespacemulti__pipes.html#a7cfd75b337f007460a86d927e152004e" title=": This sub modifies either MmatCT or the Advection&#45;diffusion equation for 1D pipe modelling NOTE fina..." alt="" coords="262,5,443,47"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="257,71,448,98"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="265,122,441,149"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="511,421,721,463"/>
<area shape="rect" href="namespacecv__advection.html#a288564175dbabfb30d9991a26e83881d" title="calculates derivatives of vector fields" alt="" coords="251,874,454,901"/>
<area shape="rect" href="namespacecv__advection.html#a84815d228aeaaff7ff8f8926cd481260" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX based on a non&#45;linear method..." alt="" coords="276,224,429,265"/>
<area shape="rect" href="namespacecv__advection.html#ad6eacfe287bc5562008363c3a93b772c" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="282,341,423,383"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a0039573fa9e1dc58af9768e61773c37e" title="Computes the flux between CVs for porous media. NDOTQNEW contains the fluxes for a given gauss integr..." alt="" coords="267,407,439,434"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aaf4c1b8dbf6fab41448a326e20f1a381" title=" " alt="" coords="272,458,433,485"/>
<area shape="rect" href="namespacecopy__outof__state.html#a0520a99d915a669f52eadab9a438194b" title="@DEPRECATED: Gets memory from packed state This subroutine returns a pointer to the desired values of..." alt="" coords="262,509,443,551"/>
<area shape="rect" href="namespacecopy__outof__state.html#abc850cced2fb9b525f015e758e4b45da" title=": For a given field, retrieve the associated old field name" alt="" coords="243,575,463,602"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a77201531d5bc443a857dce86befbb61e" title=" " alt="" coords="256,692,449,733"/>
<area shape="rect" href="namespacecv__advection.html#afe9ea10242e33e1921ac5526e6827999" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="282,627,423,668"/>
<area shape="rect" href="namespacecv__advection.html#a4e1eb601b6c5bee7ee10ce9598fb73db" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="275,757,431,799"/>
<area shape="rect" href="namespacemulti__tools.html#a225d95bb84187e3f0fcee8a3bd08b221" title=" " alt="" coords="277,823,428,850"/>
<area shape="rect" href="namespacecv__advection.html#a504d3dce7eef9e4be29410c9eea88e17" title=" " alt="" coords="783,457,958,483"/>
<area shape="rect" href="namespacecv__advection.html#ae140305e60c328f17beabcae47d8aa6f" title="Detects whether the element has a shockfront or not." alt="" coords="275,925,430,967"/>
<area shape="rect" href="namespacecopy__outof__state.html#ab4280b302a2f45375be2df118ed6d100" title=": Sets the boundary condition, if the time has advanced and the BCs changed, here they are set to the..." alt="" coords="259,991,446,1032"/>
<area shape="rect" href="namespacecopy__outof__state.html#a3e466dfb76c8c3e30de12d2f7d36d3bb" title=": Updates the outfluxes information based on NDOTQNEW, shape functions and transported fields for a g..." alt="" coords="259,1056,446,1097"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a79ef0980d4538eb6d60d63f82a5c5e3e" title="Computes the derivatives of vector fields." alt="" coords="558,849,674,875"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a279dc82b53707b674ea9b70360e7e258" title=" " alt="" coords="787,841,955,883"/>
<area shape="rect" href="namespacecv__advection.html#a59bf765f03106e474053c6af073fb1ae" title="Form approximate surface normal (NORMX,NORMY,NORMZ)" alt="" coords="769,790,972,817"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a915ed0656cc376f20e85f62cd9cec4de" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="1020,787,1188,828"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="523,231,709,258"/>
<area shape="rect" href="namespacecopy__outof__state.html#a1394fdd5e9adcc149eb319739c07f854" title=": Subroutine to calculate the integrated mass inside the domain" alt="" coords="515,692,717,733"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="541,627,691,668"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aa40294c371735f893e09254f0416ae74" title="This subroutine populates Bound_ele_correct and Bound_ele2_correct to properly apply the BCs when cre..." alt="" coords="523,757,709,799"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_icgraph.png" border="0" usemap="#namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_icgraph" alt=""/></div>
<map name="namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_icgraph" id="namespacecv__advection_a904baa4815053bc8025c3ae2b8f69037_icgraph">
<area shape="rect" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,107,1181,134"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,100,419,141"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,100,171,141"/>
</map>
</div>

</div>
</div>
<a id="ae1eba9d13ff146b1bf390a5de461d421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae1eba9d13ff146b1bf390a5de461d421">&#9670;&nbsp;</a></span>cv_count_faces()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer function cv_advection::cv_count_faces </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_ELE_TYPE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( <a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a> ), intent(in), optional&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine counts then number of faces in the control volume space. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_cgraph.png" border="0" usemap="#namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_cgraph" alt=""/></div>
<map name="namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_cgraph" id="namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_cgraph">
<area shape="rect" title="This subroutine counts then number of faces in the control volume space." alt="" coords="5,5,180,47"/>
<area shape="rect" href="namespaceshape__functions__linear__quadratic.html#a523197b210811772a490d2fecb451771" title=": Computes the number of Gauss integration points and all the necessary information" alt="" coords="228,5,404,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_icgraph.png" border="0" usemap="#namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_icgraph" alt=""/></div>
<map name="namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_icgraph" id="namespacecv__advection_ae1eba9d13ff146b1bf390a5de461d421_icgraph">
<area shape="rect" title="This subroutine counts then number of faces in the control volume space." alt="" coords="749,27,924,69"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,93,701,134"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,27,419,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#aa42a6f5cdc900bd4a54bb2b7be3975be" title="In this internal subrotuine the generation of output vts and checkpoint are performed." alt="" coords="501,27,667,69"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,100,396,127"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,27,171,69"/>
</map>
</div>

</div>
</div>
<a id="a288564175dbabfb30d9991a26e83881d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a288564175dbabfb30d9991a26e83881d">&#9670;&nbsp;</a></span>dg_derivs_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dg_derivs_all </td>
          <td>(</td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>T_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, :), intent(inout)&#160;</td>
          <td class="paramname"><em>DTX_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( :,  :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>WIC_T_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SUF_T_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, optional&#160;</td>
          <td class="paramname"><em>P0Mesh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>calculates derivatives of vector fields </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a288564175dbabfb30d9991a26e83881d_cgraph.png" border="0" usemap="#namespacecv__advection_a288564175dbabfb30d9991a26e83881d_cgraph" alt=""/></div>
<map name="namespacecv__advection_a288564175dbabfb30d9991a26e83881d_cgraph" id="namespacecv__advection_a288564175dbabfb30d9991a26e83881d_cgraph">
<area shape="rect" title="calculates derivatives of vector fields" alt="" coords="5,42,208,69"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a79ef0980d4538eb6d60d63f82a5c5e3e" title="Computes the derivatives of vector fields." alt="" coords="256,42,372,69"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a279dc82b53707b674ea9b70360e7e258" title=" " alt="" coords="437,5,605,47"/>
<area shape="rect" href="namespacecv__advection.html#a59bf765f03106e474053c6af073fb1ae" title="Form approximate surface normal (NORMX,NORMY,NORMZ)" alt="" coords="420,71,623,98"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a915ed0656cc376f20e85f62cd9cec4de" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="671,5,839,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a288564175dbabfb30d9991a26e83881d_icgraph.png" border="0" usemap="#namespacecv__advection_a288564175dbabfb30d9991a26e83881d_icgraph" alt=""/></div>
<map name="namespacecv__advection_a288564175dbabfb30d9991a26e83881d_icgraph" id="namespacecv__advection_a288564175dbabfb30d9991a26e83881d_icgraph">
<area shape="rect" title="calculates derivatives of vector fields" alt="" coords="1229,107,1432,134"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,107,1181,134"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,100,419,141"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,100,171,141"/>
</map>
</div>

</div>
</div>
<a id="a59bf765f03106e474053c6af073fb1ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59bf765f03106e474053c6af073fb1ae">&#9670;&nbsp;</a></span>dgsimplnorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dgsimplnorm </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>SILOC2ILOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>XONDGL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>Y</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>Z</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>NORMX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>NORMY</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>NORMZ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Form approximate surface normal (NORMX,NORMY,NORMZ) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a59bf765f03106e474053c6af073fb1ae_icgraph.png" border="0" usemap="#namespacecv__advection_a59bf765f03106e474053c6af073fb1ae_icgraph" alt=""/></div>
<map name="namespacecv__advection_a59bf765f03106e474053c6af073fb1ae_icgraph" id="namespacecv__advection_a59bf765f03106e474053c6af073fb1ae_icgraph">
<area shape="rect" title="Form approximate surface normal (NORMX,NORMY,NORMZ)" alt="" coords="1644,107,1847,134"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a79ef0980d4538eb6d60d63f82a5c5e3e" title="Computes the derivatives of vector fields." alt="" coords="1480,107,1596,134"/>
<area shape="rect" href="namespacecv__advection.html#a288564175dbabfb30d9991a26e83881d" title="calculates derivatives of vector fields" alt="" coords="1229,107,1432,134"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,107,1181,134"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,100,419,141"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,100,171,141"/>
</map>
</div>

</div>
</div>
<a id="aba06a5f3680d58e1db30e740119dd5dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba06a5f3680d58e1db30e740119dd5dc">&#9670;&nbsp;</a></span>dgsimplnorm_all()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::dgsimplnorm_all </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>XL_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, snloc ), intent(in)&#160;</td>
          <td class="paramname"><em>XSL_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim ), intent(inout)&#160;</td>
          <td class="paramname"><em>NORMX_ALL</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3)) </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aba06a5f3680d58e1db30e740119dd5dc_icgraph.png" border="0" usemap="#namespacecv__advection_aba06a5f3680d58e1db30e740119dd5dc_icgraph" alt=""/></div>
<map name="namespacecv__advection_aba06a5f3680d58e1db30e740119dd5dc_icgraph" id="namespacecv__advection_aba06a5f3680d58e1db30e740119dd5dc_icgraph">
<area shape="rect" title="Form approximate surface normal (NORMX_ALL(1),NORMX_ALL(2),NORMX_ALL(3))" alt="" coords="480,13,705,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#aa2eb04d27443c785084566c701903207" title="and faster to compute than for Navier&#45;Stokes. Therefore, here the RHS and the Mass matrix are compute..." alt="" coords="241,13,432,39"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="5,5,193,47"/>
</map>
</div>

</div>
</div>
<a id="a84815d228aeaaff7ff8f8926cd481260"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84815d228aeaaff7ff8f8926cd481260">&#9670;&nbsp;</a></span>diffus_cal_coeff()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::diffus_cal_coeff </td>
          <td>(</td>
          <td class="paramtype">real, dimension( nphase ), intent(inout)&#160;</td>
          <td class="paramname"><em>DIFF_COEF_DIVDX</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>MAT_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NPHASE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>MAT_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SMATFEN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>SCVFEN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>GI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>NDIM</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>TDIFFUSION</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>HDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>T_CV_NODJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>T_CV_NODI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CVNORMX_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, cv_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>LOC_DTX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( ndim, nphase, cv_nloc ), intent(in)&#160;</td>
          <td class="paramname"><em>LOC2_DTX_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( nphase ), intent(in)&#160;</td>
          <td class="paramname"><em>LOC_WIC_T_BC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_OTHER_LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>MAT_OTHER_LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_domain_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>between_elements</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX based on a non-linear method and a non-oscillating scheme. It requires the derivatives of the field obtained using DG_DERIVS_ALL DG_DERIVS_ALL. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_cgraph.png" border="0" usemap="#namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_cgraph" alt=""/></div>
<map name="namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_cgraph" id="namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_cgraph">
<area shape="rect" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX based on a non&#45;linear method..." alt="" coords="5,5,159,47"/>
<area shape="rect" href="namespacemulti__tools.html#a4f90f9b3033bd34d8d52d140a8b6d8cf" title=":This function is a tolerance function for a scalar which is used as a denominator...." alt="" coords="207,13,392,39"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_icgraph.png" border="0" usemap="#namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_icgraph" alt=""/></div>
<map name="namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_icgraph" id="namespacecv__advection_a84815d228aeaaff7ff8f8926cd481260_icgraph">
<area shape="rect" title="This sub calculates the effective diffusion coefficientd DIFF_COEF_DIVDX based on a non&#45;linear method..." alt="" coords="1229,100,1383,141"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,107,1181,134"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,100,419,141"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,100,171,141"/>
</map>
</div>

</div>
</div>
<a id="ad6eacfe287bc5562008363c3a93b772c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6eacfe287bc5562008363c3a93b772c">&#9670;&nbsp;</a></span>find_other_side()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::find_other_side </td>
          <td>(</td>
          <td class="paramtype">integer, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_OTHER_LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(inout)&#160;</td>
          <td class="paramname"><em>INTEGRAT_AT_GI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>X_NDGLN</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_SNLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CVFEM_ON_FACE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>X_SHARE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(inout)&#160;</td>
          <td class="paramname"><em>ELE2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>FINELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>COLELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>DISTCONTINUOUS_METHOD</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,GI)=.TRUE. if CV_KLOC is on the face that GI is centred on. Look for these nodes on the other elements. ELE2=0 also when we are between elements but are trying to integrate across the middle of a CV. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_ad6eacfe287bc5562008363c3a93b772c_icgraph.png" border="0" usemap="#namespacecv__advection_ad6eacfe287bc5562008363c3a93b772c_icgraph" alt=""/></div>
<map name="namespacecv__advection_ad6eacfe287bc5562008363c3a93b772c_icgraph" id="namespacecv__advection_ad6eacfe287bc5562008363c3a93b772c_icgraph">
<area shape="rect" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="1452,192,1593,233"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,137,1181,163"/>
<area shape="rect" href="namespacecv__advection.html#a133a322640c972e4b8577bb3a2439357" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1229,221,1404,263"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,161,419,203"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,161,171,203"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1002,217,1171,273"/>
<area shape="rect" href="namespacemulti__sp.html#a3761caa03a0d114b25c395685b965a73" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="775,253,925,295"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#aa42a6f5cdc900bd4a54bb2b7be3975be" title="In this internal subrotuine the generation of output vts and checkpoint are performed." alt="" coords="504,312,671,353"/>
</map>
</div>

</div>
</div>
<a id="a133a322640c972e4b8577bb3a2439357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a133a322640c972e4b8577bb3a2439357">&#9670;&nbsp;</a></span>generate_laplacian_system()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::generate_laplacian_system </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>Sigma_field</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( scalar_field ), intent(inout)&#160;</td>
          <td class="paramname"><em>Solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>K_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,:), intent(in)&#160;</td>
          <td class="paramname"><em>F_fields</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>intface_val_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: In this method we assemble and solve the Laplacian system using at least P1 elements The equation solved is the following: Div sigma Grad X = - SUM (Div K Grad F) with Neuman BCs = 0 where K and F are passed down as a vector. Therefore for n entries the SUM will be performed over n fields Example: F = (3, nphase, cv_nonods) would include three terms in the RHS and the same for K If harmonic average then we perform the harmonic average of sigma and K IMPORTANT: This subroutine requires the PHsparsity to be generated Note that this method solves considering FE fields. If using CV you may incur in an small error. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Mdims</td><td>Data type storing all the dimensions describing the mesh, fields, nodes, etc </td></tr>
    <tr><td class="paramname">packed_state</td><td>Linked list containing all the fields used by IC-FERST, memory partially shared with state </td></tr>
    <tr><td class="paramname">ndgln</td><td>Global to local variables </td></tr>
    <tr><td class="paramname">Mmat</td><td>Matrices for ICFERST </td></tr>
    <tr><td class="paramname">Mspars</td><td>Sparsity of the matrices </td></tr>
    <tr><td class="paramname">CV_funs</td><td>Shape functions for the CV mesh </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>Gauss integration numbers for CV fields </td></tr>
    <tr><td class="paramname">Sigma_field</td><td>Coefficient multipliying the left-hand side term </td></tr>
    <tr><td class="paramname">Solution</td><td>Solution field of type scalar_field, required to ensure consistency </td></tr>
    <tr><td class="paramname">K_fields</td><td>Coefficients multipliying the RHS terms </td></tr>
    <tr><td class="paramname">F_fields</td><td>RHS fierlds </td></tr>
    <tr><td class="paramname">intface_val_type</td><td>0 = no interpolation; 1 Harmonic mean; !20 for SP solver, harmonic mean considering charge; negative normal mean </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a133a322640c972e4b8577bb3a2439357_cgraph.png" border="0" usemap="#namespacecv__advection_a133a322640c972e4b8577bb3a2439357_cgraph" alt=""/></div>
<map name="namespacecv__advection_a133a322640c972e4b8577bb3a2439357_cgraph" id="namespacecv__advection_a133a322640c972e4b8577bb3a2439357_cgraph">
<area shape="rect" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="5,141,180,182"/>
<area shape="rect" href="namespacemulti__tools.html#aedaed2b29fa348112b4f347045e75ab6" title=": Calculate FACE_ELE &#45; the list of elements surrounding an element and referenced with a face &#45;ve val..." alt="" coords="238,5,429,32"/>
<area shape="rect" href="namespacecv__advection.html#a9a0d23f536863720989376a298e7bfca" title="Calculate surface element, surface control volume: SELE, CV_SILOC, U_SLOC2LOC, CV_SLOC2LOC for a face..." alt="" coords="245,56,421,83"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="228,107,439,149"/>
<area shape="rect" href="namespacecv__advection.html#ad6eacfe287bc5562008363c3a93b772c" title="We are on the boundary or next to another element. Determine CV_OTHER_LOC CVFEM_ON_FACE(CV_KLOC,..." alt="" coords="263,173,404,214"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#a659fc896150d136fb79922d4a3209b9b" title=": Computes the effective value of K or sigma. at the interface between CVs Based on the intface_type ..." alt="" coords="258,239,409,265"/>
<area shape="rect" href="namespacecv__advection.html#a504d3dce7eef9e4be29410c9eea88e17" title=" " alt="" coords="246,289,421,316"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a915ed0656cc376f20e85f62cd9cec4de" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="487,282,655,323"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a133a322640c972e4b8577bb3a2439357_icgraph.png" border="0" usemap="#namespacecv__advection_a133a322640c972e4b8577bb3a2439357_icgraph" alt=""/></div>
<map name="namespacecv__advection_a133a322640c972e4b8577bb3a2439357_icgraph" id="namespacecv__advection_a133a322640c972e4b8577bb3a2439357_icgraph">
<area shape="rect" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1096,35,1271,76"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="879,27,1048,83"/>
<area shape="rect" href="namespacemulti__sp.html#a3761caa03a0d114b25c395685b965a73" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="681,35,831,76"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#aa42a6f5cdc900bd4a54bb2b7be3975be" title="In this internal subrotuine the generation of output vts and checkpoint are performed." alt="" coords="467,5,633,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,35,419,76"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,35,171,76"/>
</map>
</div>

</div>
</div>
<a id="afe9ea10242e33e1921ac5526e6827999"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe9ea10242e33e1921ac5526e6827999">&#9670;&nbsp;</a></span>proj_cv_to_fem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::proj_cv_to_fem </td>
          <td>(</td>
          <td class="paramtype">type(state_type)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>fempsi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>psi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__sparsities.html">multi_sparsities</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>igetct</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>X</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>mass_mn_pres</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(tensor_field), intent(in)&#160;</td>
          <td class="paramname"><em>tracer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(vector_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_ave</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(vector_field_pointer), dimension(:), intent(inout)&#160;</td>
          <td class="paramname"><em>psi_int</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method is uncluded Subroutine description: (1) determine FEMT (finite element wise) etc from T (control volume wise) (2) (optional) calculate psi_int (area) and psi_ave (barycentre) over each CV. </p>
<dl class="section author"><dt>Author</dt><dd>Chris Pain, Pablo Salinas </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packed_state</td><td>! local state data </td></tr>
    <tr><td class="paramname">fempsi</td><td>! finite element field data </td></tr>
    <tr><td class="paramname">psi</td><td>! finite volume field data </td></tr>
    <tr><td class="paramname">Mdims</td><td>! dimension data </td></tr>
    <tr><td class="paramname">CV_GIdims</td><td>! gauss integer dimension data </td></tr>
    <tr><td class="paramname">CV_funs</td><td>! control volume shape function data </td></tr>
    <tr><td class="paramname">Mspars</td><td>! sparsity data </td></tr>
    <tr><td class="paramname">ndgln</td><td>! global numbering data </td></tr>
    <tr><td class="paramname">igetct</td><td>! whether to get CT matrix </td></tr>
    <tr><td class="paramname">X</td><td>! coordinates of the elements </td></tr>
    <tr><td class="paramname">mass_ele</td><td>! finite element mass </td></tr>
    <tr><td class="paramname">mass_mn_pres</td><td>! ?? </td></tr>
    <tr><td class="paramname">tracer</td><td>field to be projected </td></tr>
    <tr><td class="paramname">psi_int</td><td>! control volume area </td></tr>
    <tr><td class="paramname">psi_ave</td><td>! control volume barycentre </td></tr>
  </table>
  </dd>
</dl>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_cgraph.png" border="0" usemap="#namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_cgraph" alt=""/></div>
<map name="namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_cgraph" id="namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_cgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="5,39,147,80"/>
<area shape="rect" href="namespacemulti__data__types.html#a5641f05bcbbf1c56b952f99ed0cd1f67" title="Deallocates the required memory to store the derivatives of the shape functions." alt="" coords="195,5,405,47"/>
<area shape="rect" href="namespacematrix__operations.html#ae6b8bf3fc8ca7e4a1b4a1ea3b639d75e" title=": Find position in matrix POSMAT which has column GLOBJ" alt="" coords="225,71,375,112"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_icgraph.png" border="0" usemap="#namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_icgraph" alt=""/></div>
<map name="namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_icgraph" id="namespacecv__advection_afe9ea10242e33e1921ac5526e6827999_icgraph">
<area shape="rect" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="1229,100,1371,141"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,107,1181,134"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,100,419,141"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,100,171,141"/>
</map>
</div>

</div>
</div>
<a id="a4e1eb601b6c5bee7ee10ce9598fb73db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e1eb601b6c5bee7ee10ce9598fb73db">&#9670;&nbsp;</a></span>put_in_ct_rhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::put_in_ct_rhs </td>
          <td>(</td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>GET_C_IN_CV_ADVDIF_AND_CALC_C_CV</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>ct_rhs_phase_cv_nodi</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>ct_rhs_phase_cv_nodj</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>final_phase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (<a class="el" href="structmulti__data__types_1_1multi__matrices.html">multi_matrices</a>), intent(inout)&#160;</td>
          <td class="paramname"><em>Mmat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>GI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>between_elements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_domain_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>SELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>HDC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>MASS_ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>JCOUNT_KLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>ICOUNT_KLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>C_JCOUNT_KLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>C_ICOUNT_KLOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>U_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>CV_SLOC2LOC</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>SCVDETWEI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>CVNORMX_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>DEN_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_NODI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>CV_NODJ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:,:)&#160;</td>
          <td class="paramname"><em>WIC_U_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, dimension(:,:,:)&#160;</td>
          <td class="paramname"><em>WIC_P_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(inout)&#160;</td>
          <td class="paramname"><em>SUF_P_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>UGI_COEF_ELE_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>NDOTQ</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>LIMT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>LIMDT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>LIMT_HAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>LIMT2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>NDOTQ_HAT</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>integrate_other_side_and_not_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( :, :, : ), intent(in)&#160;</td>
          <td class="paramname"><em>loc_u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>THETA_VEL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>UDGI_IMP_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>RCON</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>RCON_J</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( final_phase ), intent(inout)&#160;</td>
          <td class="paramname"><em>NDOTQ_IMP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), pointer&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:,: ), pointer&#160;</td>
          <td class="paramname"><em>SUF_D_BC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>gravty</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT, MmatCT_RHS It also computes the gradient matrix using the DCVFE method. </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_cgraph.png" border="0" usemap="#namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_cgraph" alt=""/></div>
<map name="namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_cgraph" id="namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_cgraph">
<area shape="rect" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="5,5,161,47"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aa40294c371735f893e09254f0416ae74" title="This subroutine populates Bound_ele_correct and Bound_ele2_correct to properly apply the BCs when cre..." alt="" coords="209,5,396,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_icgraph.png" border="0" usemap="#namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_icgraph" alt=""/></div>
<map name="namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_icgraph" id="namespacecv__advection_a4e1eb601b6c5bee7ee10ce9598fb73db_icgraph">
<area shape="rect" title="This subroutine caculates the discretised cty eqn acting on the velocities i.e. MmatCT,..." alt="" coords="1229,100,1385,141"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,107,1181,134"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,100,419,141"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,100,171,141"/>
</map>
</div>

</div>
</div>
<a id="a504d3dce7eef9e4be29410c9eea88e17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a504d3dce7eef9e4be29410c9eea88e17">&#9670;&nbsp;</a></span>scvdetnx()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::scvdetnx </td>
          <td>(</td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:)&#160;</td>
          <td class="paramname"><em>X_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__shape__funs.html">multi_shape_funs</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__gi__dimensions.html">multi_gi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">logical, intent(in)&#160;</td>
          <td class="paramname"><em>on_domain_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>ELE</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>GI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>SCVDETWEI</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim, cv_gidims%scvngi ), intent(inout)&#160;</td>
          <td class="paramname"><em>CVNORMX_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%ndim ), intent(in)&#160;</td>
          <td class="paramname"><em>XC_ALL</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NOD</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>X_NODJ</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<hr  />
<ul>
<li>this subroutine computed the surface area at the Gi point (SCVDETWEI)</li>
<li>this subroutine calculates the control volume (CV)</li>
<li>CVNORMX, CVNORMY, CVNORMZ normals at the Gaussian</li>
<li>integration points GI. NODI = the current global</li>
<li>node number for the co-ordinates.</li>
<li>(XC,YC,ZC) is the centre of CV NODI</li>
</ul>
<hr  />
 <h2><a class="anchor" id="autotoc_md1"></a>
- date last modified : 25/08/2020</h2>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_cgraph.png" border="0" usemap="#namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_cgraph" alt=""/></div>
<map name="namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_cgraph" id="namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,180,39"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#a915ed0656cc376f20e85f62cd9cec4de" title="Calculate the normal at the Gauss pts Perform x&#45;product. N=T1 x T2." alt="" coords="228,5,396,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_icgraph.png" border="0" usemap="#namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_icgraph" alt=""/></div>
<map name="namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_icgraph" id="namespacecv__advection_a504d3dce7eef9e4be29410c9eea88e17_icgraph">
<area shape="rect" title=" " alt="" coords="1452,199,1627,226"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="992,137,1181,163"/>
<area shape="rect" href="namespacecv__advection.html#a133a322640c972e4b8577bb3a2439357" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1229,221,1404,263"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="756,5,944,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="758,71,942,112"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="497,129,677,171"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,195,708,236"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="470,12,705,53"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,161,419,203"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,19,396,46"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,161,171,203"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aeef4ba493db104704c886272f75f1f34" title=": In this method we assemble and solve the Laplacian system using at least P1 elements The equation s..." alt="" coords="1002,217,1171,273"/>
<area shape="rect" href="namespacemulti__sp.html#a3761caa03a0d114b25c395685b965a73" title=": This subroutine computes the saturated rock conductivity based on Tiab and Donaldson,..." alt="" coords="775,253,925,295"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#aa42a6f5cdc900bd4a54bb2b7be3975be" title="In this internal subrotuine the generation of output vts and checkpoint are performed." alt="" coords="504,312,671,353"/>
</map>
</div>

</div>
</div>
<a id="ae140305e60c328f17beabcae47d8aa6f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae140305e60c328f17beabcae47d8aa6f">&#9670;&nbsp;</a></span>shock_front_in_ele()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">logical function cv_advection::shock_front_in_ele </td>
          <td>(</td>
          <td class="paramtype">integer&#160;</td>
          <td class="paramname"><em>ele</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__dimensions.html">multi_dimensions</a>), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(<a class="el" href="structmulti__data__types_1_1multi__ndgln.html">multi_ndgln</a>), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>Imble_frac</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Detects whether the element has a shockfront or not. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_ae140305e60c328f17beabcae47d8aa6f_icgraph.png" border="0" usemap="#namespacecv__advection_ae140305e60c328f17beabcae47d8aa6f_icgraph" alt=""/></div>
<map name="namespacecv__advection_ae140305e60c328f17beabcae47d8aa6f_icgraph" id="namespacecv__advection_ae140305e60c328f17beabcae47d8aa6f_icgraph">
<area shape="rect" title="Detects whether the element has a shockfront or not." alt="" coords="1301,64,1456,105"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae48bbf14b3a637156be0ca7daefc590c" title="Subroutine that calculates the backtrack_par_factor based on Machine Learning. The inputs of the Mach..." alt="" coords="1039,5,1253,47"/>
<area shape="rect" href="namespacecv__advection.html#a904baa4815053bc8025c3ae2b8f69037" title="This subroutines generates the transport equation for a cv field. It also can generate the Continuity..." alt="" coords="1051,71,1241,98"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a4d12626bedcc63285cc6c18affa3842e" title=" " alt="" coords="1074,122,1218,149"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="749,5,991,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,97,419,139"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,97,171,139"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a2ca070e362a90a07dcb98eada12a622f" title="WARNING: It is currently not working well...better to use Chris&#39; method which uses a RHS." alt="" coords="776,123,964,164"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a98e757b51a04b55df8d38e36470e0b96" title="Calls to generate the transport equation for the transport of energy/temperature and to solve the tra..." alt="" coords="778,188,962,229"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#aa5819c18b57b8144faa1885776a2cc8b" title="Calls to generate and solve the transport equation for n passive tracers defined in diamond as Passiv..." alt="" coords="494,65,674,107"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#a871f4ede396b430a5194023196511192" title=":In this subroutine the components are solved for all the phases. Systems for each component are asse..." alt="" coords="467,185,701,227"/>
<area shape="rect" href="multi__dyncore__dg_8_f90.html#a171ba3eb037458ea0b2f128257e43588" title="WARNING: Still work in progress." alt="" coords="241,193,396,219"/>
</map>
</div>

</div>
</div>
<a id="aeb4c2b2bcca484786a8d6f3d1410c689"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb4c2b2bcca484786a8d6f3d1410c689">&#9670;&nbsp;</a></span>triloccords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::triloccords </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Zp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Z1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Z2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Z3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y4</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Z4</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_cgraph.png" border="0" usemap="#namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_cgraph" alt=""/></div>
<map name="namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_cgraph" id="namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,189,32"/>
<area shape="rect" href="namespacemulti__tools.html#a9455b92cfb559c3b76e4b77580886c47" title=" " alt="" coords="237,5,408,32"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_icgraph.png" border="0" usemap="#namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_icgraph" alt=""/></div>
<map name="namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_icgraph" id="namespacecv__advection_aeb4c2b2bcca484786a8d6f3d1410c689_icgraph">
<area shape="rect" title=" " alt="" coords="176,5,360,32"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aad25281c21796ab5cdd1ecf160cdad8f" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<a id="a1a0899f179933a6d3cbc48431237aff7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a0899f179933a6d3cbc48431237aff7">&#9670;&nbsp;</a></span>triloccords2d()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine cv_advection::triloccords2d </td>
          <td>(</td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Xp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Yp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>N3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y2</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>X3</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real&#160;</td>
          <td class="paramname"><em>Y3</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_cgraph.png" border="0" usemap="#namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_cgraph" alt=""/></div>
<map name="namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_cgraph" id="namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,205,39"/>
<area shape="rect" href="namespaceshape__functions__ndim.html#af4782b913aba9aef1af79d9db7c1739a" title=" " alt="" coords="253,5,421,47"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_icgraph.png" border="0" usemap="#namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_icgraph" alt=""/></div>
<map name="namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_icgraph" id="namespacecv__advection_a1a0899f179933a6d3cbc48431237aff7_icgraph">
<area shape="rect" title=" " alt="" coords="176,5,376,32"/>
<area shape="rect" href="cv-adv-dif_8_f90.html#aad25281c21796ab5cdd1ecf160cdad8f" title=" " alt="" coords="5,5,128,32"/>
</map>
</div>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="aa646dbddd6308ea78c1c05d5b51c4d22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa646dbddd6308ea78c1c05d5b51c4d22">&#9670;&nbsp;</a></span>wic_d_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_d_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03647ce996f35f7512f2206c2a4bc8d4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03647ce996f35f7512f2206c2a4bc8d4">&#9670;&nbsp;</a></span>wic_p_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_p_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6d139b0bd7722182c16855e683657878"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d139b0bd7722182c16855e683657878">&#9670;&nbsp;</a></span>wic_p_bc_free</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_p_bc_free = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a29adecab6c33872a56cf4775b4e1c3e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29adecab6c33872a56cf4775b4e1c3e3">&#9670;&nbsp;</a></span>wic_t_bc_diri_adv_and_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_t_bc_diri_adv_and_robin = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a939c43361c098c807280c739e30b5370"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a939c43361c098c807280c739e30b5370">&#9670;&nbsp;</a></span>wic_t_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_t_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a8f50cabe5b0bcd1018205e2d6f15f3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f50cabe5b0bcd1018205e2d6f15f3ff">&#9670;&nbsp;</a></span>wic_t_bc_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_t_bc_robin = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="ab87709ec60fd78f0870ce18b9bbf7eb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab87709ec60fd78f0870ce18b9bbf7eb8">&#9670;&nbsp;</a></span>wic_u_bc_diri_adv_and_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_diri_adv_and_robin = 3</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a7ceb6fac2898be0cae2d603d5226f631"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7ceb6fac2898be0cae2d603d5226f631">&#9670;&nbsp;</a></span>wic_u_bc_dirichlet</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_dirichlet = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a03129ee41533b2c78d1ec116019892fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03129ee41533b2c78d1ec116019892fa">&#9670;&nbsp;</a></span>wic_u_bc_dirichlet_inout</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_dirichlet_inout = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a id="a6309cc2d2e0e51146784619230b6e70a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6309cc2d2e0e51146784619230b6e70a">&#9670;&nbsp;</a></span>wic_u_bc_robin</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">integer, parameter cv_advection::wic_u_bc_robin = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacecv__advection.html">cv_advection</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
