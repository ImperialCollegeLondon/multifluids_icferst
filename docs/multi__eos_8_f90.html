<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: /home/mbahlali/Softwares/MultiFluids_Dev/ICFERST/src/multi_eos.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ICFERST
   &#160;<span id="projectnumber">22-06</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('multi__eos_8_f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">multi_eos.F90 File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;fdebug.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for multi_eos.F90:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90__incl.png" border="0" usemap="#_2home_2mbahlali_2_softwares_2_multi_fluids___dev_2_i_c_f_e_r_s_t_2src_2multi__eos_8_f90" alt=""/></div>
<map name="_2home_2mbahlali_2_softwares_2_multi_fluids___dev_2_i_c_f_e_r_s_t_2src_2multi__eos_8_f90" id="_2home_2mbahlali_2_softwares_2_multi_fluids___dev_2_i_c_f_e_r_s_t_2src_2multi__eos_8_f90">
<area shape="rect" title=" " alt="" coords="5,5,199,61"/>
<area shape="rect" title=" " alt="" coords="63,109,141,136"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemultiphase__eos"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html">multiphase_eos</a></td></tr>
<tr class="memdesc:namespacemultiphase__eos"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module contains subroutines related to the equations of state and other properties such as relative permeabilities, capillary, flash, etc. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:ab16c45da0af88c69945beac4e3334349"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349">multiphase_eos::calculate_all_rhos</a> (state, packed_state, Mdims, get_RhoCp)</td></tr>
<tr class="memdesc:ab16c45da0af88c69945beac4e3334349"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density for the phases and the derivatives of the density  <a href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349">More...</a><br /></td></tr>
<tr class="separator:ab16c45da0af88c69945beac4e3334349"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa45791df12ab50edf07b075fc8c83335"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa45791df12ab50edf07b075fc8c83335">multiphase_eos::cap_bulk_rho</a> (state, ncomp, nphase, cv_nonods, Density_Component, Density, Density_Cp, compute_rhoCP)</td></tr>
<tr class="memdesc:aa45791df12ab50edf07b075fc8c83335"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the bulk density for components and the derivatives of the density  <a href="namespacemultiphase__eos.html#aa45791df12ab50edf07b075fc8c83335">More...</a><br /></td></tr>
<tr class="separator:aa45791df12ab50edf07b075fc8c83335"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c4f57d9c50b3421a8059d73fb260dd5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5">multiphase_eos::calculate_component_rho</a> (state, packed_state, Mdims)</td></tr>
<tr class="memdesc:a3c4f57d9c50b3421a8059d73fb260dd5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density for the components and the derivatives of the density This is were the action is actually done, the other calculate rhos are wrappers  <a href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5">More...</a><br /></td></tr>
<tr class="separator:a3c4f57d9c50b3421a8059d73fb260dd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6a1c7227872bf2073b960ddfabedee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee">multiphase_eos::calculate_rho_drhodp</a> (state, packed_state, iphase, icomp, nphase, ncomp, eos_option_path, rho, drhodp)</td></tr>
<tr class="memdesc:a3f6a1c7227872bf2073b960ddfabedee"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density and the derivative of the density  <a href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee">More...</a><br /></td></tr>
<tr class="separator:a3f6a1c7227872bf2073b960ddfabedee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d9a124e3bfdcebea01989fde6ea5cd1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#a5d9a124e3bfdcebea01989fde6ea5cd1">linear_eos_formula</a> (rho_internal)</td></tr>
<tr class="separator:a5d9a124e3bfdcebea01989fde6ea5cd1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab548da6c93ce257b9cec9b1c27a9390a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ab548da6c93ce257b9cec9b1c27a9390a">multiphase_eos::calculate_porous_rho_drhop</a> (state, packed_state, Mdims, cv_ndgln, drhodp_porous)</td></tr>
<tr class="memdesc:ab548da6c93ce257b9cec9b1c27a9390a"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine we calculate and update the density of the porous media based on the compressibility given in Diamond (ele-wise). We also calculate the drho/dp term for the porous media which then goes into the DERIV term in the continuity equation (cv-wise).  <a href="namespacemultiphase__eos.html#ab548da6c93ce257b9cec9b1c27a9390a">More...</a><br /></td></tr>
<tr class="separator:ab548da6c93ce257b9cec9b1c27a9390a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a44aebb6e29a5271abb6ec2b04f213b56"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56">multiphase_eos::density_polynomial</a> (eos_coefs, pressure, temperature, Density_Field)</td></tr>
<tr class="memdesc:a44aebb6e29a5271abb6ec2b04f213b56"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Define de density as a polynomial  <a href="namespacemultiphase__eos.html#a44aebb6e29a5271abb6ec2b04f213b56">More...</a><br /></td></tr>
<tr class="separator:a44aebb6e29a5271abb6ec2b04f213b56"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13395594592fe917fc20b7c3c2b7a5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d">multiphase_eos::assign_equation_of_state</a> (eos_option_path_out)</td></tr>
<tr class="memdesc:ac13395594592fe917fc20b7c3c2b7a5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Read from diamond and decide which sort of density representation do we have  <a href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d">More...</a><br /></td></tr>
<tr class="separator:ac13395594592fe917fc20b7c3c2b7a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d4a7655cae6c58eae3fc141d80d5639"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639">multiphase_eos::calculate_porousmedia_absorptionterms</a> (nphase, state, packed_state, PorousMedia_absorp, Mdims, CV_funs, CV_GIdims, Mspars, ndgln, upwnd, suf_sig_diagten_bc)</td></tr>
<tr class="memdesc:a1d4a7655cae6c58eae3fc141d80d5639"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Here we compute the absorption for porous media This is the sigma term defined in the papers and contains The permeability, the relative permeability, the viscosity and the saturation  <a href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639">More...</a><br /></td></tr>
<tr class="separator:a1d4a7655cae6c58eae3fc141d80d5639"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e38f3c2af7da0c1a95bbb5e485cf0b7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7">calculate_porousmedia_adv_terms</a> (nphase, state, packed_state, PorousMedia_absorp, Mdims, ndgln, upwnd, viscosities)</td></tr>
<tr class="memdesc:a2e38f3c2af7da0c1a95bbb5e485cf0b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the absorption and its derivatives against the saturation  <a href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7">More...</a><br /></td></tr>
<tr class="separator:a2e38f3c2af7da0c1a95bbb5e485cf0b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7b4b5e95a2c1b64f376a9c4092d60c0a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a">calculate_suf_sig_diagten_bc</a> (nphase, packed_state, suf_sig_diagten_bc, Mdims, CV_funs, CV_GIdims, Mspars, ndgln, PorousMedia_absorp, state, inv_perm, viscosities)</td></tr>
<tr class="memdesc:a7b4b5e95a2c1b64f376a9c4092d60c0a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the absorption and its derivatives against the saturation on the boundary  <a href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a">More...</a><br /></td></tr>
<tr class="separator:a7b4b5e95a2c1b64f376a9c4092d60c0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa152716c3e7e6d83fb9b90b26a9c7be7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#aa152716c3e7e6d83fb9b90b26a9c7be7">set_viscosity</a> (nphase, Mdims, state, visc_phases)</td></tr>
<tr class="memdesc:aa152716c3e7e6d83fb9b90b26a9c7be7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: For porous media, just sets the viscosity as a scalar  <a href="multi__eos_8_f90.html#aa152716c3e7e6d83fb9b90b26a9c7be7">More...</a><br /></td></tr>
<tr class="separator:aa152716c3e7e6d83fb9b90b26a9c7be7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a659427fd61af753266767259b441a345"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345">multiphase_eos::calculate_absorption2</a> (nphase, packed_state, PorousMedia_absorp, Mdims, ndgln, SATURA, viscosities, inv_PorousMedia_absorp)</td></tr>
<tr class="memdesc:a659427fd61af753266767259b441a345"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine where the absorption for the porous media is actually computed  <a href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345">More...</a><br /></td></tr>
<tr class="separator:a659427fd61af753266767259b441a345"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af235dd0c336c71b8afbfb65399766c10"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10">multiphase_eos::get_material_absorption</a> (nphase, iphase, material_absorption, sat, visc, CV_Immobile_fract, Corey_exponent, Endpoint_relperm)</td></tr>
<tr class="memdesc:af235dd0c336c71b8afbfb65399766c10"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases  <a href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10">More...</a><br /></td></tr>
<tr class="separator:af235dd0c336c71b8afbfb65399766c10"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa5bc056e9d4cafeb1706afca8e780c1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1">multiphase_eos::get_relperm</a> (nphase, iphase, sat, CV_Immobile_fract, Corey_exponent, Endpoint_relperm, Kr)</td></tr>
<tr class="memdesc:afa5bc056e9d4cafeb1706afca8e780c1"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases  <a href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1">More...</a><br /></td></tr>
<tr class="separator:afa5bc056e9d4cafeb1706afca8e780c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f94604be6099dd1304ee7568ad7aac1"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1">relperm_corey_epsilon</a> (Kr)</td></tr>
<tr class="memdesc:a0f94604be6099dd1304ee7568ad7aac1"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid getting a relperm=0 that may give problems when dividing it to obtain the sigma.  <a href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1">More...</a><br /></td></tr>
<tr class="separator:a0f94604be6099dd1304ee7568ad7aac1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb461540e77781fc8560dcdf98a7ed12"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12">relperm_stone</a> (Kr)</td></tr>
<tr class="memdesc:afb461540e77781fc8560dcdf98a7ed12"><td class="mdescLeft">&#160;</td><td class="mdescRight">:This subroutine calculates the relative permeability for three phases First phase has to be water, second oil and the third gas We use Stone's model II adapted, and for the two phases we use the Corey model Model explained in: Aziz, K. And Settari, T.:“Petroleum Reservoir Simulation” Applied Science Publishers, London, 30-38, 1979.  <a href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12">More...</a><br /></td></tr>
<tr class="separator:afb461540e77781fc8560dcdf98a7ed12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:add6fbcd53b92e8dd346a9ac6fbc30055"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#add6fbcd53b92e8dd346a9ac6fbc30055">multiphase_eos::calculate_capillary_pressure</a> (packed_state, NDGLN, totele, cv_nloc, CV_funs)</td></tr>
<tr class="memdesc:add6fbcd53b92e8dd346a9ac6fbc30055"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine the capilalry pressure is computed based on the saturation and the formula used  <a href="namespacemultiphase__eos.html#add6fbcd53b92e8dd346a9ac6fbc30055">More...</a><br /></td></tr>
<tr class="separator:add6fbcd53b92e8dd346a9ac6fbc30055"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd1caed43acc66691c351206d8dd7b2c"><td class="memItemLeft" align="right" valign="top">pure real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#acd1caed43acc66691c351206d8dd7b2c">get_cappressure</a> (sat, Pe, a, CV_Immobile_Fraction, Imbibition_term, iphase)</td></tr>
<tr class="memdesc:acd1caed43acc66691c351206d8dd7b2c"><td class="mdescLeft">&#160;</td><td class="mdescRight">:This functions returns the capillary pressure for a certain input saturation  <a href="multi__eos_8_f90.html#acd1caed43acc66691c351206d8dd7b2c">More...</a><br /></td></tr>
<tr class="separator:acd1caed43acc66691c351206d8dd7b2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dfd3eac29921ca66854cebaa01162f9"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9">multiphase_eos::get_devcappressure</a> (sat, Pe, a, CV_Immobile_Fraction, iphase, nphase)</td></tr>
<tr class="memdesc:a7dfd3eac29921ca66854cebaa01162f9"><td class="mdescLeft">&#160;</td><td class="mdescRight">:This functions returns the derivative of the capillary pressure with respect to the saturation  <a href="namespacemultiphase__eos.html#a7dfd3eac29921ca66854cebaa01162f9">More...</a><br /></td></tr>
<tr class="separator:a7dfd3eac29921ca66854cebaa01162f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac21530a3f76ed685a2ce5fcb0bb11bd0"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0">multiphase_eos::calculate_u_source_cv</a> (Mdims, state, packed_state, den, u_source_cv)</td></tr>
<tr class="memdesc:ac21530a3f76ed685a2ce5fcb0bb11bd0"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine computed the gravity effect, i.e. rho * g  <a href="namespacemultiphase__eos.html#ac21530a3f76ed685a2ce5fcb0bb11bd0">More...</a><br /></td></tr>
<tr class="separator:ac21530a3f76ed685a2ce5fcb0bb11bd0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa7fff87db23a4e3474815ee4a821e1cd"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd">multiphase_eos::calculate_diffusivity</a> (state, packed_state, Mdims, ndgln, ScalarAdvectionField_Diffusion, TracerName, divide_by_rho_CP)</td></tr>
<tr class="memdesc:aa7fff87db23a4e3474815ee4a821e1cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Here we compute component/solute/thermal diffusion coefficient  <a href="namespacemultiphase__eos.html#aa7fff87db23a4e3474815ee4a821e1cd">More...</a><br /></td></tr>
<tr class="separator:aa7fff87db23a4e3474815ee4a821e1cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae417127536bdb365fbdde3951524a9d6"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6">multiphase_eos::calculate_solute_dispersity</a> (state, packed_state, Mdims, ndgln, density, SoluteDispersion)</td></tr>
<tr class="memdesc:ae417127536bdb365fbdde3951524a9d6"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Dispersion for porous media For thermal, the field density needs to be passed down, which ensures that even for boussinesq a reference density is still used  <a href="namespacemultiphase__eos.html#ae417127536bdb365fbdde3951524a9d6">More...</a><br /></td></tr>
<tr class="separator:ae417127536bdb365fbdde3951524a9d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26eebc3a39a15f39961c783b8558fbef"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a26eebc3a39a15f39961c783b8558fbef">multiphase_eos::calculate_viscosity</a> (state, Mdims, ndgln, Momentum_Diffusion, Momentum_Diffusion2)</td></tr>
<tr class="memdesc:a26eebc3a39a15f39961c783b8558fbef"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the viscosity effect as a momemtum diffusion, this is zero for porous media  <a href="namespacemultiphase__eos.html#a26eebc3a39a15f39961c783b8558fbef">More...</a><br /></td></tr>
<tr class="separator:a26eebc3a39a15f39961c783b8558fbef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba2170c291d049cf032d6b1a253aa276"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aba2170c291d049cf032d6b1a253aa276">multiphase_eos::compute_viscosity_eos</a> (state, Mdims)</td></tr>
<tr class="memdesc:aba2170c291d049cf032d6b1a253aa276"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine we compute the viscosity EOS. Options for different EOS.  <a href="namespacemultiphase__eos.html#aba2170c291d049cf032d6b1a253aa276">More...</a><br /></td></tr>
<tr class="separator:aba2170c291d049cf032d6b1a253aa276"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48">multiphase_eos::update_velocity_absorption</a> (states, ndim, nphase, velocity_absorption)</td></tr>
<tr class="memdesc:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&lt;INERTIA ONLY&gt;Computes velocity absorption from diamond information  <a href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48">More...</a><br /></td></tr>
<tr class="separator:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98927879ae36867eabec1a9e6a5f22d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8">multiphase_eos::update_velocity_absorption_coriolis</a> (states, ndim, nphase, velocity_absorption)</td></tr>
<tr class="memdesc:a98927879ae36867eabec1a9e6a5f22d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Computes velocity absorption associated to coriolis forces from diamond information  <a href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8">More...</a><br /></td></tr>
<tr class="separator:a98927879ae36867eabec1a9e6a5f22d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f7f68ee8d294089b9077c480795eb9c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a8f7f68ee8d294089b9077c480795eb9c">multiphase_eos::update_velocity_source</a> (states, Mdims, u_source)</td></tr>
<tr class="memdesc:a8f7f68ee8d294089b9077c480795eb9c"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Computes velocity source from diamond information  <a href="namespacemultiphase__eos.html#a8f7f68ee8d294089b9077c480795eb9c">More...</a><br /></td></tr>
<tr class="separator:a8f7f68ee8d294089b9077c480795eb9c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2591de41e9c67340b83129722447923b"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2591de41e9c67340b83129722447923b">multiphase_eos::saturation_temperature</a> (pressure)</td></tr>
<tr class="memdesc:a2591de41e9c67340b83129722447923b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: ????  <a href="namespacemultiphase__eos.html#a2591de41e9c67340b83129722447923b">More...</a><br /></td></tr>
<tr class="separator:a2591de41e9c67340b83129722447923b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb644e3565a7e33c61f0e40e73a3c990"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990">multiphase_eos::get_rockfluidprop</a> (state, packed_state, Mdims, ndgln, current_time, update_only)</td></tr>
<tr class="memdesc:aeb644e3565a7e33c61f0e40e73a3c990"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed state By index this is: 1) immobile fraction, 2) relperm max, 3)relperm exponent 4)Capillary entry pressure 5) Capillary exponent 6) Capillary imbition term The effective inmobile fraction is the min(inmobile,saturation_flipping formula), being the saturation the value after a succesful non-linear solver convergence! This NEEDS to be called after a succesful non-linear solver (with update_only)  <a href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990">More...</a><br /></td></tr>
<tr class="separator:aeb644e3565a7e33c61f0e40e73a3c990"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a098f3f1c27b74be5d61f21fcff4c50a7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="multi__eos_8_f90.html#a098f3f1c27b74be5d61f21fcff4c50a7">update_saturation_flipping</a> (sat_flip, sat, old_Sat)</td></tr>
<tr class="memdesc:a098f3f1c27b74be5d61f21fcff4c50a7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This internal subroutine checks the if we are flipping from drainage to imbibition, or the other way round, and updates if required the value stored in Saturation_flipping Saturation_flipping stores both the value and the history, being positive if the phase is increasing and negative if the phase is decreasing. Therefore its minimum absolute value is non-zero NOTE: Currently the trapping can only increase, i.e. no thermal effects have been considered  <a href="multi__eos_8_f90.html#a098f3f1c27b74be5d61f21fcff4c50a7">More...</a><br /></td></tr>
<tr class="separator:a098f3f1c27b74be5d61f21fcff4c50a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac01c010ab184f242b5ca90a44d40affa"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac01c010ab184f242b5ca90a44d40affa">multiphase_eos::jwl</a> (A, B, w, R1, R2, E0, p, roe, ro)</td></tr>
<tr class="memdesc:ac01c010ab184f242b5ca90a44d40affa"><td class="mdescLeft">&#160;</td><td class="mdescRight">JWL equation functions.  <a href="namespacemultiphase__eos.html#ac01c010ab184f242b5ca90a44d40affa">More...</a><br /></td></tr>
<tr class="separator:ac01c010ab184f242b5ca90a44d40affa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7870c763c81a10948617345c3d0ca219"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7870c763c81a10948617345c3d0ca219">multiphase_eos::diffjwl</a> (A, B, w, R1, R2, E0, roe, ro)</td></tr>
<tr class="memdesc:a7870c763c81a10948617345c3d0ca219"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diff of JWL equation functions.  <a href="namespacemultiphase__eos.html#a7870c763c81a10948617345c3d0ca219">More...</a><br /></td></tr>
<tr class="separator:a7870c763c81a10948617345c3d0ca219"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8585fdea6dd3d2ca6508cf37236a7cc0"><td class="memItemLeft" align="right" valign="top">real function, dimension(jwln)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a8585fdea6dd3d2ca6508cf37236a7cc0">multiphase_eos::jwldensity</a> (eos_coefs, pressure, ro0, JWLn)</td></tr>
<tr class="memdesc:a8585fdea6dd3d2ca6508cf37236a7cc0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density of JWL equation functions.  <a href="namespacemultiphase__eos.html#a8585fdea6dd3d2ca6508cf37236a7cc0">More...</a><br /></td></tr>
<tr class="separator:a8585fdea6dd3d2ca6508cf37236a7cc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f5f7836734b85fb788ba57a2793eda7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3f5f7836734b85fb788ba57a2793eda7">multiphase_eos::initialise_porous_media</a> (Mdims, ndgln, packed_state, state, exit_initialise_porous_media)</td></tr>
<tr class="memdesc:a3f5f7836734b85fb788ba57a2793eda7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Initialising porous media models Given a free water level (FWL) we simulate capillary gravity equilibration, control volumes below FWL is kept at residual lighter phase saturation This subroutine is called after each timestep and saturations overidden below FWL with the heavier phase  <a href="namespacemultiphase__eos.html#a3f5f7836734b85fb788ba57a2793eda7">More...</a><br /></td></tr>
<tr class="separator:a3f5f7836734b85fb788ba57a2793eda7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282f02f39508adfb64d99bf4659af86c"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c">multiphase_eos::retrieve_reference_density</a> (state, packed_state, iphase, icomp, nphase)</td></tr>
<tr class="memdesc:a282f02f39508adfb64d99bf4659af86c"><td class="mdescLeft">&#160;</td><td class="mdescRight">: For boussinesq porous media we need the reference density to ensure consistency when mixing with the porous density/Cp etc. In this subroutine we retrieve the value given a phase, component.  <a href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c">More...</a><br /></td></tr>
<tr class="separator:a282f02f39508adfb64d99bf4659af86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a439637e5906b37a16646c186d7fc0daf"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a439637e5906b37a16646c186d7fc0daf">multiphase_eos::flash_gas_dissolution</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:a439637e5906b37a16646c186d7fc0daf"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to dissolv phase2 into phase1. Currently only for system for phase 1 = water, phase 2 = gas Dissolve instantaneously the amount introduced in diamond in mol/m3 for CO2 a reference number is 38 mol/m3. Requires the first phase to have a concentration field  <a href="namespacemultiphase__eos.html#a439637e5906b37a16646c186d7fc0daf">More...</a><br /></td></tr>
<tr class="separator:a439637e5906b37a16646c186d7fc0daf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7403abd4f0f6b2a8237aaa49bee9081e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7403abd4f0f6b2a8237aaa49bee9081e">multiphase_eos::metal_dissolution</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:a7403abd4f0f6b2a8237aaa49bee9081e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the partition coefficient, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not.  <a href="namespacemultiphase__eos.html#a7403abd4f0f6b2a8237aaa49bee9081e">More...</a><br /></td></tr>
<tr class="separator:a7403abd4f0f6b2a8237aaa49bee9081e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad552bb5fe3f1a7753cb81faaf6097893"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ad552bb5fe3f1a7753cb81faaf6097893">multiphase_eos::metal_precipitation</a> (state, packed_state, Mdims, ndgln, dt)</td></tr>
<tr class="memdesc:ad552bb5fe3f1a7753cb81faaf6097893"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the precipitation rate, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not.  <a href="namespacemultiphase__eos.html#ad552bb5fe3f1a7753cb81faaf6097893">More...</a><br /></td></tr>
<tr class="separator:ad552bb5fe3f1a7753cb81faaf6097893"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c4ed816844055b0ed8990bbbc37f11a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2c4ed816844055b0ed8990bbbc37f11a">multiphase_eos::total_mass_metal</a> (state, packed_state, Mdims, ndgln, CV_funs, metal_total_mass)</td></tr>
<tr class="memdesc:a2c4ed816844055b0ed8990bbbc37f11a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to calculate the metal total mass (in kg).  <a href="namespacemultiphase__eos.html#a2c4ed816844055b0ed8990bbbc37f11a">More...</a><br /></td></tr>
<tr class="separator:a2c4ed816844055b0ed8990bbbc37f11a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8db613abbe75c163af30406a36bfc49"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac8db613abbe75c163af30406a36bfc49">multiphase_eos::bound_metal_concentrations</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:ac8db613abbe75c163af30406a36bfc49"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to bound the metal concentrations after an adapt, in order to avoid unphysical values.  <a href="namespacemultiphase__eos.html#ac8db613abbe75c163af30406a36bfc49">More...</a><br /></td></tr>
<tr class="separator:ac8db613abbe75c163af30406a36bfc49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e3f9c0b2e55a90103c72b4570f45e48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2e3f9c0b2e55a90103c72b4570f45e48">multiphase_eos::correction_mass_metal</a> (state, packed_state, Mdims, ndgln, total_mass_before, total_mass_after)</td></tr>
<tr class="memdesc:a2e3f9c0b2e55a90103c72b4570f45e48"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to apply a correction factor to the metal concentrations in order to conserve mass if needed.  <a href="namespacemultiphase__eos.html#a2e3f9c0b2e55a90103c72b4570f45e48">More...</a><br /></td></tr>
<tr class="separator:a2e3f9c0b2e55a90103c72b4570f45e48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84fa5e7155dc42f6e8365fc6a0dfd899"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a84fa5e7155dc42f6e8365fc6a0dfd899">multiphase_eos::copy_metal_field</a> (state, packed_state, Mdims, ndgln)</td></tr>
<tr class="memdesc:a84fa5e7155dc42f6e8365fc6a0dfd899"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to copy a Metal Field into a copied field BEFORE the exchange steps happen (dissolution or precipitation). This can be used to have access to a liquid or solid metal field before the exchange step has happened.  <a href="namespacemultiphase__eos.html#a84fa5e7155dc42f6e8365fc6a0dfd899">More...</a><br /></td></tr>
<tr class="separator:a84fa5e7155dc42f6e8365fc6a0dfd899"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae1ce91e74714b2c125d7a764aaa79ff3"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae1ce91e74714b2c125d7a764aaa79ff3">multiphase_eos::flooding_hmin</a> = 1e-5</td></tr>
<tr class="separator:ae1ce91e74714b2c125d7a764aaa79ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function/Subroutine Documentation</h2>
<a id="a2e38f3c2af7da0c1a95bbb5e485cf0b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e38f3c2af7da0c1a95bbb5e485cf0b7">&#9670;&nbsp;</a></span>calculate_porousmedia_adv_terms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine calculate_porousmedia_absorptionterms::calculate_porousmedia_adv_terms </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_field), intent(inout)&#160;</td>
          <td class="paramname"><em>PorousMedia_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_ndgln ), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (porous_adv_coefs), intent(inout)&#160;</td>
          <td class="paramname"><em>upwnd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>viscosities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the absorption and its derivatives against the saturation </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_cgraph.png" border="0" usemap="#multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_cgraph" alt=""/></div>
<map name="multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_cgraph" id="multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_cgraph">
<area shape="rect" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="5,23,179,65"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="227,23,419,65"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="467,23,627,65"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="675,23,829,65"/>
<area shape="rect" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="877,5,1048,32"/>
<area shape="rect" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="905,56,1021,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_icgraph.png" border="0" usemap="#multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_icgraph" id="multi__eos_8_f90_a2e38f3c2af7da0c1a95bbb5e485cf0b7_icgraph">
<area shape="rect" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1032,5,1205,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="756,5,984,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,35,708,76"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a7b4b5e95a2c1b64f376a9c4092d60c0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7b4b5e95a2c1b64f376a9c4092d60c0a">&#9670;&nbsp;</a></span>calculate_suf_sig_diagten_bc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine calculate_porousmedia_absorptionterms::calculate_suf_sig_diagten_bc </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), intent(inout)&#160;</td>
          <td class="paramname"><em>packed_state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension( mdims%stotel * mdims%cv_snloc * mdims%nphase, mdims%ndim ), intent(inout)&#160;</td>
          <td class="paramname"><em>suf_sig_diagten_bc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_shape_funs), intent(inout)&#160;</td>
          <td class="paramname"><em>CV_funs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_gi_dimensions), intent(in)&#160;</td>
          <td class="paramname"><em>CV_GIdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_sparsities), intent(in)&#160;</td>
          <td class="paramname"><em>Mspars</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(multi_ndgln), intent(in)&#160;</td>
          <td class="paramname"><em>ndgln</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type (multi_field), intent(inout)&#160;</td>
          <td class="paramname"><em>PorousMedia_absorp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type(state_type), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:, :, :), intent(in), target&#160;</td>
          <td class="paramname"><em>inv_perm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(in)&#160;</td>
          <td class="paramname"><em>viscosities</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Computes the absorption and its derivatives against the saturation on the boundary </p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_cgraph.png" border="0" usemap="#multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_cgraph" alt=""/></div>
<map name="multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_cgraph" id="multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_cgraph">
<area shape="rect" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="5,31,217,57"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="265,23,425,65"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="473,23,628,65"/>
<area shape="rect" href="multi__eos_8_f90.html#a0f94604be6099dd1304ee7568ad7aac1" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="676,5,847,32"/>
<area shape="rect" href="multi__eos_8_f90.html#afb461540e77781fc8560dcdf98a7ed12" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="703,56,819,83"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_icgraph.png" border="0" usemap="#multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_icgraph" id="multi__eos_8_f90_a7b4b5e95a2c1b64f376a9c4092d60c0a_icgraph">
<area shape="rect" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="1032,13,1244,39"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="756,5,984,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,35,708,76"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="acd1caed43acc66691c351206d8dd7b2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd1caed43acc66691c351206d8dd7b2c">&#9670;&nbsp;</a></span>get_cappressure()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">pure real function calculate_capillary_pressure::get_cappressure </td>
          <td>(</td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Pe</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:), intent(in)&#160;</td>
          <td class="paramname"><em>CV_Immobile_Fraction</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>Imbibition_term</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>iphase</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:This functions returns the capillary pressure for a certain input saturation </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_acd1caed43acc66691c351206d8dd7b2c_icgraph.png" border="0" usemap="#multi__eos_8_f90_acd1caed43acc66691c351206d8dd7b2c_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_acd1caed43acc66691c351206d8dd7b2c_icgraph" id="multi__eos_8_f90_acd1caed43acc66691c351206d8dd7b2c_icgraph">
<area shape="rect" title=":This functions returns the capillary pressure for a certain input saturation" alt="" coords="964,13,1093,39"/>
<area shape="rect" href="namespacemultiphase__eos.html#add6fbcd53b92e8dd346a9ac6fbc30055" title=": In this subroutine the capilalry pressure is computed based on the saturation and the formula used" alt="" coords="724,5,916,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ae5be4b78c1796fac4008d398a7cdd0aa" title="Calls to generate the Gradient Matrix, the divergence matrix, the momentum matrix and the mass matrix..." alt="" coords="467,5,676,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a5d9a124e3bfdcebea01989fde6ea5cd1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d9a124e3bfdcebea01989fde6ea5cd1">&#9670;&nbsp;</a></span>linear_eos_formula()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine calculate_rho_drhodp::linear_eos_formula </td>
          <td>(</td>
          <td class="paramtype">real, dimension( : ), intent(inout)&#160;</td>
          <td class="paramname"><em>rho_internal</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a5d9a124e3bfdcebea01989fde6ea5cd1_icgraph.png" border="0" usemap="#multi__eos_8_f90_a5d9a124e3bfdcebea01989fde6ea5cd1_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_a5d9a124e3bfdcebea01989fde6ea5cd1_icgraph" id="multi__eos_8_f90_a5d9a124e3bfdcebea01989fde6ea5cd1_icgraph">
<area shape="rect" title=" " alt="" coords="947,46,1093,73"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee" title=": Computes the density and the derivative of the density" alt="" coords="707,39,899,80"/>
<area shape="rect" href="namespacemultiphase__eos.html#ab16c45da0af88c69945beac4e3334349" title=": Computes the density for the phases and the derivatives of the density" alt="" coords="467,5,659,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a3c4f57d9c50b3421a8059d73fb260dd5" title=": Computes the density for the components and the derivatives of the density This is were the action ..." alt="" coords="467,71,659,112"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,13,401,39"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,67,419,108"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,67,171,108"/>
</map>
</div>

</div>
</div>
<a id="a0f94604be6099dd1304ee7568ad7aac1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f94604be6099dd1304ee7568ad7aac1">&#9670;&nbsp;</a></span>relperm_corey_epsilon()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_relperm::relperm_corey_epsilon </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>Kr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid getting a relperm=0 that may give problems when dividing it to obtain the sigma. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a0f94604be6099dd1304ee7568ad7aac1_icgraph.png" border="0" usemap="#multi__eos_8_f90_a0f94604be6099dd1304ee7568ad7aac1_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_a0f94604be6099dd1304ee7568ad7aac1_icgraph" id="multi__eos_8_f90_a0f94604be6099dd1304ee7568ad7aac1_icgraph">
<area shape="rect" title=": Brooks corey model of relperm. This subroutine add a small quantity to the corey function to avoid ..." alt="" coords="1943,42,2113,69"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1740,35,1895,76"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1532,35,1692,76"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1292,5,1484,47"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="1032,71,1244,98"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1051,5,1225,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="756,35,984,76"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,35,419,76"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,64,708,105"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,35,171,76"/>
</map>
</div>

</div>
</div>
<a id="afb461540e77781fc8560dcdf98a7ed12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb461540e77781fc8560dcdf98a7ed12">&#9670;&nbsp;</a></span>relperm_stone()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_relperm::relperm_stone </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>Kr</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>:This subroutine calculates the relative permeability for three phases First phase has to be water, second oil and the third gas We use Stone's model II adapted, and for the two phases we use the Corey model Model explained in: Aziz, K. And Settari, T.:“Petroleum Reservoir Simulation” Applied Science Publishers, London, 30-38, 1979. </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_afb461540e77781fc8560dcdf98a7ed12_icgraph.png" border="0" usemap="#multi__eos_8_f90_afb461540e77781fc8560dcdf98a7ed12_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_afb461540e77781fc8560dcdf98a7ed12_icgraph" id="multi__eos_8_f90_afb461540e77781fc8560dcdf98a7ed12_icgraph">
<area shape="rect" title=":This subroutine calculates the relative permeability for three phases First phase has to be water,..." alt="" coords="1943,42,2059,69"/>
<area shape="rect" href="namespacemultiphase__eos.html#afa5bc056e9d4cafeb1706afca8e780c1" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1740,35,1895,76"/>
<area shape="rect" href="namespacemultiphase__eos.html#af235dd0c336c71b8afbfb65399766c10" title=":Calculates the relative permeability for 1, 2 (Brooks&#45;corey) or 3 (stone&#39;s model) phases" alt="" coords="1532,35,1692,76"/>
<area shape="rect" href="namespacemultiphase__eos.html#a659427fd61af753266767259b441a345" title=": Subroutine where the absorption for the porous media is actually computed" alt="" coords="1292,5,1484,47"/>
<area shape="rect" href="multi__eos_8_f90.html#a7b4b5e95a2c1b64f376a9c4092d60c0a" title=": Computes the absorption and its derivatives against the saturation on the boundary" alt="" coords="1032,71,1244,98"/>
<area shape="rect" href="multi__eos_8_f90.html#a2e38f3c2af7da0c1a95bbb5e485cf0b7" title=": Computes the absorption and its derivatives against the saturation" alt="" coords="1051,5,1225,47"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="756,35,984,76"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,35,419,76"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,64,708,105"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,35,171,76"/>
</map>
</div>

</div>
</div>
<a id="aa152716c3e7e6d83fb9b90b26a9c7be7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa152716c3e7e6d83fb9b90b26a9c7be7">&#9670;&nbsp;</a></span>set_viscosity()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine calculate_porousmedia_absorptionterms::set_viscosity </td>
          <td>(</td>
          <td class="paramtype">integer, intent(in)&#160;</td>
          <td class="paramname"><em>nphase</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( multi_dimensions ), intent(in)&#160;</td>
          <td class="paramname"><em>Mdims</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">type( state_type ), dimension( : ), intent(in)&#160;</td>
          <td class="paramname"><em>state</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, dimension(:,:), intent(inout)&#160;</td>
          <td class="paramname"><em>visc_phases</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: For porous media, just sets the viscosity as a scalar </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_aa152716c3e7e6d83fb9b90b26a9c7be7_icgraph.png" border="0" usemap="#multi__eos_8_f90_aa152716c3e7e6d83fb9b90b26a9c7be7_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_aa152716c3e7e6d83fb9b90b26a9c7be7_icgraph" id="multi__eos_8_f90_aa152716c3e7e6d83fb9b90b26a9c7be7_icgraph">
<area shape="rect" title=": For porous media, just sets the viscosity as a scalar" alt="" coords="1032,13,1139,39"/>
<area shape="rect" href="namespacemultiphase__eos.html#a1d4a7655cae6c58eae3fc141d80d5639" title=": Here we compute the absorption for porous media This is the sigma term defined in the papers and co..." alt="" coords="756,5,984,47"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,5,419,47"/>
<area shape="rect" href="namespacemultiphase__1d__engine.html#ad29606c63b241238edd97827aa4564d7" title="Calls to generate the transport equation for the saturation. Embeded an FPI with backtracking method ..." alt="" coords="467,35,708,76"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,5,171,47"/>
</map>
</div>

</div>
</div>
<a id="a098f3f1c27b74be5d61f21fcff4c50a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a098f3f1c27b74be5d61f21fcff4c50a7">&#9670;&nbsp;</a></span>update_saturation_flipping()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">subroutine get_rockfluidprop::update_saturation_flipping </td>
          <td>(</td>
          <td class="paramtype">real, intent(inout)&#160;</td>
          <td class="paramname"><em>sat_flip</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>sat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">real, intent(in)&#160;</td>
          <td class="paramname"><em>old_Sat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>: This internal subroutine checks the if we are flipping from drainage to imbibition, or the other way round, and updates if required the value stored in Saturation_flipping Saturation_flipping stores both the value and the history, being positive if the phase is increasing and negative if the phase is decreasing. Therefore its minimum absolute value is non-zero NOTE: Currently the trapping can only increase, i.e. no thermal effects have been considered </p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90_a098f3f1c27b74be5d61f21fcff4c50a7_icgraph.png" border="0" usemap="#multi__eos_8_f90_a098f3f1c27b74be5d61f21fcff4c50a7_icgraph" alt=""/></div>
<map name="multi__eos_8_f90_a098f3f1c27b74be5d61f21fcff4c50a7_icgraph" id="multi__eos_8_f90_a098f3f1c27b74be5d61f21fcff4c50a7_icgraph">
<area shape="rect" title=": This internal subroutine checks the if we are flipping from drainage to imbibition,..." alt="" coords="669,35,865,61"/>
<area shape="rect" href="namespacemultiphase__eos.html#aeb644e3565a7e33c61f0e40e73a3c990" title=":Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed st..." alt="" coords="467,27,621,69"/>
<area shape="rect" href="_multiphase___time_loop_8_f90.html#acdc79e479d6b4674e9471ef506d78b2f" title=" " alt="" coords="236,5,401,32"/>
<area shape="rect" href="namespacemultiphase__time__loop.html#a04598d33bda1f46f9537570dbc0119bc" title="This is the main subroutine from which everything is called. It performs the time&#45;loop and therefore ..." alt="" coords="219,57,419,98"/>
<area shape="rect" href="_multiphase___prototype___wrapper_8_f90.html#a0849c5f8b4a25b1987221c6a5a69eeda" title=" " alt="" coords="5,57,171,98"/>
</map>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="multi__eos_8_f90.html">multi_eos.F90</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.17 </li>
  </ul>
</div>
</body>
</html>
