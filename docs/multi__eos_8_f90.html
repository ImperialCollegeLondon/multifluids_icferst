<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ICFERST: /home/mbahlali/Softwares/multifluids_icferst/ICFERST/src/multi_eos.F90 File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="IC_FERST_Logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">ICFERST<span id="projectnumber">&#160;25-11</span>
   </div>
   <div id="projectbrief">Reservoir simulator based on DCVFEM, Dynamic Mesh optimisation and Surface-based modelling</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('multi__eos_8_f90.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#namespaces">Modules</a> &#124;
<a href="#func-members">Functions/Subroutines</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">multi_eos.F90 File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;fdebug.h&quot;</code><br />
</div><div class="textblock"><div class="dynheader">
Include dependency graph for multi_eos.F90:</div>
<div class="dyncontent">
<div class="center"><img src="multi__eos_8_f90__incl.png" border="0" usemap="#a_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2multi__eos_8_f90" alt=""/></div>
<map name="a_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2multi__eos_8_f90" id="a_2home_2mbahlali_2_softwares_2multifluids__icferst_2_i_c_f_e_r_s_t_2src_2multi__eos_8_f90">
<area shape="rect" title=" " alt="" coords="5,5,207,60"/>
<area shape="rect" title=" " alt="" coords="67,108,145,133"/>
<area shape="poly" title=" " alt="" coords="109,60,109,94,103,94,103,60"/>
</map>
</div>
</div><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="namespaces" name="namespaces"></a>
Modules</h2></td></tr>
<tr class="memitem:namespacemultiphase__eos" id="r_namespacemultiphase__eos"><td class="memItemLeft" align="right" valign="top">module &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html">multiphase_eos</a></td></tr>
<tr class="memdesc:namespacemultiphase__eos"><td class="mdescLeft">&#160;</td><td class="mdescRight">This module contains subroutines related to the equations of state and other properties such as relative permeabilities, capillary, flash, etc. <br /></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions/Subroutines</h2></td></tr>
<tr class="memitem:aa9c34f49e15895fb6f72fb4d4d64888c" id="r_aa9c34f49e15895fb6f72fb4d4d64888c"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa9c34f49e15895fb6f72fb4d4d64888c">multiphase_eos::calculate_all_rhos</a> (state, packed_state, mdims, get_rhocp)</td></tr>
<tr class="memdesc:aa9c34f49e15895fb6f72fb4d4d64888c"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density for the phases and the derivatives of the density  <br /></td></tr>
<tr class="separator:aa9c34f49e15895fb6f72fb4d4d64888c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab26b8d0ab306c408cbbbe8fb8b434e67" id="r_ab26b8d0ab306c408cbbbe8fb8b434e67"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ab26b8d0ab306c408cbbbe8fb8b434e67">multiphase_eos::cap_bulk_rho</a> (state, ncomp, nphase, cv_nonods, density_component, density, density_cp, compute_rhocp)</td></tr>
<tr class="memdesc:ab26b8d0ab306c408cbbbe8fb8b434e67"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the bulk density for components and the derivatives of the density  <br /></td></tr>
<tr class="separator:ab26b8d0ab306c408cbbbe8fb8b434e67"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d6fa81c0f3362cc2bd31a8eb9dcff1d" id="r_a0d6fa81c0f3362cc2bd31a8eb9dcff1d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a0d6fa81c0f3362cc2bd31a8eb9dcff1d">multiphase_eos::calculate_component_rho</a> (state, packed_state, mdims)</td></tr>
<tr class="memdesc:a0d6fa81c0f3362cc2bd31a8eb9dcff1d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density for the components and the derivatives of the density This is were the action is actually done, the other calculate rhos are wrappers  <br /></td></tr>
<tr class="separator:a0d6fa81c0f3362cc2bd31a8eb9dcff1d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f6a1c7227872bf2073b960ddfabedee" id="r_a3f6a1c7227872bf2073b960ddfabedee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3f6a1c7227872bf2073b960ddfabedee">multiphase_eos::calculate_rho_drhodp</a> (state, packed_state, iphase, icomp, nphase, ncomp, eos_option_path, rho, drhodp)</td></tr>
<tr class="memdesc:a3f6a1c7227872bf2073b960ddfabedee"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the density and the derivative of the density  <br /></td></tr>
<tr class="separator:a3f6a1c7227872bf2073b960ddfabedee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ad387db4c93247b485df667363b8d21" id="r_a3ad387db4c93247b485df667363b8d21"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a3ad387db4c93247b485df667363b8d21">multiphase_eos::calculate_porous_rho_drhop</a> (state, packed_state, mdims, cv_ndgln, drhodp_porous)</td></tr>
<tr class="memdesc:a3ad387db4c93247b485df667363b8d21"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine we calculate and update the density of the porous media based on the compressibility given in Diamond (ele-wise). We also calculate the drho/dp term for the porous media which then goes into the DERIV term in the continuity equation (cv-wise).  <br /></td></tr>
<tr class="separator:a3ad387db4c93247b485df667363b8d21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8a232db23e1c424de5863e14c559028" id="r_ae8a232db23e1c424de5863e14c559028"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae8a232db23e1c424de5863e14c559028">multiphase_eos::density_polynomial</a> (eos_coefs, pressure, temperature, density_field)</td></tr>
<tr class="memdesc:ae8a232db23e1c424de5863e14c559028"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Define de density as a polynomial  <br /></td></tr>
<tr class="separator:ae8a232db23e1c424de5863e14c559028"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac13395594592fe917fc20b7c3c2b7a5d" id="r_ac13395594592fe917fc20b7c3c2b7a5d"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac13395594592fe917fc20b7c3c2b7a5d">multiphase_eos::assign_equation_of_state</a> (eos_option_path_out)</td></tr>
<tr class="memdesc:ac13395594592fe917fc20b7c3c2b7a5d"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Read from diamond and decide which sort of density representation do we have  <br /></td></tr>
<tr class="separator:ac13395594592fe917fc20b7c3c2b7a5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c66b15baf1f392d67a7b875514f9db7" id="r_a8c66b15baf1f392d67a7b875514f9db7"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a8c66b15baf1f392d67a7b875514f9db7">multiphase_eos::calculate_porousmedia_absorptionterms</a> (nphase, state, packed_state, porousmedia_absorp, mdims, cv_funs, cv_gidims, mspars, ndgln, upwnd, suf_sig_diagten_bc)</td></tr>
<tr class="memdesc:a8c66b15baf1f392d67a7b875514f9db7"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Here we compute the absorption for porous media This is the sigma term defined in the papers and contains The permeability, the relative permeability, the viscosity and the saturation  <br /></td></tr>
<tr class="separator:a8c66b15baf1f392d67a7b875514f9db7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4c25264c85fc53c6e510fb601aaa3b58" id="r_a4c25264c85fc53c6e510fb601aaa3b58"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a4c25264c85fc53c6e510fb601aaa3b58">multiphase_eos::calculate_absorption2</a> (nphase, packed_state, porousmedia_absorp, mdims, ndgln, satura, viscosities, inv_porousmedia_absorp)</td></tr>
<tr class="memdesc:a4c25264c85fc53c6e510fb601aaa3b58"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Subroutine where the absorption for the porous media is actually computed  <br /></td></tr>
<tr class="separator:a4c25264c85fc53c6e510fb601aaa3b58"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19df2cd38bcac98a4dadc0a3327bc1d4" id="r_a19df2cd38bcac98a4dadc0a3327bc1d4"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a19df2cd38bcac98a4dadc0a3327bc1d4">multiphase_eos::get_material_absorption</a> (nphase, iphase, material_absorption, sat, visc, cv_immobile_fract, corey_exponent, endpoint_relperm)</td></tr>
<tr class="memdesc:a19df2cd38bcac98a4dadc0a3327bc1d4"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases  <br /></td></tr>
<tr class="separator:a19df2cd38bcac98a4dadc0a3327bc1d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b630dc39b8a9a21ef87319a98039974" id="r_a2b630dc39b8a9a21ef87319a98039974"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2b630dc39b8a9a21ef87319a98039974">multiphase_eos::get_relperm</a> (nphase, iphase, sat, cv_immobile_fract, corey_exponent, endpoint_relperm, kr)</td></tr>
<tr class="memdesc:a2b630dc39b8a9a21ef87319a98039974"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Calculates the relative permeability for 1, 2 (Brooks-corey) or 3 (stone's model) phases  <br /></td></tr>
<tr class="separator:a2b630dc39b8a9a21ef87319a98039974"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29b9750459911134c7e711f15fa42614" id="r_a29b9750459911134c7e711f15fa42614"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a29b9750459911134c7e711f15fa42614">multiphase_eos::normalise_relperm_tables</a> (nphase)</td></tr>
<tr class="separator:a29b9750459911134c7e711f15fa42614"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae38ba08b6363798b651a669f506ed944" id="r_ae38ba08b6363798b651a669f506ed944"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae38ba08b6363798b651a669f506ed944">multiphase_eos::compute_normalised_saturation</a> (s_phase, simm_phase, simm_all, nphase, iphase)</td></tr>
<tr class="memdesc:ae38ba08b6363798b651a669f506ed944"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes normalised saturation for Land trapping with tabulated relperm  <br /></td></tr>
<tr class="separator:ae38ba08b6363798b651a669f506ed944"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a481c8af5bd845806f46c11121270ecb9" id="r_a481c8af5bd845806f46c11121270ecb9"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a481c8af5bd845806f46c11121270ecb9">multiphase_eos::calculate_capillary_pressure</a> (packed_state, ndgln, totele, cv_nloc, cv_funs)</td></tr>
<tr class="memdesc:a481c8af5bd845806f46c11121270ecb9"><td class="mdescLeft">&#160;</td><td class="mdescRight">: In this subroutine the capilalry pressure is computed based on the saturation and the formula used  <br /></td></tr>
<tr class="separator:a481c8af5bd845806f46c11121270ecb9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0884f603bf7bf0a4b380eb50f6de51b7" id="r_a0884f603bf7bf0a4b380eb50f6de51b7"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a0884f603bf7bf0a4b380eb50f6de51b7">multiphase_eos::get_devcappressure</a> (sat, pe, a, cv_immobile_fraction, iphase, nphase)</td></tr>
<tr class="memdesc:a0884f603bf7bf0a4b380eb50f6de51b7"><td class="mdescLeft">&#160;</td><td class="mdescRight">:This functions returns the derivative of the capillary pressure with respect to the saturation  <br /></td></tr>
<tr class="separator:a0884f603bf7bf0a4b380eb50f6de51b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae699fc2f76cbea255bf9387531dd3a6b" id="r_ae699fc2f76cbea255bf9387531dd3a6b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae699fc2f76cbea255bf9387531dd3a6b">multiphase_eos::calculate_u_source_cv</a> (mdims, state, packed_state, den, u_source_cv)</td></tr>
<tr class="memdesc:ae699fc2f76cbea255bf9387531dd3a6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: This subroutine computed the gravity effect, i.e. rho * g  <br /></td></tr>
<tr class="separator:ae699fc2f76cbea255bf9387531dd3a6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96725046151437e274a33a1d0dd944ee" id="r_a96725046151437e274a33a1d0dd944ee"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a96725046151437e274a33a1d0dd944ee">multiphase_eos::calculate_diffusivity</a> (state, packed_state, mdims, ndgln, scalaradvectionfield_diffusion, tracername, divide_by_rho_cp)</td></tr>
<tr class="memdesc:a96725046151437e274a33a1d0dd944ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Here we compute component/solute/thermal diffusion coefficient  <br /></td></tr>
<tr class="separator:a96725046151437e274a33a1d0dd944ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af676f560af728589b6f716de6b010807" id="r_af676f560af728589b6f716de6b010807"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#af676f560af728589b6f716de6b010807">multiphase_eos::calculate_solute_dispersity</a> (state, packed_state, mdims, ndgln, density, solutedispersion)</td></tr>
<tr class="memdesc:af676f560af728589b6f716de6b010807"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Dispersion for porous media For thermal, the field density needs to be passed down, which ensures that even for boussinesq a reference density is still used  <br /></td></tr>
<tr class="separator:af676f560af728589b6f716de6b010807"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9bcaed7ce8cf8559509b9cda97129227" id="r_a9bcaed7ce8cf8559509b9cda97129227"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a9bcaed7ce8cf8559509b9cda97129227">multiphase_eos::calculate_viscosity</a> (state, mdims, ndgln, momentum_diffusion, momentum_diffusion2)</td></tr>
<tr class="memdesc:a9bcaed7ce8cf8559509b9cda97129227"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Computes the viscosity effect as a momemtum diffusion, this is zero for porous media  <br /></td></tr>
<tr class="separator:a9bcaed7ce8cf8559509b9cda97129227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae389bf78d79bfc3260a4b53fe2e117d8" id="r_ae389bf78d79bfc3260a4b53fe2e117d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae389bf78d79bfc3260a4b53fe2e117d8">multiphase_eos::compute_viscosity_eos</a> (state, mdims)</td></tr>
<tr class="memdesc:ae389bf78d79bfc3260a4b53fe2e117d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">In this subroutine we compute the viscosity EOS. Options for different EOS.  <br /></td></tr>
<tr class="separator:ae389bf78d79bfc3260a4b53fe2e117d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a1f78f9f889b58b7b9f45de20d5a48" id="r_a15a1f78f9f889b58b7b9f45de20d5a48"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a15a1f78f9f889b58b7b9f45de20d5a48">multiphase_eos::update_velocity_absorption</a> (states, ndim, nphase, velocity_absorption)</td></tr>
<tr class="memdesc:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="mdescLeft">&#160;</td><td class="mdescRight">:&lt;INERTIA ONLY&gt;Computes velocity absorption from diamond information  <br /></td></tr>
<tr class="separator:a15a1f78f9f889b58b7b9f45de20d5a48"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a98927879ae36867eabec1a9e6a5f22d8" id="r_a98927879ae36867eabec1a9e6a5f22d8"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a98927879ae36867eabec1a9e6a5f22d8">multiphase_eos::update_velocity_absorption_coriolis</a> (states, ndim, nphase, velocity_absorption)</td></tr>
<tr class="memdesc:a98927879ae36867eabec1a9e6a5f22d8"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Computes velocity absorption associated to coriolis forces from diamond information  <br /></td></tr>
<tr class="separator:a98927879ae36867eabec1a9e6a5f22d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c6ec01c9df40b9a0d17e20e9a230998" id="r_a6c6ec01c9df40b9a0d17e20e9a230998"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a6c6ec01c9df40b9a0d17e20e9a230998">multiphase_eos::update_velocity_source</a> (states, mdims, u_source)</td></tr>
<tr class="memdesc:a6c6ec01c9df40b9a0d17e20e9a230998"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Computes velocity source from diamond information  <br /></td></tr>
<tr class="separator:a6c6ec01c9df40b9a0d17e20e9a230998"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2591de41e9c67340b83129722447923b" id="r_a2591de41e9c67340b83129722447923b"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2591de41e9c67340b83129722447923b">multiphase_eos::saturation_temperature</a> (pressure)</td></tr>
<tr class="memdesc:a2591de41e9c67340b83129722447923b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: ????  <br /></td></tr>
<tr class="separator:a2591de41e9c67340b83129722447923b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a395898e344d06a03d2d26b52873c0f43" id="r_a395898e344d06a03d2d26b52873c0f43"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a395898e344d06a03d2d26b52873c0f43">multiphase_eos::get_rockfluidprop</a> (state, packed_state, mdims, ndgln, current_time, update_only)</td></tr>
<tr class="memdesc:a395898e344d06a03d2d26b52873c0f43"><td class="mdescLeft">&#160;</td><td class="mdescRight">:Gets the relperm max, the relperm exponent and the immobile fractions and stores them into packed state By index this is: 1) immobile fraction, 2) relperm max, 3)relperm exponent 4)Capillary entry pressure 5) Capillary exponent 6) Capillary imbition term The effective inmobile fraction is the min(inmobile,saturation_flipping formula), being the saturation the value after a succesful non-linear solver convergence! This NEEDS to be called after a succesful non-linear solver (with update_only)  <br /></td></tr>
<tr class="separator:a395898e344d06a03d2d26b52873c0f43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b318cf3867f6cc81cf7c1440423fa1a" id="r_a6b318cf3867f6cc81cf7c1440423fa1a"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a6b318cf3867f6cc81cf7c1440423fa1a">multiphase_eos::jwl</a> (a, b, w, r1, r2, e0, p, roe, ro)</td></tr>
<tr class="memdesc:a6b318cf3867f6cc81cf7c1440423fa1a"><td class="mdescLeft">&#160;</td><td class="mdescRight">JWL equation functions.  <br /></td></tr>
<tr class="separator:a6b318cf3867f6cc81cf7c1440423fa1a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace762205cf6d6212c2dac653a94529f1" id="r_ace762205cf6d6212c2dac653a94529f1"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ace762205cf6d6212c2dac653a94529f1">multiphase_eos::diffjwl</a> (a, b, w, r1, r2, e0, roe, ro)</td></tr>
<tr class="memdesc:ace762205cf6d6212c2dac653a94529f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Diff of JWL equation functions.  <br /></td></tr>
<tr class="separator:ace762205cf6d6212c2dac653a94529f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1eff68328331bdcc0f57b48c95f166f" id="r_ad1eff68328331bdcc0f57b48c95f166f"><td class="memItemLeft" align="right" valign="top">real function, dimension(jwln)&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ad1eff68328331bdcc0f57b48c95f166f">multiphase_eos::jwldensity</a> (eos_coefs, pressure, ro0, jwln)</td></tr>
<tr class="memdesc:ad1eff68328331bdcc0f57b48c95f166f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Density of JWL equation functions.  <br /></td></tr>
<tr class="separator:ad1eff68328331bdcc0f57b48c95f166f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a835077e39726b3800e5cf4483aa4374f" id="r_a835077e39726b3800e5cf4483aa4374f"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a835077e39726b3800e5cf4483aa4374f">multiphase_eos::initialise_porous_media</a> (mdims, ndgln, packed_state, state, exit_initialise_porous_media)</td></tr>
<tr class="memdesc:a835077e39726b3800e5cf4483aa4374f"><td class="mdescLeft">&#160;</td><td class="mdescRight">: Initialising porous media models Given a free water level (FWL) we simulate capillary gravity equilibration, control volumes below FWL is kept at residual lighter phase saturation This subroutine is called after each timestep and saturations overidden below FWL with the heavier phase  <br /></td></tr>
<tr class="separator:a835077e39726b3800e5cf4483aa4374f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282f02f39508adfb64d99bf4659af86c" id="r_a282f02f39508adfb64d99bf4659af86c"><td class="memItemLeft" align="right" valign="top">real function&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a282f02f39508adfb64d99bf4659af86c">multiphase_eos::retrieve_reference_density</a> (state, packed_state, iphase, icomp, nphase)</td></tr>
<tr class="memdesc:a282f02f39508adfb64d99bf4659af86c"><td class="mdescLeft">&#160;</td><td class="mdescRight">: For boussinesq porous media we need the reference density to ensure consistency when mixing with the porous density/Cp etc. In this subroutine we retrieve the value given a phase, component.  <br /></td></tr>
<tr class="separator:a282f02f39508adfb64d99bf4659af86c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeff150de8eae0969e4033a6093195584" id="r_aeff150de8eae0969e4033a6093195584"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aeff150de8eae0969e4033a6093195584">multiphase_eos::flash_gas_dissolution</a> (state, packed_state, mdims, ndgln)</td></tr>
<tr class="memdesc:aeff150de8eae0969e4033a6093195584"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to dissolv phase2 into phase1. Currently only for system for phase 1 = water, phase 2 = gas Dissolve instantaneously the amount introduced in diamond in mol/m3 for CO2 a reference number is 38 mol/m3. Requires the first phase to have a concentration field  <br /></td></tr>
<tr class="separator:aeff150de8eae0969e4033a6093195584"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbd0599284ff1bccc6a870df86e92b6a" id="r_afbd0599284ff1bccc6a870df86e92b6a"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#afbd0599284ff1bccc6a870df86e92b6a">multiphase_eos::metal_dissolution</a> (state, packed_state, mdims, ndgln)</td></tr>
<tr class="memdesc:afbd0599284ff1bccc6a870df86e92b6a"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to dissolve metals using a partition coefficient. Dissolve/precipitate instantaneously the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the partition coefficient, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not.  <br /></td></tr>
<tr class="separator:afbd0599284ff1bccc6a870df86e92b6a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae00dcf082c70a2e6ea8d7edf4ce33d6e" id="r_ae00dcf082c70a2e6ea8d7edf4ce33d6e"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae00dcf082c70a2e6ea8d7edf4ce33d6e">multiphase_eos::metal_precipitation</a> (state, packed_state, mdims, ndgln, dt)</td></tr>
<tr class="memdesc:ae00dcf082c70a2e6ea8d7edf4ce33d6e"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to precipitate metals using a precipitation rate. Precipitate the amount introduced in diamond in kg/kg. Requires to have the following scalar fields defined: a liquid metal passive tracer field (e.g., "PassiveTracer_Metal" - has to start with "PassiveTracer"), PassiveTracer_Metal, a solid metal field (e.g., "Metal_solid") the temperature/salt coefficient fields for the precipitation rate, defined as a function of salt and temperature. These coefficients are defined element-wise in porous_properties. Requires to define porous_properties (porous_density, porous_heat_capacity, porous_thermal_conductivity) regardless of whether the simulation includes temperature transport or not.  <br /></td></tr>
<tr class="separator:ae00dcf082c70a2e6ea8d7edf4ce33d6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4c613d46a08751cbced9c19cd1556e5" id="r_ad4c613d46a08751cbced9c19cd1556e5"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ad4c613d46a08751cbced9c19cd1556e5">multiphase_eos::total_mass_metal</a> (state, packed_state, mdims, ndgln, cv_funs, metal_total_mass)</td></tr>
<tr class="memdesc:ad4c613d46a08751cbced9c19cd1556e5"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to calculate the metal total mass (in kg).  <br /></td></tr>
<tr class="separator:ad4c613d46a08751cbced9c19cd1556e5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d3cacf80aac96bde1376ebacbbf6397" id="r_a7d3cacf80aac96bde1376ebacbbf6397"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a7d3cacf80aac96bde1376ebacbbf6397">multiphase_eos::bound_metal_concentrations</a> (state, packed_state, mdims, ndgln)</td></tr>
<tr class="memdesc:a7d3cacf80aac96bde1376ebacbbf6397"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to bound the metal concentrations after an adapt, in order to avoid unphysical values.  <br /></td></tr>
<tr class="separator:a7d3cacf80aac96bde1376ebacbbf6397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a729bdee190d0cd8fff93b8a67a4f6b" id="r_a2a729bdee190d0cd8fff93b8a67a4f6b"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2a729bdee190d0cd8fff93b8a67a4f6b">multiphase_eos::correction_mass_metal</a> (state, packed_state, mdims, ndgln, total_mass_before, total_mass_after)</td></tr>
<tr class="memdesc:a2a729bdee190d0cd8fff93b8a67a4f6b"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to apply a correction factor to the metal concentrations in order to conserve mass if needed.  <br /></td></tr>
<tr class="separator:a2a729bdee190d0cd8fff93b8a67a4f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2116f86a6c7996cd50c9e4d7f7255a50" id="r_a2116f86a6c7996cd50c9e4d7f7255a50"><td class="memItemLeft" align="right" valign="top">subroutine&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#a2116f86a6c7996cd50c9e4d7f7255a50">multiphase_eos::copy_metal_field</a> (state, packed_state, mdims, ndgln)</td></tr>
<tr class="memdesc:a2116f86a6c7996cd50c9e4d7f7255a50"><td class="mdescLeft">&#160;</td><td class="mdescRight">: subroutine to copy a Metal Field into a copied field BEFORE the exchange steps happen (dissolution or precipitation). This can be used to have access to a liquid or solid metal field before the exchange step has happened.  <br /></td></tr>
<tr class="separator:a2116f86a6c7996cd50c9e4d7f7255a50"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae1ce91e74714b2c125d7a764aaa79ff3" id="r_ae1ce91e74714b2c125d7a764aaa79ff3"><td class="memItemLeft" align="right" valign="top">real, parameter&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ae1ce91e74714b2c125d7a764aaa79ff3">multiphase_eos::flooding_hmin</a> = 1e-5</td></tr>
<tr class="separator:ae1ce91e74714b2c125d7a764aaa79ff3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9e26a6e715bbcea0e5f3d124871a8b2" id="r_ac9e26a6e715bbcea0e5f3d124871a8b2"><td class="memItemLeft" align="right" valign="top">logical, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac9e26a6e715bbcea0e5f3d124871a8b2">multiphase_eos::tables_loaded</a> = .false.</td></tr>
<tr class="separator:ac9e26a6e715bbcea0e5f3d124871a8b2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa82391e55c623b151745a9ef5fe09e97" id="r_aa82391e55c623b151745a9ef5fe09e97"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aa82391e55c623b151745a9ef5fe09e97">multiphase_eos::relperm_table_data</a></td></tr>
<tr class="separator:aa82391e55c623b151745a9ef5fe09e97"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad75fdebae56a34f58313eb37d69fae6e" id="r_ad75fdebae56a34f58313eb37d69fae6e"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ad75fdebae56a34f58313eb37d69fae6e">multiphase_eos::pc_table_data</a></td></tr>
<tr class="separator:ad75fdebae56a34f58313eb37d69fae6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aadda55c84c6fbe47425442430dc79dd4" id="r_aadda55c84c6fbe47425442430dc79dd4"><td class="memItemLeft" align="right" valign="top">real, dimension(:,:,:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aadda55c84c6fbe47425442430dc79dd4">multiphase_eos::relperm_table_norm_data</a></td></tr>
<tr class="separator:aadda55c84c6fbe47425442430dc79dd4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aede48d1965af522f9a3bfcf4148a9395" id="r_aede48d1965af522f9a3bfcf4148a9395"><td class="memItemLeft" align="right" valign="top">logical, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#aede48d1965af522f9a3bfcf4148a9395">multiphase_eos::tables_normalised</a> = .false.</td></tr>
<tr class="separator:aede48d1965af522f9a3bfcf4148a9395"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac225ca863b2915b70181fe53abe4d779" id="r_ac225ca863b2915b70181fe53abe4d779"><td class="memItemLeft" align="right" valign="top">real, dimension(:), allocatable, save&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacemultiphase__eos.html#ac225ca863b2915b70181fe53abe4d779">multiphase_eos::original_immobile_per_phase</a></td></tr>
<tr class="separator:ac225ca863b2915b70181fe53abe4d779"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="multi__eos_8_f90.html">multi_eos.F90</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
